<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>autoframe</title>
    <link rel="icon" type="image/png" href="../assets/images/favicon.png" />
    <link rel="shortcut icon" type="image/png" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/favicon.png" />
    <link rel="stylesheet" href="../../tokens/dist/tokens.css" />
    <link rel="stylesheet" href="../../typography/fonts.css" />
    <link rel="stylesheet" href="../../typography/tokens-typography.css" />
    <link rel="stylesheet" href="../assets/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="../../addons/sidebar/src/styles/sidebar.css" />
    <link rel="stylesheet" href="../../addons/subnav/src/styles/subnav.css" />
    <link rel="stylesheet" href="../../addons/tabbar/src/styles/tabbar.css" />
    <link rel="stylesheet" href="../../addons/tabs/src/styles/tabs.css" />
    <link rel="stylesheet" href="../../addons/segment-control/src/styles/segment-control.css" />
    <link rel="stylesheet" href="../../addons/breadcrumb/src/styles/breadcrumb.css" />
    <link rel="stylesheet" href="../../addons/pagination/src/styles/pagination.css" />
    <link rel="stylesheet" href="../../addons/data-table/src/styles/data-table.css" />
    <link rel="stylesheet" href="../../addons/toggle/src/styles/toggle.css" />
    <link rel="stylesheet" href="../../addons/menu/src/styles/menu.css" />
    <link rel="stylesheet" href="../../addons/menubar/src/styles/menubar.css" />
    <link rel="stylesheet" href="../../addons/metric-card/src/styles/metric-card.css" />
    <link rel="stylesheet" href="../../addons/nps-card/src/styles/nps-card.css" />
    <link rel="stylesheet" href="../../addons/progress-general-card/src/styles/progress-general-card.css" />
    <link rel="stylesheet" href="../../addons/score-card-metrics/src/styles/score-card-metrics.css" />
    <link rel="stylesheet" href="../../addons/participants-menu/src/styles/participants-menu.css" />
    <link rel="stylesheet" href="../../addons/badge/src/styles/badge.css" />
    <link rel="stylesheet" href="../../addons/slider/src/styles/slider.css" />
    <!-- Button Component CSS - COMPLETO INLINE (porque @import falla con file://) -->
    <style id="button-component-css">
      /* ========================================
         UBITS BUTTON COMPONENT
         Componente de botÃ³n con todas las variantes
         Usando tokens UBITS del nuevo autoframe
         ======================================== */

      /* BASE BUTTON STYLES */
      .ubits-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 16px;
        border: none;
        border-radius: 8px;
        font-family: var(--font-sans);
        font-weight: var(--weight-semibold);
        line-height: 1;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        user-select: none;
        white-space: nowrap;
        background: var(--ubits-button-primary-bg-default);
        color: var(--ubits-btn-primary-fg);
        border: 1px solid var(--ubits-button-primary-bg-default);
        height: 40px; /* Default MD size - will be overridden by size classes */
      }
      .ubits-button span {
        font-family: var(--font-sans);
        font-size: var(--font-body-md-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-md-line);
      }

      /* STATES */
      .ubits-button:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-hover);
        border-color: var(--ubits-button-primary-hover);
      }
      .ubits-button:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-pressed);
        border-color: var(--ubits-button-primary-pressed);
        transform: translateY(1px);
      }
      .ubits-button:focus-visible {
        outline: none;
        box-shadow: 0px 0px 0px 4px var(--ubits-button-focus-ring);
      }
      /* Disabled state - PERO NO cuando estÃ¡ en loading */
      .ubits-button:disabled:not(.ubits-button--loading),
      .ubits-button[aria-disabled="true"]:not(.ubits-button--loading) {
        background: var(--ubits-bg-disabled-button) !important;
        color: var(--ubits-fg-on-disabled-button) !important;
        border-color: var(--ubits-border-disabled-button) !important;
        cursor: not-allowed;
        pointer-events: none;
      }
      .ubits-button--primary:disabled:not(.ubits-button--loading),
      .ubits-button--secondary:disabled:not(.ubits-button--loading) {
        background: var(--ubits-bg-disabled-button) !important;
        color: var(--ubits-fg-on-disabled-button) !important;
        border-color: var(--ubits-border-disabled-button) !important;
        cursor: not-allowed;
        pointer-events: none;
      }
      /* Tertiary disabled mantiene su estilo pero con opacidad reducida */
      .ubits-button--tertiary:disabled:not(.ubits-button--loading) {
        background: transparent !important;
        color: var(--ubits-btn-tertiary-fg) !important;
        border-color: transparent !important;
        opacity: 0.5;
        cursor: not-allowed;
        pointer-events: none;
      }
      
      /* Loading state - MANTENER estilos de variante */
      .ubits-button--primary.ubits-button--loading:disabled,
      .ubits-button--primary.ubits-button--loading[disabled] {
        background: var(--ubits-button-primary-bg-default) !important;
        color: var(--ubits-btn-primary-fg) !important;
        border-color: var(--ubits-button-primary-bg-default) !important;
      }
      .ubits-button--secondary.ubits-button--loading:disabled,
      .ubits-button--secondary.ubits-button--loading[disabled] {
        background: var(--ubits-btn-secondary-bg-default) !important;
        color: var(--ubits-btn-secondary-fg-default) !important;
        border-color: var(--ubits-btn-secondary-border) !important;
      }
      .ubits-button--tertiary.ubits-button--loading:disabled,
      .ubits-button--tertiary.ubits-button--loading[disabled] {
        background: transparent !important;
        color: var(--ubits-btn-tertiary-fg) !important;
        border-color: transparent !important;
      }
      .ubits-button:disabled:not(.ubits-button--loading)::before,
      .ubits-button[aria-disabled="true"]:not(.ubits-button--loading)::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border: 1px solid var(--ubits-border-disabled-button);
        border-radius: 8px;
        pointer-events: none;
      }
      /* Tertiary disabled no debe tener el pseudo-elemento ::before */
      .ubits-button--tertiary:disabled:not(.ubits-button--loading)::before,
      .ubits-button--tertiary[aria-disabled="true"]:not(.ubits-button--loading)::before {
        content: none;
        border: none;
      }

      /* LOADING STATE - Mantener todos los estilos del botÃ³n */
      .ubits-button--loading,
      .ubits-button[data-loading="true"] {
        cursor: wait !important;
        pointer-events: none;
        position: relative;
        /* NO cambiar opacity ni otros estilos - mantener apariencia completa */
        /* Los estilos de variante se mantienen con mayor especificidad */
      }

      /* Reducir opacidad del texto/icono original (mantener visible) */
      .ubits-button--loading .button-text,
      .ubits-button[data-loading="true"] .button-text {
        opacity: 0.6;
        transition: opacity 0.2s ease;
      }

      /* Ocultar iconos normales cuando hay spinner */
      .ubits-button--loading > i:not(.ubits-button__spinner *),
      .ubits-button[data-loading="true"] > i:not(.ubits-button__spinner *) {
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      /* Spinner de UBITS dentro del botÃ³n */
      .ubits-button__spinner {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        margin: 0;
        padding: 0;
        line-height: 1;
      }

      /* Asegurar que el spinner tenga el color correcto segÃºn la variante del botÃ³n */
      .ubits-button--primary .ubits-button__spinner,
      .ubits-button--primary .ubits-button__spinner .ubits-spinner__segment {
        color: var(--ubits-btn-primary-fg, #ffffff) !important;
      }

      .ubits-button--secondary .ubits-button__spinner,
      .ubits-button--secondary .ubits-button__spinner .ubits-spinner__segment {
        color: var(--ubits-btn-secondary-fg-default, #303a47) !important;
      }

      .ubits-button--tertiary .ubits-button__spinner,
      .ubits-button--tertiary .ubits-button__spinner .ubits-spinner__segment {
        color: var(--ubits-btn-tertiary-fg, #5c646f) !important;
      }

      /* Ocultar label del spinner si existe dentro del botÃ³n */
      .ubits-button__spinner .ubits-spinner__label {
        display: none;
      }

      /* Ajustar tamaÃ±o del spinner dentro del botÃ³n */
      .ubits-button__spinner .ubits-spinner__circle {
        margin: 0;
      }

      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      /* VARIANTS */
      .ubits-button--primary {
        background: var(--ubits-button-primary-bg-default);
        color: var(--ubits-btn-primary-fg) !important;
        border: 1px solid var(--ubits-button-primary-bg-default);
      }
      /* Primary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--primary.ubits-button--loading,
      .ubits-button--primary.ubits-button--loading:disabled,
      .ubits-button--primary.ubits-button--loading[disabled] {
        background: var(--ubits-button-primary-bg-default) !important;
        color: var(--ubits-btn-primary-fg) !important;
        border-color: var(--ubits-button-primary-bg-default) !important;
      }
      .ubits-button--primary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-hover);
        border-color: var(--ubits-button-primary-hover);
      }
      .ubits-button--primary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-primary-pressed);
        border-color: var(--ubits-button-primary-pressed);
        transform: translateY(1px);
      }
      .ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border: 1px solid var(--ubits-accent-brand-static-inverted);
      }
      .ubits-button--active:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border-color: var(--ubits-accent-brand-static-inverted);
      }
      .ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border-color: var(--ubits-accent-brand-static-inverted);
      }
      .ubits-button--secondary {
        background: var(--ubits-btn-secondary-bg-default);
        color: var(--ubits-btn-secondary-fg-default);
        border: 1px solid var(--ubits-btn-secondary-border);
      }
      /* Secondary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--secondary.ubits-button--loading,
      .ubits-button--secondary.ubits-button--loading:disabled,
      .ubits-button--secondary.ubits-button--loading[disabled] {
        background: var(--ubits-btn-secondary-bg-default) !important;
        color: var(--ubits-btn-secondary-fg-default) !important;
        border-color: var(--ubits-btn-secondary-border) !important;
      }
      .ubits-button--secondary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-secondary-bg-hover);
        color: var(--ubits-btn-secondary-fg-default);
        border-color: var(--ubits-btn-secondary-border);
      }
      .ubits-button--secondary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-secondary-bg-pressed);
        color: var(--ubits-btn-secondary-fg-default);
        border-color: var(--ubits-btn-secondary-border);
        transform: translateY(1px);
      }
      .ubits-button--secondary.ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border: none;
      }
      .ubits-button--secondary.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading),
      .ubits-button--secondary.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border: none;
      }
      /* Estilos para el botÃ³n "Dejar de ver seleccionados" en modo dark */
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active,
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading),
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        color: var(--ubits-accent-brand-static-inverted, var(--ubits-fg-1-high)) !important;
      }
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active i,
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading) i,
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) i {
        color: var(--ubits-accent-brand-static-inverted, var(--ubits-fg-1-high)) !important;
      }
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active span,
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading) span,
      [data-theme="dark"] #action-btn-view-selected.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) span {
        color: var(--ubits-accent-brand-static-inverted, var(--ubits-fg-1-high)) !important;
      }
      .ubits-button--tertiary {
        background: transparent;
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
      }
      /* Tertiary con loading - mantener estilos incluso cuando disabled */
      .ubits-button--tertiary.ubits-button--loading,
      .ubits-button--tertiary.ubits-button--loading:disabled,
      .ubits-button--tertiary.ubits-button--loading[disabled] {
        background: transparent !important;
        color: var(--ubits-btn-tertiary-fg) !important;
        border-color: transparent !important;
      }
      .ubits-button--tertiary:hover:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-tertiary-bg-hover);
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-btn-tertiary-bg-pressed);
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
        transform: translateY(1px);
      }
      .ubits-button--tertiary.ubits-button--active {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary.ubits-button--active:hover:not(:disabled):not(.ubits-button--loading),
      .ubits-button--tertiary.ubits-button--active:active:not(:disabled):not(.ubits-button--loading) {
        background: var(--ubits-button-active-bg);
        color: var(--ubits-accent-brand-static-inverted);
        border: 1px solid transparent;
      }
      .ubits-button--tertiary:focus-visible {
        background: transparent;
        color: var(--ubits-btn-tertiary-fg);
        border: 1px solid transparent;
        outline: none;
        box-shadow: 0px 0px 0px 4px var(--ubits-button-focus-ring);
      }

      /* SIZES */
      .ubits-button--xs {
        padding: 8px 12px !important;
        height: 28px !important;
        gap: 6px !important;
        min-height: 28px !important;
      }
      .ubits-button--xs span,
      .ubits-button.ubits-button--xs span {
        font-family: var(--font-sans) !important;
        font-size: var(--font-body-xs-size) !important;
        font-weight: var(--weight-semibold) !important;
        line-height: var(--font-body-xs-line) !important;
      }
      .ubits-button--xs.ubits-button--icon-only {
        padding: 8px !important;
        width: 28px !important;
        height: 28px !important;
        min-width: 28px !important;
        min-height: 28px !important;
      }
      .ubits-button--xs i,
      .ubits-button.ubits-button--xs i {
        font-size: 12px !important;
      }
      .ubits-button--sm {
        padding: 10px 14px !important;
        height: 32px !important;
        gap: 6px !important;
        min-height: 32px !important;
      }
      .ubits-button--sm span,
      .ubits-button.ubits-button--sm span {
        font-family: var(--font-sans) !important;
        font-size: var(--font-body-sm-size) !important;
        font-weight: var(--weight-semibold) !important;
        line-height: var(--font-body-sm-line) !important;
      }
      .ubits-button--sm.ubits-button--icon-only {
        padding: 10px !important;
        width: 32px !important;
        height: 32px !important;
        min-width: 32px !important;
        min-height: 32px !important;
      }
      .ubits-button--sm i,
      .ubits-button.ubits-button--sm i {
        font-size: 14px !important;
      }
      .ubits-button--md,
      .ubits-button {
        padding: 12px 16px;
        height: 40px;
        gap: 8px;
      }
      .ubits-button--md span,
      .ubits-button span {
        font-family: var(--font-sans);
        font-size: var(--font-body-md-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-md-line);
      }
      .ubits-button--md.ubits-button--icon-only,
      .ubits-button.ubits-button--icon-only {
        padding: 12px;
        width: 40px;
        height: 40px;
        min-width: 40px;
        min-height: 40px;
      }
      .ubits-button--md i,
      .ubits-button i {
        font-size: 16px;
      }
      .ubits-button--lg {
        padding: 14px 20px !important;
        height: 48px !important;
        gap: 10px !important;
        min-height: 48px !important;
      }
      .ubits-button--lg span {
        font-family: var(--font-sans);
        font-size: var(--font-body-lg-size);
        font-weight: var(--weight-semibold);
        line-height: var(--font-body-lg-line);
      }
      .ubits-button--lg.ubits-button--icon-only {
        padding: 14px 16px;
        width: 48px;
        height: 48px;
      }
      .ubits-button--lg i {
        font-size: 18px;
      }
      .ubits-button--xl {
        padding: 16px 24px;
        height: 56px;
        gap: 10px;
      }
      .ubits-button--xl span {
        font-family: var(--font-sans);
        font-size: 22px;
        font-weight: var(--weight-semibold);
        line-height: 33px;
      }
      .ubits-button--xl.ubits-button--icon-only {
        padding: 16px 20px;
        width: 56px;
        height: 56px;
      }
      .ubits-button--xl i {
        font-size: 20px;
      }

      /* BADGE */
      .ubits-button__badge {
        position: absolute;
        top: -2px;
        right: -3px;
        width: 10px;
        height: 10px;
        background: var(--ubits-button-badge);
        border-radius: 50%;
      }
      .ubits-button--icon-only .ubits-button__badge {
        top: -2px;
        right: -2px;
      }

      /* ICON ONLY */
      .ubits-button--icon-only {
        padding: 12px;
        min-width: 40px;
        min-height: 40px;
      }

      /* MODIFIERS */
      .ubits-button--full-width {
        width: 100%;
        display: flex;
      }
      .ubits-button--block {
        display: flex;
        width: 100%;
      }
      .ubits-button--icon-right {
        flex-direction: row-reverse;
      }

      /* PREVIEW CONTROL BUTTONS */
      .preview-control-btn.active {
        background: var(--ubits-accent-brand-static-inverted) !important;
        color: var(--ubits-fg-bold, #ffffff) !important;
        border-color: var(--ubits-accent-brand-static-inverted) !important;
      }
      .preview-control-btn.active span {
        color: var(--ubits-fg-bold, #ffffff) !important;
      }
    </style>
    <!-- Badge Component CSS -->
    <link rel="stylesheet" href="../../addons/badge/src/styles/badge.css" />
    <!-- Accordion Component CSS -->
    <link rel="stylesheet" href="../../addons/accordion/src/styles/accordion.css" />
    <!-- Selection Card Component CSS -->
    <link rel="stylesheet" href="../../addons/selection-card/src/styles/selection-card.css" />
    <!-- Radio Button Component CSS (requerido por Selection Card) -->
    <link rel="stylesheet" href="../../addons/radio-button/src/styles/radio-button.css" />
    <!-- Stepper Component CSS -->
    <link rel="stylesheet" href="../../addons/stepper/src/styles/stepper.css" />
    <!-- Spinner Component CSS -->
    <link rel="stylesheet" href="../../addons/spinner/src/styles/spinner.css" />
    <!-- Empty State Component CSS -->
    <link rel="stylesheet" href="../../addons/empty-state/src/styles/empty-state.css" />
    <!-- Popover Component CSS -->
    <link rel="stylesheet" href="../../addons/popover/src/styles/popover.css" />
    <!-- Tooltip Component CSS -->
    <link rel="stylesheet" href="../../addons/tooltip/src/styles/tooltip.css" />
    <!-- Skeleton Component CSS -->
    <link rel="stylesheet" href="../../addons/skeleton/src/styles/skeleton.css" />
    <link rel="stylesheet" href="../../addons/alert/src/styles/alert.css" />
    <link rel="stylesheet" href="../../addons/toast/src/styles/toast.css" />
    <link rel="stylesheet" href="../../addons/input/src/styles/input.css" />
    <link rel="stylesheet" href="../../addons/list/src/styles/list.css" />
    <link rel="stylesheet" href="../../addons/card/src/styles/card.css" />
    <link rel="stylesheet" href="../../addons/card/src/styles/simple-card.css" />
    <link rel="stylesheet" href="../../addons/carousel/src/styles/carousel.css" />
    <link rel="stylesheet" href="../../addons/bar-metric-card/src/styles/bar-metric-card.css" />
    <link rel="stylesheet" href="../../addons/csat-metric-card/src/styles/csat-metric-card.css" />
    <link rel="stylesheet" href="../../addons/data-view/src/styles/data-view.css" />
    <link rel="stylesheet" href="../../addons/gallery/src/styles/gallery.css" />
    <link rel="stylesheet" href="../../addons/button/src/styles/button.css" />
    <link rel="stylesheet" href="../../addons/progress/src/styles/progress.css" />
    <style>
      /* Asegurar que FontAwesome se cargue correctamente */
      /* Si las fuentes no cargan, las clases .fa-*::before mostrarÃ¡n el contenido unicode */
      .fa, .far, .fas, i[class*="fa-"] {
        font-family: 'Font Awesome 6 Pro', var(--fa-style-family, 'Font Awesome 6 Pro');
        font-style: normal;
        font-weight: 400;
        display: inline-block;
        line-height: 1;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
      }
      .fas, i[class*="fas"] {
        font-weight: 900;
      }
      /* Fallback: Si las fuentes no cargan, mostrar unicode directamente */
      /* Estos cÃ³digos vienen del CSS de FontAwesome */
      .fa-plus::before { content: '\2b'; }
      .fa-check::before { content: '\f00c'; }
      .fa-trash::before { content: '\f1f8'; }
      .fa-edit::before { content: '\f044'; }
      .fa-user::before { content: '\f007'; }
      .fa-globe::before { content: '\f0ac'; }
      .fa-print::before { content: '\f02f'; }
      .fa-bars::before { content: '\f0c9'; }
      .fa-truck::before { content: '\f0d1'; }
      .fa-ghost::before { content: '\f6e2'; }
    </style>
    <style>
      body{font-family: var(--font-sans); margin:16px; background: var(--ubits-bg-2) !important; color: var(--ubits-fg-2-high)}
      /* Layout centrado */
      #sections-host{ max-width: 1120px; margin: 0 auto; padding: 12px 8px }
      .container{ max-width: 1120px; margin: 0 auto; width: 100%; padding: 0 8px }
      h1{margin:0 0 8px 0; color: var(--ubits-fg-2-high)}
      .subtitle{margin:0 0 24px 0; color: var(--ubits-fg-2-medium)}
      .columns{display:grid; grid-template-columns: 1fr 1fr; gap:16px}
      .columns + .columns{margin-top:24px}
      .panel{border:none; border-radius:10px; padding:16px; background: var(--ubits-bg-1)}
      .panel.dark{background: var(--ubits-bg-2); color: var(--ubits-fg-2-high); border:none}
      .section-title{font-weight: var(--weight-bold); margin:0 0 12px 0; color: var(--ubits-fg-1-high)}
      .grid{display:grid; grid-template-columns: 240px 1fr; gap:8px; align-items:center}
      .row{display:contents}
      .token-name{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
      .swatch{height:28px; border:none; border-radius:6px; margin-bottom:4px}
      code{font-size: var(--font-body-sm-size); color:inherit; opacity:.85}
      .copyable{cursor:pointer}
      .copied{outline:2px solid var(--ubits-accent-green); outline-offset:2px}
      .icon-card.copyable:hover{
        border-color: var(--ubits-accent-brand-static-inverted) !important;
        background: var(--ubits-bg-active) !important;
        transform: translateY(-2px);
        box-shadow: var(--ubits-effects-elevation-3);
      }
      .letter-section{
        margin-bottom: 32px;
      }
      .letter-grid{
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
      }
      .toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
        background: var(--ubits-bg-2); color: var(--ubits-fg-2-high); padding:10px 14px; border-radius:8px;
        box-shadow: var(--ubits-effects-elevation-4); font-size: var(--font-body-sm-size); opacity:0; pointer-events:none;
        transition:opacity .2s ease, transform .2s ease}
      .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px)}
      .navbar{display:flex; gap:20px; align-items:center; padding:10px 0; border-bottom:none; position:sticky; top:0; background: var(--ubits-bg-2); z-index:20}
      .nav-link{display:inline-flex; align-items:center; gap:8px; padding:8px 2px; color: var(--ubits-fg-2-medium); text-decoration:none; font-weight: var(--weight-semibold); line-height:1; border-bottom:2px solid transparent}
      .nav-link:hover{color: var(--ubits-fg-2-high)}
      .nav-link.active{color: var(--ubits-accent-brand-static-inverted); border-bottom-color: var(--ubits-accent-brand-static-inverted)}
      .tabs-wrap{position:sticky; top:0; z-index:20; margin-bottom:12px; background: var(--ubits-bg-2)}
      .layout-colors{display:flex; gap:16px; align-items:flex-start}
      .sidebar{width:320px}
      .sidebox{position:sticky; top:56px; border:none; border-radius:12px; padding:8px; background:var(--ubits-bg-1)}
      .side-title{font-size: var(--font-body-sm-size); color:var(--ubits-fg-1-medium); padding:8px 10px; font-weight: var(--weight-semibold); text-transform:uppercase; letter-spacing:0.5px}
      .category-toggle:hover{background-color: var(--ubits-bg-2);}
      .category-content{display: flex; flex-direction: column; gap: 6px; transition: opacity 0.2s ease;}
      .side{display:flex; flex-direction:column; gap:6px; max-height:calc(100vh - 140px); overflow-y:auto; padding-right:4px; scrollbar-width: thin; scrollbar-color: var(--ubits-fg-2-medium-static-inverted) transparent}
      /* Scrollbar personalizado UBITS para menÃºs laterales - Webkit (Chrome, Safari, Edge) */
      .side::-webkit-scrollbar{width:8px}
      .side::-webkit-scrollbar-track{background:transparent; border-radius:var(--ubits-border-radius-full, 1000px)}
      .side::-webkit-scrollbar-thumb{background:var(--ubits-fg-2-medium-static-inverted); border-radius:var(--ubits-border-radius-full, 1000px); opacity:0; transition:opacity 0.3s ease}
      .side:hover::-webkit-scrollbar-thumb{opacity:1}
      .side-link{padding:8px 10px; border-radius:8px; color:var(--ubits-fg-1-medium); text-decoration:none; font-weight: var(--weight-medium); white-space:nowrap; transition:background 0.2s ease, color 0.2s ease}
      .side-link:hover{background:var(--ubits-bg-2); color:var(--ubits-fg-2-high)}
      .side-link.active{background:var(--ubits-bg-2); color:var(--ubits-accent-brand-static-inverted); font-weight: var(--weight-semibold)}
      .content{flex:1; display:block; width:100%; margin:0; padding:0}
      #section-colores .columns{width:100%}
      #section-colores .cat-section{margin:0; padding:0}
      #section-colores .cat-section > .columns{margin-top:0}
      .section{display:none}
      .section.active{display:block}
      .kcard{background: var(--ubits-bg-1);border:none;border-radius:12px;padding:16px}
      .kstack{display:grid;gap:12px}
      .searchbar{margin:8px 0 16px; display:flex; justify-content:flex-end}
      .searchbar input{width:360px; padding:10px 12px; border:none; border-radius:8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-md-size)}
      /* TipografÃ­a vive en #section-texto */
      /* Nuevo menÃº (usa tokens) */
      /* Estilos para bloques copiables */
      .copyable-code-block{ position: relative; }
      .copyable-code-block pre{ position: relative; padding-right: 40px; cursor: pointer; transition: background 0.2s; }
      .copyable-code-block pre:hover{ background: var(--ubits-bg-active) !important; }
      .copyable-code-block .copy-btn{ position: absolute; top: 8px; right: 8px; background: var(--ubits-bg-1); border: none; border-radius: 6px; padding: 6px 10px; cursor: pointer; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-medium); transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
      .copyable-code-block .copy-btn:hover{ background: var(--ubits-accent-brand-static-inverted); color: var(--ubits-bg-1); border-color: var(--ubits-accent-brand-static-inverted); }
      .copyable-code-block .copy-btn.copied{ background: var(--ubits-accent-green); color: var(--ubits-bg-1); border-color: var(--ubits-accent-green); }
      .copyable-code-block .copy-btn i{ font-size: var(--font-body-sm-size); }
      
      .copyable-prompt{ position: relative; }
      .copyable-prompt .copy-btn{ position: absolute; top: 12px; right: 12px; background: var(--ubits-bg-1); border: none; border-radius: 6px; padding: 8px 12px; cursor: pointer; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-medium); transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
      .copyable-prompt .copy-btn:hover{ background: var(--ubits-accent-brand-static-inverted); color: var(--ubits-bg-1); border-color: var(--ubits-accent-brand-static-inverted); }
      .copyable-prompt .copy-btn.copied{ background: var(--ubits-accent-green); color: var(--ubits-bg-1); border-color: var(--ubits-accent-green); }
      .copyable-prompt .copy-btn i{ font-size: var(--font-body-sm-size); }
      
      #navbar2{ background: var(--ubits-bg-1); border-bottom:none; margin-bottom: 24px; padding: 12px 0; box-shadow: var(--ubits-effects-elevation-1, 0px 1px 2px 0px rgba(0, 0, 0, 0.12)); }
      #navbar2 .navbar2-container{ display: flex; gap: 32px; align-items: center; border-radius: 8px; }
      #navbar2 .ubits-logo{ display: flex; align-items: center; gap: 8px; margin-right: 16px; text-decoration: none; transition: transform 0.2s ease; }
      #navbar2 .ubits-logo:hover{ transform: scale(1.05); }
      #navbar2 .ubits-logo img{ width: 28px; height: 28px; transition: filter 0.2s ease; }
      #navbar2 .ubits-logo:hover img{ filter: brightness(1.1); }
      /* Mostrar logo segÃºn el tema */
      [data-theme="dark"] #navbar2 .autoframe-logo-dark{ display: block !important; }
      [data-theme="dark"] #navbar2 .autoframe-logo-light{ display: none !important; }
      [data-theme="light"] #navbar2 .autoframe-logo-dark{ display: none !important; }
      [data-theme="light"] #navbar2 .autoframe-logo-light{ display: block !important; }
      #navbar2 .ubits-logo-text{ font-size: var(--font-body-lg-size); font-weight: var(--weight-bold); color: var(--ubits-fg-1-high); transition: color 0.2s ease; }
      #navbar2 .ubits-logo:hover .ubits-logo-text{ color: var(--ubits-accent-brand-static-inverted); }
      #navbar2 .nav2-link{ color: var(--ubits-fg-1-medium); text-decoration:none; padding:10px 12px; border-bottom:2px solid transparent; transition:all .15s ease; display: flex; align-items: center; gap: 8px; font-size: var(--font-body-md-size); font-weight: var(--weight-medium); position: relative; }
      #navbar2 .nav2-link i{ font-size: var(--font-body-md-size); }
      #navbar2 .nav2-link:hover{ color: var(--ubits-fg-1-high); background: var(--ubits-bg-2); border-radius: 8px; }
      #navbar2 .nav2-link.active2{ color: var(--ubits-accent-brand-static-inverted); border-bottom-color: var(--ubits-accent-brand-static-inverted); }
      #navbar2 .nav2-link.has-submenu{ cursor: pointer; }
      #navbar2 .nav2-link.has-submenu .fa-chevron-down{ transition: transform 0.2s ease; }
      #navbar2 .nav2-link.has-submenu.submenu-open .fa-chevron-down{ transform: rotate(180deg); }
      #navbar2 .nav2-submenu{ display: none; position: absolute; top: 100%; left: 0; background: var(--ubits-bg-1); border-radius: 8px; padding: 8px 0; margin-top: 4px; min-width: 200px; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)); z-index: 1000; }
      #navbar2 .nav2-link.submenu-open .nav2-submenu{ display: block; }
      #navbar2 .nav2-submenu .nav2-subitem{ display: flex; align-items: center; gap: 8px; padding: 8px 16px; color: var(--ubits-fg-1-medium); text-decoration: none; font-size: var(--font-body-sm-size); transition: all 0.15s ease; }
      #navbar2 .nav2-submenu .nav2-subitem:hover{ background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); }
      #navbar2 .nav2-submenu .nav2-subitem.active{ color: var(--ubits-accent-brand-static-inverted); font-weight: var(--weight-semibold); }
      #navbar2 .nav2-submenu .nav2-subitem i{ font-size: var(--font-body-sm-size); }
      
      /* Dark Mode Toggle Button */
      #navbar2 .dark-mode-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        padding: 0;
        border: none;
        background: transparent;
        color: var(--ubits-fg-1-medium);
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.15s ease;
        margin-left: auto;
      }
      
      #navbar2 .dark-mode-toggle:hover {
        background: var(--ubits-bg-2);
        color: var(--ubits-fg-1-high);
      }
      
      #navbar2 .dark-mode-toggle:active {
        background: var(--ubits-bg-3);
      }
      
      #navbar2 .dark-mode-toggle i {
        font-size: var(--font-body-md-size);
        color: var(--ubits-fg-1-medium);
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        margin: 0 auto;
      }
      
      #navbar2 .dark-mode-toggle i::before {
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        width: 100%;
        height: 100%;
      }
      
      /* AnimaciÃ³n de transiciÃ³n de icono - una sola vuelta */
      #navbar2 .dark-mode-toggle i.ubits-icon-transition {
        animation: iconSpinFade 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      @keyframes iconSpinFade {
        0% {
          transform: rotate(0deg) scale(1);
          opacity: 1;
        }
        50% {
          transform: rotate(180deg) scale(1.2);
          opacity: 0.6;
        }
        100% {
          transform: rotate(360deg) scale(1);
          opacity: 1;
        }
      }
      
      #navbar2 .dark-mode-toggle:hover i {
        color: var(--ubits-fg-1-high);
      }
      
      /* Cambio de icono en modo oscuro */
      #navbar2 .dark-mode-toggle[data-theme="dark"] i {
        color: var(--ubits-fg-yellow-subtle);
      }
      
      #navbar2 .dark-mode-toggle[data-theme="light"] i {
        color: var(--ubits-fg-1-medium);
      }
      
      /* Espaciado entre navbar y tÃ­tulos de secciones */
      .section{ padding-top: 32px; }
      .section > h1{ margin-top: 0 !important; margin-bottom: 8px; }
      /* Unificar ancho en la secciÃ³n Colores para evitar cambios de tamaÃ±o al navegar */
      #section-espaciado > h1,
      #section-espaciado > p.subtitle,
      #section-espaciado > .searchbar,
      #section-espaciado > div[style*="display: flex"],
      #section-colores > h1,
      #section-colores > p.subtitle,
      #section-colores > .searchbar,
      #section-colores > .layout-colors,
      #section-grid-breakpoints > h1,
      #section-grid-breakpoints > p.subtitle,
      #section-grid-breakpoints > div[style*="display: flex"]{ max-width:1120px; margin-left:auto; margin-right:auto; padding-left:8px; padding-right:8px }
      #section-effects > h1,
      #section-effects > p.subtitle,
      #section-effects > div[style*="display: flex"]{ max-width:1120px; margin-left:auto; margin-right:auto; padding-left:8px; padding-right:8px }
      #section-effects.active{ display: block !important; visibility: visible !important; opacity: 1 !important; }
      #section-effects.active .cat-section[style*="display: block"]{ display: block !important; }
    </style>
  </head>
  <body data-theme="dark">
    <!-- Nuevo menÃº interno, independiente del menÃº anterior -->
    <nav id="navbar2" style="display:block; position:sticky; top:0; z-index:30">
      <div class="container">
        <div class="navbar2-container">
          <a href="#" class="ubits-logo" style="transition: transform 0.2s ease;">
            <img src="../assets/images/autoframe-logo-dark.png" alt="autoframe Logo" class="autoframe-logo-dark" style="width: 28px; height: 28px; display: block;" />
            <img src="../assets/images/autoframe-logo-light.png" alt="autoframe Logo" class="autoframe-logo-light" style="width: 28px; height: 28px; display: none;" />
            <span class="ubits-logo-text">autoframe</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-hub">
            <i class="fas fa-puzzle-piece"></i>
            <span>Hub</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-addons">
            <i class="fas fa-plug"></i>
            <span>Add-ons</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-colores">
            <i class="fas fa-palette"></i>
            <span>Colores</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-texto">
            <i class="fas fa-font"></i>
            <span>TipografÃ­a</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-espaciado" data-cat="espaciado-basico">
            <i class="fas fa-arrows-alt"></i>
            <span>Espaciado</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-grid-breakpoints" data-cat="breakpoints">
            <i class="fas fa-th"></i>
            <span>Grid y Breakpoints</span>
          </a>
          <a href="#" class="nav2-link" data-target="section-effects" data-cat="focus">
            <i class="fas fa-magic"></i>
            <span>Effects</span>
          </a>
          <button class="dark-mode-toggle" id="navbar-darkmode-toggle" data-theme="dark" title="Modo oscuro">
            <i class="fa-solid fa-sun-bright"></i>
          </button>
        </div>
      </div>
    </nav>
    <main id="sections-host" style="position:relative; z-index:1"></main>
    <div class="tabs-wrap" style="display:none">
      <nav class="navbar" aria-label="NavegaciÃ³n principal">
        <a class="nav-link" href="#hub" data-tab="hub">Hub</a>
        <a class="nav-link" href="#addons" data-tab="addons">Add-ons</a>
        <a class="nav-link active" href="#colores" data-tab="colores">Colores</a>
        <a class="nav-link" href="typo.html" data-tab="texto">TipografÃ­a</a>
        <a class="nav-link" href="#iconos" data-tab="iconos">Iconos</a>
        <a class="nav-link" href="#componentes" data-tab="componentes">Componentes</a>
        <a class="nav-link" href="#guia" data-tab="guia">GuÃ­a de prompts</a>
      </nav>
    </div>
    
    <div id="section-hub" class="section">
      <h1 class="ubits-heading-h1" style="color: var(--ubits-fg-2-high); margin-bottom: 8px;">Autoframe Hub</h1>
      <p class="subtitle" style="color: var(--ubits-fg-2-medium); margin-bottom: 32px; font-size: var(--font-body-md-size); line-height: var(--font-body-md-line);">
        Sistema central de orquestaciÃ³n de add-ons que permite conectar componentes UI, funcionalidades, tokens de diseÃ±o y mÃ¡s, todo desde un punto central.
      </p>
      
      <!-- Tabs para Â¿QuÃ© es? y CÃ³mo funciona -->
      <div style="display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 1px solid var(--ubits-border-1);">
        <button class="hub-tab-btn active" data-tab="que-es" onclick="switchHubTab('que-es')" style="background: none; border: none; padding: 12px 16px; cursor: pointer; color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); border-bottom: 2px solid var(--ubits-button-primary-bg-default);">
          Â¿QuÃ© es?
        </button>
        <button class="hub-tab-btn" data-tab="como-funciona" onclick="switchHubTab('como-funciona')" style="background: none; border: none; padding: 12px 16px; cursor: pointer; color: var(--ubits-fg-2-medium); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); border-bottom: 2px solid transparent;">
          CÃ³mo funciona
        </button>
      </div>
      
      <!-- Contenido: Â¿QuÃ© es? -->
      <div id="hub-content-que-es" class="hub-content" style="display: block;">
        <!-- Â¿QuÃ© es Autoframe Hub? -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ¯ Â¿QuÃ© es Autoframe Hub?</h3>
          <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0 0 16px 0;">
            <strong>Autoframe Hub</strong> es el sistema central de orquestaciÃ³n que gestiona todos los add-ons del proyecto. ActÃºa como un punto de conexiÃ³n Ãºnico donde puedes conectar componentes UI, funcionalidades, tokens de diseÃ±o, servicios externos y mÃ¡s.
          </p>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-top: 16px;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">CaracterÃ­sticas principales:</h4>
            <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
              <li><strong>OrquestaciÃ³n central:</strong> Gestiona el ciclo de vida de todos los add-ons</li>
              <li><strong>Modularidad:</strong> Conecta y desconecta add-ons segÃºn tus necesidades</li>
              <li><strong>ConfiguraciÃ³n unificada:</strong> Todo se configura desde un punto central</li>
              <li><strong>Intercambiabilidad:</strong> Cambia entre diferentes add-ons del mismo tipo fÃ¡cilmente</li>
              <li><strong>Extensibilidad:</strong> Agrega nuevos add-ons sin modificar el core</li>
            </ul>
          </div>
        </div>

        <!-- Estructura del Hub -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ“ Estructura del Hub</h3>
          <pre style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; overflow-x: auto; font-size: var(--font-body-xs-size); color: var(--ubits-fg-2-high); margin: 0; line-height: var(--font-body-sm-line); font-family: 'Monaco', 'Menlo', monospace;"><code>Autoframe/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ autoframe-core/        # Core del Hub (orquestador)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ AutoframeHub.ts    # Clase principal del Hub
â”‚   â”‚   â”‚   â”œâ”€â”€ AddonRegistry.ts   # Registro de add-ons
â”‚   â”‚   â”‚   â”œâ”€â”€ AddonLoader.ts     # Cargador de add-ons
â”‚   â”‚   â”‚   â”œâ”€â”€ ConfigManager.ts   # Gestor de configuraciÃ³n
â”‚   â”‚   â”‚   â””â”€â”€ interfaces/        # Interfaces de add-ons
â”‚   â”‚   â””â”€â”€ dist/                  # CÃ³digo compilado
â”‚   â”œâ”€â”€ addons/
â”‚   â”‚   â”œâ”€â”€ design/            # Add-ons de diseÃ±o
â”‚   â”‚   â”‚   â”œâ”€â”€ tokens/        # Tokens genÃ©ricos
â”‚   â”‚   â”‚   â”œâ”€â”€ typography/    # TipografÃ­a
â”‚   â”‚   â”‚   â””â”€â”€ templates-*/   # Templates
â”‚   â”‚   â”œâ”€â”€ functional/        # Add-ons funcionales
â”‚   â”‚   â”‚   â”œâ”€â”€ github/        # GitHub (auto-commit)
â”‚   â”‚   â”‚   â”œâ”€â”€ clarity/       # Microsoft Clarity
â”‚   â”‚   â”‚   â”œâ”€â”€ vercel/        # Vercel Deploy
â”‚   â”‚   â”‚   â”œâ”€â”€ storybook/     # Storybook
â”‚   â”‚   â”‚   â”œâ”€â”€ supabase/      # Supabase
â”‚   â”‚   â”‚   â”œâ”€â”€ ai/            # AI Assistant
â”‚   â”‚   â”‚   â””â”€â”€ ...            # MÃ¡s add-ons
â”‚   â”‚   â””â”€â”€ components/        # Add-ons de componentes UI
â”‚   â”‚       â”œâ”€â”€ button/
â”‚   â”‚       â”œâ”€â”€ sidebar/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ proyecto-app/        # AplicaciÃ³n principal
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ autoframe-init.cjs     # InicializaciÃ³n del Hub
â”‚   â””â”€â”€ autoframe-start.cjs    # Iniciar el Hub</code></pre>
        </div>

        <!-- Tipos de Add-ons -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ”Œ Tipos de Add-ons</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px;">
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">ğŸ¨ DiseÃ±o</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Tokens, tipografÃ­a, templates
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li>Tokens Autoframe</li>
                <li>TipografÃ­a</li>
                <li>Templates</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">âš™ï¸ Funcionales</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Servicios y herramientas
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li>GitHub</li>
                <li>Clarity</li>
                <li>Vercel</li>
                <li>Storybook</li>
                <li>Supabase</li>
                <li>AI Assistant</li>
                <li>Y mÃ¡s...</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">ğŸ§© Componentes</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Componentes UI reutilizables
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li>Button</li>
                <li>Sidebar</li>
                <li>Input</li>
                <li>Alert</li>
                <li>Toast</li>
                <li>Y mÃ¡s...</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- TecnologÃ­as -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ› ï¸ TecnologÃ­as</h3>
          <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0 0 16px 0;">
            Autoframe estÃ¡ construido con tecnologÃ­as modernas y estÃ¡ndares de la industria para garantizar rendimiento, escalabilidad y mantenibilidad.
          </p>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ’» Lenguajes y Runtime</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>TypeScript</strong> - Lenguaje principal para type safety</li>
                <li><strong>JavaScript (ES Modules)</strong> - Para scripts y compatibilidad</li>
                <li><strong>Node.js</strong> - Runtime para scripts y herramientas</li>
                <li><strong>HTML/CSS</strong> - Para templates y estilos</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ”¨ Build Tools</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Vite</strong> - Build tool y dev server</li>
                <li><strong>TypeScript Compiler (tsc)</strong> - CompilaciÃ³n de TypeScript</li>
                <li><strong>Style Dictionary</strong> - GeneraciÃ³n de design tokens</li>
                <li><strong>npm Workspaces</strong> - Monorepo management</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">âœ¨ Calidad de CÃ³digo</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Biome</strong> - Linter y formateador</li>
                <li><strong>ESLint</strong> - Linting adicional (en add-ons)</li>
                <li><strong>Prettier</strong> - Formateo de cÃ³digo</li>
                <li><strong>JEST</strong> - Testing unitario</li>
                <li><strong>Husky</strong> - Git hooks</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ¨ DiseÃ±o y UI</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>CSS Variables</strong> - Design tokens</li>
                <li><strong>Font Awesome</strong> - Iconos</li>
                <li><strong>Style Dictionary</strong> - Sistema de tokens</li>
                <li><strong>CSS Modules</strong> - Estilos modulares</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ“š Desarrollo y DocumentaciÃ³n</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Storybook</strong> - Desarrollo y documentaciÃ³n de componentes</li>
                <li><strong>Docusaurus</strong> - GeneraciÃ³n de documentaciÃ³n</li>
                <li><strong>Markdown</strong> - DocumentaciÃ³n</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">â˜ï¸ Servicios y APIs</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>GitHub API</strong> - Control de versiones y CI/CD</li>
                <li><strong>Vercel</strong> - Deployment y hosting</li>
                <li><strong>Supabase</strong> - Base de datos y autenticaciÃ³n</li>
                <li><strong>Microsoft Clarity</strong> - Analytics</li>
                <li><strong>Ollama / Google Gemini</strong> - AI Assistant</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ”§ Herramientas Adicionales</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Lighthouse</strong> - AuditorÃ­a de performance</li>
                <li><strong>i18n</strong> - InternacionalizaciÃ³n</li>
                <li><strong>Figma Sync</strong> - SincronizaciÃ³n con Figma</li>
                <li><strong>Git</strong> - Control de versiones</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Contenido: CÃ³mo funciona -->
      <div id="hub-content-como-funciona" class="hub-content" style="display: none;">
        <!-- Inicio RÃ¡pido -->
      <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
        <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸš€ Inicio RÃ¡pido</h3>
        <div style="display: grid; gap: 16px;">
          <div>
            <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">1. Clonar el Repositorio</h4>
            <div class="copyable-code-block">
              <pre data-code="git clone https://github.com/elkingarcia22/Autoframe.git
cd Autoframe" style="background: var(--ubits-bg-2); padding: 12px; border-radius: 8px; border: none; overflow-x: auto; font-size: var(--font-body-sm-size); color: var(--ubits-fg-2-high); margin: 0; font-family: 'Monaco', 'Menlo', monospace;"><code>git clone https://github.com/elkingarcia22/Autoframe.git
cd Autoframe</code></pre>
              <button class="copy-btn" onclick="copyCodeBlock(this)" title="Copiar cÃ³digo">
                <i class="far fa-copy"></i> <span>Copiar</span>
              </button>
            </div>
          </div>
          <div>
            <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">2. Instalar Dependencias</h4>
            <div class="copyable-code-block">
              <pre data-code="npm install" style="background: var(--ubits-bg-2); padding: 12px; border-radius: 8px; border: none; overflow-x: auto; font-size: var(--font-body-sm-size); color: var(--ubits-fg-2-high); margin: 0; font-family: 'Monaco', 'Menlo', monospace;"><code>npm install</code></pre>
              <button class="copy-btn" onclick="copyCodeBlock(this)" title="Copiar cÃ³digo">
                <i class="far fa-copy"></i> <span>Copiar</span>
              </button>
            </div>
          </div>
          <div>
            <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">3. Inicializar el Hub</h4>
            <div class="copyable-code-block">
              <pre data-code="node scripts/autoframe-init.cjs" style="background: var(--ubits-bg-2); padding: 12px; border-radius: 8px; border: none; overflow-x: auto; font-size: var(--font-body-sm-size); color: var(--ubits-fg-2-high); margin: 0; font-family: 'Monaco', 'Menlo', monospace;"><code>node scripts/autoframe-init.cjs</code></pre>
              <button class="copy-btn" onclick="copyCodeBlock(this)" title="Copiar cÃ³digo">
                <i class="far fa-copy"></i> <span>Copiar</span>
              </button>
            </div>
            <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 8px 0 0 0; line-height: var(--font-body-sm-line);">
              Este comando interactivo te guiarÃ¡ paso a paso: solicita URL del repositorio GitHub, permite seleccionar y configurar quÃ© add-ons quieres usar (diseÃ±o, componentes, funcionales), luego pregunta si quieres trabajar con un template (ej: UBITS) o construir desde cero, y configura el Hub automÃ¡ticamente con el validador activo.
            </p>
          </div>
          <div>
            <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">4. Iniciar Desarrollo</h4>
            <div class="copyable-code-block">
              <pre data-code="# Terminal 1: Auto-commit y validaciÃ³n
npm run watch

# Terminal 2: Servidor de desarrollo
npm run dev" style="background: var(--ubits-bg-2); padding: 12px; border-radius: 8px; border: none; overflow-x: auto; font-size: var(--font-body-sm-size); color: var(--ubits-fg-2-high); margin: 0; font-family: 'Monaco', 'Menlo', monospace;"><code># Terminal 1: Auto-commit y validaciÃ³n
npm run watch

# Terminal 2: Servidor de desarrollo
npm run dev</code></pre>
              <button class="copy-btn" onclick="copyCodeBlock(this)" title="Copiar cÃ³digo">
                <i class="far fa-copy"></i> <span>Copiar</span>
              </button>
            </div>
          </div>
        </div>
      </div>

        <!-- Proceso de InicializaciÃ³n -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">âš™ï¸ Proceso de InicializaciÃ³n</h3>
          <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0 0 16px 0;">
            Cuando ejecutas <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-2-high);">node scripts/autoframe-init.cjs</code>, el script te guÃ­a interactivamente:
          </p>
          <ol style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
            <li><strong>Solicita URL del repositorio GitHub:</strong> Para conectar el proyecto con tu repositorio remoto</li>
            <li><strong>Permite seleccionar add-ons:</strong> Elige quÃ© add-ons quieres usar (diseÃ±o, componentes, funcionales)</li>
            <li><strong>Configura cada add-on:</strong> Para cada add-on seleccionado, te pregunta por la configuraciÃ³n necesaria (API keys, URLs, etc.)</li>
            <li><strong>Genera el archivo de configuraciÃ³n:</strong> Crea o actualiza el archivo de configuraciÃ³n con todas las configuraciones</li>
            <li><strong>SelecciÃ³n de Template o ConstrucciÃ³n desde Cero:</strong> Te pregunta si quieres trabajar con un template existente (ej: UBITS) o construir tu proyecto desde cero</li>
            <li><strong>Inicializa Git:</strong> Si no existe, inicializa el repositorio Git y configura el remoto</li>
            <li><strong>Instala dependencias:</strong> Ejecuta <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-2-high);">npm install</code> para instalar todas las dependencias necesarias</li>
            <li><strong>Activa el Validador AutomÃ¡tico:</strong> Configura el sistema de validaciÃ³n que revisarÃ¡ tokens, tipografÃ­as y componentes durante el desarrollo</li>
          </ol>
        </div>

        <!-- CÃ³mo se Carga el Hub -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ”„ CÃ³mo se Carga el Hub</h3>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-bottom: 16px;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">1. InicializaciÃ³n del Hub</h4>
            <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
              El Hub se inicializa leyendo el archivo de configuraciÃ³n generado durante la inicializaciÃ³n, que contiene la informaciÃ³n de los add-ons seleccionados y configurados
            </p>
          </div>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-bottom: 16px;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">2. Carga de Add-ons</h4>
            <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
              El Hub busca los add-ons configurados en sus rutas especificadas y los carga dinÃ¡micamente usando el <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">AddonLoader</code>
            </p>
          </div>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-bottom: 16px;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">3. ResoluciÃ³n de Dependencias</h4>
            <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
              El Hub verifica que todas las dependencias entre add-ons estÃ©n satisfechas antes de activarlos
            </p>
          </div>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">4. ActivaciÃ³n</h4>
            <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
              Una vez cargados y validados, el Hub activa los add-ons en el orden correcto (respetando dependencias)
            </p>
          </div>
        </div>

        <!-- Flujo de Trabajo -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ”„ Flujo de Trabajo</h3>
          <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0 0 16px 0;">
            Una vez completada la inicializaciÃ³n (repositorio, add-ons configurados), comienza el flujo de desarrollo:
          </p>
          <div style="display: grid; gap: 12px;">
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">1. SelecciÃ³n de Template o ConstrucciÃ³n desde Cero</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                DespuÃ©s de configurar los add-ons, Autoframe te pregunta:
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Â¿Trabajar con un template existente?</strong> (ej: Template UBITS)</li>
                <li><strong>Â¿Construir desde cero?</strong> Crear tu propio proyecto</li>
              </ul>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 8px 0 0 0; line-height: var(--font-body-sm-line);">
                SegÃºn tu elecciÃ³n, se configuran automÃ¡ticamente los add-ons correspondientes (tokens, tipografÃ­as, componentes) y comienza el desarrollo.
              </p>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">2. Desarrollo con Validador AutomÃ¡tico</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Mientras trabajas, el <strong>Validador AutomÃ¡tico</strong> estÃ¡ activo y revisa en tiempo real:
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Tokens:</strong> Verifica que uses tokens del add-on seleccionado (ej: si usas UBITS, valida tokens <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">--ubits-*</code>)</li>
                <li><strong>TipografÃ­as:</strong> Valida que las clases de tipografÃ­a sean del add-on correcto</li>
                <li><strong>Componentes:</strong> Verifica que los componentes usados pertenezcan al add-on activo</li>
                <li><strong>Consistencia:</strong> Asegura que todo sea coherente con el add-on seleccionado</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">3. Reporte de ImplementaciÃ³n</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                DespuÃ©s de construir, el sistema genera un reporte automÃ¡tico:
              </p>
              <div style="background: var(--ubits-bg-1); padding: 12px; border-radius: 6px; border: none; margin-top: 8px;">
                <pre style="background: var(--ubits-bg-2); padding: 12px; border-radius: 6px; border: none; overflow-x: auto; font-size: var(--font-body-xs-size); color: var(--ubits-fg-2-high); margin: 0; line-height: var(--font-body-sm-line); font-family: 'Monaco', 'Menlo', monospace;"><code>âœ… Implementado:
  - 15 tokens del add-on UBITS
  - 8 componentes del add-on UBITS
  - 3 tipografÃ­as del add-on UBITS

âš ï¸ Componentes nuevos detectados:
  - custom-card (no existe en add-ons)
  - custom-modal (no existe en add-ons)

ğŸ’¡ El sistema crearÃ¡ estos componentes automÃ¡ticamente
   usando los tokens y tipografÃ­as del add-on UBITS.</code></pre>
              </div>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">4. CreaciÃ³n AutomÃ¡tica de Componentes</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Si creas un componente que no existe en los add-ons disponibles:
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>El sistema lo detecta</strong> y te informa que es necesario crearlo</li>
                <li><strong>Se crea automÃ¡ticamente</strong> usando los tokens y tipografÃ­as del add-on activo</li>
                <li><strong>Se integra</strong> con el sistema de add-ons para futuros usos</li>
                <li><strong>Mantiene consistencia</strong> con el resto del proyecto</li>
              </ul>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 8px 0 0 0; line-height: var(--font-body-sm-line);">
                <strong>Ejemplo:</strong> Si usas el add-on UBITS y creas un componente nuevo, se generarÃ¡ con tokens <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">--ubits-*</code> y tipografÃ­as <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">.ubits-*</code> automÃ¡ticamente.
              </p>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">5. Despliegue con Vercel</h4>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
                Una vez que hayas construido tu proyecto, puedes desplegarlo automÃ¡ticamente con Vercel:
              </p>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li><strong>Si configuraste el add-on de Vercel:</strong> El despliegue se puede hacer automÃ¡ticamente</li>
                <li><strong>Si lo solicitas:</strong> El sistema te pregunta si quieres desplegar ahora</li>
                <li><strong>Despliegue automÃ¡tico:</strong> Se conecta con Vercel y despliega tu proyecto</li>
                <li><strong>URL de producciÃ³n:</strong> Obtienes una URL pÃºblica para tu aplicaciÃ³n</li>
              </ul>
              <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 8px 0 0 0; line-height: var(--font-body-sm-line);">
                <strong>Nota:</strong> El despliegue con Vercel es opcional. Puedes construir tu proyecto sin desplegarlo, o desplegarlo mÃ¡s tarde cuando lo necesites.
              </p>
            </div>
          </div>
        </div>

        <!-- Validador AutomÃ¡tico -->
        <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px;">
          <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 16px 0; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">ğŸ›¡ï¸ Validador AutomÃ¡tico</h3>
          <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0 0 16px 0;">
            El validador automÃ¡tico es un sistema interno que garantiza la consistencia y calidad de tu cÃ³digo durante todo el desarrollo.
          </p>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">âœ… QuÃ© Valida</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li>Tokens usados pertenecen al add-on activo</li>
                <li>TipografÃ­as corresponden al add-on seleccionado</li>
                <li>Componentes son del add-on correcto</li>
                <li>No hay mezcla de add-ons diferentes</li>
                <li>Componentes nuevos se crean correctamente</li>
              </ul>
            </div>
            <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
              <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ“Š Reportes</h4>
              <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                <li>Conteo de tokens implementados</li>
                <li>Conteo de componentes usados</li>
                <li>DetecciÃ³n de componentes nuevos</li>
                <li>Alertas de inconsistencias</li>
                <li>Recomendaciones de mejora</li>
              </ul>
            </div>
          </div>
          <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-top: 16px;">
            <h4 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">ğŸ’¡ Ejemplo de ValidaciÃ³n</h4>
            <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 8px 0; line-height: var(--font-body-sm-line);">
              Si seleccionas el add-on <strong>UBITS</strong> y usas un token <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">--autoframe-bg-1</code>:
            </p>
            <div style="background: var(--ubits-bg-1); padding: 12px; border-radius: 6px; border: none; margin-top: 8px;">
              <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                âš ï¸ <strong>Alerta:</strong> Token <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-2-high);">--autoframe-bg-1</code> no pertenece al add-on UBITS activo.<br>
                ğŸ’¡ <strong>Sugerencia:</strong> Usa <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-2-high);">--ubits-bg-1</code> en su lugar.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SecciÃ³n Add-ons -->
    <div id="section-addons" class="section" style="display: none;">
      <h1 class="ubits-heading-h1" style="color: var(--ubits-fg-2-high); margin-bottom: 8px;">Add-ons</h1>
      <p class="subtitle" style="color: var(--ubits-fg-2-medium); margin-bottom: 32px; font-size: var(--font-body-md-size); line-height: var(--font-body-md-line);">
        DocumentaciÃ³n completa de todos los add-ons disponibles en Autoframe Hub, organizados por categorÃ­as.
      </p>

      <div style="display: flex; gap: 20px; align-items: flex-start; margin-top: 24px;">
        <!-- Sidebar de navegaciÃ³n de add-ons -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title" id="addons-category-title" style="display: flex; align-items: center; justify-content: space-between;">
              <span>CategorÃ­as</span>
              <span style="font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-medium); font-weight: var(--weight-regular); margin-left: 8px;">0 add-ons</span>
            </div>
            <nav class="side" id="addons-nav" role="navigation" aria-label="NavegaciÃ³n de add-ons">
              <!-- Se generarÃ¡ dinÃ¡micamente -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal de add-ons -->
        <div style="flex: 1; min-width: 0;">
          <div id="addons-empty-state" style="display: none; text-align: center; padding: 60px 20px;">
            <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">
              <i class="far fa-plug"></i>
            </div>
            <h3 style="color: var(--ubits-fg-1-high); margin-bottom: 8px;">Sin resultados</h3>
            <p style="color: var(--ubits-fg-1-medium);">Intenta con otro tÃ©rmino de bÃºsqueda.</p>
          </div>
          <div id="addons-container" class="kstack">
            <!-- Los add-ons se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
            <div id="addons-default-message" style="text-align: center; padding: 60px 20px;">
              <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">
                <i class="far fa-plug"></i>
              </div>
              <h3 style="color: var(--ubits-fg-1-high); margin-bottom: 8px;">Selecciona un add-on</h3>
              <p style="color: var(--ubits-fg-1-medium);">Elige un add-on del menÃº lateral para ver su documentaciÃ³n completa.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="section-colores" class="section active">
      <div style="display: flex; align-items: center; justify-content: space-between; gap: 24px; margin-bottom: 32px; flex-wrap: wrap;">
        <h1 style="color: var(--ubits-fg-2-high); margin: 0;">Colores</h1>
        
        <!-- Barra de bÃºsqueda -->
        <div class="searchbar" style="flex: 1; min-width: 300px; max-width: 500px;">
          <div style="position: relative; width: 100%;">
            <i class="far fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none;"></i>
            <input id="tokens-search" type="search" placeholder="Buscar por nombre o valor (hex/rgba)" style="width: 100%; padding: 10px 12px 10px 36px; border: none; border-radius: 8px; font-size: 14px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-md-size);" aria-label="Buscar tokens" />
          </div>
        </div>
      </div>
      <div class="layout-colors">
        <aside class="sidebar">
          <div class="sidebox">
            <div class="side-title" id="colors-category-title" style="display: flex; align-items: center; justify-content: space-between;">
              <span>CategorÃ­as</span>
              <span style="font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-medium); font-weight: var(--weight-regular); margin-left: 8px;">0 colores</span>
            </div>
            <nav class="side" id="colors-nav" role="tablist" aria-label="CategorÃ­as de colores">
              <!-- Se generarÃ¡ dinÃ¡micamente con TreeMenu -->
            </nav>
          </div>
        </aside>
        <div class="content">
    
      <div id="cat-brand" class="cat-section">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE Â· BRAND COLORS</div>
          <div class="grid" id="grid-light">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE Â· BRAND COLORS</div>
          <div class="grid" id="grid-dark">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        </div>
      </div>

      <div id="cat-background" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BACKGROUND COLORS</div>
            <div class="grid" id="grid-light-bg">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BACKGROUND COLORS</div>
            <div class="grid" id="grid-dark-bg">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>
      <div id="cat-button" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE Â· BUTTON COLORS</div>
          <div class="grid" id="grid-light-button">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE Â· BUTTON COLORS</div>
          <div class="grid" id="grid-dark-button">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>

      <div id="cat-foreground" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE Â· FOREGROUND COLORS</div>
          <div class="grid" id="grid-light-fg">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE Â· FOREGROUND COLORS</div>
          <div class="grid" id="grid-dark-fg">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>
      <div id="cat-blue" class="cat-section" style="display:none">
      <div class="columns">
        <div class="panel">
          <div class="section-title">LIGHT MODE Â· BLUE FOREGROUNDS</div>
          <div class="grid" id="grid-light-fg-blue">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
        <div class="panel dark">
          <div class="section-title">DARK MODE Â· BLUE FOREGROUNDS</div>
          <div class="grid" id="grid-dark-fg-blue">
            <div class="head"></div><div class="head"></div>
          </div>
        </div>
      </div>
      </div>

      <div id="cat-gray" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· GRAY FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-gray">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· GRAY FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-gray">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-yellow" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· YELLOW FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-yellow">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· YELLOW FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-yellow">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-green" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· GREEN FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-green">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· GREEN FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-green">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-teal" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· TEAL FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-teal">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· TEAL FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-teal">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-purple" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· PURPLE FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-purple">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· PURPLE FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-purple">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-pink" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· PINK FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-pink">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· PINK FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-pink">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-rose" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· ROSE FOREGROUNDS</div>
            <div class="grid" id="grid-light-fg-rose">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· ROSE FOREGROUNDS</div>
            <div class="grid" id="grid-dark-fg-rose">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-main" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BORDER COLORS - MAIN</div>
            <div class="grid" id="grid-light-border-main">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BORDER COLORS - MAIN</div>
            <div class="grid" id="grid-dark-border-main">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-colored" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BORDER COLORS - COLORED</div>
            <div class="grid" id="grid-light-border-colored">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BORDER COLORS - COLORED</div>
            <div class="grid" id="grid-dark-border-colored">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-inverted" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BORDER COLORS - INVERTED</div>
            <div class="grid" id="grid-light-border-inverted">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BORDER COLORS - INVERTED</div>
            <div class="grid" id="grid-dark-border-inverted">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-static" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BORDER COLORS - STATIC</div>
            <div class="grid" id="grid-light-border-static">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BORDER COLORS - STATIC</div>
            <div class="grid" id="grid-dark-border-static">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-borders-static-inverted" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BORDER COLORS - STATIC INVERTED</div>
            <div class="grid" id="grid-light-border-static-inv">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BORDER COLORS - STATIC INVERTED</div>
            <div class="grid" id="grid-dark-border-static-inv">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-sidebar" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· SIDEBAR COLORS</div>
            <div class="grid" id="grid-light-sidebar">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· SIDEBAR COLORS</div>
            <div class="grid" id="grid-dark-sidebar">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-success" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· FEEDBACK SUCCESS</div>
            <div class="grid" id="grid-light-feedback-success">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· FEEDBACK SUCCESS</div>
            <div class="grid" id="grid-dark-feedback-success">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-info" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· FEEDBACK INFO</div>
            <div class="grid" id="grid-light-feedback-info">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· FEEDBACK INFO</div>
            <div class="grid" id="grid-dark-feedback-info">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-warning" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· FEEDBACK WARNING</div>
            <div class="grid" id="grid-light-feedback-warning">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· FEEDBACK WARNING</div>
            <div class="grid" id="grid-dark-feedback-warning">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-error" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· FEEDBACK ERROR</div>
            <div class="grid" id="grid-light-feedback-error">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· FEEDBACK ERROR</div>
            <div class="grid" id="grid-dark-feedback-error">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-feedback-borders" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· FEEDBACK BORDERS</div>
            <div class="grid" id="grid-light-feedback-borders">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· FEEDBACK BORDERS</div>
            <div class="grid" id="grid-dark-feedback-borders">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-chart" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· CHART COLORS</div>
            <div class="grid" id="grid-light-chart">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· CHART COLORS</div>
            <div class="grid" id="grid-dark-chart">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-toast" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· TOAST COLORS</div>
            <div class="grid" id="grid-light-toast">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· TOAST COLORS</div>
            <div class="grid" id="grid-dark-toast">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="cat-bottom-nav" class="cat-section" style="display:none">
        <div class="columns">
          <div class="panel">
            <div class="section-title">LIGHT MODE Â· BOTTOM NAV COLORS</div>
            <div class="grid" id="grid-light-bottom-nav">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
          <div class="panel dark">
            <div class="section-title">DARK MODE Â· BOTTOM NAV COLORS</div>
            <div class="grid" id="grid-dark-bottom-nav">
              <div class="head"></div><div class="head"></div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>

    <div id="section-tipografia" class="section" style="display:none">
      <h1>TipografÃ­a</h1>
      <p class="subtitle">Escala alineada al autoframe anterior. Haz clic para copiar variables o CSS.</p>
      <div class="kstack">
        <div class="kcard">
          <h3>Display</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D1</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1 Â· 48 / 57.6</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D2</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:700">Display 2 Â· 40 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D3</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:700">Display 3 Â· 32 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D4</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:700">Display 4 Â· 28 / 42</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Headings</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H1 Â· Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:600">Heading 1 Â· 20 / 30</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H2 Â· Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:600">Heading 2 Â· 18 / 27</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Body</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>Body LG Â· 600</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:600">Cuerpo grande Â· 20 / 30 Â· Semibold</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body MD Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:400">Cuerpo mediano Â· 16 / 24 Â· Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body SM Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:400">Cuerpo pequeÃ±o Â· 13 / 19.5 Â· Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body XS Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:400">Cuerpo extra pequeÃ±o Â· 11 / 16.5 Â· Regular</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Notas</h3>
          <ul>
            <li>Familia por defecto: <code>var(--font-sans)</code></li>
            <li>Pesos: <code>--weight-regular</code>, <code>--weight-semibold</code>, <code>--weight-bold</code></li>
            <li>Click en una fila copia una regla CSS con variables.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="section-texto" class="section" style="display:block">
      <h1>TipografÃ­a</h1>
      <p class="subtitle">Escala alineada al autoframe anterior. Haz clic para copiar variables o CSS.</p>
      <div class="kstack">
        <div class="kcard">
          <h3>Display</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D1</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1 Â· 48 / 57.6</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D2</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d2-size); line-height:var(--font-d2-line); font-weight:700">Display 2 Â· 40 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D3</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d3-size); line-height:var(--font-d3-line); font-weight:700">Display 3 Â· 32 / 48</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:var(--weight-bold);">
              <div class="typo-box"><code>D4</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-d4-size); line-height:var(--font-d4-line); font-weight:700">Display 4 Â· 28 / 42</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Headings</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H1 Â· Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h1-size); line-height:var(--font-h1-line); font-weight:600">Heading 1 Â· 20 / 30</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>H2 Â· Semibold</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-h2-size); line-height:var(--font-h2-line); font-weight:600">Heading 2 Â· 18 / 27</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Body</h3>
          <div class="kstack">
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:var(--weight-semibold);">
              <div class="typo-box"><code>Body LG Â· 600</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-lg-size); line-height:var(--font-body-lg-line); font-weight:600">Cuerpo grande Â· 20 / 30 Â· Semibold</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body MD Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-md-size); line-height:var(--font-body-md-line); font-weight:400">Cuerpo mediano Â· 16 / 24 Â· Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body SM Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-sm-size); line-height:var(--font-body-sm-line); font-weight:400">Cuerpo pequeÃ±o Â· 13 / 19.5 Â· Regular</div>
            </div>
            <div class="typo-sample copyable" data-copy="css" data-css="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:var(--weight-regular);">
              <div class="typo-box"><code>Body XS Â· 400</code></div>
              <div style="font-family:var(--font-sans); font-size:var(--font-body-xs-size); line-height:var(--font-body-xs-line); font-weight:400">Cuerpo extra pequeÃ±o Â· 11 / 16.5 Â· Regular</div>
            </div>
          </div>
        </div>
        <div class="kcard">
          <h3>Notas</h3>
          <ul>
            <li>Familia por defecto: <code>var(--font-sans)</code></li>
            <li>Pesos: <code>--weight-regular</code>, <code>--weight-semibold</code>, <code>--weight-bold</code></li>
            <li>Click en una fila copia una regla CSS con variables.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- SECCIÃ“N ESPACIADO Y BORDES -->
    <div id="section-espaciado" class="section" style="display:none">
      <div style="display: flex; align-items: center; justify-content: space-between; gap: 24px; margin-bottom: 32px; flex-wrap: wrap;">
        <h1 class="ubits-heading-h1" style="color: var(--ubits-fg-2-high); margin: 0;">Espaciado y Bordes</h1>
        
        <!-- Barra de bÃºsqueda -->
        <div class="searchbar" style="flex: 1; min-width: 300px; max-width: 500px;">
          <div style="position: relative; width: 100%;">
            <i class="far fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none;"></i>
            <input id="spacing-search" type="search" placeholder="Buscar por nombre o valor (ej: sm, 8, 16)" style="width: 100%; padding: 10px 12px 10px 36px; border: none; border-radius: 8px; font-size: 14px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-md-size);" aria-label="Buscar tokens de espaciado" />
          </div>
        </div>
      </div>

      <div style="display: flex; gap: 20px; align-items: flex-start; margin-top: 24px;">
        <!-- Sidebar de navegaciÃ³n -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title" id="spacing-category-title" style="display: flex; align-items: center; justify-content: space-between;">
              <span>CategorÃ­as</span>
              <span style="font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-medium); font-weight: var(--weight-regular); margin-left: 8px;">0 elementos</span>
            </div>
            <nav class="side" id="spacing-nav" role="navigation" aria-label="NavegaciÃ³n de espaciado">
              <!-- Se generarÃ¡ dinÃ¡micamente con TreeMenu -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal -->
        <div style="flex: 1; min-width: 0;">
          <!-- Espaciado BÃ¡sico -->
          <div id="cat-espaciado-basico" class="cat-section" style="display: block;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high);">Espaciado BÃ¡sico</h3>
            <div class="columns">
              <div class="grid">
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-none" onclick="copyToken(this)">--ubits-spacing-none</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 0px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">0</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-xs" onclick="copyToken(this)">--ubits-spacing-xs</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 4px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">4px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-sm" onclick="copyToken(this)">--ubits-spacing-sm</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 8px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">8px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-md" onclick="copyToken(this)">--ubits-spacing-md</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 12px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">12px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-lg" onclick="copyToken(this)">--ubits-spacing-lg</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 16px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">16px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-xl" onclick="copyToken(this)">--ubits-spacing-xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 20px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">20px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-2xl" onclick="copyToken(this)">--ubits-spacing-2xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: 24px; height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">24px</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Espaciado Extendido -->
          <div id="cat-espaciado-extendido" class="cat-section" style="display: none;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high);">Espaciado Extendido</h3>
            <div class="columns">
              <div class="grid">
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-3xl" onclick="copyToken(this)">--ubits-spacing-3xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(28px * 0.8); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 60px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">28px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-4xl" onclick="copyToken(this)">--ubits-spacing-4xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(32px * 0.8); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 60px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">32px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-5xl" onclick="copyToken(this)">--ubits-spacing-5xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(36px * 0.8); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 60px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">36px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-6xl" onclick="copyToken(this)">--ubits-spacing-6xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(40px * 0.8); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 60px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">40px</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Espaciado Grande -->
          <div id="cat-espaciado-grande" class="cat-section" style="display: none;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high);">Espaciado Grande</h3>
            <div class="columns">
              <div class="grid">
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-7" onclick="copyToken(this)">--ubits-spacing-7</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(28px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">28px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-8" onclick="copyToken(this)">--ubits-spacing-8</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(32px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">32px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-10" onclick="copyToken(this)">--ubits-spacing-10</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(40px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">40px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-12" onclick="copyToken(this)">--ubits-spacing-12</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(48px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">48px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-16" onclick="copyToken(this)">--ubits-spacing-16</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(64px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">64px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-20" onclick="copyToken(this)">--ubits-spacing-20</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(80px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">80px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-24" onclick="copyToken(this)">--ubits-spacing-24</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(96px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">96px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-32" onclick="copyToken(this)">--ubits-spacing-32</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(128px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">128px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-40" onclick="copyToken(this)">--ubits-spacing-40</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(160px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">160px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-48" onclick="copyToken(this)">--ubits-spacing-48</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(192px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">192px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-64" onclick="copyToken(this)">--ubits-spacing-64</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(256px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">256px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-80" onclick="copyToken(this)">--ubits-spacing-80</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(320px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">320px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-spacing-96" onclick="copyToken(this)">--ubits-spacing-96</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: flex-start; padding-left: 8px; position: relative;">
                    <div style="width: calc(384px * 0.5); height: 20px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px; max-width: 80px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">384px</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Bordes -->
          <div id="cat-bordes" class="cat-section" style="display: none;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high);">Border Radius</h3>
            <div class="columns">
              <div class="grid">
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-none" onclick="copyToken(this)">--ubits-border-radius-none</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 0;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">0</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-xs" onclick="copyToken(this)">--ubits-border-radius-xs</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 4px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">4px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-sm" onclick="copyToken(this)">--ubits-border-radius-sm</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 8px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">8px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-md" onclick="copyToken(this)">--ubits-border-radius-md</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 12px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">12px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-lg" onclick="copyToken(this)">--ubits-border-radius-lg</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 16px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">16px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-xl" onclick="copyToken(this)">--ubits-border-radius-xl</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 20px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">20px</span>
                  </div>
                </div>
                <div class="row">
                  <div class="token-name copyable" data-token="--ubits-border-radius-full" onclick="copyToken(this)">--ubits-border-radius-full</div>
                  <div class="swatch" style="background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; padding: 8px;">
                    <div style="width: 40px; height: 40px; background: var(--ubits-accent-brand-static-inverted); border-radius: 1000px;"></div>
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-left: 8px;">1000px</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SECCIÃ“N EFFECTS -->
    <div id="section-effects" class="section" style="display:none">
      <h1 class="ubits-heading-h1" style="color: var(--ubits-fg-2-high); margin-bottom: 8px;">Effects</h1>
      <p class="subtitle" style="color: var(--ubits-fg-2-medium); margin-bottom: 32px; font-size: var(--font-body-md-size); line-height: var(--font-body-md-line);">
        Tokens de efectos visuales del sistema de diseÃ±o UBITS. Configura Focus y Elevation con controles interactivos.
      </p>

      <div style="display: flex; gap: 20px; align-items: flex-start; margin-top: 24px;">
        <!-- Sidebar de navegaciÃ³n -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title" id="effects-category-title" style="display: flex; align-items: center; justify-content: space-between;">
              <span>CategorÃ­as</span>
              <span style="font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-medium); font-weight: var(--weight-regular); margin-left: 8px;">0 elementos</span>
            </div>
            <nav class="side" id="effects-nav" role="navigation" aria-label="NavegaciÃ³n de effects">
              <!-- Se generarÃ¡ dinÃ¡micamente con TreeMenu -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal -->
        <div style="flex: 1; min-width: 0;">
          <!-- Focus -->
          <div id="cat-focus" class="cat-section" style="display: block;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high); margin-bottom: 24px; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">Focus</h3>
            
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                <!-- Preview -->
                <div>
                  <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Preview</h4>
                  <div id="focus-preview" style="width: 120px; height: 120px; background: var(--ubits-bg-2); border-radius: 8px; display: flex; align-items: center; justify-content: center; border: 2px solid var(--ubits-accent-brand, #5297F4); box-shadow: 0px 0px 0px 4px var(--ubits-button-focus-ring, rgba(82, 151, 244, 0.3));">
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">Focus</span>
                  </div>
                </div>

                <!-- Controles -->
                <div>
                  <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Controles</h4>
                  
                  <!-- Position -->
                  <div style="margin-bottom: 20px;">
                    <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); font-weight: var(--weight-medium); margin-bottom: 8px; display: block;">Position</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                      <div>
                        <label style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">X</label>
                        <input type="number" id="focus-position-x" value="0" oninput="updateFocusEffect()" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                      </div>
                      <div>
                        <label style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Y</label>
                        <input type="number" id="focus-position-y" value="0" oninput="updateFocusEffect()" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                      </div>
                    </div>
                  </div>

                  <!-- Blur -->
                  <div style="margin-bottom: 20px;">
                    <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); font-weight: var(--weight-medium); margin-bottom: 8px; display: block;">Blur</label>
                    <input type="number" id="focus-blur" value="0" oninput="updateFocusEffect()" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                  </div>

                  <!-- Spread -->
                  <div style="margin-bottom: 20px;">
                    <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); font-weight: var(--weight-medium); margin-bottom: 8px; display: block;">Spread</label>
                    <input type="number" id="focus-spread" value="4" oninput="updateFocusEffect()" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                  </div>

                  <!-- Color -->
                  <div>
                    <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); font-weight: var(--weight-medium); margin-bottom: 8px; display: block;">Color</label>
                    <div style="display: flex; gap: 8px; align-items: center;">
                      <input type="color" id="focus-color" value="#0c5bef" oninput="updateFocusEffect()" style="width: 50px; height: 40px; padding: 0; border: 1px solid var(--ubits-border-1); border-radius: 6px; cursor: pointer;" />
                      <input type="text" id="focus-color-hex" value="#0c5bef" oninput="updateFocusColorFromHex()" style="flex: 1; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: monospace;" />
                      <input type="number" id="focus-color-opacity" value="30" min="0" max="100" oninput="updateFocusEffect()" style="width: 60px; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                      <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Elevation -->
          <div id="cat-elevation" class="cat-section" style="display: none;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high); margin-bottom: 24px; font-size: var(--font-h2-size); font-weight: var(--weight-semibold);">Elevation</h3>
            
            <!-- Default -->
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Default</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                <div>
                  <div id="elevation-default-preview" style="width: 120px; height: 120px; background: var(--ubits-bg-2); border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: var(--ubits-effects-elevation-1, 0px 1px 2px 0px rgba(0, 0, 0, 0.12));">
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">Default</span>
                  </div>
                </div>
                <div>
                  <div style="display: grid; gap: 12px;">
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position X</label>
                      <input type="number" id="elevation-default-x" value="0" oninput="updateElevationEffect('default')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position Y</label>
                      <input type="number" id="elevation-default-y" value="1" oninput="updateElevationEffect('default')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Blur</label>
                      <input type="number" id="elevation-default-blur" value="2" oninput="updateElevationEffect('default')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Spread</label>
                      <input type="number" id="elevation-default-spread" value="0" oninput="updateElevationEffect('default')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Color</label>
                      <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="color" id="elevation-default-color" value="#000000" oninput="updateElevationEffect('default')" style="width: 50px; height: 40px; padding: 0; border: 1px solid var(--ubits-border-1); border-radius: 6px; cursor: pointer;" />
                        <input type="text" id="elevation-default-color-hex" value="#000000" oninput="updateElevationColorFromHex('default')" style="flex: 1; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: monospace;" />
                        <input type="number" id="elevation-default-opacity" value="12" min="0" max="100" oninput="updateElevationEffect('default')" style="width: 60px; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                        <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Hover -->
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Hover</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                <div>
                  <div id="elevation-hover-preview" style="width: 120px; height: 120px; background: var(--ubits-bg-2); border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: var(--ubits-effects-elevation-2, 0px 1px 2px 0px rgba(0, 0, 0, 0.14));">
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">Hover</span>
                  </div>
                </div>
                <div>
                  <div style="display: grid; gap: 12px;">
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position X</label>
                      <input type="number" id="elevation-hover-x" value="0" oninput="updateElevationEffect('hover')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position Y</label>
                      <input type="number" id="elevation-hover-y" value="1" oninput="updateElevationEffect('hover')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Blur</label>
                      <input type="number" id="elevation-hover-blur" value="2" oninput="updateElevationEffect('hover')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Spread</label>
                      <input type="number" id="elevation-hover-spread" value="0" oninput="updateElevationEffect('hover')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Color</label>
                      <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="color" id="elevation-hover-color" value="#000000" oninput="updateElevationEffect('hover')" style="width: 50px; height: 40px; padding: 0; border: 1px solid var(--ubits-border-1); border-radius: 6px; cursor: pointer;" />
                        <input type="text" id="elevation-hover-color-hex" value="#000000" oninput="updateElevationColorFromHex('hover')" style="flex: 1; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: monospace;" />
                        <input type="number" id="elevation-hover-opacity" value="14" min="0" max="100" oninput="updateElevationEffect('hover')" style="width: 60px; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                        <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Overlay -->
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Overlay</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                <div>
                  <div id="elevation-overlay-preview" style="width: 120px; height: 120px; background: var(--ubits-bg-2); border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12));">
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">Overlay</span>
                  </div>
                </div>
                <div>
                  <div style="display: grid; gap: 12px;">
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position X</label>
                      <input type="number" id="elevation-overlay-x" value="0" oninput="updateElevationEffect('overlay')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position Y</label>
                      <input type="number" id="elevation-overlay-y" value="4" oninput="updateElevationEffect('overlay')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Blur</label>
                      <input type="number" id="elevation-overlay-blur" value="8" oninput="updateElevationEffect('overlay')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Spread</label>
                      <input type="number" id="elevation-overlay-spread" value="0" oninput="updateElevationEffect('overlay')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Color</label>
                      <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="color" id="elevation-overlay-color" value="#000000" oninput="updateElevationEffect('overlay')" style="width: 50px; height: 40px; padding: 0; border: 1px solid var(--ubits-border-1); border-radius: 6px; cursor: pointer;" />
                        <input type="text" id="elevation-overlay-color-hex" value="#000000" oninput="updateElevationColorFromHex('overlay')" style="flex: 1; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: monospace;" />
                        <input type="number" id="elevation-overlay-opacity" value="14" min="0" max="100" oninput="updateElevationEffect('overlay')" style="width: 60px; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                        <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Floating -->
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">Floating</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
                <div>
                  <div id="elevation-floating-preview" style="width: 120px; height: 120px; background: var(--ubits-bg-2); border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: var(--ubits-effects-elevation-4);">
                    <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">Floating</span>
                  </div>
                </div>
                <div>
                  <div style="display: grid; gap: 12px;">
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position X</label>
                      <input type="number" id="elevation-floating-x" value="0" oninput="updateElevationEffect('floating')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Position Y</label>
                      <input type="number" id="elevation-floating-y" value="14" oninput="updateElevationEffect('floating')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Blur</label>
                      <input type="number" id="elevation-floating-blur" value="28.8" step="0.1" oninput="updateElevationEffect('floating')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Spread</label>
                      <input type="number" id="elevation-floating-spread" value="0" oninput="updateElevationEffect('floating')" style="width: 100%; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                    </div>
                    <div>
                      <label style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin-bottom: 4px; display: block;">Color</label>
                      <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="color" id="elevation-floating-color" value="#000000" oninput="updateElevationEffect('floating')" style="width: 50px; height: 40px; padding: 0; border: 1px solid var(--ubits-border-1); border-radius: 6px; cursor: pointer;" />
                        <input type="text" id="elevation-floating-color-hex" value="#000000" oninput="updateElevationColorFromHex('floating')" style="flex: 1; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: monospace;" />
                        <input type="number" id="elevation-floating-opacity" value="24" min="0" max="100" oninput="updateElevationEffect('floating')" style="width: 60px; padding: 8px; background: var(--ubits-bg-2); border: 1px solid var(--ubits-border-1); border-radius: 6px; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);" />
                        <span style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size);">%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SECCIÃ“N GRID Y BREAKPOINTS -->
    <div id="section-grid-breakpoints" class="section" style="display:none">
      <h1 class="ubits-heading-h1" style="color: var(--ubits-fg-2-high); margin-bottom: 8px;">Grid y Breakpoints</h1>
      <p class="subtitle" style="color: var(--ubits-fg-2-medium); margin-bottom: 32px; font-size: var(--font-body-md-size); line-height: var(--font-body-md-line);">
        Sistema de grid y breakpoints responsivos del sistema de diseÃ±o UBITS. DocumentaciÃ³n completa del layout y puntos de quiebre.
      </p>

      <div style="display: flex; gap: 20px; align-items: flex-start; margin-top: 24px;">
        <!-- Sidebar de navegaciÃ³n -->
        <aside class="sidebar" style="width: 280px; flex-shrink: 0;">
          <div class="sidebox">
            <div class="side-title" id="grid-category-title" style="display: flex; align-items: center; justify-content: space-between;">
              <span>CategorÃ­as</span>
              <span style="font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-medium); font-weight: var(--weight-regular); margin-left: 8px;">0 elementos</span>
            </div>
            <nav class="side" id="grid-breakpoints-nav" role="navigation" aria-label="NavegaciÃ³n de grid y breakpoints">
              <!-- Se generarÃ¡ dinÃ¡micamente con TreeMenu -->
            </nav>
          </div>
        </aside>

        <!-- Contenedor principal -->
        <div style="flex: 1; min-width: 0;">
          <!-- Breakpoints -->
          <div id="cat-breakpoints" class="cat-section" style="display: block;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high); margin-bottom: 24px;">Breakpoints</h3>
            
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-h2-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">ğŸ“± Breakpoints</h4>
              <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 0 0 20px 0; line-height: var(--font-body-sm-line);">
                El sistema UBITS utiliza breakpoints responsivos para adaptar la interfaz segÃºn el tamaÃ±o de pantalla. Los breakpoints definen cuando cambian los componentes principales (Sidebar/TabBar).
              </p>
              
              <div style="display: grid; gap: 12px;">
                <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <div style="width: 4px; height: 32px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold);">Mobile</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 8px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">&lt; 480px</code>
                      </div>
                      <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                        Pantallas pequeÃ±as. TabBar visible, Sidebar oculta. Padding reducido (12px).
                      </p>
                    </div>
                  </div>
                </div>

                <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <div style="width: 8px; height: 32px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold);">Tablet</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 8px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">480px - 767px</code>
                      </div>
                      <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                        Pantallas medianas. TabBar visible, Sidebar oculta. Layout adaptativo.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <div style="width: 12px; height: 32px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold);">Desktop</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 8px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">768px - 1023px</code>
                      </div>
                      <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                        Pantallas grandes. TabBar visible, Sidebar oculta. TransiciÃ³n hacia Wide.
                      </p>
                    </div>
                  </div>
                </div>

                <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <div style="width: 16px; height: 32px; background: var(--ubits-accent-brand-static-inverted); border-radius: 2px;"></div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold);">Wide</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 8px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">â‰¥ 1024px</code>
                      </div>
                      <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                        Pantallas extra grandes. <strong>Sidebar visible</strong>, TabBar oculta. Contenido centrado con max-width: 1607px (â‰¥ 1440px).
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none; margin-top: 20px;">
                <h5 style="color: var(--ubits-fg-2-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 8px 0;">ğŸ”‘ Punto crÃ­tico</h5>
                <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                  El breakpoint de <strong>1024px</strong> es crÃ­tico: define el cambio entre Sidebar y TabBar. En <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">max-width: 1023px</code> se muestra TabBar, en <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">min-width: 1024px</code> se muestra Sidebar.
                </p>
              </div>
            </div>
          </div>

          <!-- Sistema de Grid -->
          <div id="cat-grid-system" class="cat-section" style="display: none;">
            <h3 class="section-title" style="color: var(--ubits-fg-1-high); margin-bottom: 24px;">Sistema de Grid</h3>
            
            <div class="kcard" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
              <h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-h2-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">ğŸ“ Sistema de Grid</h4>
              <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 0 0 20px 0; line-height: var(--font-body-sm-line);">
                El sistema de grid UBITS utiliza contenedores flexibles y secciones configurables para crear layouts adaptativos y consistentes.
              </p>

              <div style="display: grid; gap: 20px;">
                <!-- Contenedores -->
                <div>
                  <h5 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">Contenedores</h5>
                  <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                    <div style="display: grid; gap: 12px;">
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.dashboard-container</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Contenedor principal con <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">display: flex</code> y <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">min-height: 100vh</code>.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.main-content</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Contenido principal: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">flex: 1</code>, <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">margin-left: 143px</code> (sidebar), <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 20px</code>. En pantallas â‰¥ 1440px: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">max-width: 1607px</code> centrado.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.content-area</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Ãrea de contenido: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">flex: 1</code>, <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">justify-content: center</code>.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.content-sections</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Contenedor de secciones: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">display: flex</code>, <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">flex-direction: column</code>, <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 16px</code>.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Secciones -->
                <div>
                  <h5 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">Secciones de Widgets</h5>
                  <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                    <div style="display: grid; gap: 12px;">
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.section-single</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Una columna: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">display: flex</code>, widget ocupa 100% del ancho.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.section-dual</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Dos columnas: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 20px</code>. En mÃ³vil (< 1024px): <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">flex-direction: column</code>, <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 16px</code>.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.section-triple</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Tres columnas: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 20px</code>. En mÃ³vil se apila verticalmente.
                        </p>
                      </div>
                      <div>
                        <code style="background: var(--ubits-bg-1); padding: 4px 8px; border-radius: 4px; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-high); display: inline-block; margin-bottom: 8px;">.section-quad</code>
                        <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; line-height: var(--font-body-sm-line);">
                          Cuatro columnas: <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">gap: 20px</code>. En mÃ³vil se apila verticalmente.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Widgets -->
                <div>
                  <h5 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">Widgets</h5>
                  <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                    <p style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0 0 12px 0; line-height: var(--font-body-sm-line);">
                      Los widgets dentro de las secciones tienen:
                    </p>
                    <ul style="color: var(--ubits-fg-2-medium); font-size: var(--font-body-sm-size); margin: 0; padding-left: 20px; line-height: var(--font-body-sm-line);">
                      <li><code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">background: var(--ubits-bg-1)</code></li>
                      <li><code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">border-radius: 8px</code></li>
                      <li><code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">padding: 16px</code> (desktop) / <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">padding: 12px</code> (mÃ³vil â‰¤ 480px)</li>
                      <li><code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size);">flex: 1</code> para distribuciÃ³n equitativa</li>
                    </ul>
                  </div>
                </div>

                <!-- Espaciado -->
                <div>
                  <h5 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 12px 0;">Espaciado del Grid</h5>
                  <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: none;">
                    <div style="display: grid; gap: 12px;">
                      <div>
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-sm-size);">Entre secciones:</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high); margin-left: 8px;">gap: 16px</code> (20px entre SubNav y Content Area)
                      </div>
                      <div>
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-sm-size);">Entre widgets:</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high); margin-left: 8px;">gap: 20px</code> (desktop) / <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high);">gap: 16px</code> (mÃ³vil)
                      </div>
                      <div>
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-sm-size);">Sidebar:</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high); margin-left: 8px;">width: 143px</code> (24px + 96px + 23px gap)
                      </div>
                      <div>
                        <strong style="color: var(--ubits-fg-2-high); font-size: var(--font-body-sm-size);">Max-width contenido:</strong>
                        <code style="background: var(--ubits-bg-1); padding: 2px 6px; border-radius: 4px; font-size: var(--font-body-xs-size); color: var(--ubits-fg-1-high); margin-left: 8px;">1607px</code> (en pantallas â‰¥ 1440px)
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

    <script>
      // Asegurar que las secciones vivan dentro de #sections-host para evitar colapsos
      (function ensureHost(){
        const host = document.getElementById('sections-host') || (function(){
          const m = document.createElement('main');
          m.id = 'sections-host';
          m.style.position = 'relative';
          m.style.zIndex = '1';
          document.body.insertBefore(m, document.querySelector('.tabs-wrap'));
          return m;
        })();
        ['section-hub','section-addons','section-colores','section-texto','section-espaciado','section-grid-breakpoints','section-effects'].forEach(id=>{
          const el = document.getElementById(id);
          if (el && el.parentElement !== host) {
            host.appendChild(el);
            console.log('[ensureHost] Moved', id, 'to sections-host');
          }
        });
      })();

      const root = document.documentElement;
      const html = document.documentElement;

      const TOKENS = [
        '--ubits-accent-brand-static-inverted',
        '--ubits-accent-brand-static-inverted-inverted',
        '--ubits-accent-brand-static-inverted-static',
        '--ubits-accent-brand-static-inverted-static-inverted',
        '--ubits-accent-success',
        '--ubits-logo',
        '--ubits-logo-inverted',
        '--ubits-logo-static',
        '--ubits-logo-static-inverted'
      ];

      function showToast(message){
        const el = document.getElementById('toast');
        if(!el) return;
        el.textContent = message;
        el.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=> el.classList.remove('show'), 1200);
      }

      // FunciÃ³n para cambiar tabs en la secciÃ³n Hub
      function switchHubTab(tabId) {
        // Ocultar todos los contenidos
        document.querySelectorAll('.hub-content').forEach(content => {
          content.style.display = 'none';
        });
        
        // Mostrar el contenido seleccionado
        const selectedContent = document.getElementById(`hub-content-${tabId}`);
        if (selectedContent) {
          selectedContent.style.display = 'block';
        }
        
        // Actualizar estilos de los botones
        document.querySelectorAll('.hub-tab-btn').forEach(btn => {
          const isActive = btn.getAttribute('data-tab') === tabId;
          btn.style.color = isActive ? 'var(--ubits-fg-2-high)' : 'var(--ubits-fg-2-medium)';
          btn.style.borderBottomColor = isActive ? 'var(--ubits-button-primary-bg-default)' : 'transparent';
        });
      }

      // FunciÃ³n para cambiar tabs en la secciÃ³n Add-ons
      // Inventario de Add-ons organizados por categorÃ­a
      const addonsInventory = {
        'Funcionales': [
          { id: 'github', name: 'GitHub', icon: 'fa-code-branch', description: 'Auto-commit y gestiÃ³n de repositorios' },
          { id: 'clarity', name: 'Microsoft Clarity', icon: 'fa-chart-line', description: 'Analytics y seguimiento de usuarios' },
          { id: 'vercel', name: 'Vercel', icon: 'fa-rocket', description: 'Despliegue automÃ¡tico de aplicaciones' },
          { id: 'storybook', name: 'Storybook', icon: 'fa-book', description: 'Desarrollo y documentaciÃ³n de componentes' },
          { id: 'supabase', name: 'Supabase', icon: 'fa-database', description: 'Base de datos, autenticaciÃ³n y almacenamiento' },
          { id: 'ai', name: 'AI Assistant', icon: 'fa-robot', description: 'Asistente de IA con Ollama/Gemini' },
          { id: 'jest', name: 'JEST', icon: 'fa-vial', description: 'Testing unitario automatizado' },
          { id: 'eslint', name: 'ESLint', icon: 'fa-code', description: 'Linting automÃ¡tico de cÃ³digo' },
          { id: 'prettier', name: 'Prettier', icon: 'fa-magic', description: 'Formateo automÃ¡tico de cÃ³digo' },
          { id: 'lighthouse', name: 'Lighthouse', icon: 'fa-tachometer-alt', description: 'AuditorÃ­a de performance y calidad' },
          { id: 'docusaurus', name: 'Docusaurus', icon: 'fa-book-open', description: 'GeneraciÃ³n de documentaciÃ³n' },
          { id: 'i18n', name: 'i18n', icon: 'fa-globe', description: 'InternacionalizaciÃ³n y traducciÃ³n' },
          { id: 'figma-sync', name: 'Figma Sync', icon: 'fa-sync', description: 'SincronizaciÃ³n con Figma' }
        ],
        'DiseÃ±o': [
          { id: 'tokens', name: 'Tokens Autoframe', icon: 'fa-palette', description: 'Tokens de diseÃ±o genÃ©ricos' },
          { id: 'typography', name: 'TipografÃ­a', icon: 'fa-font', description: 'Sistema de tipografÃ­a' },
          { id: 'fontawesome', name: 'Font Awesome', icon: 'fa-icons', description: 'Biblioteca de iconos' },
          { id: 'componentes', name: 'Componentes Autoframe', icon: 'fa-cubes', description: 'Componentes base del sistema' }
        ]
      };

      // InformaciÃ³n detallada de cada add-on
      const addonsDetails = {
        'github': {
          name: 'GitHub',
          category: 'Funcionales',
          icon: 'fa-code-branch',
          description: 'Add-on para gestiÃ³n automÃ¡tica de repositorios Git y GitHub',
          whatIs: 'GitHub es un add-on funcional que permite gestionar automÃ¡ticamente tu repositorio Git. Proporciona funcionalidades de auto-commit, gestiÃ³n de ramas, reversiÃ³n a estados anteriores, y sincronizaciÃ³n con repositorios remotos.',
          whatFor: 'Este add-on es Ãºtil para automatizar el flujo de trabajo con Git, permitiendo commits automÃ¡ticos cuando detecta cambios, gestiÃ³n de ramas, y sincronizaciÃ³n automÃ¡tica con GitHub. Ideal para proyectos que requieren un control de versiones robusto y automatizado.',
          requirements: [
            { type: 'repositorio', label: 'URL del repositorio GitHub', required: true, example: 'https://github.com/usuario/repositorio.git' },
            { type: 'config', label: 'ConfiguraciÃ³n de auto-commit', required: false, example: 'Activar/desactivar commits automÃ¡ticos' },
            { type: 'token', label: 'GitHub Personal Access Token (opcional)', required: false, example: 'ghp_xxxxxxxxxxxx' }
          ]
        },
        'clarity': {
          name: 'Microsoft Clarity',
          category: 'Funcionales',
          icon: 'fa-chart-line',
          description: 'Analytics y seguimiento de comportamiento de usuarios',
          whatIs: 'Microsoft Clarity es un add-on funcional que integra Microsoft Clarity Analytics en tu aplicaciÃ³n. Permite rastrear el comportamiento de los usuarios, generar mapas de calor, grabar sesiones, y analizar mÃ©tricas de rendimiento.',
          whatFor: 'Este add-on es esencial para entender cÃ³mo los usuarios interactÃºan con tu aplicaciÃ³n. Proporciona insights valiosos sobre navegaciÃ³n, clicks, scrolls, y problemas de usabilidad. Ideal para optimizar la experiencia del usuario y mejorar la conversiÃ³n.',
          requirements: [
            { type: 'api-key', label: 'Clarity Project ID', required: true, example: 'abc123xyz' },
            { type: 'link', label: 'URL de tu aplicaciÃ³n', required: true, example: 'https://tu-app.com' }
          ]
        },
        'vercel': {
          name: 'Vercel',
          category: 'Funcionales',
          icon: 'fa-rocket',
          description: 'Despliegue automÃ¡tico de aplicaciones en Vercel',
          whatIs: 'Vercel es un add-on funcional que permite desplegar automÃ¡ticamente tu aplicaciÃ³n en la plataforma Vercel. Proporciona despliegues instantÃ¡neos, preview deployments, y optimizaciones automÃ¡ticas.',
          whatFor: 'Este add-on simplifica el proceso de despliegue, permitiendo que cada push a tu repositorio genere un nuevo deployment automÃ¡ticamente. Ideal para proyectos que requieren despliegues frecuentes y previews de cambios antes de producciÃ³n.',
          requirements: [
            { type: 'token', label: 'Vercel Access Token', required: true, example: 'vercel_xxxxxxxxxxxx' },
            { type: 'repositorio', label: 'Repositorio conectado (opcional)', required: false, example: 'GitHub/GitLab/Bitbucket' },
            { type: 'config', label: 'ConfiguraciÃ³n de proyecto', required: false, example: 'Build settings, environment variables' }
          ]
        },
        'storybook': {
          name: 'Storybook',
          category: 'Funcionales',
          icon: 'fa-book',
          description: 'Desarrollo y documentaciÃ³n de componentes UI',
          whatIs: 'Storybook es un add-on funcional que proporciona un entorno aislado para desarrollar, probar y documentar componentes UI. Permite crear "stories" para cada componente, visualizar diferentes variantes, y generar documentaciÃ³n interactiva.',
          whatFor: 'Este add-on es fundamental para el desarrollo de sistemas de diseÃ±o. Permite desarrollar componentes de forma aislada, probar diferentes estados y variantes, y crear documentaciÃ³n viva que se actualiza automÃ¡ticamente. Ideal para equipos que trabajan con sistemas de diseÃ±o.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de Storybook', required: false, example: 'Framework, addons, configuraciÃ³n de build' },
            { type: 'path', label: 'Ruta de componentes (opcional)', required: false, example: './src/components' }
          ]
        },
        'supabase': {
          name: 'Supabase',
          category: 'Funcionales',
          icon: 'fa-database',
          description: 'Base de datos, autenticaciÃ³n y almacenamiento',
          whatIs: 'Supabase es un add-on funcional que integra Supabase (alternativa open-source a Firebase) en tu aplicaciÃ³n. Proporciona base de datos PostgreSQL, autenticaciÃ³n, almacenamiento de archivos, y APIs en tiempo real.',
          whatFor: 'Este add-on es ideal para aplicaciones que necesitan backend completo sin configurar servidores. Proporciona autenticaciÃ³n lista para usar, base de datos relacional, almacenamiento de archivos, y APIs REST automÃ¡ticas. Perfecto para MVPs y aplicaciones full-stack.',
          requirements: [
            { type: 'api-key', label: 'Supabase Project URL', required: true, example: 'https://xxxxx.supabase.co' },
            { type: 'api-key', label: 'Supabase Anon Key', required: true, example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...' },
            { type: 'config', label: 'ConfiguraciÃ³n de servicios', required: false, example: 'Auth, Database, Storage' }
          ]
        },
        'ai': {
          name: 'AI Assistant',
          category: 'Funcionales',
          icon: 'fa-robot',
          description: 'Asistente de IA con Ollama (local) y Google Gemini (API)',
          whatIs: 'AI Assistant es un add-on funcional que proporciona capacidades de inteligencia artificial en tu aplicaciÃ³n. Soporta Ollama para ejecuciÃ³n local y gratuita, y Google Gemini para uso basado en API.',
          whatFor: 'Este add-on permite integrar capacidades de IA en tu aplicaciÃ³n, como generaciÃ³n de texto, respuestas inteligentes, anÃ¡lisis de contenido, y mÃ¡s. Ollama es perfecto para desarrollo local sin costos, mientras que Gemini ofrece capacidades mÃ¡s avanzadas con API.',
          requirements: [
            { type: 'config', label: 'Proveedor de IA (Ollama/Gemini)', required: true, example: 'Ollama (local) o Gemini (API)' },
            { type: 'api-key', label: 'Google Gemini API Key (si usas Gemini)', required: false, example: 'AIzaSyxxxxxxxxxxxx' },
            { type: 'config', label: 'ConfiguraciÃ³n de modelo', required: false, example: 'Modelo, temperatura, max tokens' }
          ]
        },
        'jest': {
          name: 'JEST',
          category: 'Funcionales',
          icon: 'fa-vial',
          description: 'Testing unitario automatizado',
          whatIs: 'JEST es un add-on funcional que integra Jest, el framework de testing de JavaScript. Permite escribir y ejecutar tests unitarios, de integraciÃ³n, y de snapshot de forma automatizada.',
          whatFor: 'Este add-on es esencial para mantener la calidad del cÃ³digo. Permite escribir tests que se ejecutan automÃ¡ticamente, generar reportes de cobertura, y detectar regresiones. Ideal para proyectos que requieren alta confiabilidad y mantenibilidad.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de Jest', required: false, example: 'Test environment, coverage, mocks' },
            { type: 'path', label: 'Ruta de tests (opcional)', required: false, example: './src/**/*.test.js' }
          ]
        },
        'eslint': {
          name: 'ESLint',
          category: 'Funcionales',
          icon: 'fa-code',
          description: 'Linting automÃ¡tico de cÃ³digo',
          whatIs: 'ESLint es un add-on funcional que integra ESLint, el linter mÃ¡s popular de JavaScript. Analiza tu cÃ³digo en busca de errores, problemas de estilo, y violaciones de mejores prÃ¡cticas.',
          whatFor: 'Este add-on ayuda a mantener la consistencia y calidad del cÃ³digo. Detecta errores antes de que lleguen a producciÃ³n, aplica reglas de estilo consistentes, y sugiere mejoras. Ideal para equipos que trabajan en proyectos grandes y requieren cÃ³digo uniforme.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de ESLint', required: false, example: 'Rules, plugins, parser options' },
            { type: 'config', label: 'Auto-fix (opcional)', required: false, example: 'Activar correcciÃ³n automÃ¡tica' }
          ]
        },
        'prettier': {
          name: 'Prettier',
          category: 'Funcionales',
          icon: 'fa-magic',
          description: 'Formateo automÃ¡tico de cÃ³digo',
          whatIs: 'Prettier es un add-on funcional que integra Prettier, el formateador de cÃ³digo mÃ¡s popular. Formatea automÃ¡ticamente tu cÃ³digo segÃºn reglas predefinidas, eliminando debates sobre estilo.',
          whatFor: 'Este add-on asegura que todo el cÃ³digo tenga un formato consistente, independientemente del desarrollador. Se integra con el editor y puede formatear al guardar o antes de commits. Ideal para mantener cÃ³digo limpio y legible.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de Prettier', required: false, example: 'Print width, tab width, semicolons' },
            { type: 'config', label: 'Formateo al guardar (opcional)', required: false, example: 'Activar formateo automÃ¡tico' }
          ]
        },
        'lighthouse': {
          name: 'Lighthouse',
          category: 'Funcionales',
          icon: 'fa-tachometer-alt',
          description: 'AuditorÃ­a de performance y calidad web',
          whatIs: 'Lighthouse es un add-on funcional que integra Google Lighthouse, una herramienta de auditorÃ­a automatizada. Analiza el rendimiento, accesibilidad, SEO, y mejores prÃ¡cticas de tu aplicaciÃ³n web.',
          whatFor: 'Este add-on es esencial para optimizar el rendimiento y calidad de tu aplicaciÃ³n. Proporciona mÃ©tricas detalladas, sugerencias de mejora, y reportes visuales. Ideal para asegurar que tu aplicaciÃ³n cumpla con estÃ¡ndares web modernos.',
          requirements: [
            { type: 'link', label: 'URL para auditar', required: true, example: 'https://tu-app.com' },
            { type: 'config', label: 'CategorÃ­as a auditar', required: false, example: 'Performance, Accessibility, SEO, Best Practices' }
          ]
        },
        'docusaurus': {
          name: 'Docusaurus',
          category: 'Funcionales',
          icon: 'fa-book-open',
          description: 'GeneraciÃ³n de documentaciÃ³n estÃ¡tica',
          whatIs: 'Docusaurus es un add-on funcional que integra Docusaurus, un generador de sitios de documentaciÃ³n estÃ¡tica. Permite crear documentaciÃ³n moderna, navegable, y con bÃºsqueda integrada.',
          whatFor: 'Este add-on simplifica la creaciÃ³n y mantenimiento de documentaciÃ³n. Genera sitios estÃ¡ticos rÃ¡pidos, con navegaciÃ³n automÃ¡tica, bÃºsqueda, y soporte para Markdown. Ideal para documentar APIs, guÃ­as de usuario, y sistemas de diseÃ±o.',
          requirements: [
            { type: 'path', label: 'Ruta de documentaciÃ³n', required: false, example: './docs' },
            { type: 'config', label: 'ConfiguraciÃ³n de sitio', required: false, example: 'TÃ­tulo, URL, tema' }
          ]
        },
        'i18n': {
          name: 'i18n',
          category: 'Funcionales',
          icon: 'fa-globe',
          description: 'InternacionalizaciÃ³n y traducciÃ³n',
          whatIs: 'i18n es un add-on funcional que proporciona capacidades de internacionalizaciÃ³n (i18n) para tu aplicaciÃ³n. Permite traducir contenido a mÃºltiples idiomas y gestionar locales.',
          whatFor: 'Este add-on es esencial para aplicaciones que necesitan soportar mÃºltiples idiomas. Permite gestionar traducciones, cambiar idiomas dinÃ¡micamente, y mantener consistencia en formatos de fecha, moneda, y nÃºmeros. Ideal para aplicaciones globales.',
          requirements: [
            { type: 'config', label: 'Idiomas soportados', required: true, example: 'es, en, fr, de' },
            { type: 'config', label: 'Idioma por defecto', required: false, example: 'es' },
            { type: 'path', label: 'Ruta de traducciones (opcional)', required: false, example: './locales' }
          ]
        },
        'figma-sync': {
          name: 'Figma Sync',
          category: 'Funcionales',
          icon: 'fa-sync',
          description: 'SincronizaciÃ³n de diseÃ±o con Figma',
          whatIs: 'Figma Sync es un add-on funcional que sincroniza tokens de diseÃ±o y componentes desde Figma a tu proyecto. Permite mantener los tokens y componentes actualizados automÃ¡ticamente.',
          whatFor: 'Este add-on conecta el diseÃ±o con el cÃ³digo, asegurando que los tokens y componentes en tu aplicaciÃ³n estÃ©n siempre sincronizados con el diseÃ±o en Figma. Ideal para equipos que trabajan con sistemas de diseÃ±o y requieren consistencia entre diseÃ±o y cÃ³digo.',
          requirements: [
            { type: 'api-key', label: 'Figma API Key', required: true, example: 'figd_xxxxxxxxxxxx' },
            { type: 'api-key', label: 'Figma File Key', required: true, example: 'abc123xyz' },
            { type: 'config', label: 'SincronizaciÃ³n automÃ¡tica (opcional)', required: false, example: 'Activar sync periÃ³dico' }
          ]
        },
        'tokens': {
          name: 'Tokens Autoframe',
          category: 'DiseÃ±o',
          icon: 'fa-palette',
          description: 'Tokens de diseÃ±o genÃ©ricos de Autoframe',
          whatIs: 'Tokens Autoframe es un add-on de diseÃ±o que proporciona tokens de diseÃ±o genÃ©ricos (colores, espaciado, tipografÃ­a, etc.) que pueden ser utilizados como base para cualquier proyecto.',
          whatFor: 'Este add-on proporciona una base sÃ³lida de tokens de diseÃ±o que puedes personalizar segÃºn las necesidades de tu proyecto. Ideal para proyectos que necesitan tokens consistentes y bien estructurados desde el inicio.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de tokens (opcional)', required: false, example: 'Personalizar colores, espaciado, etc.' }
          ]
        },
        'typography': {
          name: 'TipografÃ­a',
          category: 'DiseÃ±o',
          icon: 'fa-font',
          description: 'Sistema de tipografÃ­a completo',
          whatIs: 'TipografÃ­a es un add-on de diseÃ±o que proporciona un sistema completo de tipografÃ­a, incluyendo fuentes, tamaÃ±os, pesos, y estilos predefinidos.',
          whatFor: 'Este add-on asegura consistencia tipogrÃ¡fica en toda la aplicaciÃ³n. Proporciona escalas tipogrÃ¡ficas bien definidas y clases CSS reutilizables. Ideal para mantener jerarquÃ­a visual y legibilidad.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de fuentes (opcional)', required: false, example: 'Fuentes personalizadas, tamaÃ±os, etc.' }
          ]
        },
        'fontawesome': {
          name: 'Font Awesome',
          category: 'DiseÃ±o',
          icon: 'fa-icons',
          description: 'Biblioteca de iconos Font Awesome',
          whatIs: 'Font Awesome es un add-on de diseÃ±o que integra la biblioteca de iconos Font Awesome, proporcionando miles de iconos vectoriales listos para usar.',
          whatFor: 'Este add-on proporciona una amplia colecciÃ³n de iconos profesionales que puedes usar en tu aplicaciÃ³n. Soporta versiones gratuitas y Pro, y se integra fÃ¡cilmente con CSS. Ideal para mejorar la interfaz visual con iconos consistentes.',
          requirements: [
            { type: 'config', label: 'VersiÃ³n (Free/Pro)', required: false, example: 'Free (CDN) o Pro (Kit ID)' },
            { type: 'api-key', label: 'Font Awesome Kit ID (si usas Pro)', required: false, example: 'abc123xyz' }
          ]
        },
        'componentes': {
          name: 'Componentes Autoframe',
          category: 'DiseÃ±o',
          icon: 'fa-cubes',
          description: 'Componentes base del sistema de diseÃ±o Autoframe',
          whatIs: 'Componentes Autoframe es un add-on de diseÃ±o que proporciona un conjunto completo de componentes UI base para construir aplicaciones. Incluye componentes como Button, Sidebar, Input, Alert, Toast y mÃ¡s, todos diseÃ±ados con tokens y tipografÃ­a consistentes del sistema Autoframe.',
          whatFor: 'Este add-on proporciona una base sÃ³lida de componentes UI consistentes y accesibles que puedes usar directamente o personalizar segÃºn las necesidades de tu proyecto. Todos los componentes estÃ¡n diseÃ±ados para trabajar juntos y mantener consistencia visual y funcional. Ideal para proyectos que necesitan componentes base bien estructurados desde el inicio.',
          requirements: [
            { type: 'config', label: 'ConfiguraciÃ³n de componentes (opcional)', required: false, example: 'Personalizar estilos, variantes, comportamientos' }
          ]
        }
      };

      // ========================================
      // HELPER: Convertir estructura de menÃº a TreeMenu
      // ========================================
      function renderTreeMenuFromData(containerId, treeData, options = {}) {
        const {
          showIcons = true,
          showChevron = true,
          size = 'md',
          cascade = true,
          onNodeClick = null,
          activeNodeId = null
        } = options;
        
        const container = document.getElementById(containerId);
        if (!container) {
          console.error(`âŒ Container ${containerId} no encontrado`);
          return;
        }
        
        // Cargar CSS del TreeMenu si no estÃ¡ cargado
        const treeMenuCSSId = 'ubits-tree-menu-sidebar-css';
        if (!document.getElementById(treeMenuCSSId)) {
          const style = document.createElement('style');
          style.id = treeMenuCSSId;
          style.textContent = `
            .ubits-tree-menu {
              width: 100%;
              user-select: none;
            }
            
            .ubits-tree-node {
              position: relative;
            }
            
            .ubits-tree-node__content {
              display: flex;
              align-items: center;
              gap: var(--ubits-spacing-sm, 8px);
              padding: var(--ubits-spacing-xs, 4px) var(--ubits-spacing-sm, 8px);
              border-radius: 6px;
              cursor: pointer;
              transition: all 0.2s ease;
              color: var(--ubits-fg-1-high, #303a47);
              background: transparent;
              position: relative;
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) {
              background: var(--ubits-bg-2, #F3F3F4);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__chevron {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__icon {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__label {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content--active,
            .ubits-tree-node__content[aria-selected="true"] {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              background: var(--ubits-bg-active-button, rgba(12, 91, 239, 0.15));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__chevron,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__chevron {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__icon,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__icon {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__label,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__label {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              font-weight: var(--weight-semibold, 600);
            }
            
            .ubits-tree-node__content--expandable:focus-visible {
              outline: 2px solid var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              outline-offset: -2px;
              border-radius: 6px;
            }
            
            .ubits-tree-node__chevron {
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              color: var(--ubits-fg-1-medium, #5c646f);
              transition: color 0.2s ease;
            }
            
            .ubits-tree-node__icon {
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              color: var(--ubits-fg-1-medium, #5c646f);
              width: 20px;
              transition: color 0.2s ease;
            }
            
            .ubits-tree-node__label {
              flex: 1;
              color: var(--ubits-fg-1-high, #303a47);
              transition: color 0.2s ease, font-weight 0.2s ease;
            }
            
            .ubits-tree-node__children {
              margin-top: 2px;
            }
            
            .ubits-tree-menu--vertical .ubits-tree-node {
              padding-left: 0 !important;
            }
            
            .ubits-tree-menu--vertical .ubits-tree-node__children {
              margin-left: 0;
              padding-left: 0;
            }
            
            .ubits-tree-menu--cascade .ubits-tree-node__children {
              margin-left: 0;
            }
          `;
          document.head.appendChild(style);
        }
        
        const uniqueId = `tree-menu-${containerId}-${Date.now()}`;
        const cascadeClass = cascade ? 'ubits-tree-menu--cascade' : 'ubits-tree-menu--vertical';
        
        // FunciÃ³n recursiva para renderizar nodos
        function renderTreeNode(node, level = 0) {
          const hasChildren = node.children && node.children.length > 0;
          const nodeId = `${uniqueId}-node-${level}-${node.id || node.label.toLowerCase().replace(/\s+/g, '-')}`;
          const isExpanded = node.defaultExpanded !== false && hasChildren;
          const isActive = activeNodeId && (node.id === activeNodeId || node.dataId === activeNodeId);
          
          const typographyClass = size === 'sm' 
            ? 'ubits-body-sm-regular' 
            : size === 'lg' 
            ? 'ubits-body-lg-regular' 
            : 'ubits-body-md-regular';
          
          const paddingLeft = cascade 
            ? (size === 'sm' 
              ? `calc(var(--ubits-spacing-md, 16px) * ${level})` 
              : size === 'lg'
              ? `calc(var(--ubits-spacing-lg, 24px) * ${level})`
              : `calc(var(--ubits-spacing-md, 16px) * ${level})`)
            : '0';
          
          const iconSize = size === 'sm' ? '14px' : size === 'lg' ? '18px' : '16px';
          const chevronSize = size === 'sm' ? '12px' : size === 'lg' ? '16px' : '14px';
          
          const iconHTML = showIcons && node.icon 
            ? `<span class="ubits-tree-node__icon" style="font-size: ${iconSize};"><i class="${node.iconStyle || 'far'} fa-${node.icon}"></i></span>`
            : '';
          
          const chevronHTML = hasChildren && showChevron
            ? `<span class="ubits-tree-node__chevron" style="width: ${chevronSize}; height: ${chevronSize};"><i class="far fa-chevron-${isExpanded ? 'down' : 'right'}" style="font-size: ${chevronSize};"></i></span>`
            : hasChildren && !showChevron
            ? `<span class="ubits-tree-node__chevron" style="width: 0; height: 0; display: none;"></span>`
            : `<span class="ubits-tree-node__chevron" style="width: 0; height: 0; display: none;"></span>`;
          
          const activeClass = isActive ? 'ubits-tree-node__content--active' : '';
          
          let html = `
            <div class="ubits-tree-node ${cascade ? 'ubits-tree-node--cascade' : 'ubits-tree-node--vertical'}" data-level="${level}" style="${cascade ? `padding-left: ${paddingLeft};` : ''}">
              <div 
                class="ubits-tree-node__content ${hasChildren ? 'ubits-tree-node__content--expandable' : ''} ${activeClass}" 
                data-node-id="${nodeId}"
                data-item-id="${node.id || node.dataId || ''}"
                ${hasChildren ? `data-expanded="${isExpanded}"` : ''}
                role="${hasChildren ? 'button' : 'treeitem'}"
                ${hasChildren ? 'tabindex="0"' : ''}
                aria-expanded="${hasChildren ? isExpanded : undefined}"
                aria-label="${node.label}"
                ${isActive ? 'aria-selected="true"' : ''}
              >
                ${chevronHTML}
                ${iconHTML}
                <span class="ubits-tree-node__label ${typographyClass}">${node.label}</span>
              </div>
              ${hasChildren ? `
                <div class="ubits-tree-node__children ${cascade ? 'ubits-tree-node__children--cascade' : 'ubits-tree-node__children--vertical'}" data-children-id="${nodeId}" style="display: ${isExpanded ? 'block' : 'none'};">
                  ${node.children.map(child => renderTreeNode(child, level + 1)).join('')}
                </div>
              ` : ''}
            </div>
          `;
          
          return html;
        }
        
        // Renderizar todos los nodos
        const nodesHtml = treeData.map(node => renderTreeNode(node, 0)).join('');
        const treeHTML = `<div class="ubits-tree-menu ${cascadeClass}" id="${uniqueId}" role="tree">${nodesHtml}</div>`;
        container.innerHTML = treeHTML;
        
        // Agregar funcionalidad de expandir/colapsar y selecciÃ³n
        const treeElement = container.querySelector('.ubits-tree-menu');
        if (treeElement) {
          treeElement.addEventListener('click', (e) => {
            const target = e.target;
            const content = target.closest('.ubits-tree-node__content');
            
            if (!content) return;
            
            const itemId = content.getAttribute('data-item-id');
            
            // Manejar expandir/colapsar para nodos con hijos
            if (content.classList.contains('ubits-tree-node__content--expandable')) {
              const nodeId = content.getAttribute('data-node-id');
              const children = treeElement.querySelector(`[data-children-id="${nodeId}"]`);
              const chevron = content.querySelector('.ubits-tree-node__chevron i');
              const isExpanded = content.getAttribute('data-expanded') === 'true';
              
              if (children) {
                if (isExpanded) {
                  children.style.display = 'none';
                  content.setAttribute('data-expanded', 'false');
                  content.setAttribute('aria-expanded', 'false');
                  if (chevron && showChevron) {
                    chevron.className = 'far fa-chevron-right';
                  }
                } else {
                  children.style.display = 'block';
                  content.setAttribute('data-expanded', 'true');
                  content.setAttribute('aria-expanded', 'true');
                  if (chevron && showChevron) {
                    chevron.className = 'far fa-chevron-down';
                  }
                }
              }
            }
            
            // Manejar selecciÃ³n (active state) para todos los nodos
            const allContents = treeElement.querySelectorAll('.ubits-tree-node__content');
            allContents.forEach((node) => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            
            // Agregar active al nodo clickeado
            content.classList.add('ubits-tree-node__content--active');
            content.setAttribute('aria-selected', 'true');
            
            // Llamar callback si existe
            if (onNodeClick && itemId) {
              onNodeClick(itemId, content);
            }
          });
          
          // Soporte para teclado
          treeElement.addEventListener('keydown', (e) => {
            const target = e.target;
            const content = target.closest('.ubits-tree-node__content');
            
            if (!content) return;
            
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              content.click();
            }
          });
        }
        
        return treeElement;
      }
      
      // Generar navegaciÃ³n lateral de add-ons usando TreeMenu
      function generateAddonsNav() {
        console.log('ğŸ”„ generateAddonsNav llamado');
        
        const nav = document.getElementById('addons-nav');
        if (!nav) {
          console.error('âŒ addons-nav NO encontrado en DOM');
          return false;
        }

        console.log('âœ… addons-nav encontrado, generando TreeMenu...');

        const categories = Object.keys(addonsInventory);
        let firstAddonId = null;
        let activeAddonId = null;
        
        // Obtener add-on activo si existe
        const activeLink = nav.querySelector('.side-link.active');
        if (activeLink) {
          activeAddonId = activeLink.getAttribute('data-addon');
        }

        // Convertir estructura a TreeMenu
        const treeData = categories.map((category, catIndex) => {
          const addons = addonsInventory[category];
          const categoryId = category.toLowerCase().replace(/\s+/g, '-');
          const isFirstCategory = catIndex === 0;
          const isExpanded = isFirstCategory 
            ? (localStorage.getItem(`addon-category-${categoryId}-expanded`) !== 'false')
            : (localStorage.getItem(`addon-category-${categoryId}-expanded`) === 'true');
          
          const children = addons.map((addon, addonIndex) => {
            const addonId = addon.id;
            
            const isFirst = catIndex === 0 && addonIndex === 0;
            if (isFirst && !firstAddonId) {
              firstAddonId = addonId;
            }
            
            return {
              label: addon.name,
              id: addonId,
              dataId: addonId,
              defaultExpanded: false
            };
          });
          
          return {
            label: category,
            id: categoryId,
            dataId: categoryId,
            defaultExpanded: isExpanded,
            children: children
          };
        });

        // Renderizar TreeMenu
        renderTreeMenuFromData('addons-nav', treeData, {
          showIcons: false,
          showChevron: true,
          size: 'md',
          cascade: true,
          activeNodeId: activeAddonId || firstAddonId,
          onNodeClick: (itemId, content) => {
            // Verificar si es un add-on (no una categorÃ­a)
            const allAddons = Object.values(addonsInventory).flat();
            const isAddon = allAddons.some(addon => addon.id === itemId);
            
            if (isAddon) {
              handleAddonNavClick(null, itemId);
            } else {
              // Es una categorÃ­a, guardar estado de expansiÃ³n
              const categoryId = itemId;
              const nodeId = content.getAttribute('data-node-id');
              const children = nav.querySelector(`[data-children-id="${nodeId}"]`);
              const isExpanded = children && children.style.display !== 'none';
              localStorage.setItem(`addon-category-${categoryId}-expanded`, isExpanded);
            }
          }
        });
        
        const linkCount = Object.values(addonsInventory).flat().length;
        console.log(`âœ… TreeMenu generado: ${linkCount} add-ons`);
        
        const addonsCategoryTitle = document.getElementById('addons-category-title');
        if (addonsCategoryTitle) {
          const total = Object.values(addonsInventory).flat().length;
          const countSpan = addonsCategoryTitle.querySelector('span:last-child');
          if (countSpan) {
            countSpan.textContent = `${total} add-ons`;
          }
        }

        // Cargar el primer add-on por defecto
        if (firstAddonId && !activeAddonId) {
          setTimeout(() => {
            loadAddon(firstAddonId);
          }, 100);
        }

        return true;
      }

      // FunciÃ³n para cargar el contenido de un add-on
      function loadAddon(addonId) {
        console.log('ğŸ“¦ loadAddon llamado para:', addonId);
        
        const addon = addonsDetails[addonId];
        if (!addon) {
          console.error('âŒ Add-on no encontrado:', addonId);
          return;
        }

        const container = document.getElementById('addons-container');
        if (!container) {
          console.error('âŒ addons-container no encontrado');
          return;
        }

        // Ocultar mensaje por defecto
        const defaultMessage = document.getElementById('addons-default-message');
        if (defaultMessage) {
          defaultMessage.style.display = 'none';
        }

        // Generar HTML del add-on
        let requirementsHTML = '';
        if (addon.requirements && addon.requirements.length > 0) {
          requirementsHTML = '<div style="margin-top: 24px;"><h4 style="color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size); font-weight: var(--weight-semibold); margin: 0 0 16px 0;">ğŸ“‹ Requisitos para usar este add-on:</h4><div style="display: grid; gap: 12px;">';
          addon.requirements.forEach((req, index) => {
            requirementsHTML += `
              <div style="background: var(--ubits-bg-2); padding: 16px; border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                  <span style="color: ${req.required ? 'var(--ubits-error)' : 'var(--ubits-fg-1-medium)'}; font-size: var(--font-body-xs-size); font-weight: var(--weight-semibold);">
                    ${req.required ? 'ğŸ”´ Requerido' : 'ğŸŸ¡ Opcional'}
                  </span>
                  <strong style="color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size);">${req.label}</strong>
                </div>
                ${req.example ? `<p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-xs-size); margin: 8px 0 0 0; font-family: monospace; background: var(--ubits-bg-1); padding: 8px; border-radius: 4px;">Ejemplo: ${req.example}</p>` : ''}
              </div>
            `;
          });
          requirementsHTML += '</div></div>';
        }

        const addonHTML = `
          <div id="addon-${addonId}" class="addon-detail" style="background: var(--ubits-bg-1); border: none; border-radius: 12px; padding: 24px;">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
              <div style="font-size: 32px; color: var(--ubits-button-primary-bg-default);">
                <i class="fas ${addon.icon}"></i>
              </div>
              <div>
                <h2 class="ubits-heading-h2" style="color: var(--ubits-fg-1-high); margin: 0 0 4px 0;">${addon.name}</h2>
                <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size); margin: 0;">
                  ${addon.category} â€¢ ${addon.description}
                </p>
              </div>
            </div>

            <div style="margin-top: 24px;">
              <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 12px 0; font-size: var(--font-h3-size);">Â¿QuÃ© es?</h3>
              <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0;">
                ${addon.whatIs}
              </p>
            </div>

            <div style="margin-top: 24px;">
              <h3 class="ubits-heading-h3" style="color: var(--ubits-fg-1-high); margin: 0 0 12px 0; font-size: var(--font-h3-size);">Â¿Para quÃ© sirve?</h3>
              <p style="color: var(--ubits-fg-1-medium); font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); margin: 0;">
                ${addon.whatFor}
              </p>
            </div>

            ${requirementsHTML}
          </div>
        `;

        container.innerHTML = addonHTML;

        // Actualizar estado activo en TreeMenu
        const nav = document.getElementById('addons-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            // Remover active de todos los nodos
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            
            // Agregar active al nodo correspondiente
            const activeNode = treeMenu.querySelector(`[data-item-id="${addonId}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
              
              // Expandir categorÃ­a padre si estÃ¡ colapsada
              const parentChildren = activeNode.closest('.ubits-tree-node__children');
              if (parentChildren && parentChildren.style.display === 'none') {
                const childrenId = parentChildren.getAttribute('data-children-id');
                // Buscar el nodo padre que tiene este childrenId
                const parentContent = treeMenu.querySelector(`.ubits-tree-node__content[data-node-id="${childrenId}"]`);
                if (parentContent && parentContent.classList.contains('ubits-tree-node__content--expandable')) {
                  // Expandir la categorÃ­a
                  parentChildren.style.display = 'block';
                  parentContent.setAttribute('data-expanded', 'true');
                  parentContent.setAttribute('aria-expanded', 'true');
                  const chevron = parentContent.querySelector('.ubits-tree-node__chevron i');
                  if (chevron) {
                    chevron.className = 'far fa-chevron-down';
                  }
                }
              }
            }
          }
        }

        console.log('âœ… Add-on cargado:', addonId);
      }

      // FunciÃ³n para manejar clicks en navegaciÃ³n de add-ons
      window.handleAddonNavClick = function(event, addonId) {
        console.log('ğŸ¯ handleAddonNavClick llamado con:', addonId);
        
        if (!addonId) {
          console.error('âŒ addonId no proporcionado');
          return;
        }
        
        if (event) {
          event.preventDefault();
          event.stopPropagation();
        }
        
        loadAddon(addonId);
      };

      // Inicializar navegaciÃ³n de add-ons cuando se muestra la secciÃ³n
      function initializeAddonsSection() {
        console.log('ğŸ”„ initializeAddonsSection llamado');
        const nav = document.getElementById('addons-nav');
        if (!nav) {
          console.error('âŒ addons-nav no encontrado en DOM');
          return;
        }
        
        // Siempre regenerar la navegaciÃ³n si estÃ¡ vacÃ­a o si no se ha inicializado
        if (!nav.innerHTML.trim() || nav.querySelectorAll('.side-link').length === 0) {
          console.log('ğŸ“¦ Generando navegaciÃ³n de add-ons...');
          generateAddonsNav();
        } else {
          console.log('âœ… NavegaciÃ³n de add-ons ya existe');
        }
      }

      // Tabs por hash (#hub, #addons, #colores)
      function activateTab(tab){
        const tabs = document.querySelectorAll('.nav-link');
        tabs.forEach(t => t.classList.toggle('active', t.getAttribute('data-tab')===tab));
        const sections = document.querySelectorAll('.section');
        sections.forEach(s => { s.classList.remove('active'); s.style.display = 'none'; });
        const section = document.getElementById(`section-${tab}`);
        if(section) {
          section.classList.add('active');
          section.style.display = 'block';
          console.log('[tabs] activateTab ->', tab, 'section found:', section.id, 'display:', section.style.display, 'parent:', section.parentElement?.id || section.parentElement?.tagName);
          // Verificar visibilidad
          const rect = section.getBoundingClientRect();
          const computedStyle = window.getComputedStyle(section);
          console.log('[tabs] section visibility check:', {
            display: computedStyle.display,
            visibility: computedStyle.visibility,
            opacity: computedStyle.opacity,
            width: rect.width,
            height: rect.height,
            innerHTML: section.innerHTML.length > 0 ? 'has content' : 'empty'
          });
        } else {
          console.warn('[tabs] activateTab -> section not found for tab:', tab);
        }
      }

      function syncFromHash(){
        // Si hay hash, usarlo; si no, usar 'template' por defecto
        const raw = (location.hash||'#template').replace('#','');
        const parts = raw.split('/');
        const tab = parts[0];
        const sub = parts[1];
        console.log('[hash] raw:', raw, 'tab:', tab, 'sub:', sub);
        activateTab(tab);
        if(tab==='colores') activateSubtab(sub||'brand');
        if(tab==='espaciado') activateSpacingCat(sub||'espaciado-basico');
        if(tab==='grid-breakpoints') activateGridBreakpointsCat(sub||'breakpoints');
        if(tab==='effects') activateEffectsCat(sub||'focus');
        debugLayout(sub||'brand');
        // Actualizar menÃº visual segÃºn hash
        const sectionId = `section-${tab}`;
        document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
        document.querySelectorAll('#navbar2 .nav2-subitem').forEach(l=> l.classList.remove('active'));
        
        // Activar el link correspondiente
        const link = document.querySelector(`#navbar2 .nav2-link[data-target="${sectionId}"]`);
        if (link) link.classList.add('active2');
        
        if (tab === 'colores') {
          // aplicar filtro tras activar la categorÃ­a
          if (typeof applySearchFilter === 'function') {
            applySearchFilter();
          }
        } else if (tab === 'espaciado') {
          // aplicar filtro tras activar la categorÃ­a
          if (typeof applySpacingSearchFilter === 'function') {
            applySpacingSearchFilter();
          }
        } else if (tab === 'tipografia') {
          const tipSec = document.getElementById('section-tipografia');
            console.log('[hash] tipografia visible?', !!tipSec, 'display:', tipSec?.style.display, 'classList:', tipSec?.className);
            if (tipSec) {
              // Evitar que reglas .section afecten
              if (tipSec.classList.contains('section')) {
                tipSec.classList.remove('section');
              }
              // Asegurar jerarquÃ­a visible
              document.documentElement.style.minHeight = '100%';
              document.body.style.minHeight = '100%';
              document.body.style.display = 'block';
              tipSec.style.display = 'block';
              tipSec.classList.add('active');
              tipSec.style.outline = '2px dashed #f59e0b';
              tipSec.style.minHeight = '400px';
              const cs = window.getComputedStyle(tipSec);
              const rect = tipSec.getBoundingClientRect();
              console.log('[hash] tipografia size:', tipSec.offsetWidth, tipSec.offsetHeight, 'rect:', rect.width, rect.height, 'cs.display:', cs.display, 'children:', tipSec.children.length);
              // Pintar el header para verificar render
              const h1 = tipSec.querySelector('h1');
              if (h1) { h1.style.background = '#fde68a'; h1.style.padding = '8px'; }
              console.log('[hash] tipografia innerHTML length:', tipSec.innerHTML.length);
              setTimeout(()=>{ if(tipSec) tipSec.style.outline = ''; }, 800);
              // Traer a vista
              tipSec.scrollIntoView({ behavior:'auto', block:'start' });
            }
        } else if (tab === 'texto') {
          const textSec = document.getElementById('section-texto');
          if (textSec) {
            textSec.style.display = 'block';
            textSec.classList.add('active');
            console.log('[hash] texto size:', textSec.offsetWidth, textSec.offsetHeight, 'children:', textSec.children.length);
          }
        }
      }

      // Habilitar hashchange para mantener la secciÃ³n al recargar
      window.addEventListener('hashchange', function() {
        syncFromHash();
        // Actualizar menÃº visual segÃºn hash
        const hash = location.hash ? location.hash.replace('#', '') : '';
        if (hash) {
          const sectionId = `section-${hash.split('/')[0]}`;
          document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
          const link = document.querySelector(`#navbar2 .nav2-link[data-target="${sectionId}"]`);
          if (link) link.classList.add('active2');
        }
      });

      // FunciÃ³n para copiar tokens de espaciado
      window.copyToken = async function(element) {
        const token = element.getAttribute('data-token') || element.textContent.trim();
        try {
          await copyToClipboard(token);
          element.classList.add('copied');
          showToast('success', 'Token copiado', { title: 'Copiado' });
          setTimeout(() => {
            element.classList.remove('copied');
          }, 2000);
        } catch (error) {
          showToast('error', 'Error al copiar', { title: 'Error' });
        }
      };

      // FunciÃ³n para activar categorÃ­as de espaciado
      // Inicializar TreeMenu para espaciado
      function initSpacingTreeMenu() {
        const nav = document.getElementById('spacing-nav');
        if (!nav) {
          console.error('âŒ spacing-nav no encontrado');
          return;
        }
        
        const spacingCategories = [
          { id: 'espaciado-basico', label: 'Espaciado BÃ¡sico' },
          { id: 'espaciado-extendido', label: 'Espaciado Extendido' },
          { id: 'espaciado-grande', label: 'Espaciado Grande' },
          { id: 'bordes', label: 'Bordes' }
        ];
        
        // Obtener categorÃ­a activa del hash o default
        const hash = window.location.hash;
        let activeCat = 'espaciado-basico';
        if (hash && hash.startsWith('#espaciado/')) {
          activeCat = hash.replace('#espaciado/', '');
        }
        
        // Convertir a estructura TreeMenu (un solo nivel)
        const treeData = spacingCategories.map(cat => ({
          label: cat.label,
          id: cat.id,
          dataId: cat.id,
          defaultExpanded: false
        }));

        // Renderizar TreeMenu
        renderTreeMenuFromData('spacing-nav', treeData, {
          showIcons: false, // Sin iconos
          showChevron: false, // Sin chevron porque es un solo nivel
          size: 'md',
          cascade: true,
          activeNodeId: activeCat,
          onNodeClick: (itemId, content) => {
            console.log('ğŸ”— Click en categorÃ­a de espaciado:', itemId);
            if (itemId) {
              activateSpacingCat(itemId);
            }
          }
        });
        
        console.log('âœ… TreeMenu de espaciado inicializado');
      }
      
      window.activateSpacingCat = function(cat) {
        // Actualizar TreeMenu
        const nav = document.getElementById('spacing-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            const activeNode = treeMenu.querySelector(`[data-item-id="${cat}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
            }
          }
        }
        
        document.querySelectorAll('#section-espaciado .cat-section').forEach(s => s.style.display = 'none');
        const el = document.getElementById(`cat-${cat}`);
        if (el) el.style.display = 'block';
        // Sincronizar hash
        const base = 'espaciado';
        history.replaceState(null, '', `#${base}/${cat}`);
        // Aplicar filtro si existe
        if (typeof applySpacingSearchFilter === 'function') {
          applySpacingSearchFilter();
        }
      };
      
      // Inicializar TreeMenu de espaciado cuando se muestra la secciÃ³n
      function initSpacingTreeMenuIfNeeded() {
        const nav = document.getElementById('spacing-nav');
        if (!nav) return;
        
        // Verificar si ya estÃ¡ inicializado
        const treeMenu = nav.querySelector('.ubits-tree-menu');
        if (treeMenu) return; // Ya estÃ¡ inicializado
        
        // Inicializar si la secciÃ³n estÃ¡ visible
        const section = document.getElementById('section-espaciado');
        if (section && (section.classList.contains('active') || section.style.display !== 'none')) {
          initSpacingTreeMenu();
          // Activar categorÃ­a del hash o default
          const hash = window.location.hash;
          if (hash && hash.startsWith('#espaciado/')) {
            const cat = hash.replace('#espaciado/', '');
            activateSpacingCat(cat);
          } else {
            activateSpacingCat('espaciado-basico');
          }
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(() => {
            initSpacingTreeMenuIfNeeded();
          }, 100);
        });
      } else {
        setTimeout(() => {
          initSpacingTreeMenuIfNeeded();
        }, 100);
      }
      
      // Observar cambios en la visibilidad de la secciÃ³n de espaciado
      const spacingSection = document.getElementById('section-espaciado');
      if (spacingSection) {
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && (mutation.attributeName === 'class' || mutation.attributeName === 'style')) {
              const section = mutation.target;
              if (section.classList.contains('active') || section.style.display !== 'none') {
                setTimeout(() => {
                  initSpacingTreeMenuIfNeeded();
                }, 50);
              }
            }
          });
        });
        observer.observe(spacingSection, { attributes: true, attributeFilter: ['class', 'style'] });
      }
      
      // Manejar hashchange para actualizar TreeMenu cuando cambia el hash
      window.addEventListener('hashchange', function() {
        if (window.location.hash.startsWith('#espaciado/')) {
          const cat = window.location.hash.replace('#espaciado/', '');
          activateSpacingCat(cat);
        }
      });

      // Inicializar TreeMenu para grid-breakpoints
      function initGridBreakpointsTreeMenu() {
        const nav = document.getElementById('grid-breakpoints-nav');
        if (!nav) {
          console.error('âŒ grid-breakpoints-nav no encontrado');
          return;
        }
        
        const gridCategories = [
          { id: 'breakpoints', label: 'Breakpoints' },
          { id: 'grid-system', label: 'Sistema de Grid' }
        ];
        
        // Obtener categorÃ­a activa del hash o default
        const hash = window.location.hash;
        let activeCat = 'breakpoints';
        if (hash && hash.startsWith('#grid-breakpoints/')) {
          activeCat = hash.replace('#grid-breakpoints/', '');
        }
        
        // Convertir a estructura TreeMenu (un solo nivel)
        const treeData = gridCategories.map(cat => ({
          label: cat.label,
          id: cat.id,
          dataId: cat.id,
          defaultExpanded: false
        }));
        
        // Renderizar TreeMenu
        renderTreeMenuFromData('grid-breakpoints-nav', treeData, {
          showIcons: false, // Sin iconos
          showChevron: false, // Sin chevron porque es un solo nivel
          size: 'md',
          cascade: true,
          activeNodeId: activeCat,
          onNodeClick: (itemId, content) => {
            console.log('ğŸ”— Click en categorÃ­a de grid-breakpoints:', itemId);
            if (itemId) {
              activateGridBreakpointsCat(itemId);
            }
          }
        });
        
        console.log('âœ… TreeMenu de grid-breakpoints inicializado');
      }

      // FunciÃ³n para activar categorÃ­as de grid y breakpoints
      window.activateGridBreakpointsCat = function(cat) {
        // Actualizar TreeMenu
        const nav = document.getElementById('grid-breakpoints-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            const activeNode = treeMenu.querySelector(`[data-item-id="${cat}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
            }
          }
        }
        
        document.querySelectorAll('#section-grid-breakpoints .cat-section').forEach(s => s.style.display = 'none');
        const el = document.getElementById(`cat-${cat}`);
        if (el) el.style.display = 'block';
        // Sincronizar hash
        const base = 'grid-breakpoints';
        history.replaceState(null, '', `#${base}/${cat}`);
      };
      
      // Inicializar TreeMenu para effects
      function initEffectsTreeMenu() {
        const nav = document.getElementById('effects-nav');
        if (!nav) {
          console.error('âŒ effects-nav no encontrado');
          return;
        }
        
        const effectsCategories = [
          { id: 'focus', label: 'Focus' },
          { id: 'elevation', label: 'Elevation' }
        ];
        
        // Obtener categorÃ­a activa del hash o default
        const hash = window.location.hash;
        let activeCat = 'focus';
        if (hash && hash.startsWith('#effects/')) {
          activeCat = hash.replace('#effects/', '');
        }
        
        // Convertir a estructura TreeMenu (un solo nivel)
        const treeData = effectsCategories.map(cat => ({
          label: cat.label,
          id: cat.id,
          dataId: cat.id,
          defaultExpanded: false
        }));
        
        // Renderizar TreeMenu
        renderTreeMenuFromData('effects-nav', treeData, {
          showIcons: false, // Sin iconos
          showChevron: false, // Sin chevron porque es un solo nivel
          size: 'md',
          cascade: true,
          activeNodeId: activeCat,
          onNodeClick: (itemId, content) => {
            console.log('ğŸ”— Click en categorÃ­a de effects:', itemId);
            if (itemId) {
              activateEffectsCat(itemId);
            }
          }
        });
        
        console.log('âœ… TreeMenu de effects inicializado');
      }

      // FunciÃ³n para activar categorÃ­as de effects
      window.activateEffectsCat = function(cat) {
        // Actualizar TreeMenu
        const nav = document.getElementById('effects-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            const activeNode = treeMenu.querySelector(`[data-item-id="${cat}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
            }
          }
        }
        
        document.querySelectorAll('#section-effects .cat-section').forEach(s => s.style.display = 'none');
        const el = document.getElementById(`cat-${cat}`);
        if (el) el.style.display = 'block';
        // Sincronizar hash
        const base = 'effects';
        history.replaceState(null, '', `#${base}/${cat}`);
      };
      
      // Inicializar TreeMenu de grid-breakpoints cuando se muestra la secciÃ³n
      function initGridBreakpointsTreeMenuIfNeeded() {
        const nav = document.getElementById('grid-breakpoints-nav');
        if (!nav) return;
        
        // Verificar si ya estÃ¡ inicializado
        const treeMenu = nav.querySelector('.ubits-tree-menu');
        if (treeMenu) return; // Ya estÃ¡ inicializado
        
        // Inicializar si la secciÃ³n estÃ¡ visible
        const section = document.getElementById('section-grid-breakpoints');
        if (section && (section.classList.contains('active') || section.style.display !== 'none')) {
          initGridBreakpointsTreeMenu();
          const hash = window.location.hash;
          if (hash && hash.startsWith('#grid-breakpoints/')) {
            const cat = hash.replace('#grid-breakpoints/', '');
            activateGridBreakpointsCat(cat);
          } else {
            activateGridBreakpointsCat('breakpoints');
          }
        }
      }
      
      // Inicializar TreeMenu de effects cuando se muestra la secciÃ³n
      function initEffectsTreeMenuIfNeeded() {
        const nav = document.getElementById('effects-nav');
        if (!nav) return;
        
        // Verificar si ya estÃ¡ inicializado
        const treeMenu = nav.querySelector('.ubits-tree-menu');
        if (treeMenu) return; // Ya estÃ¡ inicializado
        
        // Inicializar si la secciÃ³n estÃ¡ visible
        const section = document.getElementById('section-effects');
        if (section && (section.classList.contains('active') || section.style.display !== 'none')) {
          initEffectsTreeMenu();
          const hash = window.location.hash;
          if (hash && hash.startsWith('#effects/')) {
            const cat = hash.replace('#effects/', '');
            activateEffectsCat(cat);
          } else {
            activateEffectsCat('focus');
          }
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(() => {
            initGridBreakpointsTreeMenuIfNeeded();
            initEffectsTreeMenuIfNeeded();
          }, 100);
        });
      } else {
        setTimeout(() => {
          initGridBreakpointsTreeMenuIfNeeded();
          initEffectsTreeMenuIfNeeded();
        }, 100);
      }
      
      // Observar cambios en la visibilidad de las secciones
      const gridSection = document.getElementById('section-grid-breakpoints');
      if (gridSection) {
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && (mutation.attributeName === 'class' || mutation.attributeName === 'style')) {
              const section = mutation.target;
              if (section.classList.contains('active') || section.style.display !== 'none') {
                setTimeout(() => {
                  initGridBreakpointsTreeMenuIfNeeded();
                }, 50);
              }
            }
          });
        });
        observer.observe(gridSection, { attributes: true, attributeFilter: ['class', 'style'] });
      }
      
      const effectsSection = document.getElementById('section-effects');
      if (effectsSection) {
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && (mutation.attributeName === 'class' || mutation.attributeName === 'style')) {
              const section = mutation.target;
              if (section.classList.contains('active') || section.style.display !== 'none') {
                setTimeout(() => {
                  initEffectsTreeMenuIfNeeded();
                }, 50);
              }
            }
          });
        });
        observer.observe(effectsSection, { attributes: true, attributeFilter: ['class', 'style'] });
      }
      
      // Manejar hashchange para actualizar TreeMenus cuando cambia el hash
      window.addEventListener('hashchange', function() {
        if (window.location.hash.startsWith('#grid-breakpoints/')) {
          const cat = window.location.hash.replace('#grid-breakpoints/', '');
          activateGridBreakpointsCat(cat);
        }
        if (window.location.hash.startsWith('#effects/')) {
          const cat = window.location.hash.replace('#effects/', '');
          activateEffectsCat(cat);
        }
      });

      // FunciÃ³n para actualizar el efecto Focus
      window.updateFocusEffect = function() {
        const preview = document.getElementById('focus-preview');
        if (!preview) return;
        
        const x = document.getElementById('focus-position-x').value || 0;
        const y = document.getElementById('focus-position-y').value || 0;
        const blur = document.getElementById('focus-blur').value || 0;
        const spread = document.getElementById('focus-spread').value || 4;
        const color = document.getElementById('focus-color').value || '#5297F4';
        const opacity = document.getElementById('focus-color-opacity').value || 30;
        
        const rgba = hexToRgba(color, opacity / 100);
        // El borde siempre usa el color sin opacidad
        preview.style.borderColor = color;
        // El box-shadow usa el color con opacidad
        preview.style.boxShadow = `${x}px ${y}px ${blur}px ${spread}px ${rgba}`;
      };

      // FunciÃ³n para actualizar el color Focus desde hex input
      window.updateFocusColorFromHex = function() {
        const hexInput = document.getElementById('focus-color-hex');
        const colorInput = document.getElementById('focus-color');
        if (hexInput && colorInput) {
          const hex = hexInput.value.trim();
          if (/^#[0-9A-F]{6}$/i.test(hex)) {
            colorInput.value = hex;
            updateFocusEffect();
          }
        }
      };

      // FunciÃ³n para actualizar efectos de Elevation
      window.updateElevationEffect = function(type) {
        const preview = document.getElementById(`elevation-${type}-preview`);
        if (!preview) return;
        
        const x = document.getElementById(`elevation-${type}-x`).value || 0;
        const y = document.getElementById(`elevation-${type}-y`).value || 0;
        const blur = document.getElementById(`elevation-${type}-blur`).value || 0;
        const spread = document.getElementById(`elevation-${type}-spread`).value || 0;
        const color = document.getElementById(`elevation-${type}-color`).value || '#000000';
        const opacity = document.getElementById(`elevation-${type}-opacity`).value || 0;
        
        const rgba = hexToRgba(color, opacity / 100);
        preview.style.boxShadow = `${x}px ${y}px ${blur}px ${spread}px ${rgba}`;
      };

      // FunciÃ³n para actualizar el color Elevation desde hex input
      window.updateElevationColorFromHex = function(type) {
        const hexInput = document.getElementById(`elevation-${type}-color-hex`);
        const colorInput = document.getElementById(`elevation-${type}-color`);
        if (hexInput && colorInput) {
          const hex = hexInput.value.trim();
          if (/^#[0-9A-F]{6}$/i.test(hex)) {
            colorInput.value = hex;
            updateElevationEffect(type);
          }
        }
      };

      // FunciÃ³n auxiliar para convertir hex a rgba
      function hexToRgba(hex, opacity) {
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        return `rgba(${r}, ${g}, ${b}, ${opacity})`;
      }

      // Sincronizar color picker con hex input para Focus
      (function initFocusColorSync() {
        const colorInput = document.getElementById('focus-color');
        const hexInput = document.getElementById('focus-color-hex');
        if (colorInput && hexInput) {
          colorInput.addEventListener('input', function() {
            hexInput.value = this.value;
            updateFocusEffect();
          });
        }
      })();

      // Sincronizar color picker con hex input para Elevation
      (function initElevationColorSync() {
        ['default', 'hover', 'overlay', 'floating'].forEach(type => {
          const colorInput = document.getElementById(`elevation-${type}-color`);
          const hexInput = document.getElementById(`elevation-${type}-color-hex`);
          if (colorInput && hexInput) {
            colorInput.addEventListener('input', function() {
              hexInput.value = this.value;
              updateElevationEffect(type);
            });
          }
        });
      })();

      // Inicializar efectos con valores por defecto
      (function initEffects() {
        if (document.getElementById('focus-preview')) {
          updateFocusEffect();
        }
        ['default', 'hover', 'overlay', 'floating'].forEach(type => {
          if (document.getElementById(`elevation-${type}-preview`)) {
            updateElevationEffect(type);
          }
        });
      })();

      // Buscador de tokens de espaciado
      function applySpacingSearchFilter() {
        const input = document.getElementById('spacing-search');
        const q = (input && input.value ? input.value : '').trim().toLowerCase();
        const sectionEspaciado = document.getElementById('section-espaciado');
        if (!sectionEspaciado) return;
        // Detectar categorÃ­a activa visible
        const activeSection = Array.from(sectionEspaciado.querySelectorAll('.cat-section')).find(s => 
          s.style.display === '' || s.style.display === 'block' || (!s.hasAttribute('style'))
        );
        if (!activeSection) return;
        // Si la secciÃ³n activa es grid-breakpoints, no hacer nada (no tiene grids para filtrar)
        if (activeSection.id === 'cat-grid-breakpoints') return;
        const grids = activeSection.querySelectorAll('.grid');
        if (grids.length === 0) return;
        grids.forEach(grid => {
          const children = Array.from(grid.children);
          for (let i = 0; i < children.length; i += 2) {
            const nameEl = children[i];
            const valEl = children[i + 1];
            if (!nameEl || !valEl) continue;
            const txt = (nameEl.textContent + ' ' + valEl.textContent).toLowerCase();
            const match = q === '' || txt.includes(q);
            nameEl.style.display = match ? '' : 'none';
            valEl.style.display = match ? '' : 'none';
          }
        });
      }

      // Subtabs (categorÃ­as dentro de Colores)
      function activateSubtab(cat){
        // Actualizar TreeMenu si existe
        const nav = document.getElementById('colors-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            const activeNode = treeMenu.querySelector(`[data-item-id="${cat}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
            }
          }
        }
        
        // Mantener compatibilidad con links antiguos (por si acaso)
        const subTabs = document.querySelectorAll('#section-colores .side-link');
        subTabs.forEach(t=> t.classList.toggle('active', t.getAttribute('data-cat')===cat));
        
        document.querySelectorAll('#section-colores .cat-section').forEach(s=> s.style.display='none');
        const el = document.getElementById(`cat-${cat}`);
        if(el) el.style.display = '';
        // sincronizar hash
        const base = 'colores';
        history.replaceState(null,'',`#${base}/${cat}`);
        debugLayout(cat);
        if (typeof applySearchFilter === 'function') {
          applySearchFilter();
        }
      }

      // Buscador de tokens por nombre o valor en la categorÃ­a activa
      function applySearchFilter(){
        const input = document.getElementById('tokens-search');
        const q = (input && input.value ? input.value : '').trim().toLowerCase();
        const sectionColores = document.getElementById('section-colores');
        if(!sectionColores) return;
        // detectar secciÃ³n activa visible (sin display:none)
        const activeSection = Array.from(sectionColores.querySelectorAll('.cat-section')).find(s => s.style.display === '' || s.style.display === 'block' || (!s.hasAttribute('style')));
        if(!activeSection) return;
        const grids = activeSection.querySelectorAll('.grid');
        grids.forEach(grid => {
          const children = Array.from(grid.children);
          for(let i=0;i<children.length;i+=2){
            const nameEl = children[i];
            const valEl = children[i+1];
            if(!nameEl || !valEl) continue;
            const txt = (nameEl.textContent + ' ' + valEl.textContent).toLowerCase();
            const match = q === '' || txt.includes(q);
            nameEl.style.display = match ? '' : 'none';
            valEl.style.display = match ? '' : 'none';
          }
        });
      }

      (function initSearch(){
        const input = document.getElementById('tokens-search');
        if(input){
          input.addEventListener('input', applySearchFilter);
        }
        // Buscador de espaciado
        const spacingInput = document.getElementById('spacing-search');
        if (spacingInput) {
          spacingInput.addEventListener('input', applySpacingSearchFilter);
        }
        // Manejo de clicks en el menÃº lateral de espaciado
        const spacingSide = document.querySelector('#section-espaciado .side');
        if (spacingSide) {
          spacingSide.addEventListener('click', (ev) => {
            const a = ev.target.closest('a.side-link');
            if (!a) return;
            const cat = a.getAttribute('data-cat');
            if (!cat) return;
            ev.preventDefault();
            activateSpacingCat(cat);
          });
        }
        // Manejo de clicks en el menÃº lateral de effects
        const effectsSide = document.querySelector('#section-effects .side');
        if (effectsSide) {
          effectsSide.addEventListener('click', (ev) => {
            const a = ev.target.closest('a.side-link');
            if (!a) return;
            const cat = a.getAttribute('data-cat');
            if (!cat) return;
            ev.preventDefault();
            activateEffectsCat(cat);
          });
        }
        // Nuevo menÃº controlador simple
        const nav2 = document.getElementById('navbar2');
        if (nav2) {
          // Inicializar dark mode toggle
          const darkModeToggle = document.getElementById('navbar-darkmode-toggle');
          if (darkModeToggle) {
            // FunciÃ³n para actualizar el icono segÃºn el tema con animaciÃ³n
            const updateIcon = (theme) => {
              const iconElement = darkModeToggle.querySelector('i');
              if (iconElement) {
                // Remover todas las clases de iconos anteriores
                iconElement.classList.remove('fa-moon', 'fa-sun', 'fa-sun-bright', 'far', 'fas', 'fa-solid', 'fa-regular');
                
                // Agregar clase de animaciÃ³n
                iconElement.classList.add('ubits-icon-transition');
                
                // Agregar la clase del icono correspondiente despuÃ©s de un pequeÃ±o delay para asegurar que se aplique la animaciÃ³n
                requestAnimationFrame(() => {
                  if (theme === 'dark') {
                    iconElement.classList.add('fa-solid', 'fa-sun-bright');
                  } else {
                    iconElement.classList.add('far', 'fa-moon');
                  }
                });
                
                // Remover clase de animaciÃ³n despuÃ©s de la transiciÃ³n (ajustado a 400ms para coincidir con la duraciÃ³n de la animaciÃ³n)
                setTimeout(() => {
                  iconElement.classList.remove('ubits-icon-transition');
                }, 400);
              }
            };
            
            // Verificar tema inicial desde localStorage o atributo del body
            const initialTheme = document.body.getAttribute('data-theme') || localStorage.getItem('ubits-theme') || 'dark';
            if (initialTheme === 'dark') {
              darkModeToggle.setAttribute('data-theme', 'dark');
              updateIcon('dark');
            }
            
            darkModeToggle.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              
              const currentTheme = darkModeToggle.getAttribute('data-theme') || 'light';
              const newTheme = currentTheme === 'light' ? 'dark' : 'light';
              
              // Actualizar atributo del botÃ³n
              darkModeToggle.setAttribute('data-theme', newTheme);
              
              // Actualizar el icono
              updateIcon(newTheme);
              
              // Actualizar atributo en el body completo para que todos los componentes se actualicen
              document.body.setAttribute('data-theme', newTheme);
              
              // Guardar en localStorage
              localStorage.setItem('ubits-theme', newTheme);
              
              // Notificar Theme Manager si estÃ¡ disponible
              if (window.UBITS_ThemeManager) {
                window.UBITS_ThemeManager.setTheme(newTheme);
              }
              
              // TambiÃ©n actualizar el atributo en el html
              document.documentElement.setAttribute('data-theme', newTheme);
            });
          }
          
          nav2.addEventListener('click', (e)=>{
            // Manejar clic en el logo
            const logoLink = e.target instanceof Element ? e.target.closest('a.ubits-logo') : null;
            if(logoLink) {
              e.preventDefault();
              const all = Array.from(document.querySelectorAll('#section-template, #section-colores, #section-texto, #section-espaciado, #section-grid-breakpoints, #section-effects'));
              all.forEach(x=> x && (x.style.display = (x.id==='section-template')? 'block' : 'none'));
              document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
              document.querySelectorAll('#navbar2 .nav2-subitem').forEach(l=> l.classList.remove('active'));
              const link = document.querySelector(`#navbar2 .nav2-link[data-target="section-template"]`);
              if (link) link.classList.add('active2');
              history.replaceState(null, '', '#template');
              return;
            }
            // Manejar clic en subitems del menÃº Tokens
            const subitem = e.target instanceof Element ? e.target.closest('a.nav2-subitem') : null;
            if (subitem) {
              e.preventDefault();
              e.stopPropagation();
              const targetId = subitem.getAttribute('data-target');
              const cat = subitem.getAttribute('data-cat');
              
              // Cerrar el menÃº desplegable
              if (tokensMenu) tokensMenu.classList.remove('submenu-open');
              
              // Extraer el nombre de la secciÃ³n del targetId (ej: "section-effects" -> "effects")
              const sectionName = targetId.replace('section-', '');
              
              // Llamar a activateTab para mostrar la secciÃ³n correctamente
              activateTab(sectionName);
              
              // Actualizar estado visual
              document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
              document.querySelectorAll('#navbar2 .nav2-subitem').forEach(l=> l.classList.remove('active'));
              subitem.classList.add('active');
              if (tokensMenu) tokensMenu.classList.add('active2');
              
              // Si hay categorÃ­a especÃ­fica (como bordes), inicializar TreeMenu y activarla
              if (cat && targetId === 'section-espaciado') {
                setTimeout(() => {
                  initSpacingTreeMenuIfNeeded();
                  if (typeof activateSpacingCat === 'function') {
                    activateSpacingCat(cat);
                  }
                }, 100);
              }
              
              // Si hay categorÃ­a especÃ­fica para grid-breakpoints, inicializar TreeMenu y activarla
              if (cat && targetId === 'section-grid-breakpoints') {
                setTimeout(() => {
                  initGridBreakpointsTreeMenuIfNeeded();
                  if (typeof activateGridBreakpointsCat === 'function') {
                    activateGridBreakpointsCat(cat);
                  }
                }, 100);
              }
              
              // Si hay categorÃ­a especÃ­fica para effects, inicializar TreeMenu y activarla
              if (cat && targetId === 'section-effects') {
                setTimeout(() => {
                  initEffectsTreeMenuIfNeeded();
                  if (typeof activateEffectsCat === 'function') {
                    activateEffectsCat(cat);
                  }
                }, 100);
              }
              
              // Si hay categorÃ­a especÃ­fica para espaciado, inicializar TreeMenu y activarla
              if (cat && targetId === 'section-espaciado') {
                setTimeout(() => {
                  initSpacingTreeMenuIfNeeded();
                  if (typeof activateSpacingCat === 'function') {
                    activateSpacingCat(cat);
                  }
                }, 100);
              }
              
              // Actualizar hash
              const hash = cat ? `${sectionName}/${cat}` : sectionName;
              history.replaceState(null, '', `#${hash}`);
              return;
            }
            // Manejar clic en links del menÃº principal
            const a = e.target instanceof Element ? e.target.closest('a[data-target]') : null;
            if(!a) return;
            e.preventDefault();
            const targetId = a.getAttribute('data-target');
            const all = Array.from(document.querySelectorAll('#section-hub, #section-addons, #section-template, #section-colores, #section-texto, #section-espaciado, #section-grid-breakpoints, #section-effects'));
            all.forEach(x=> x && (x.style.display = (x.id===targetId)? 'block' : 'none'));
            
            // Inicializar TreeMenus cuando se muestran las secciones
            if (targetId === 'section-espaciado') {
              setTimeout(() => {
                initSpacingTreeMenuIfNeeded();
              }, 50);
            } else if (targetId === 'section-grid-breakpoints') {
              setTimeout(() => {
                initGridBreakpointsTreeMenuIfNeeded();
              }, 50);
            } else if (targetId === 'section-effects') {
              setTimeout(() => {
                initEffectsTreeMenuIfNeeded();
              }, 50);
            } else if (targetId === 'section-colores') {
              setTimeout(() => {
                initColorsTreeMenuIfNeeded();
              }, 50);
            }
            // estado visual activo (sin scroll automÃ¡tico para evitar saltos)
            document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
            document.querySelectorAll('#navbar2 .nav2-subitem').forEach(l=> l.classList.remove('active'));
            const link = document.querySelector(`#navbar2 .nav2-link[data-target="${targetId}"]`);
            if (link) link.classList.add('active2');
            
            // Inicializar secciÃ³n de Add-ons si se estÃ¡ mostrando
            if (targetId === 'section-addons') {
              setTimeout(() => {
                console.log('ğŸ”„ SecciÃ³n Add-ons activada desde navegaciÃ³n, inicializando...');
                if (typeof initializeAddonsSection === 'function') {
                  initializeAddonsSection();
                } else {
                  console.error('âŒ initializeAddonsSection no estÃ¡ definida');
                }
              }, 150);
            }
            
            // Si es section-grid-breakpoints, inicializar TreeMenu y activar categorÃ­a
            if (targetId === 'section-grid-breakpoints') {
              setTimeout(() => {
                initGridBreakpointsTreeMenuIfNeeded();
                if (typeof activateGridBreakpointsCat === 'function') {
                  const hash = window.location.hash;
                  if (hash && hash.startsWith('#grid-breakpoints/')) {
                    const cat = hash.replace('#grid-breakpoints/', '');
                    activateGridBreakpointsCat(cat);
                  } else {
                    activateGridBreakpointsCat('breakpoints');
                  }
                }
              }, 100);
            }
            
            // Si es section-effects, inicializar TreeMenu y activar categorÃ­a
            if (targetId === 'section-effects') {
              setTimeout(() => {
                initEffectsTreeMenuIfNeeded();
                if (typeof activateEffectsCat === 'function') {
                  const hash = window.location.hash;
                  if (hash && hash.startsWith('#effects/')) {
                    const cat = hash.replace('#effects/', '');
                    activateEffectsCat(cat);
                  } else {
                    activateEffectsCat('focus');
                  }
                }
              }, 100);
            }
            
            // Si es section-espaciado, inicializar TreeMenu y activar categorÃ­a
            if (targetId === 'section-espaciado') {
              setTimeout(() => {
                initSpacingTreeMenuIfNeeded();
                if (typeof activateSpacingCat === 'function') {
                  const hash = window.location.hash;
                  if (hash && hash.startsWith('#espaciado/')) {
                    const cat = hash.replace('#espaciado/', '');
                    activateSpacingCat(cat);
                  } else {
                    activateSpacingCat('espaciado-basico');
                  }
                }
              }, 100);
            }
            
            // Actualizar hash para mantener la secciÃ³n al recargar
            const sectionName = targetId.replace('section-', '');
            history.replaceState(null, '', `#${sectionName}`);
          });
          // Mostrar Template por defecto si no hay hash
          const hash = location.hash ? location.hash.replace('#', '') : '';
          const defaultSection = hash ? `section-${hash.split('/')[0]}` : 'section-template';
              const all = Array.from(document.querySelectorAll('#section-template, #section-colores, #section-texto, #section-espaciado, #section-grid-breakpoints, #section-effects'));
          all.forEach(x=> x && (x.style.display = (x.id===defaultSection)? 'block' : 'none'));
          // Actualizar estado visual del menÃº
          document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
          document.querySelectorAll('#navbar2 .nav2-subitem').forEach(l=> l.classList.remove('active'));
          const activeLink = document.querySelector(`#navbar2 .nav2-link[data-target="${defaultSection}"]`);
          if (activeLink) {
            activeLink.classList.add('active2');
          }
          console.log('[nav2] default ->', defaultSection,
            'states:', all.map(x=> x.id+':'+getComputedStyle(x).display).join(', ')
          );
          // Si hay hash, sincronizar con Ã©l; si no, establecer hash por defecto
          if (hash) {
            syncFromHash();
            // Si es espaciado, inicializar TreeMenu y activar la categorÃ­a del hash o la bÃ¡sica por defecto
            if (hash.startsWith('espaciado')) {
              setTimeout(() => {
                initSpacingTreeMenuIfNeeded();
                const parts = hash.split('/');
                const cat = parts[1] || 'espaciado-basico';
                if (typeof activateSpacingCat === 'function') {
                  activateSpacingCat(cat);
                }
              }, 100);
            }
            // Si es effects, inicializar TreeMenu y activar la categorÃ­a del hash o focus por defecto
            if (hash.startsWith('effects')) {
              setTimeout(() => {
                initEffectsTreeMenuIfNeeded();
                const parts = hash.split('/');
                const cat = parts[1] || 'focus';
                if (typeof activateEffectsCat === 'function') {
                  activateEffectsCat(cat);
                }
              }, 100);
            }
            // Si es grid-breakpoints, inicializar TreeMenu y activar la categorÃ­a del hash o breakpoints por defecto
            if (hash.startsWith('grid-breakpoints')) {
              setTimeout(() => {
                initGridBreakpointsTreeMenuIfNeeded();
                const parts = hash.split('/');
                const cat = parts[1] || 'breakpoints';
                if (typeof activateGridBreakpointsCat === 'function') {
                  activateGridBreakpointsCat(cat);
                }
              }, 100);
            }
            // Si es colores, inicializar TreeMenu
            if (hash.startsWith('colores')) {
              setTimeout(() => {
                initColorsTreeMenuIfNeeded();
              }, 100);
            }
          } else {
            // Establecer hash por defecto para mantener la secciÃ³n al recargar
            history.replaceState(null, '', '#template');
          }
        }
        // Desactivar fallback del navbar viejo (evitamos reconstrucciÃ³n)

        // Fallback: si secciÃ³n #section-texto no existe, crear mÃ­nima para render
        if (!document.getElementById('section-texto')) {
          const sec = document.createElement('div');
          sec.id = 'section-texto';
          sec.className = 'section';
          sec.style.display = 'none';
          sec.innerHTML = `
            <h1>TipografÃ­a</h1>
            <div class="kcard"><h3>Display</h3>
              <div class="typo-sample">
                <div class="typo-box"><code>D1</code></div>
                <div style="font-family:var(--font-sans); font-size:var(--font-d1-size); line-height:var(--font-d1-line); font-weight:700">Display 1</div>
              </div>
            </div>`;
          document.body.appendChild(sec);
          console.warn('[fallback] secciÃ³n #section-texto creada (mÃ­nima)');
        }
        // Manejo robusto de clicks en el menÃº lateral (evita estados de hash inconsistentes)
        const side = document.querySelector('#section-colores .side');
        if(side){
          side.addEventListener('click', (ev)=>{
            const a = ev.target.closest('a.side-link');
            if(!a) return;
            const cat = a.getAttribute('data-cat');
            if(!cat) return;
            ev.preventDefault();
            activateSubtab(cat);
          });
        }
      })();

      // Ajuste: detecciÃ³n mÃ¡s robusta de secciÃ³n activa visible
      function getActiveCategorySection(){
        const all = Array.from(document.querySelectorAll('#section-colores .cat-section'));
        // secciÃ³n sin display:none (inline style)
        const visible = all.find(s => s.style.display !== 'none');
        return visible || all.find(s => !s.hasAttribute('style')) || null;
      }
      function getActiveCatId(){
        const nav = document.getElementById('colors-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            const activeNode = treeMenu.querySelector('.ubits-tree-node__content--active');
            if (activeNode) {
              return activeNode.getAttribute('data-item-id') || 'brand';
            }
          }
        }
        // Fallback: buscar en hash de URL
        const hash = window.location.hash;
        if (hash && hash.startsWith('#colores/')) {
          return hash.replace('#colores/', '');
        }
        return 'brand';
      }
      
      // Inicializar TreeMenu para colores
      function initColorsTreeMenu() {
        const nav = document.getElementById('colors-nav');
        if (!nav) {
          console.error('âŒ colors-nav no encontrado');
          return;
        }
        
        const colorCategories = [
          { id: 'brand', label: 'Brand' },
          { id: 'button', label: 'Button' },
          { id: 'foreground', label: 'Foreground' },
          { id: 'blue', label: 'Blue Foregrounds' },
          { id: 'gray', label: 'Gray Foregrounds' },
          { id: 'green', label: 'Green Foregrounds' },
          { id: 'teal', label: 'Teal Foregrounds' },
          { id: 'purple', label: 'Purple Foregrounds' },
          { id: 'yellow', label: 'Yellow Foregrounds' },
          { id: 'background', label: 'Background Colors' },
          { id: 'borders-main', label: 'Border Colors - Main' },
          { id: 'borders-colored', label: 'Border Colors - Colored' },
          { id: 'borders-inverted', label: 'Border Colors - Inverted' },
          { id: 'borders-static', label: 'Border Colors - Static' },
          { id: 'borders-static-inverted', label: 'Border Colors - Static Inverted' },
          { id: 'sidebar', label: 'Sidebar Colors' },
          { id: 'feedback-success', label: 'Feedback Â· Success' },
          { id: 'feedback-info', label: 'Feedback Â· Info' },
          { id: 'feedback-warning', label: 'Feedback Â· Warning' },
          { id: 'feedback-error', label: 'Feedback Â· Error' },
          { id: 'feedback-borders', label: 'Feedback Â· Borders' },
          { id: 'chart', label: 'Chart Colors' },
          { id: 'toast', label: 'Toast Colors' },
          { id: 'bottom-nav', label: 'Bottom Nav Colors' },
          { id: 'pink', label: 'Pink Foregrounds' },
          { id: 'rose', label: 'Rose Foregrounds' }
        ];
        
        // Obtener categorÃ­a activa del hash o default
        const activeCat = getActiveCatId();
        
        // Convertir a estructura TreeMenu (un solo nivel)
        const treeData = colorCategories.map(cat => ({
          label: cat.label,
          id: cat.id,
          dataId: cat.id,
          defaultExpanded: false
        }));

        // Renderizar TreeMenu
        renderTreeMenuFromData('colors-nav', treeData, {
          showIcons: false, // Sin iconos
          showChevron: false, // Sin chevron porque es un solo nivel
          size: 'md',
          cascade: true,
          activeNodeId: activeCat,
          onNodeClick: (itemId, content) => {
            console.log('ğŸ”— Click en categorÃ­a de color:', itemId);
            if (itemId) {
              // Cambiar hash
              window.location.hash = `#colores/${itemId}`;
              // Mostrar solo la categorÃ­a activa
              showOnlyActive();
              // Actualizar estado activo
              const treeMenu = nav.querySelector('.ubits-tree-menu');
              if (treeMenu) {
                treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
                  node.classList.remove('ubits-tree-node__content--active');
                  node.removeAttribute('aria-selected');
                });
                content.classList.add('ubits-tree-node__content--active');
                content.setAttribute('aria-selected', 'true');
              }
            }
          }
        });
        
        console.log('âœ… TreeMenu de colores inicializado');
      }
      function showOnlyActive(){
        const active = getActiveCatId();
        document.querySelectorAll('#section-colores .cat-section').forEach(sec => {
          sec.style.display = (sec.id === `cat-${active}`) ? '' : 'none';
        });
        
        // Actualizar estado activo en TreeMenu
        const nav = document.getElementById('colors-nav');
        if (nav) {
          const treeMenu = nav.querySelector('.ubits-tree-menu');
          if (treeMenu) {
            treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
              node.classList.remove('ubits-tree-node__content--active');
              node.removeAttribute('aria-selected');
            });
            const activeNode = treeMenu.querySelector(`[data-item-id="${active}"]`);
            if (activeNode) {
              activeNode.classList.add('ubits-tree-node__content--active');
              activeNode.setAttribute('aria-selected', 'true');
            }
          }
        }
      }
      
      // Inicializar TreeMenu de colores cuando se carga la pÃ¡gina o se muestra la secciÃ³n
      function initColorsTreeMenuIfNeeded() {
        const nav = document.getElementById('colors-nav');
        if (!nav) return;
        
        // Verificar si ya estÃ¡ inicializado
        const treeMenu = nav.querySelector('.ubits-tree-menu');
        if (treeMenu) return; // Ya estÃ¡ inicializado
        
        // Inicializar si la secciÃ³n estÃ¡ visible
        const section = document.getElementById('section-colores');
        if (section && (section.classList.contains('active') || section.style.display !== 'none')) {
          initColorsTreeMenu();
          showOnlyActive();
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(() => {
            initColorsTreeMenuIfNeeded();
          }, 100);
        });
      } else {
        setTimeout(() => {
          initColorsTreeMenuIfNeeded();
        }, 100);
      }
      
      // Observar cambios en la visibilidad de la secciÃ³n de colores
      const colorsSection = document.getElementById('section-colores');
      if (colorsSection) {
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
              const section = mutation.target;
              if (section.classList.contains('active') || section.style.display !== 'none') {
                setTimeout(() => {
                  initColorsTreeMenuIfNeeded();
                }, 50);
              }
            }
          });
        });
        observer.observe(colorsSection, { attributes: true, attributeFilter: ['class'] });
      }
      
      // Manejar hashchange para actualizar TreeMenu cuando cambia el hash
      window.addEventListener('hashchange', function() {
        if (window.location.hash.startsWith('#colores/')) {
          showOnlyActive();
        }
      });

      // Reescribir applySearchFilter para usar bÃºsqueda global por todas las categorÃ­as
      function applySearchFilter(){
        const input = document.getElementById('tokens-search');
        const q = (input && input.value ? input.value : '').trim().toLowerCase();
        const sections = Array.from(document.querySelectorAll('#section-colores .cat-section'));
        if(q === ''){
          // restaurar visibilidad de pares en todas las secciones y mostrar solo la activa
          sections.forEach(sec => {
            sec.querySelectorAll('.grid').forEach(grid => {
              const children = Array.from(grid.children);
              for(let i=0;i<children.length;i+=2){
                if(children[i]) children[i].style.display = '';
                if(children[i+1]) children[i+1].style.display = '';
              }
            });
          });
          showOnlyActive();
          return;
        }
        // Mostrar todas las secciones y filtrar cada una; ocultar las que no tengan matches
        sections.forEach(sec => {
          sec.style.display = '';
          let hasVisible = false;
          sec.querySelectorAll('.grid').forEach(grid => {
            const children = Array.from(grid.children);
            for(let i=0;i<children.length;i+=2){
              const nameEl = children[i];
              const valEl = children[i+1];
              if(!nameEl || !valEl) continue;
              const txt = (nameEl.textContent + ' ' + valEl.textContent).toLowerCase();
              const match = txt.includes(q);
              nameEl.style.display = match ? '' : 'none';
              valEl.style.display = match ? '' : 'none';
              if(match) hasVisible = true;
            }
          });
          // Ocultar secciÃ³n si no hay ningÃºn par visible
          sec.style.display = hasVisible ? '' : 'none';
        });
      }

      function copyToClipboard(text){
        if (navigator.clipboard && navigator.clipboard.writeText) {
          return navigator.clipboard.writeText(text);
        }
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.focus(); ta.select();
        try { document.execCommand('copy'); } catch(e) {}
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      // FunciÃ³n para copiar bloques de cÃ³digo
      window.copyCodeBlock = async function(button) {
        const codeBlock = button.closest('.copyable-code-block');
        const pre = codeBlock.querySelector('pre');
        const code = pre.getAttribute('data-code') || pre.textContent.trim();
        
        try {
          await copyToClipboard(code);
          button.classList.add('copied');
          const span = button.querySelector('span');
          if (span) span.textContent = 'Copiado';
          showToast('success', 'CÃ³digo copiado', { title: 'Copiado' });
          
          setTimeout(() => {
            button.classList.remove('copied');
            const span = button.querySelector('span');
            if (span) span.textContent = 'Copiar';
          }, 2000);
        } catch (error) {
          showToast('error', 'Error al copiar', { title: 'Error' });
        }
      };

      // Permitir copiar al hacer clic en el bloque de cÃ³digo
      (function initCopyableBlocks() {
        function setupCopyableBlocks() {
          document.querySelectorAll('.copyable-code-block pre').forEach(pre => {
            if (!pre.hasAttribute('data-copy-listener')) {
              pre.setAttribute('data-copy-listener', 'true');
              pre.addEventListener('click', function() {
                const codeBlock = this.closest('.copyable-code-block');
                const button = codeBlock.querySelector('.copy-btn');
                if (button) window.copyCodeBlock(button);
              });
            }
          });
        }
        
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', setupCopyableBlocks);
        } else {
          setupCopyableBlocks();
        }
        
        // FunciÃ³n global para actualizar el estado visual de los toggles UBITS
        window.updateToggleState = function(toggleInput) {
          if (!toggleInput) return;
          const toggleLabel = toggleInput.closest('.ubits-toggle');
          if (toggleLabel) {
            if (toggleInput.checked) {
              toggleLabel.classList.add('ubits-toggle--checked');
            } else {
              toggleLabel.classList.remove('ubits-toggle--checked');
            }
          }
        };
        
        // FunciÃ³n global para inicializar todos los toggles existentes
        window.initializeToggles = function() {
          const toggleInputs = document.querySelectorAll('.ubits-toggle__input');
          toggleInputs.forEach(input => {
            // Actualizar estado visual inicial
            window.updateToggleState(input);
            // Agregar listener solo si no tiene uno ya (evitar duplicados)
            if (!input.hasAttribute('data-toggle-initialized')) {
              input.setAttribute('data-toggle-initialized', 'true');
              input.addEventListener('change', function() {
                window.updateToggleState(this);
              });
            }
          });
        };
        
        // Delegado de eventos global para todos los toggles (captura eventos antes de que se propaguen)
        function setupToggleEventDelegation() {
          document.addEventListener('change', function(e) {
            if (e.target && e.target.classList && e.target.classList.contains('ubits-toggle__input')) {
              window.updateToggleState(e.target);
            }
          }, true); // Usar capture phase para capturar antes que otros listeners
        }
        
        // Inicializar toggles cuando el DOM estÃ© listo
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            window.initializeToggles();
            setupToggleEventDelegation();
          });
        } else {
          window.initializeToggles();
          setupToggleEventDelegation();
        }
        
        // Usar MutationObserver para detectar cuando se agregan nuevos toggles al DOM
        if (typeof MutationObserver !== 'undefined') {
          const toggleObserver = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeType === 1) { // Element node
                  // Buscar toggles dentro del nodo agregado
                  if (node.querySelectorAll) {
                    const toggleInputs = node.querySelectorAll('.ubits-toggle__input');
                    toggleInputs.forEach(input => {
                      window.updateToggleState(input);
                      // Agregar listener solo si no tiene uno ya
                      if (!input.hasAttribute('data-toggle-initialized')) {
                        input.setAttribute('data-toggle-initialized', 'true');
                        input.addEventListener('change', function() {
                          window.updateToggleState(this);
                        });
                      }
                    });
                  }
                  // Si el nodo mismo es un toggle
                  if (node.classList && node.classList.contains('ubits-toggle')) {
                    const input = node.querySelector('.ubits-toggle__input');
                    if (input) {
                      window.updateToggleState(input);
                      // Agregar listener solo si no tiene uno ya
                      if (!input.hasAttribute('data-toggle-initialized')) {
                        input.setAttribute('data-toggle-initialized', 'true');
                        input.addEventListener('change', function() {
                          window.updateToggleState(this);
                        });
                      }
                    }
                  }
                }
              });
            });
          });
          
          // Observar cambios en el body cuando estÃ© disponible
          if (document.body) {
            toggleObserver.observe(document.body, {
              childList: true,
              subtree: true
            });
          } else {
            document.addEventListener('DOMContentLoaded', function() {
              toggleObserver.observe(document.body, {
                childList: true,
                subtree: true
              });
            });
          }
        }
        
        // TambiÃ©n inicializar cuando se agreguen nuevos componentes dinÃ¡micamente
        const originalCreateComponent = window.createComponent;
        if (originalCreateComponent) {
          window.createComponent = function(...args) {
            const result = originalCreateComponent.apply(this, args);
            // Esperar un poco para que el DOM se actualice
            setTimeout(function() {
              if (window.initializeToggles) {
                window.initializeToggles();
              }
            }, 100);
            return result;
          };
        }
      })();

      // FunciÃ³n para copiar prompts completos
      window.copyPrompt = async function(button, type) {
        const promptCard = button.closest('.copyable-prompt');
        let promptText = '';
        
        if (type === 'cursor') {
          promptText = `EstÃ¡s trabajando con el Template UBITS, un sistema completo para crear aplicaciones UBITS con diseÃ±o system, componentes modulares y validaciÃ³n automÃ¡tica.

Instrucciones para Cursor:
1. Ejecuta npm run init y selecciona el perfil
2. Usa npm run watch para auto-commit
3. Siempre usa tokens UBITS para colores y tipografÃ­a
4. Reutiliza componentes existentes
5. Valida con npm run validate`;
        } else if (type === 'storybook') {
          promptText = `EstÃ¡s trabajando con el Template UBITS en Storybook. Este template incluye componentes modulares, tokens de diseÃ±o UBITS y validaciÃ³n automÃ¡tica.

Instrucciones para Storybook:
1. Ejecuta "cd packages/docs-site && npm run storybook" para iniciar Storybook
2. Los componentes estÃ¡n documentados en packages/storybook/stories/
3. Usa los tokens UBITS para colores, tipografÃ­a y espaciado
4. Reutiliza componentes existentes de packages/components/
5. Valida tus cambios con "npm run validate"

Componentes Disponibles en Storybook:
- Sidebar - Con variantes colaborador/admin
- TabBar - Con variantes colaborador/admin
- SubNav - NavegaciÃ³n por pestaÃ±as
- Button, Input, Card, Alert, Toast, Badge

Reglas Importantes:
- Siempre usa tokens UBITS (var(--ubits-bg-1), var(--ubits-fg-1-high), etc.)
- Usa clases de tipografÃ­a oficiales (.ubits-heading-h1, .ubits-body-lg, etc.)
- Reutiliza componentes existentes en lugar de crear nuevos
- MantÃ©n la consistencia con el diseÃ±o system`;
        }
        
        try {
          await copyToClipboard(promptText);
          button.classList.add('copied');
          const span = button.querySelector('span');
          if (span) span.textContent = 'Copiado';
          showToast('success', 'Prompt copiado', { title: 'Copiado' });
          
          setTimeout(() => {
            button.classList.remove('copied');
            const span = button.querySelector('span');
            if (span) span.textContent = 'Copiar Prompt';
          }, 2000);
        } catch (error) {
          showToast('error', 'Error al copiar', { title: 'Error' });
        }
      };

      // No-op de diagnÃ³stico para evitar errores en consola
      function debugLayout(){ /* noop */ }

      // Copiado de reglas CSS en TipografÃ­a
      document.addEventListener('click', async (ev)=>{
        const el = (ev.target instanceof Element) ? ev.target.closest('.typo-sample.copyable') : null;
        if(!el) return;
        const css = el.getAttribute('data-css');
        if(!css) return;
        ev.preventDefault();
        await copyToClipboard(css);
        showToast('success', 'Fuente copiada', { title: 'Copiado' });
      });

      // Copiado de cÃ³digo HTML de iconos
      document.addEventListener('click', async (ev)=>{
        const iconCard = (ev.target instanceof Element) ? ev.target.closest('.icon-card.copyable') : null;
        if(!iconCard) return;
        const code = iconCard.getAttribute('data-code');
        if(!code) return;
        ev.preventDefault();
        const htmlCode = `<i class="${code}"></i>`;
        await copyToClipboard(htmlCode);
        iconCard.classList.add('copied');
        showToast('success', 'Icono copiado', { title: 'Copiado' });
        setTimeout(() => {
          iconCard.classList.remove('copied');
        }, 900);
      });

      function cell(name, theme){
        html.setAttribute('data-theme', theme);
        const value = getComputedStyle(root).getPropertyValue(name).trim();
        const wrap = document.createElement('div');
        wrap.className = 'copyable';
        wrap.title = `Click para copiar: ${name} = ${value}`;
        const vLower = value.toLowerCase();
        const isWhite = vLower === '#fff' || vLower === '#ffffff' || vLower.includes('255, 255, 255');
        const swatchStyle = isWhite
          ? 'background:repeating-conic-gradient(#eee 0% 25%, #fff 0% 50%) 50%/12px 12px; border:1px solid #9ca3af'
          : `background:${value}`;
        wrap.innerHTML = `<div class="swatch" style="${swatchStyle}"></div><code>${value}</code>`;
        wrap.addEventListener('click', async () => {
          await copyToClipboard(`${name}: ${value}`);
          showToast('success', 'Color copiado', { title: 'Copiado' });
          wrap.classList.add('copied');
          const prev = wrap.querySelector('code')?.textContent;
          const codeEl = wrap.querySelector('code');
          if (codeEl) codeEl.textContent = 'copiado';
          setTimeout(() => {
            wrap.classList.remove('copied');
            if (codeEl && prev) codeEl.textContent = prev;
          }, 900);
        });
        return wrap;
      }

      function addRow(token){
        const gridL = document.getElementById('grid-light');
        const gridD = document.getElementById('grid-dark');
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridL.appendChild(nameL);
        gridL.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridD.appendChild(nameD);
        gridD.appendChild(cell(token,'dark'));
      }

      TOKENS.forEach(addRow);
      
      // BUTTON COLORS
      const BTN = [
        '--ubits-button-primary-bg-default',
        '--ubits-button-primary-hover',
        '--ubits-button-primary-pressed',
        '--ubits-button-active-bg',
        '--ubits-button-focus-ring',
        '--ubits-button-badge',
        '--ubits-btn-primary-fg',
        '--ubits-bg-disabled-button',
        '--ubits-border-disabled-button',
        '--ubits-fg-on-disabled-button',
        '--ubits-btn-secondary-bg-default',
        '--ubits-btn-secondary-bg-hover',
        '--ubits-btn-secondary-bg-pressed',
        '--ubits-btn-secondary-fg-default',
        '--ubits-btn-secondary-border',
        '--ubits-btn-tertiary-fg',
        '--ubits-btn-tertiary-bg-hover',
        '--ubits-btn-tertiary-bg-pressed'
      ];
      const gridLB = document.getElementById('grid-light-button');
      const gridDB = document.getElementById('grid-dark-button');
      function addRowBtn(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLB.appendChild(nameL);
        gridLB.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDB.appendChild(nameD);
        gridDB.appendChild(cell(token,'dark'));
      }
      BTN.forEach(addRowBtn);

      // FOREGROUND COLORS
      const FG = [
        '--ubits-fg-1-high','--ubits-fg-1-high-inverted','--ubits-fg-1-high-static','--ubits-fg-1-high-static-inverted',
        '--ubits-fg-1-medium','--ubits-fg-1-medium-inverted','--ubits-fg-1-medium-static','--ubits-fg-1-medium-static-inverted',
        '--ubits-fg-2-high','--ubits-fg-2-high-inverted','--ubits-fg-2-high-static','--ubits-fg-2-high-static-inverted',
        '--ubits-fg-2-medium','--ubits-fg-2-medium-inverted','--ubits-fg-2-medium-static','--ubits-fg-2-medium-static-inverted',
        '--ubits-fg-disabled','--ubits-fg-disabled-inverted','--ubits-fg-disabled-static','--ubits-fg-disabled-static-inverted',
        '--ubits-fg-on-disabled','--ubits-fg-on-disabled-inverted','--ubits-fg-on-disabled-static','--ubits-fg-on-disabled-static-inverted',
        '--ubits-fg-bold'
      ];
      const gridLFG = document.getElementById('grid-light-fg');
      const gridDFG = document.getElementById('grid-dark-fg');
      function addRowFg(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFG.appendChild(nameL);
        gridLFG.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFG.appendChild(nameD);
        gridDFG.appendChild(cell(token,'dark'));
      }
      FG.forEach(addRowFg);

      // BLUE FOREGROUNDS
      const BLUE_FG = [
        '--ubits-fg-blue-subtle',
        '--ubits-fg-blue-subtle-inverted',
        '--ubits-fg-blue-subtle-hover',
        '--ubits-fg-blue-subtle-inverted-hover',
        '--ubits-fg-blue-subtle-static',
        '--ubits-fg-blue-subtle-static-inverted',
        '--ubits-fg-blue-subtle-static-hover',
        '--ubits-fg-blue-subtle-static-inverted-hover'
      ];
      const gridLBlue = document.getElementById('grid-light-fg-blue');
      const gridDBlue = document.getElementById('grid-dark-fg-blue');
      function addRowBlue(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBlue.appendChild(nameL);
        gridLBlue.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBlue.appendChild(nameD);
        gridDBlue.appendChild(cell(token,'dark'));
      }
      BLUE_FG.forEach(addRowBlue);

      // GRAY FOREGROUNDS
      const GRAY_FG = [
        '--ubits-fg-gray-subtle',
        '--ubits-fg-gray-subtle-inverted',
        '--ubits-fg-gray-subtle-hover',
        '--ubits-fg-gray-subtle-inverted-hover',
        '--ubits-fg-gray-subtle-static',
        '--ubits-fg-gray-subtle-static-inverted',
        '--ubits-fg-gray-subtle-static-hover',
        '--ubits-fg-gray-subtle-static-inverted-hover'
      ];
      const gridLGray = document.getElementById('grid-light-fg-gray');
      const gridDGray = document.getElementById('grid-dark-fg-gray');
      function addRowGray(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLGray.appendChild(nameL);
        gridLGray.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDGray.appendChild(nameD);
        gridDGray.appendChild(cell(token,'dark'));
      }
      GRAY_FG.forEach(addRowGray);

      // GREEN FOREGROUNDS
      const GREEN_FG = [
        '--ubits-fg-green-subtle',
        '--ubits-fg-green-subtle-inverted',
        '--ubits-fg-green-subtle-hover',
        '--ubits-fg-green-subtle-inverted-hover',
        '--ubits-fg-green-subtle-static',
        '--ubits-fg-green-subtle-static-inverted',
        '--ubits-fg-green-subtle-static-hover',
        '--ubits-fg-green-subtle-static-inverted-hover'
      ];
      const gridLGreen = document.getElementById('grid-light-fg-green');
      const gridDGreen = document.getElementById('grid-dark-fg-green');
      function addRowGreen(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLGreen.appendChild(nameL);
        gridLGreen.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDGreen.appendChild(nameD);
        gridDGreen.appendChild(cell(token,'dark'));
      }
      GREEN_FG.forEach(addRowGreen);

      // TEAL FOREGROUNDS
      const TEAL_FG = [
        '--ubits-fg-teal-subtle',
        '--ubits-fg-teal-subtle-inverted',
        '--ubits-fg-teal-subtle-hover',
        '--ubits-fg-teal-subtle-inverted-hover',
        '--ubits-fg-teal-subtle-static',
        '--ubits-fg-teal-subtle-static-inverted',
        '--ubits-fg-teal-subtle-static-hover',
        '--ubits-fg-teal-subtle-static-inverted-hover'
      ];
      const gridLTeal = document.getElementById('grid-light-fg-teal');
      const gridDTeal = document.getElementById('grid-dark-fg-teal');
      function addRowTeal(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLTeal.appendChild(nameL);
        gridLTeal.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDTeal.appendChild(nameD);
        gridDTeal.appendChild(cell(token,'dark'));
      }
      TEAL_FG.forEach(addRowTeal);

      // PURPLE FOREGROUNDS
      const PURPLE_FG = [
        '--ubits-fg-purple-subtle',
        '--ubits-fg-purple-subtle-inverted',
        '--ubits-fg-purple-subtle-hover',
        '--ubits-fg-purple-subtle-inverted-hover',
        '--ubits-fg-purple-subtle-static',
        '--ubits-fg-purple-subtle-static-inverted',
        '--ubits-fg-purple-subtle-static-hover',
        '--ubits-fg-purple-subtle-static-inverted-hover'
      ];
      const gridLPurple = document.getElementById('grid-light-fg-purple');
      const gridDPurple = document.getElementById('grid-dark-fg-purple');
      function addRowPurple(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLPurple.appendChild(nameL);
        gridLPurple.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDPurple.appendChild(nameD);
        gridDPurple.appendChild(cell(token,'dark'));
      }
      PURPLE_FG.forEach(addRowPurple);

      // PINK FOREGROUNDS
      const PINK_FG = [
        '--ubits-fg-pink-subtle',
        '--ubits-fg-pink-subtle-inverted',
        '--ubits-fg-pink-subtle-hover',
        '--ubits-fg-pink-subtle-inverted-hover',
        '--ubits-fg-pink-subtle-static',
        '--ubits-fg-pink-subtle-static-inverted',
        '--ubits-fg-pink-subtle-static-hover',
        '--ubits-fg-pink-subtle-static-inverted-hover'
      ];
      const gridLPink = document.getElementById('grid-light-fg-pink');
      const gridDPink = document.getElementById('grid-dark-fg-pink');
      function addRowPink(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLPink.appendChild(nameL);
        gridLPink.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDPink.appendChild(nameD);
        gridDPink.appendChild(cell(token,'dark'));
      }
      PINK_FG.forEach(addRowPink);

      // ROSE FOREGROUNDS
      const ROSE_FG = [
        '--ubits-fg-rose-subtle',
        '--ubits-fg-rose-subtle-inverted',
        '--ubits-fg-rose-subtle-hover',
        '--ubits-fg-rose-subtle-inverted-hover',
        '--ubits-fg-rose-subtle-static',
        '--ubits-fg-rose-subtle-static-inverted',
        '--ubits-fg-rose-subtle-static-hover',
        '--ubits-fg-rose-subtle-static-inverted-hover'
      ];
      const gridLRose = document.getElementById('grid-light-fg-rose');
      const gridDRose = document.getElementById('grid-dark-fg-rose');
      function addRowRose(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLRose.appendChild(nameL);
        gridLRose.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDRose.appendChild(nameD);
        gridDRose.appendChild(cell(token,'dark'));
      }
      ROSE_FG.forEach(addRowRose);

      // BACKGROUND COLORS
      const BG = [
        '--ubits-bg-active','--ubits-bg-1','--ubits-bg-2','--ubits-bg-3','--ubits-bg-4','--ubits-bg-5','--ubits-bg-dim','--ubits-bg-disabled'
      ];
      const gridLBG = document.getElementById('grid-light-bg');
      const gridDBG = document.getElementById('grid-dark-bg');
      function addRowBg(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBG.appendChild(nameL);
        gridLBG.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBG.appendChild(nameD);
        gridDBG.appendChild(cell(token,'dark'));
      }
      BG.forEach(addRowBg);

      // BORDER COLORS - MAIN
      const BORDERS_MAIN = [
        '--ubits-border-1','--ubits-border-2','--ubits-border-disabled'
      ];
      const gridLBM = document.getElementById('grid-light-border-main');
      const gridDBM = document.getElementById('grid-dark-border-main');
      function addRowBM(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBM.appendChild(nameL);
        gridLBM.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBM.appendChild(nameD);
        gridDBM.appendChild(cell(token,'dark'));
      }
      BORDERS_MAIN.forEach(addRowBM);

      // BORDER COLORS - COLORED
      const BORDERS_COLORED = [
        '--ubits-border-blue','--ubits-border-gray','--ubits-border-green','--ubits-border-teal','--ubits-border-indigo','--ubits-border-purple','--ubits-border-pink','--ubits-border-yellow','--ubits-border-rose'
      ];
      const gridLBC = document.getElementById('grid-light-border-colored');
      const gridDBC = document.getElementById('grid-dark-border-colored');
      function addRowBC(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBC.appendChild(nameL);
        gridLBC.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBC.appendChild(nameD);
        gridDBC.appendChild(cell(token,'dark'));
      }
      BORDERS_COLORED.forEach(addRowBC);

      // BORDER COLORS - INVERTED
      const BORDERS_INVERTED = [
        '--ubits-border-1-inverted','--ubits-border-2-inverted','--ubits-border-disabled-inverted',
        '--ubits-border-blue-inverted','--ubits-border-gray-inverted','--ubits-border-green-inverted','--ubits-border-teal-inverted','--ubits-border-indigo-inverted','--ubits-border-purple-inverted','--ubits-border-pink-inverted','--ubits-border-yellow-inverted','--ubits-border-rose-inverted'
      ];
      const gridLBI = document.getElementById('grid-light-border-inverted');
      const gridDBI = document.getElementById('grid-dark-border-inverted');
      function addRowBI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBI.appendChild(nameL);
        gridLBI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBI.appendChild(nameD);
        gridDBI.appendChild(cell(token,'dark'));
      }
      BORDERS_INVERTED.forEach(addRowBI);

      // BORDER COLORS - STATIC
      const BORDERS_STATIC = [
        '--ubits-border-1-static','--ubits-border-2-static','--ubits-border-disabled-static',
        '--ubits-border-blue-static','--ubits-border-gray-static','--ubits-border-green-static','--ubits-border-teal-static','--ubits-border-indigo-static','--ubits-border-purple-static','--ubits-border-pink-static','--ubits-border-yellow-static','--ubits-border-rose-static'
      ];
      const gridLBS = document.getElementById('grid-light-border-static');
      const gridDBS = document.getElementById('grid-dark-border-static');
      function addRowBS(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBS.appendChild(nameL);
        gridLBS.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBS.appendChild(nameD);
        gridDBS.appendChild(cell(token,'dark'));
      }
      BORDERS_STATIC.forEach(addRowBS);

      // BORDER COLORS - STATIC INVERTED
      const BORDERS_STATIC_INV = [
        '--ubits-border-1-static-inverted','--ubits-border-2-static-inverted','--ubits-border-disabled-static-inverted',
        '--ubits-border-blue-static-inverted','--ubits-border-gray-static-inverted','--ubits-border-green-static-inverted','--ubits-border-teal-static-inverted','--ubits-border-indigo-static-inverted','--ubits-border-purple-static-inverted','--ubits-border-pink-static-inverted','--ubits-border-yellow-static-inverted','--ubits-border-rose-static-inverted'
      ];
      const gridLBSI = document.getElementById('grid-light-border-static-inv');
      const gridDBSI = document.getElementById('grid-dark-border-static-inv');
      function addRowBSI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBSI.appendChild(nameL);
        gridLBSI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBSI.appendChild(nameD);
        gridDBSI.appendChild(cell(token,'dark'));
      }
      BORDERS_STATIC_INV.forEach(addRowBSI);

      // SIDEBAR COLORS
      const SIDEBAR = [
        '--ubits-sidebar-bg','--ubits-sidebar-logo','--ubits-sidebar-button-bg-pressed','--ubits-sidebar-button-bg-disabled','--ubits-sidebar-button-bg-active','--ubits-sidebar-button-fg-default','--ubits-sidebar-button-fg-hover','--ubits-sidebar-button-fg-pressed','--ubits-sidebar-button-fg-active','--ubits-sidebar-button-fg-disabled'
      ];
      const gridLSide = document.getElementById('grid-light-sidebar');
      const gridDSide = document.getElementById('grid-dark-sidebar');
      function addRowSide(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLSide.appendChild(nameL);
        gridLSide.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDSide.appendChild(nameD);
        gridDSide.appendChild(cell(token,'dark'));
      }
      SIDEBAR.forEach(addRowSide);

      // FEEDBACK SUCCESS
      const FEEDBACK_SUCCESS = [
        '--ubits-feedback-bg-success-subtle',
        '--ubits-feedback-fg-success-subtle',
        '--ubits-feedback-accent-success',
        '--ubits-feedback-accent-success-inverted',
        '--ubits-feedback-accent-success-static',
        '--ubits-feedback-accent-success-static-inverted',
        '--ubits-feedback-fg-success-subtle-alt',
        '--ubits-feedback-fg-success-subtle-inverted',
        '--ubits-feedback-fg-success-subtle-hover',
        '--ubits-feedback-fg-success-subtle-inverted-hover',
        '--ubits-feedback-fg-success-subtle-static',
        '--ubits-feedback-fg-success-subtle-static-inverted',
        '--ubits-feedback-fg-success-subtle-static-hover',
        '--ubits-feedback-fg-success-subtle-static-inverted-hover'
      ];
      const gridLFS = document.getElementById('grid-light-feedback-success');
      const gridDFS = document.getElementById('grid-dark-feedback-success');
      function addRowFS(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFS.appendChild(nameL);
        gridLFS.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFS.appendChild(nameD);
        gridDFS.appendChild(cell(token,'dark'));
      }
      FEEDBACK_SUCCESS.forEach(addRowFS);

      // FEEDBACK INFO
      const FEEDBACK_INFO = [
        '--ubits-feedback-bg-info-subtle',
        '--ubits-feedback-fg-info-subtle',
        '--ubits-feedback-accent-info',
        '--ubits-feedback-accent-info-inverted',
        '--ubits-feedback-accent-info-static',
        '--ubits-feedback-accent-info-static-inverted',
        '--ubits-feedback-fg-info-subtle-alt',
        '--ubits-feedback-fg-info-subtle-inverted',
        '--ubits-feedback-fg-info-subtle-hover',
        '--ubits-feedback-fg-info-subtle-inverted-hover',
        '--ubits-feedback-fg-info-subtle-static',
        '--ubits-feedback-fg-info-subtle-static-inverted',
        '--ubits-feedback-fg-info-subtle-static-hover',
        '--ubits-feedback-fg-info-subtle-static-inverted-hover'
      ];
      const gridLFI = document.getElementById('grid-light-feedback-info');
      const gridDFI = document.getElementById('grid-dark-feedback-info');
      function addRowFI(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFI.appendChild(nameL);
        gridLFI.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFI.appendChild(nameD);
        gridDFI.appendChild(cell(token,'dark'));
      }
      FEEDBACK_INFO.forEach(addRowFI);

      // FEEDBACK WARNING
      const FEEDBACK_WARNING = [
        '--ubits-feedback-bg-warning-subtle',
        '--ubits-feedback-fg-warning-subtle',
        '--ubits-feedback-accent-warning',
        '--ubits-feedback-accent-warning-inverted',
        '--ubits-feedback-fg-warning-subtle-alt',
        '--ubits-feedback-fg-warning-subtle-inverted',
        '--ubits-feedback-fg-warning-subtle-hover',
        '--ubits-feedback-fg-warning-subtle-inverted-hover',
        '--ubits-feedback-fg-warning-bold',
        '--ubits-feedback-fg-warning-bold-inverted',
        '--ubits-feedback-fg-warning-bold-hover',
        '--ubits-feedback-fg-warning-bold-inverted-hover',
        '--ubits-feedback-fg-warning-subtle-static',
        '--ubits-feedback-fg-warning-subtle-static-inverted',
        '--ubits-feedback-fg-warning-subtle-static-hover',
        '--ubits-feedback-fg-warning-subtle-static-inverted-hover'
      ];
      const gridLFW = document.getElementById('grid-light-feedback-warning');
      const gridDFW = document.getElementById('grid-dark-feedback-warning');
      function addRowFW(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFW.appendChild(nameL);
        gridLFW.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFW.appendChild(nameD);
        gridDFW.appendChild(cell(token,'dark'));
      }
      FEEDBACK_WARNING.forEach(addRowFW);

      // FEEDBACK ERROR
      const FEEDBACK_ERROR = [
        '--ubits-feedback-bg-error-subtle',
        '--ubits-feedback-fg-error-subtle',
        '--ubits-feedback-accent-error',
        '--ubits-feedback-accent-error-inverted',
        '--ubits-feedback-accent-error-static',
        '--ubits-feedback-accent-error-static-inverted',
        '--ubits-feedback-fg-error-subtle-alt',
        '--ubits-feedback-fg-error-subtle-inverted',
        '--ubits-feedback-fg-error-subtle-hover',
        '--ubits-feedback-fg-error-subtle-inverted-hover',
        '--ubits-feedback-fg-error-subtle-static',
        '--ubits-feedback-fg-error-subtle-static-inverted',
        '--ubits-feedback-fg-error-subtle-static-hover',
        '--ubits-feedback-fg-error-subtle-static-inverted-hover'
      ];
      const gridLFE = document.getElementById('grid-light-feedback-error');
      const gridDFE = document.getElementById('grid-dark-feedback-error');
      function addRowFE(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFE.appendChild(nameL);
        gridLFE.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFE.appendChild(nameD);
        gridDFE.appendChild(cell(token,'dark'));
      }
      FEEDBACK_ERROR.forEach(addRowFE);

      // FEEDBACK BORDERS
      const FEEDBACK_BORDERS = [
        '--ubits-feedback-border-success','--ubits-feedback-border-info','--ubits-feedback-border-warning','--ubits-feedback-border-error',
        '--ubits-feedback-border-success-inverted','--ubits-feedback-border-info-inverted','--ubits-feedback-border-warning-inverted','--ubits-feedback-border-error-inverted',
        '--ubits-feedback-border-success-static','--ubits-feedback-border-info-static','--ubits-feedback-border-warning-static','--ubits-feedback-border-error-static',
        '--ubits-feedback-border-success-static-inverted','--ubits-feedback-border-info-static-inverted','--ubits-feedback-border-warning-static-inverted','--ubits-feedback-border-error-static-inverted'
      ];
      const gridLFB = document.getElementById('grid-light-feedback-borders');
      const gridDFB = document.getElementById('grid-dark-feedback-borders');
      function addRowFB(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLFB.appendChild(nameL);
        gridLFB.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDFB.appendChild(nameD);
        gridDFB.appendChild(cell(token,'dark'));
      }
      FEEDBACK_BORDERS.forEach(addRowFB);

      // CHART COLORS
      const CHART = [
        '--ubits-chart-bg-level-1'
      ];
      const gridLChart = document.getElementById('grid-light-chart');
      const gridDChart = document.getElementById('grid-dark-chart');
      function addRowChart(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLChart.appendChild(nameL);
        gridLChart.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDChart.appendChild(nameD);
        gridDChart.appendChild(cell(token,'dark'));
      }
      CHART.forEach(addRowChart);

      // TOAST COLORS
      const TOAST = [
        '--ubits-toast-feedback-bg'
      ];
      const gridLToast = document.getElementById('grid-light-toast');
      const gridDToast = document.getElementById('grid-dark-toast');
      function addRowToast(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLToast.appendChild(nameL);
        gridLToast.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDToast.appendChild(nameD);
        gridDToast.appendChild(cell(token,'dark'));
      }
      TOAST.forEach(addRowToast);

      // BOTTOM NAV COLORS
      const BOTTOM_NAV = [
        '--ubits-bottom-nav-shadow-opacity'
      ];
      const gridLBN = document.getElementById('grid-light-bottom-nav');
      const gridDBN = document.getElementById('grid-dark-bottom-nav');
      function addRowBN(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLBN.appendChild(nameL);
        gridLBN.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDBN.appendChild(nameD);
        gridDBN.appendChild(cell(token,'dark'));
      }
      BOTTOM_NAV.forEach(addRowBN);

      // YELLOW FOREGROUNDS
      const YELLOW_FG = [
        '--ubits-fg-yellow-subtle','--ubits-fg-yellow-subtle-inverted','--ubits-fg-yellow-subtle-hover','--ubits-fg-yellow-subtle-inverted-hover',
        '--ubits-fg-yellow-bold','--ubits-fg-yellow-bold-inverted','--ubits-fg-yellow-bold-hover','--ubits-fg-yellow-bold-inverted-hover',
        '--ubits-fg-yellow-subtle-static','--ubits-fg-yellow-subtle-static-inverted','--ubits-fg-yellow-bold-static','--ubits-fg-yellow-bold-static-inverted',
        '--ubits-fg-yellow-subtle-static-hover','--ubits-fg-yellow-subtle-static-inverted-hover','--ubits-fg-yellow-bold-static-hover','--ubits-fg-yellow-bold-static-inverted-hover'
      ];
      const gridLYellow = document.getElementById('grid-light-fg-yellow');
      const gridDYellow = document.getElementById('grid-dark-fg-yellow');
      function addRowYellow(token){
        const nameL = document.createElement('div'); nameL.className='token-name'; nameL.textContent = token; gridLYellow.appendChild(nameL);
        gridLYellow.appendChild(cell(token,'light'));
        const nameD = document.createElement('div'); nameD.className='token-name'; nameD.textContent = token; gridDYellow.appendChild(nameD);
        gridDYellow.appendChild(cell(token,'dark'));
      }
      YELLOW_FG.forEach(addRowYellow);

      // Calcular total de tokens de colores y actualizar contador
      (function updateColorsCount() {
        const totalColors = 
          TOKENS.length +
          BTN.length +
          FG.length +
          BLUE_FG.length +
          GRAY_FG.length +
          GREEN_FG.length +
          TEAL_FG.length +
          PURPLE_FG.length +
          PINK_FG.length +
          ROSE_FG.length +
          BG.length +
          BORDERS_MAIN.length +
          BORDERS_COLORED.length +
          BORDERS_INVERTED.length +
          BORDERS_STATIC.length +
          BORDERS_STATIC_INV.length +
          SIDEBAR.length +
          FEEDBACK_SUCCESS.length +
          FEEDBACK_INFO.length +
          FEEDBACK_WARNING.length +
          FEEDBACK_ERROR.length +
          FEEDBACK_BORDERS.length +
          CHART.length +
          TOAST.length +
          BOTTOM_NAV.length +
          YELLOW_FG.length;
        
        const colorsCategoryTitle = document.getElementById('colors-category-title');
        if (colorsCategoryTitle) {
          const countSpan = colorsCategoryTitle.querySelector('span:last-child');
          if (countSpan) {
            countSpan.textContent = `${totalColors} ${totalColors === 1 ? 'color' : 'colores'}`;
          }
        }
      })();

      // Calcular total de tokens de espaciado y actualizar contador
      (function updateSpacingCount() {
        const spacingSection = document.getElementById('section-espaciado');
        if (spacingSection) {
          const spacingTokens = spacingSection.querySelectorAll('[data-token*="spacing"]');
          const totalSpacing = spacingTokens.length;
          
          const spacingCategoryTitle = document.getElementById('spacing-category-title');
          if (spacingCategoryTitle) {
            const countSpan = spacingCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = `${totalSpacing} ${totalSpacing === 1 ? 'elemento' : 'elementos'}`;
            }
          }
        }
      })();

      // Calcular total de elementos de effects y actualizar contador
      (function updateEffectsCount() {
        const effectsSection = document.getElementById('section-effects');
        if (effectsSection) {
          // Effects tiene 2 categorÃ­as: Focus y Elevation (con 4 variantes: default, hover, overlay, floating)
          const totalEffects = 2; // Focus + Elevation
          
          const effectsCategoryTitle = document.getElementById('effects-category-title');
          if (effectsCategoryTitle) {
            const countSpan = effectsCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = `${totalEffects} ${totalEffects === 1 ? 'elemento' : 'elementos'}`;
            }
          }
        }
      })();

      // Calcular total de elementos de grid y actualizar contador
      (function updateGridCount() {
        const gridSection = document.getElementById('section-grid-breakpoints');
        if (gridSection) {
          // Grid tiene 2 categorÃ­as: Breakpoints (4 breakpoints) y Sistema de Grid (documentaciÃ³n)
          const totalGrid = 2; // Breakpoints + Sistema de Grid
          
          const gridCategoryTitle = document.getElementById('grid-category-title');
          if (gridCategoryTitle) {
            const countSpan = gridCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = `${totalGrid} ${totalGrid === 1 ? 'elemento' : 'elementos'}`;
            }
          }
        }
      })();

      // restaurar estado por defecto de cÃ¡lculo si fuese necesario
      html.setAttribute('data-theme','dark');
      // Mostrar Template por defecto si no hay hash, o respetar el hash si existe
      (function ensureDefaultSection(){
        const hash = location.hash ? location.hash.replace('#', '') : '';
        const texto = document.getElementById('section-texto');
        const colores = document.getElementById('section-colores');
        const template = document.getElementById('section-template');
        
        if(texto && colores && template){
          if (hash) {
            // Si hay hash, usar syncFromHash para activar la secciÃ³n correcta
            syncFromHash();
            console.log('[startup] hash detected ->', hash);
          } else {
            // Si no hay hash, mostrar Template por defecto y establecer hash
            texto.style.display = 'none';
            colores.style.display = 'none';
            template.style.display = 'block';
            template.classList.add('active');
            iconos.style.display = 'none';
            componentes.style.display = 'none';
            // Actualizar menÃº
            document.querySelectorAll('#navbar2 .nav2-link').forEach(l=> l.classList.remove('active2'));
            const link = document.querySelector(`#navbar2 .nav2-link[data-target="section-template"]`);
            if (link) link.classList.add('active2');
            // Establecer hash por defecto para mantener la secciÃ³n al recargar
            history.replaceState(null, '', '#template');
            console.log('[startup] no hash -> default section-template');
          }
        } else {
          console.warn('[startup] sections missing', !!texto, !!colores, !!template, !!iconos, !!componentes);
        }
      })();

      // ========================================
      // SISTEMA DE ICONOS COMPLETO - POR CATEGORÃAS
      // ========================================
      // Sistema de iconos eliminado - Autoframe ya no maneja iconos
      (function initIconsSystem() {
        // CÃ³digo deshabilitado - secciÃ³n eliminada
        return;
        /*
        let allIcons = [];
        let filteredIcons = [];
        const iconsContainer = document.getElementById('icons-container');
        const iconsSearchInput = document.getElementById('icons-search-input');
        const iconsClearSearch = document.getElementById('icons-clear-search');
        const iconsCategoryTitle = document.getElementById('icons-category-title');
        const iconsEmptyState = document.getElementById('icons-empty-state');
        const iconsCategoryNav = document.getElementById('icons-category-nav');

        // Validar que los elementos existan
        if (!iconsContainer || !iconsCategoryTitle || !iconsCategoryNav) {
          console.error('âŒ Elementos DOM faltantes para sistema de iconos');
          return;
        }

        // Sistema de categorÃ­as basado en palabras clave - EXPANDIDO
        const iconCategories = {
          'Interfaz': {
            keywords: ['menu', 'bars', 'hamburger', 'nav', 'sidebar', 'list', 'grid', 'layout', 'view', 'display', 'show', 'hide', 'eye', 'eye-slash', 'toggle', 'switch', 'window', 'maximize', 'minimize', 'restore', 'mobile', 'desktop', 'tablet', 'screen', 'panel', 'dashboard'],
            label: 'Interfaz'
          },
          'Acciones': {
            keywords: ['add', 'plus', 'create', 'new', 'save', 'delete', 'trash', 'remove', 'edit', 'update', 'modify', 'change', 'copy', 'cut', 'paste', 'duplicate', 'clone', 'undo', 'redo', 'refresh', 'reload', 'recycle', 'repeat', 'rotate', 'shuffle', 'sort', 'swap'],
            label: 'Acciones'
          },
          'ComunicaciÃ³n': {
            keywords: ['message', 'chat', 'comment', 'reply', 'mail', 'email', 'envelope', 'send', 'receive', 'notification', 'bell', 'alert', 'inbox', 'outbox', 'phone', 'call', 'microphone', 'headset', 'headphone', 'speaker', 'bullhorn', 'announcement', 'megaphone', 'voicemail', 'video', 'camera', 'facetime'],
            label: 'ComunicaciÃ³n'
          },
          'NavegaciÃ³n': {
            keywords: ['arrow', 'chevron', 'caret', 'direction', 'up', 'down', 'left', 'right', 'back', 'forward', 'next', 'previous', 'first', 'last', 'step', 'move', 'navigate', 'route', 'path', 'direction', 'turn', 'angle'],
            label: 'NavegaciÃ³n'
          },
          'Usuario': {
            keywords: ['user', 'person', 'people', 'account', 'profile', 'avatar', 'login', 'logout', 'sign', 'member', 'team', 'group', 'crowd', 'users', 'human', 'personnel', 'staff', 'employee', 'customer', 'client'],
            label: 'Usuario'
          },
          'Archivos': {
            keywords: ['file', 'folder', 'document', 'paper', 'archive', 'directory', 'download', 'upload', 'export', 'import', 'attachment', 'clipboard', 'documentation', 'spreadsheet', 'presentation', 'pdf', 'excel', 'word', 'zip', 'rar', 'code', 'script'],
            label: 'Archivos'
          },
          'BÃºsqueda': {
            keywords: ['search', 'find', 'filter', 'magnify', 'lookup', 'query', 'scan', 'discover', 'explore', 'investigate', 'hunt'],
            label: 'BÃºsqueda'
          },
          'EdiciÃ³n': {
            keywords: ['edit', 'pencil', 'pen', 'write', 'draw', 'paint', 'brush', 'eraser', 'highlight', 'marker', 'ink', 'sketch', 'draft', 'note', 'annotate'],
            label: 'EdiciÃ³n'
          },
          'ValidaciÃ³n': {
            keywords: ['check', 'ok', 'success', 'done', 'complete', 'verify', 'confirm', 'approve', 'accept', 'times', 'close', 'cancel', 'error', 'warning', 'exclamation', 'circle', 'badge', 'certificate', 'validation', 'approved', 'rejected', 'denied', 'blocked'],
            label: 'ValidaciÃ³n'
          },
          'ConfiguraciÃ³n': {
            keywords: ['settings', 'config', 'gear', 'cog', 'preferences', 'option', 'setup', 'admin', 'control', 'manage', 'wrench', 'tools', 'screwdriver', 'adjust', 'tune', 'calibrate', 'configure'],
            label: 'ConfiguraciÃ³n'
          },
          'GrÃ¡ficos y Diagramas': {
            keywords: ['chart', 'graph', 'diagram', 'analytics', 'statistics', 'data', 'metric', 'bar', 'line', 'pie', 'area', 'column', 'trend', 'gantt', 'tree', 'flow', 'sitemap', 'network', 'node', 'connection', 'map', 'visualization', 'dashboard', 'report', 'insight'],
            label: 'GrÃ¡ficos y Diagramas'
          },
          'MÃºsica y Media': {
            keywords: ['music', 'audio', 'video', 'play', 'pause', 'stop', 'record', 'volume', 'sound', 'film', 'movie', 'camera', 'photo', 'image', 'picture', 'media', 'multimedia', 'album', 'cd', 'vinyl', 'radio', 'podcast', 'stream', 'broadcast'],
            label: 'MÃºsica y Media'
          },
          'Negocio': {
            keywords: ['business', 'money', 'dollar', 'euro', 'currency', 'payment', 'credit', 'card', 'wallet', 'shopping', 'cart', 'store', 'shop', 'market', 'sales', 'revenue', 'profit', 'loss', 'invoice', 'bill', 'receipt', 'transaction', 'bank', 'finance', 'investment', 'stock', 'trade'],
            label: 'Negocio'
          },
          'EducaciÃ³n': {
            keywords: ['education', 'learning', 'course', 'training', 'graduate', 'diploma', 'degree', 'certificate', 'school', 'university', 'college', 'student', 'teacher', 'book', 'textbook', 'notebook', 'study', 'exam', 'test', 'quiz', 'assignment', 'homework', 'lesson', 'class', 'lecture'],
            label: 'EducaciÃ³n'
          },
          'Transporte': {
            keywords: ['car', 'truck', 'bus', 'plane', 'train', 'bike', 'ship', 'transport', 'delivery', 'shipping', 'vehicle', 'automobile', 'motorcycle', 'scooter', 'taxi', 'van', 'trailer', 'cargo', 'freight', 'logistics'],
            label: 'Transporte'
          },
          'Tiempo': {
            keywords: ['time', 'clock', 'watch', 'calendar', 'date', 'schedule', 'deadline', 'timer', 'alarm', 'hourglass', 'stopwatch', 'chronometer', 'calendar', 'event', 'appointment', 'meeting', 'reminder', 'notification', 'past', 'future', 'history', 'timeline'],
            label: 'Tiempo'
          },
          'UbicaciÃ³n': {
            keywords: ['location', 'map', 'pin', 'marker', 'address', 'place', 'position', 'gps', 'navigation', 'route', 'destination', 'origin', 'compass', 'direction', 'latitude', 'longitude', 'coordinates', 'geography', 'country', 'city', 'landmark'],
            label: 'UbicaciÃ³n'
          },
          'Seguridad': {
            keywords: ['lock', 'unlock', 'key', 'shield', 'secure', 'privacy', 'protect', 'safe', 'guard', 'security', 'encryption', 'password', 'access', 'permission', 'authorization', 'firewall', 'vault', 'safety', 'protection', 'defense'],
            label: 'Seguridad'
          },
          'Internet': {
            keywords: ['network', 'wifi', 'connection', 'link', 'chain', 'url', 'web', 'internet', 'browser', 'globe', 'world', 'cloud', 'server', 'database', 'api', 'connectivity', 'signal', 'online', 'offline', 'sync', 'share', 'upload', 'download', 'stream'],
            label: 'Internet'
          },
          'DiseÃ±o': {
            keywords: ['design', 'paint', 'brush', 'palette', 'color', 'swatch', 'art', 'creative', 'sketch', 'drawing', 'illustration', 'graphic', 'visual', 'style', 'theme', 'template', 'layout', 'typography', 'font', 'text', 'heading', 'paragraph'],
            label: 'DiseÃ±o'
          },
          'Utilidades': {
            keywords: ['tool', 'utility', 'helper', 'assistant', 'robot', 'automation', 'puzzle', 'piece', 'keyboard', 'mouse', 'device', 'gadget', 'machine', 'equipment', 'instrument', 'accessibility', 'universal', 'support', 'help', 'question', 'info'],
            label: 'Utilidades'
          },
          'Otros': {
            keywords: [],
            label: 'Otros'
          }
        };

        // Cargar catÃ¡logo de iconos
        async function loadIconsCatalog() {
          if (!iconsContainer || !iconsCategoryTitle) {
            console.error('Elementos del DOM no encontrados');
            return;
          }

          try {
            // Actualizar contador en el tÃ­tulo
            const countSpan = iconsCategoryTitle?.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = 'Cargando...';
            }
            const response = await fetch('icons-catalog.json');
            
            if (!response.ok) {
              throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            console.log('ğŸ“¦ Datos recibidos:', Object.keys(data), 'regular:', data.regular?.length, 'solid:', data.solid?.length);
            
            // Combinar regular y solid, eliminar duplicados
            const iconMap = new Map();
            [...(data.regular || []), ...(data.solid || [])].forEach(icon => {
              if (icon && icon.name && icon.className) {
                // Filtrar iconos numÃ©ricos y otros que no sean Ãºtiles
                const name = icon.name;
                // Ignorar iconos que son solo nÃºmeros o muy cortos
                if (!/^\d+$/.test(name) && name.length > 1) {
                  if (!iconMap.has(icon.name)) {
                    iconMap.set(icon.name, icon);
                  }
                }
              }
            });
            
            allIcons = Array.from(iconMap.values());
            filteredIcons = [...allIcons];
            
            // Ordenar alfabÃ©ticamente
            allIcons.sort((a, b) => a.name.localeCompare(b.name));
            filteredIcons.sort((a, b) => a.name.localeCompare(b.name));
            
            console.log(`âœ… Cargados ${allIcons.length} iconos`);
            
            if (allIcons.length === 0) {
              throw new Error('CatÃ¡logo vacÃ­o o sin iconos vÃ¡lidos');
            }
            
            renderIcons();
            generateCategoryNav();
            updateCount();
          } catch (error) {
            console.error('âŒ Error cargando catÃ¡logo de iconos:', error);
            console.log('Intentando cargar muestra de iconos directamente...');
            
            // Fallback: Cargar muestra de iconos directamente desde el CSS parseado
            loadSampleIcons();
          }
        }

        // Fallback: Cargar TODOS los 237 iconos del autoframe anterior
        function loadSampleIcons() {
          // Lista completa de los 237 iconos del autoframe anterior
          const sampleIcons = [
            'award', 'album-collection', 'badge-check', 'arrow-down', 'arrow-down-arrow-up', 'arrow-down-to-line',
            'arrow-left', 'arrow-left-to-line', 'arrow-right', 'arrow-right-to-line', 'arrow-trend-down', 'arrow-trend-up',
            'arrow-up', 'arrow-up-from-bracket', 'arrow-up-right-from-square', 'arrows-left-right', 'arrows-left-right-to-line',
            'arrows-rotate', 'chevron-down', 'chevron-left', 'chevron-right', 'chevron-up', 'chevrons-left', 'chevrons-right',
            'alarm-clock', 'analytics', 'angle-down', 'angle-left', 'angle-right', 'angle-up', 'bars', 'bars-progress',
            'bed', 'bell', 'bell-on', 'bell-slash', 'birthday-cake', 'bolt', 'book', 'bookmark', 'book-open', 'books',
            'brain', 'briefcase', 'brush', 'bug', 'building', 'building-columns', 'bullseye', 'bullseye-arrow',
            'bullseye-pointer', 'bus', 'calendar', 'calendar-check', 'calendar-arrow-down', 'calendar-days', 'caret-down',
            'caret-left', 'caret-right', 'caret-up', 'camera', 'car', 'cube', 'chart-line', 'chart-mixed', 'chart-pie',
            'chart-tree-map', 'chart-column', 'check', 'check-circle', 'circle-down', 'circle-chevron-down',
            'circle-chevron-left', 'circle-chevron-right', 'circle-chevron-up', 'circle-dot', 'clock', 'clock-rotate-left',
            'clone', 'closed-captioning', 'cloud', 'cloud-arrow-down', 'coin-vertical', 'cog', 'cogs', 'comment',
            'comment-lines', 'comments', 'copy', 'clipboard', 'clipboard-list-check', 'credit-card', 'database', 'desktop',
            'diploma', 'display-arrow-down', 'download', 'down-to-line', 'edit', 'ellipsis-vertical', 'envelope',
            'envelope-open-dollar', 'envelope-open-text', 'exclamation-triangle', 'eye', 'eye-dropper-full', 'eye-slash',
            'file', 'file-alt', 'file-arrow-down', 'file-arrow-up', 'file-audio', 'file-certificate', 'file-check',
            'file-circle-check', 'file-excel', 'file-exclamation', 'file-export', 'file-lock', 'file-magnifying-glass',
            'file-minus', 'file-music', 'file-plus', 'file-video', 'file-word', 'file-zipper', 'file-chart-column',
            'file-chart-pie', 'file-invoice-dollar', 'file-signature', 'file-waveform', 'film', 'filter', 'filter-circle-xmark',
            'filter-list', 'filter-slash', 'filters', 'fire', 'face-frown-slight', 'face-laugh-beam', 'face-meh', 'face-tired',
            'flag', 'flag-pennant', 'floppy-disk', 'folder', 'folder-arrow-down', 'folder-open', 'globe', 'gauge',
            'gauge-max', 'gauge-min', 'graduation-cap', 'grid-2', 'hand', 'hand-holding-heart', 'hand-point-up', 'handshake',
            'headphones', 'heading', 'heart', 'home', 'image', 'icons', 'info-circle', 'key', 'layer-group', 'lightbulb',
            'link', 'link-slash', 'list', 'location-dot', 'lock', 'map', 'map-location-dot', 'microphone', 'message-lines',
            'mobile', 'money-bill', 'moon', 'moon-stars', 'music', 'paint-brush', 'paint-roller', 'palette', 'paper-plane',
            'paperclip', 'paragraph', 'pause', 'pen-to-square', 'play', 'play-circle', 'plus', 'power-off', 'print',
            'question', 'question-circle', 'refresh', 'repeat', 'rotate-right', 'route', 'rocket', 'search', 'share',
            'sitemap', 'skull-crossbones', 'sliders', 'sliders-simple', 'sliders-up', 'slider', 'sparkles', 'store',
            'shield', 'shield-check', 'star', 'stop', 'sun', 'sun-bright', 'subtitles', 'tablet', 'tag', 'text-size',
            'text-slash', 'th-large', 'thumbs-up', 'thumbs-down', 'times', 'trash', 'trophy', 'upload', 'user', 'users',
            'video', 'volume-up', 'wifi', 'wand-magic-sparkles', 'wrench'
          ];

          allIcons = sampleIcons.map(name => ({
            name: name,
            className: `fa-${name}`,
            keywords: [name],
            styles: ['regular', 'solid']
          }));

          filteredIcons = [...allIcons];
          allIcons.sort((a, b) => a.name.localeCompare(b.name));
          filteredIcons.sort((a, b) => a.name.localeCompare(b.name));

          console.log(`âœ… Cargados ${allIcons.length} iconos del autoframe anterior`);

          // Actualizar contador en el tÃ­tulo
          if (iconsCategoryTitle) {
            const countSpan = iconsCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = `${allIcons.length} ${allIcons.length === 1 ? 'icono' : 'iconos'} (del autoframe anterior - usa servidor HTTP para catÃ¡logo completo)`;
            }
          }

          renderIcons();
          generateCategoryNav();
          updateCount();
        }

        // Asignar icono a categorÃ­a basÃ¡ndose en keywords
        function assignIconToCategory(icon) {
          if (!icon || !icon.name) return 'Otros';
          
          const iconName = icon.name.toLowerCase();
          const iconKeywords = (icon.keywords || []).map(kw => kw.toLowerCase());
          
          // Buscar en cada categorÃ­a
          for (const [categoryKey, category] of Object.entries(iconCategories)) {
            if (categoryKey === 'Otros') continue;
            
            // Verificar si el nombre del icono o keywords coinciden
            const matches = category.keywords.some(keyword => 
              iconName.includes(keyword.toLowerCase()) || 
              iconKeywords.some(kw => kw.includes(keyword.toLowerCase()))
            );
            
            if (matches) {
              return categoryKey;
            }
          }
          
          return 'Otros';
        }

        // Generar navegaciÃ³n por categorÃ­as usando TreeMenu (un solo nivel)
        function generateCategoryNav() {
          if (!iconsCategoryNav || allIcons.length === 0) {
            console.warn('No se puede generar navegaciÃ³n: elementos faltantes o sin iconos');
            return;
          }

          // Asignar categorÃ­as a los iconos
          const iconsByCategory = {};
          Object.keys(iconCategories).forEach(category => {
            iconsByCategory[category] = [];
          });

          filteredIcons.forEach(icon => {
            const category = assignIconToCategory(icon);
            if (!iconsByCategory[category]) {
              iconsByCategory[category] = [];
            }
            iconsByCategory[category].push(icon);
          });

          // Filtrar categorÃ­as vacÃ­as y ordenar
          const categoriesWithIcons = Object.keys(iconsByCategory)
            .filter(category => iconsByCategory[category].length > 0)
            .sort();

          if (categoriesWithIcons.length === 0) {
            iconsCategoryNav.innerHTML = '<div style="padding: 8px 10px; color: var(--ubits-fg-1-medium); font-size: 12px;">Sin iconos</div>';
            return;
          }

          // Convertir a estructura TreeMenu (un solo nivel, sin hijos)
          const treeData = categoriesWithIcons.map(category => ({
            label: `${iconCategories[category].label} (${iconsByCategory[category].length})`,
            id: category,
            dataId: category,
            defaultExpanded: false
          }));

          // Renderizar TreeMenu
          renderTreeMenuFromData('icons-category-nav', treeData, {
            showIcons: false, // Sin iconos
            showChevron: false, // Sin chevron porque es un solo nivel
            size: 'md',
            cascade: true,
            activeNodeId: null,
            onNodeClick: (itemId, content) => {
              console.log('ğŸ”— Click en categorÃ­a:', itemId);
              if (itemId) {
                scrollToCategory(itemId);
              }
            }
          });

          console.log(`âœ… TreeMenu de categorÃ­as generado: ${categoriesWithIcons.length} categorÃ­as`);
        }

        // Renderizar iconos por categorÃ­a
        function renderIcons() {
          if (!iconsContainer) {
            console.error('iconsContainer no encontrado');
            return;
          }

          if (filteredIcons.length === 0) {
            iconsContainer.innerHTML = '';
            if (iconsEmptyState) iconsEmptyState.style.display = 'block';
            return;
          }

          if (iconsEmptyState) iconsEmptyState.style.display = 'none';

          // Agrupar por categorÃ­a
          const iconsByCategory = {};
          Object.keys(iconCategories).forEach(category => {
            iconsByCategory[category] = [];
          });

          filteredIcons.forEach(icon => {
            const category = assignIconToCategory(icon);
            if (!iconsByCategory[category]) {
              iconsByCategory[category] = [];
            }
            iconsByCategory[category].push(icon);
          });

          // Ordenar iconos dentro de cada categorÃ­a
          Object.keys(iconsByCategory).forEach(category => {
            iconsByCategory[category].sort((a, b) => a.name.localeCompare(b.name));
          });

          // Filtrar categorÃ­as vacÃ­as y ordenar
          const categoriesWithIcons = Object.keys(iconsByCategory)
            .filter(category => iconsByCategory[category].length > 0)
            .sort();

          // Renderizar secciones por categorÃ­a
          iconsContainer.innerHTML = categoriesWithIcons.map(category => `
              <div class="kcard" style="margin-bottom: 24px;">
                <h3 id="category-${category}" style="margin-bottom: 16px; color: var(--ubits-fg-1-high); font-size: 18px; font-weight: 600;">
                  ${iconCategories[category].label} <span style="color: var(--ubits-fg-1-medium); font-weight: 400; font-size: 14px;">(${iconsByCategory[category].length})</span>
                </h3>
                <div class="icons-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px;">
                  ${iconsByCategory[category].map(icon => {
                    // Determinar si usar far o fas (por defecto far para outline)
                    const style = icon.styles && icon.styles.includes('regular') ? 'far' : 'fas';
                    const code = `${style} ${icon.className}`;
                    return `
                      <div class="icon-card copyable" data-icon="${icon.name}" data-code="${code}" style="border: none; border-radius: 8px; padding: 16px; text-align: center; cursor: pointer; transition: all 0.2s ease; background: var(--ubits-bg-1);">
                        <div style="font-size: 24px; margin-bottom: 8px; color: var(--ubits-accent-brand-static-inverted);">
                          <i class="${code}"></i>
                        </div>
                        <div style="font-weight: 500; font-size: 12px; color: var(--ubits-fg-1-high); word-break: break-word; line-height: 1.3;">
                          ${icon.name}
                        </div>
                      </div>
                    `;
                  }).join('')}
                </div>
              </div>
            `).join('');
        }

        // Filtrar iconos
        function filterIcons(searchTerm) {
          if (!searchTerm) {
            filteredIcons = [...allIcons];
          } else {
            const term = searchTerm.trim().toLowerCase();
            if (!term) {
              filteredIcons = [...allIcons];
            } else {
              filteredIcons = allIcons.filter(icon => 
                icon && icon.name &&
                (icon.name.toLowerCase().includes(term) ||
                 (icon.className && icon.className.toLowerCase().includes(term)) ||
                 (icon.keywords && icon.keywords.some(kw => kw && kw.toLowerCase().includes(term))))
              );
            }
          }
          filteredIcons.sort((a, b) => a.name.localeCompare(b.name));
          renderIcons();
          updateCount();
        }

        // Actualizar contador en el tÃ­tulo del menÃº lateral
        function updateCount() {
          const total = allIcons.length;
          const showing = filteredIcons.length;
          if (iconsCategoryTitle) {
            const countSpan = iconsCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              if (showing === total) {
                countSpan.textContent = `${total} ${total === 1 ? 'icono' : 'iconos'}`;
              } else {
                countSpan.textContent = `${showing} de ${total} ${total === 1 ? 'icono' : 'iconos'}`;
              }
            }
          }
        }

        // Scroll a categorÃ­a
        function scrollToCategory(category) {
          if (!category) return;
          
          const element = document.getElementById(`category-${category}`);
          if (element) {
            // Scroll con offset para el header sticky
            const offset = 80;
            const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
            const offsetPosition = elementPosition - offset;

            window.scrollTo({
              top: offsetPosition,
              behavior: 'smooth'
            });

            // Actualizar estado activo en TreeMenu
            if (iconsCategoryNav) {
              const treeMenu = iconsCategoryNav.querySelector('.ubits-tree-menu');
              if (treeMenu) {
                // Remover active de todos los nodos
                treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
                  node.classList.remove('ubits-tree-node__content--active');
                  node.removeAttribute('aria-selected');
                });
                
                // Agregar active al nodo correspondiente
                const activeNode = treeMenu.querySelector(`[data-item-id="${category}"]`);
                if (activeNode) {
                  activeNode.classList.add('ubits-tree-node__content--active');
                  activeNode.setAttribute('aria-selected', 'true');
                }
              }
            }
          } else {
            console.warn(`No se encontrÃ³ secciÃ³n para la categorÃ­a: ${category}`);
          }
        }

        // Event listeners
        if (iconsSearchInput) {
          iconsSearchInput.addEventListener('input', (e) => {
            filterIcons(e.target.value);
            iconsClearSearch.style.display = e.target.value ? 'block' : 'none';
          });
        }

        if (iconsClearSearch) {
          iconsClearSearch.addEventListener('click', () => {
            iconsSearchInput.value = '';
            filterIcons('');
            iconsClearSearch.style.display = 'none';
            iconsSearchInput.focus();
          });
        }

        // Inicializar cuando se muestre la secciÃ³n
        const iconosSection = document.getElementById('section-iconos');
        if (iconosSection) {
          // Cargar inmediatamente si ya estÃ¡ visible
          if (iconosSection.style.display !== 'none') {
            console.log('ğŸ”„ SecciÃ³n iconos visible, cargando catÃ¡logo...');
            loadIconsCatalog();
          }

          // Observer para cuando se muestre la secciÃ³n
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const isVisible = iconosSection.style.display !== 'none';
                if (isVisible && allIcons.length === 0) {
                  console.log('ğŸ”„ SecciÃ³n iconos ahora visible, cargando catÃ¡logo...');
                  loadIconsCatalog();
                }
              }
            });
          });
          observer.observe(iconosSection, { attributes: true, attributeFilter: ['style'] });
        } else {
          console.error('âŒ section-iconos no encontrada en el DOM');
        }

        // TambiÃ©n intentar cargar cuando se hace click en el menÃº
        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[data-target="section-iconos"]');
          if (link && allIcons.length === 0) {
            setTimeout(() => {
              console.log('ğŸ”„ Click en iconos detectado, cargando catÃ¡logo...');
              loadIconsCatalog();
            }, 100);
          }
        });
      })();
      */

      // ========================================
      // SISTEMA DE INVENTARIO DE COMPONENTES
      // ========================================
      // Sistema de componentes eliminado - Autoframe ya no maneja componentes
      (function initComponentsInventory() {
        // CÃ³digo deshabilitado - secciÃ³n eliminada
        return;
        /*
        const componentsContainer = document.getElementById('components-container');
        const componentsNav = document.getElementById('components-nav');
        
        if (!componentsContainer) {
          console.error('âŒ components-container no encontrado');
          return;
        }
        
        if (!componentsNav) {
          console.error('âŒ components-nav no encontrado');
          return;
        }

        // Inventario simplificado: Solo Button y Badge
        const componentsInventory = {
          'NavegaciÃ³n': [
            {
              name: 'Sidebar',
              description: 'Componente de navegaciÃ³n lateral con 2 variantes (colaborador y admin). Incluye tooltips, menÃº de perfil, dark mode toggle y ajuste dinÃ¡mico de altura.',
              files: {
                css: 'addons/sidebar/src/styles/sidebar.css',
                ts: 'addons/sidebar/src/SidebarProvider.ts'
              },
              variants: ['colaborador', 'admin'],
              sizes: [],
              states: ['default', 'hover', 'active', 'pressed', 'disabled', 'focus'],
              features: ['2 variantes (colaborador/admin)', '8 botones body (colaborador) / 6 botones body (admin)', 'Tooltips dinÃ¡micos', 'MenÃº de perfil con hover', 'Dark mode toggle con animaciÃ³n', 'Altura dinÃ¡mica', 'Avatar de usuario', '6 estados por botÃ³n', 'Ancho fijo 96px', 'Colores fijos (no cambian con tema)'],
              class: 'ubits-sidebar ubits-sidebar-nav-button ubits-sidebar-nav-button--active',
              example: 'createSidebar({\n  containerId: \'sidebar-container\',\n  variant: \'colaborador\',\n  bodyButtons: [...],\n  footerButtons: [...],\n  profileMenuItems: [...]\n})',
              hasPreview: true
            },
            {
              name: 'SubNav',
              description: 'Componente de navegaciÃ³n superior horizontal con 8 variantes. Muestra sub-navegaciones de los mÃ³dulos principales con tabs y navegaciÃ³n por URL o callbacks.',
              files: {
                css: 'addons/subnav/src/styles/subnav.css',
                ts: 'addons/subnav/src/SubNavProvider.ts'
              },
              variants: ['template', 'aprendizaje', 'desempeÃ±o', 'encuestas', 'tareas', 'empresa', 'admin-aprendizaje', 'admin-desempeno'],
              sizes: [],
              states: ['default', 'hover', 'active'],
              features: ['8 variantes predefinidas', 'Tabs personalizables', 'NavegaciÃ³n por URL o callbacks', 'Responsive design', 'Dark mode support', 'Indicador visual activo (lÃ­nea inferior)'],
              class: 'ubits-sub-nav ubits-sub-nav-tab ubits-sub-nav-tab--active',
              example: 'createSubNav({\n  containerId: \'subnav-container\',\n  variant: \'template\',\n  tabs: [...],\n  activeTabId: \'section1\'\n})',
              hasPreview: true
            },
            {
              name: 'TabBar',
              description: 'Componente de navegaciÃ³n inferior para dispositivos mÃ³viles. Reemplaza al sidebar en pantallas pequeÃ±as con items personalizables con iconos o avatares. Incluye Floating Menu (accordions) que se muestra al hacer click en "MÃ³dulos" y Profile Menu que se muestra al hacer click en "Mi perfil".',
              files: {
                css: 'addons/tabbar/src/styles/tabbar.css',
                ts: 'addons/tabbar/src/TabBarProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active'],
              features: ['Items personalizables', 'Iconos o avatares', 'Dark mode toggle', 'Callbacks por item', 'Responsive (< 1024px)', 'Altura fija 60px', 'Transiciones suaves', 'Floating Menu con accordions', 'Profile Menu dropdown', 'Solo visible en mÃ³vil'],
              class: 'ubits-tabbar ubits-tabbar-item ubits-tabbar-item--active',
              example: 'createTabBar({\n  containerId: \'tabbar-container\',\n  items: [\n    { id: \'modulos\', label: \'MÃ³dulos\', icon: \'th-large\' },\n    { id: \'perfil\', label: \'Mi perfil\', avatar: \'images/Profile-image.jpg\' },\n    { id: \'modo-oscuro\', label: \'Modo oscuro\', icon: \'moon\' }\n  ],\n  activeTabId: \'modulos\',\n  floatingMenuSections: [...],\n  profileMenuItems: [...]\n})',
              hasPreview: true
            },
            {
              name: 'Tabs',
              description: 'Componente de tabs horizontal con soporte para iconos opcionales. El tab activo muestra fondo blanco, icono oscuro y texto en negrita. Los tabs inactivos muestran icono y texto en gris claro sin fondo.',
              files: {
                css: 'addons/tabs/src/styles/tabs.css',
                ts: 'addons/tabs/src/TabsProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['Iconos opcionales', 'Tabs personalizables', 'Callbacks por tab', 'Estado activo visual', 'Soporte para tabs deshabilitados', 'Dark mode support', 'Responsive design'],
              class: 'ubits-tabs ubits-tab ubits-tab--active',
              example: 'createTabs({\n  tabs: [\n    { id: \'tab-1\', label: \'Label\', icon: \'far fa-th\', active: true },\n    { id: \'tab-2\', label: \'Label\', icon: \'far fa-th\' },\n    { id: \'tab-3\', label: \'Label\', icon: \'far fa-th\' }\n  ],\n  activeTabId: \'tab-1\',\n  onTabChange: (tabId, tabElement) => { ... }\n}, \'tabs-container\')',
              hasPreview: true
            },
            {
              name: 'Segment Control',
              description: 'Componente de segmentos horizontal similar a Tabs pero con contenedor con padding interno de 4px y altura de 30px. El segmento activo muestra fondo blanco, icono solid oscuro y texto en negrita. Los segmentos inactivos muestran icono regular y texto en gris claro sin fondo.',
              files: {
                css: 'addons/segment-control/src/styles/segment-control.css',
                ts: 'addons/segment-control/src/SegmentControlProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['Iconos opcionales', 'Segmentos personalizables', 'Callbacks por segmento', 'Estado activo visual', 'Soporte para segmentos deshabilitados', 'Dark mode support', 'Responsive design', 'Padding interno 4px', 'Altura 30px'],
              class: 'ubits-segment-control ubits-segment ubits-segment--active',
              example: 'createSegmentControl({\n  segments: [\n    { id: \'segment-1\', label: \'Label\', icon: \'far fa-th\', active: true },\n    { id: \'segment-2\', label: \'Label\', icon: \'far fa-th\' },\n    { id: \'segment-3\', label: \'Label\', icon: \'far fa-th\' }\n  ],\n  activeSegmentId: \'segment-1\',\n  onSegmentChange: (segmentId, segmentElement) => { ... }\n}, \'segment-control-container\')',
              hasPreview: true
            },
            {
              name: 'Breadcrumb',
              description: 'Componente de breadcrumb para navegaciÃ³n jerÃ¡rquica. El Ãºltimo item muestra texto en bold (active) con fg-1-high, los demÃ¡s en regular (default) con fg-1-medium. Usa body-sm con tokens UBITS.',
              files: {
                css: 'addons/breadcrumb/src/styles/breadcrumb.css',
                ts: 'addons/breadcrumb/src/BreadcrumbProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['Separador personalizable', 'Items clickeables', 'Estado activo visual (Ãºltimo item)', 'Soporte para items deshabilitados', 'Dark mode support', 'Responsive design', 'Body-sm regular (default)', 'Body-sm bold (active)'],
              class: 'ubits-breadcrumb ubits-breadcrumb__item ubits-breadcrumb__item--active',
              example: 'createBreadcrumb({\n  items: [\n    { id: \'item-1\', label: \'Home\', url: \'#home\' },\n    { id: \'item-2\', label: \'CategorÃ­a\', url: \'#categoria\' },\n    { id: \'item-3\', label: \'PÃ¡gina\', active: true }\n  ],\n  separator: \'>\',\n  onItemClick: (itemId, itemElement) => { ... }\n}, \'breadcrumb-container\')',
              hasPreview: true
            },
            {
              name: 'Menu',
              description: 'Componente Menu UBITS de navegaciÃ³n lateral con secciones, items, badges e informaciÃ³n de usuario. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/menu/src/styles/menu.css',
                ts: 'addons/menu/src/MenuProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['Secciones con tÃ­tulos', 'Items con iconos y badges', 'InformaciÃ³n de usuario', 'Logo y nombre de app', 'Ancho configurable', 'Items activos y deshabilitados', 'Badges de UBITS', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-menu ubits-menu-item ubits-menu-item--active',
              example: 'createMenu({\n  logoImage: \'/images/logo.svg\',\n  appName: \'AUTOFROME\',\n  sections: [\n    { id: \'section1\', title: \'Documents\', items: [...] },\n    { id: \'section2\', title: \'Profile\', items: [...] }\n  ],\n  userInfo: { avatarImage: \'/images/avatar.jpg\', name: \'John Doe\', role: \'Admin\' },\n  width: 280\n})',
              hasPreview: true
            },
            {
              name: 'Menubar',
              description: 'Componente Menubar UBITS de navegaciÃ³n horizontal con soporte para dropdowns y submenÃºs anidados. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/menubar/src/styles/menubar.css',
                ts: 'addons/menubar/src/MenubarProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['NavegaciÃ³n horizontal', 'Dropdowns con submenÃºs', 'SubmenÃºs anidados (nivel 3)', 'Iconos opcionales', 'Items activos y deshabilitados', 'NavegaciÃ³n por URL o callbacks', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-menubar ubits-menubar-item ubits-menubar-item--active',
              example: 'createMenubar({\n  items: [\n    { id: \'home\', label: \'Home\', icon: \'house\', href: \'#\' },\n    { id: \'projects\', label: \'Projects\', icon: \'magnifying-glass\', submenu: [...] }\n  ],\n  onActiveItemChange: (itemId, parentId) => { ... },\n  onItemClick: (itemId, item) => { ... }\n})',
              hasPreview: true
            },
            {
              name: 'TreeMenu',
              description: 'Componente Tree Menu UBITS para mostrar estructuras jerÃ¡rquicas con expandir/colapsar. Soporta iconos opcionales, mÃºltiples niveles, chevron opcional y modo cascada o vertical.',
              files: {
                css: 'addons/tree-menu/src/styles/tree-menu.css',
                ts: 'addons/tree-menu/src/TreeMenuProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default', 'hover', 'active'],
              features: ['Iconos opcionales en nodos', 'Chevron opcional para expandir/colapsar', 'MÃºltiples niveles (1-5)', 'Expandir todos los nodos por defecto', '3 tamaÃ±os (sm, md, lg)', '2 modos (cascada con indentaciÃ³n, vertical sin indentaciÃ³n)', 'NavegaciÃ³n por teclado', 'SelecciÃ³n de nodos', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-tree-menu ubits-tree-menu--{cascade|vertical}',
              example: 'renderTreeMenu({\n  showIcons: true,\n  showChevron: true,\n  maxLevels: 3,\n  defaultExpanded: false,\n  size: \'md\',\n  cascade: true\n})',
              hasPreview: true
            },
            {
              name: 'Menu de Participantes',
              description: 'Componente de menÃº lateral UBITS para mostrar una lista de participantes. Incluye bÃºsqueda, filtro y lista de participantes con avatar, nombre, rol y estado.',
              files: {
                css: 'addons/participants-menu/src/styles/participants-menu.css',
                ts: 'addons/participants-menu/src/ParticipantsMenuProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'selected'],
              features: ['BÃºsqueda de participantes', 'Filtro por roles y estados', 'Lista de participantes con avatar', 'Mostrar/ocultar avatar, rol y status tag', 'Scrollbar de UBITS opcional', 'Estado seleccionado', 'Usa tokens UBITS exclusivamente', 'Usa componentes Input, Button, Avatar, StatusTag, EmptyState UBITS'],
              class: 'ubits-participants-menu',
              example: 'createParticipantsMenu({\n  title: \'Participantes\',\n  searchPlaceholder: \'Buscar participan...\',\n  participants: [\n    { id: \'1\', name: \'Elkin Garcia\', role: \'Producto\', avatarImage: \'...\', status: \'bajo\' },\n    { id: \'2\', name: \'EstefanÃ­a Rojas\', role: \'Ventas\', avatarImage: \'...\', status: \'muy-alto\' }\n  ],\n  selectedParticipantId: \'1\',\n  showAvatar: true,\n  showRole: true,\n  showStatusTag: true,\n  enableScrollbar: true\n})',
              hasPreview: true
            },
            {
              name: 'Stepper',
              description: 'Componente Stepper UBITS para mostrar el progreso de un proceso multi-paso. Soporta orientaciÃ³n horizontal y vertical, con estados: default, completado, activo, error y warning. Cada paso puede tener nÃºmero, tÃ­tulo y descripciÃ³n.',
              files: {
                css: 'addons/stepper/src/styles/stepper.css',
                ts: 'addons/stepper/src/StepperProvider.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'completed', 'active', 'error', 'warning'],
              features: ['2 orientaciones (horizontal, vertical)', '4 tamaÃ±os (xs, sm, md, lg)', '5 estados por paso (default, completed, active, error, warning)', 'TÃ­tulos opcionales', 'Descripciones opcionales', '2-5 pasos configurables', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-stepper ubits-stepper--{orientation} ubits-stepper--{size}',
              example: 'renderStepper({\n  orientation: \'horizontal\',\n  size: \'md\',\n  showTitle: true,\n  showDescription: true,\n  steps: [\n    { number: 1, title: \'Step One\', description: \'Desc for step one\', state: \'completed\' },\n    { number: 2, title: \'Step Two\', description: \'Desc for step two\', state: \'active\' },\n    { number: 3, title: \'Step Three\', description: \'Desc for step three\', state: \'default\' }\n  ]\n})',
              hasPreview: true
            },
            {
              name: 'Drawer Navigation',
              description: 'Componente drawer que sale de izquierda a derecha con overlay. Se usa para vistas de elementos, filtros en tablas, etc. Tiene diferentes tamaÃ±os horizontalmente (100%, 80%, 60%, 50%, 40%, 30%). Incluye header con tÃ­tulo y botÃ³n de cerrar, body con contenido scrollable y footer con botones primario, secundario y terciario.',
              files: {
                css: 'addons/drawer/src/styles/drawer.css',
                ts: 'addons/drawer/src/DrawerProvider.ts'
              },
              variants: [],
              sizes: ['100%', '80%', '60%', '50%', '40%', '30%'],
              states: ['closed', 'open'],
              features: ['6 tamaÃ±os de ancho (100%, 80%, 60%, 50%, 40%, 30%)', 'Overlay semitransparente', 'Header con tÃ­tulo y texto complementario', 'BotÃ³n de cerrar', 'Body con scroll personalizado', 'Footer con botones opcionales (tertiary, secondary, primary)', 'Cierre con ESC y clic en overlay', 'Animaciones suaves', 'Responsive (100% en mÃ³vil)'],
              class: 'ubits-drawer-overlay ubits-drawer',
              example: 'createDrawer({\n  title: \'TÃ­tulo del drawer\',\n  complementaryText: \'Texto complementario opcional\',\n  width: 40,\n  bodyContent: \'<p>Contenido del drawer</p>\',\n  footerButtons: {\n    tertiary: { label: \'Cancelar\', onClick: () => {} },\n    secondary: { label: \'Guardar\', onClick: () => {} },\n    primary: { label: \'Aplicar\', onClick: () => {} }\n  },\n  onClose: () => {}\n})',
              hasPreview: true
            },
            {
              name: 'Modal',
              description: 'Componente modal centrado con overlay. Se usa para diÃ¡logos, confirmaciones y formularios. Tiene diferentes tamaÃ±os (sm: 320px, md: 480px, lg: 640px, xl: 800px, full: 1280px). Incluye header con tÃ­tulo y botÃ³n de cerrar, body con contenido scrollable y footer con botones primario, secundario y terciario. Soporta variante full-screen.',
              files: {
                css: 'addons/modal/src/styles/modal.css',
                ts: 'addons/modal/src/ModalProvider.ts'
              },
              variants: ['default', 'full-screen'],
              sizes: ['sm', 'md', 'lg', 'xl', 'full'],
              states: ['closed', 'open'],
              features: ['5 tamaÃ±os (sm: 320px, md: 480px, lg: 640px, xl: 800px, full: 1280px)', 'Overlay semitransparente', 'Header con tÃ­tulo y botÃ³n de cerrar', 'Body con scroll personalizado', 'Footer con botones opcionales (tertiary, secondary, primary)', 'Variante full-screen para contenido extenso', 'Cierre con ESC y clic en overlay', 'Animaciones suaves de apertura/cierre', 'Responsive (100% en mÃ³vil)', 'MÃ©todos open/close/updateContent', 'Usa tokens UBITS exclusivamente', 'Usa componente Button existente para footer'],
              class: 'ubits-modal-overlay ubits-modal',
              example: 'createModal({\n  title: \'TÃ­tulo del modal\',\n  size: \'md\',\n  fullScreen: false,\n  bodyContent: \'<p>Contenido del modal</p>\',\n  footerButtons: {\n    tertiary: { label: \'Cancelar\', onClick: () => {} },\n    secondary: { label: \'Guardar\', onClick: () => {} },\n    primary: { label: \'Aplicar\', onClick: () => {} }\n  },\n  onClose: () => {}\n})',
              hasPreview: true
            },
            {
              name: 'Popover',
              description: 'Componente popover con tail (flecha) para mostrar informaciÃ³n contextual. Similar al modal pero mÃ¡s pequeÃ±o y con tail. Se usa para mostrar informaciÃ³n adicional, tooltips avanzados o acciones contextuales. Tiene diferentes tamaÃ±os (sm: 240px, md: 320px, lg: 400px, xl: 480px) y posiciones de tail (top, bottom, left, right). Incluye header opcional con tÃ­tulo, body con contenido scrollable y footer con botones primario, secundario y terciario.',
              files: {
                css: 'addons/popover/src/styles/popover.css',
                ts: 'addons/popover/src/PopoverProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg', 'xl'],
              states: ['closed', 'open'],
              features: ['4 tamaÃ±os (sm: 240px, md: 320px, lg: 400px, xl: 480px)', 'Tail (flecha) posicionable (top, bottom, left, right)', 'Header opcional con tÃ­tulo', 'Body con scroll personalizado y scrollbar visual', 'Footer con botones opcionales (tertiary, secondary, primary)', 'Posicionamiento absoluto o relativo a elemento de referencia', 'Cierre con clic fuera', 'Animaciones suaves de apertura/cierre', 'Responsive (100% en mÃ³vil)', 'MÃ©todos open/close/updateContent/updatePosition/destroy', 'Usa tokens UBITS exclusivamente', 'Usa componente Button existente para footer'],
              class: 'ubits-popover ubits-popover--open',
              example: 'createPopover({\n  title: \'TÃ­tulo del popover\',\n  width: \'md\',\n  tailPosition: \'top\',\n  bodyContent: \'<p>Contenido del popover</p>\',\n  footerButtons: {\n    tertiary: { label: \'Cancelar\', onClick: () => {} },\n    secondary: { label: \'Guardar\', onClick: () => {} },\n    primary: { label: \'Aplicar\', onClick: () => {} }\n  },\n  position: { top: 100, left: 100 },\n  onClose: () => {}\n})',
              hasPreview: true
            },
            {
              name: 'Scrollbar',
              description: 'Componente scrollbar personalizado UBITS. Se usa para crear scrollbars personalizados en elementos scrollable. Soporta orientaciÃ³n vertical y horizontal. Se sincroniza automÃ¡ticamente con el elemento scrollable asociado. Aparece en hover y se adapta al tamaÃ±o del contenido.',
              files: {
                css: 'addons/scroll/src/styles/scroll.css',
                ts: 'addons/scroll/src/ScrollProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default'],
              features: ['OrientaciÃ³n vertical y horizontal', 'SincronizaciÃ³n automÃ¡tica con elemento scrollable', 'Aparece en hover', 'Se adapta al tamaÃ±o del contenido', 'Responsive (2px en mÃ³vil)', 'MÃ©todos update/destroy', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-scrollbar ubits-scrollbar--vertical ubits-scrollbar--horizontal',
              example: 'createScrollbar({\n  orientation: \'vertical\',\n  targetId: \'scrollable-container\',\n  containerId: \'scrollbar-container\'\n})',
              hasPreview: true
            }
          ],
          'Formularios': [
            {
              name: 'Input',
              description: 'Componente de input con 11 tipos, 4 tamaÃ±os, 6 estados y funcionalidades especiales. Incluye password toggle, search clear, autocomplete, select scroll infinito y calendar picker.',
              files: {
                css: 'addons/input/src/styles/input.css',
                ts: 'addons/input/src/InputComponent.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'hover', 'focus', 'active', 'invalid', 'disabled'],
              types: ['text', 'email', 'password', 'number', 'tel', 'url', 'select', 'textarea', 'search', 'autocomplete', 'calendar'],
              features: ['11 tipos de input', '4 tamaÃ±os', '6 estados', 'Iconos izquierdo/derecho', 'Helper text y contador', 'Mandatory/optional', 'Password toggle', 'Search clear', 'Autocomplete', 'Select scroll infinito', 'Calendar picker'],
              class: 'ubits-input ubits-input--{size} ubits-input--{state}',
              example: '<div id="input-container">\n  <label class="ubits-input-label">Label</label>\n  <div style="position: relative;">\n    <input type="text" class="ubits-input ubits-input--md" placeholder="Placeholder" />\n  </div>\n  <div class="ubits-input-helper">\n    <span>Helper text</span>\n    <span class="ubits-input-counter">0/50</span>\n  </div>\n</div>',
              hasPreview: true
            },
            {
              name: 'List',
              description: 'Componente de lista con estados (default, hover, active, disabled). Soporta scrollbar, navegaciÃ³n por teclado y selecciÃ³n simple o mÃºltiple.',
              files: {
                css: 'addons/list/src/styles/list.css',
                ts: 'addons/list/src/ListComponent.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['4 tamaÃ±os (xs, sm, md, lg)', '4 estados', 'Scrollbar personalizado', 'NavegaciÃ³n por teclado', 'SelecciÃ³n simple/mÃºltiple', 'Accesibilidad completa (ARIA)', 'Modo oscuro'],
              class: 'ubits-list ubits-list-item ubits-list-item--{state}',
              example: '<div class="ubits-list" role="list">\n  <div class="ubits-list-item" role="listitem">Label</div>\n  <div class="ubits-list-item ubits-list-item--active" role="listitem">Label</div>\n  <div class="ubits-list-item ubits-list-item--disabled" role="listitem">Label</div>\n</div>',
              hasPreview: true
            },
            {
              name: 'Radio Button',
              description: 'Componente radio button para selecciÃ³n Ãºnica en grupos. MÃºltiples tamaÃ±os, estados y soporte para texto complementario. Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/radio-button/src/styles/radio-button.css',
                ts: 'addons/radio-button/src/RadioButtonProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md'],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['2 tamaÃ±os (sm: 16px, md: 20px)', '4 estados (default, hover, active, disabled)', 'Texto complementario opcional', 'AgrupaciÃ³n por name', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-radio-button ubits-radio-button--{size} ubits-radio-button--{state}',
              example: 'renderRadioButton({\n  label: \'Label\',\n  value: \'option1\',\n  name: \'group\',\n  size: \'md\',\n  state: \'default\',\n  checked: false\n})',
              hasPreview: true
            },
            {
              name: 'Checkbox',
              description: 'Componente checkbox para selecciÃ³n mÃºltiple. MÃºltiples tamaÃ±os, estados y soporte para texto complementario. Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/checkbox/src/styles/checkbox.css',
                ts: 'addons/checkbox/src/CheckboxProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md'],
              states: ['default', 'hover', 'active', 'disabled', 'indeterminate'],
              features: ['2 tamaÃ±os (sm: 16px, md: 20px)', '5 estados (default, hover, active, disabled, indeterminate)', 'Estado indeterminado con lÃ­nea horizontal', 'Texto complementario opcional', 'Checkmark animado', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-checkbox ubits-checkbox--{size} ubits-checkbox--{state}',
              example: 'renderCheckbox({\n  label: \'Label\',\n  size: \'md\',\n  state: \'default\',\n  checked: false,\n  indeterminate: false\n})',
              hasPreview: true
            },
            {
              name: 'Toggle',
              description: 'Componente toggle/switch para activar/desactivar opciones. MÃºltiples tamaÃ±os, estados y soporte para texto complementario. Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/toggle/src/styles/toggle.css',
                ts: 'addons/toggle/src/ToggleProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md'],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['2 tamaÃ±os (sm: 33x16px, md: 36x20px)', '4 estados (default, hover, active, disabled)', 'Texto complementario opcional', 'Thumb animado', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-toggle ubits-toggle--{size} ubits-toggle--{state}',
              example: 'renderToggle({\n  label: \'Label\',\n  size: \'md\',\n  state: \'default\',\n  checked: false\n})',
              hasPreview: true
            },
            {
              name: 'Search Button',
              description: 'Componente Search Button con modo botÃ³n e input. Cuando estÃ¡ activo, muestra un campo de bÃºsqueda con icono. Cuando no estÃ¡ activo, muestra solo un botÃ³n con icono de lupa.',
              files: {
                css: 'addons/search-button/src/styles/search-button.css',
                ts: 'addons/search-button/src/SearchButtonProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md'],
              states: ['default', 'hover', 'active', 'disabled'],
              features: ['2 tamaÃ±os (sm: 32px, md: 40px)', '2 modos (botÃ³n e input)', '4 estados (default, hover, active, disabled)', 'Icono de lupa', 'Ancho configurable del input', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-search-button ubits-search-button--{size} ubits-search-button--{state}',
              example: 'renderSearchButton({\n  active: false,\n  size: \'md\',\n  state: \'default\',\n  placeholder: \'Buscar...\'\n})',
              hasPreview: true
            },
            {
              name: 'File Upload',
              description: 'Componente para subir archivos con drag & drop. Soporta mÃºltiples estados (default, dragging, error, disabled) y muestra informaciÃ³n del archivo (nombre, extensiÃ³n, tamaÃ±o). Incluye botones de acciÃ³n opcionales (re-subir y eliminar).',
              files: {
                css: 'addons/file-upload/src/styles/file-upload.css',
                ts: 'addons/file-upload/src/FileUploadProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'dragging', 'error', 'disabled'],
              features: ['4 estados (default, dragging, error, disabled)', 'Drag & drop', 'Mostrar nombre y extensiÃ³n de archivo', 'TamaÃ±o de archivo formateado (KB, MB, GB)', 'Botones de acciÃ³n opcionales (re-subir, eliminar)', 'Iconos diferentes segÃºn estado', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-file-upload ubits-file-upload--{state}',
              example: 'createFileUpload({\n  state: \'default\',\n  uploadText: \'Haz clic para subir archivo\',\n  showFileSize: true,\n  showActions: true\n})',
              hasPreview: true
            },
            {
              name: 'Calendar',
              description: 'Componente Calendar UBITS con selecciÃ³n Ãºnica de fecha y selecciÃ³n por rango. Incluye navegaciÃ³n por mes/aÃ±o, selector de mes y aÃ±o, y soporte para fechas mÃ­nimas y mÃ¡ximas. Usa tokens UBITS exclusivamente para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/calendar/src/styles/calendar.css',
                ts: 'addons/calendar/src/CalendarProvider.ts'
              },
              variants: ['single', 'range'],
              sizes: [],
              states: ['default', 'selected'],
              features: ['SelecciÃ³n Ãºnica de fecha (modo single)', 'SelecciÃ³n por rango de fechas (modo range)', 'NavegaciÃ³n por mes/aÃ±o', 'Selector de mes y aÃ±o', 'Soporte para fechas mÃ­nimas y mÃ¡ximas', 'Resalta el dÃ­a actual', 'MÃ©todos update/destroy', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-calendar ubits-calendar--single',
              example: 'createCalendar({\n  mode: \'single\',\n  selectedDate: new Date(),\n  onDateSelect: (date) => {}\n})',
              hasPreview: true
            },
            {
              name: 'Slider',
              description: 'Componente Slider UBITS para seleccionar valores numÃ©ricos. Soporta modo single (un valor) y range (dos valores), orientaciÃ³n horizontal y vertical, inputs numÃ©ricos, marcas/ticks y guÃ­a de rango. Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/slider/src/styles/slider.css',
                ts: 'addons/slider/src/SliderProvider.ts'
              },
              variants: ['single', 'range'],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'disabled'],
              features: ['2 modos (single, range)', '2 orientaciones (horizontal, vertical)', '4 tamaÃ±os (xs, sm, md, lg)', '2 estados (default, disabled)', 'Inputs numÃ©ricos opcionales', 'Marcas/ticks opcionales', 'GuÃ­a de rango opcional', 'Label y helper text', 'MÃ©todos getValue/setValue/disable/enable', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-slider ubits-slider--{size} ubits-slider--{orientation}',
              example: 'createSlider({\n  containerId: \'slider-container\',\n  label: \'Rango de precio\',\n  mode: \'range\',\n  min: 0,\n  max: 1000,\n  values: [200, 800],\n  showInputs: true,\n  showRangeGuide: true\n})',
              hasPreview: true
            }
          ],
          'Feedback': [
            {
              name: 'Alert',
              description: 'Componente de alert para mostrar notificaciones del sistema con diferentes variantes (success, info, warning, error).',
              files: {
                css: 'addons/alert/src/styles/alert.css',
                ts: 'addons/alert/src/AlertComponent.ts'
              },
              variants: ['success', 'info', 'warning', 'error'],
              sizes: [],
              states: ['default', 'closing'],
              features: ['4 variantes', 'BotÃ³n cerrar opcional', 'Cierre automÃ¡tico', 'Animaciones', 'Responsive'],
              class: 'ubits-alert ubits-alert--{type}',
              example: '<div class="ubits-alert ubits-alert--success">\n  <div class="ubits-alert__icon">\n    <i class="far fa-check-circle"></i>\n  </div>\n  <div class="ubits-alert__content">\n    <div class="ubits-alert__text">Mensaje del alert</div>\n  </div>\n  <button class="ubits-alert__close">\n    <i class="far fa-times"></i>\n  </button>\n</div>',
              hasPreview: true
            },
            {
              name: 'Toast',
              description: 'Notificaciones flotantes que aparecen arriba al centro. Auto-cierre con duraciones por tipo, pausa en hover, apilado inteligente.',
              files: {
                css: 'addons/toast/src/styles/toast.css',
                ts: 'addons/toast/src/ToastProvider.ts'
              },
              variants: ['success', 'info', 'warning', 'error'],
              sizes: [],
              states: ['default', 'enter', 'exit'],
              features: ['4 variantes', 'Auto-cierre por tipo (3.5s-6.5s)', 'Pausa en hover/focus', 'Apilado (max 3)', 'BotÃ³n acciÃ³n opcional', 'Timer inteligente'],
              class: 'ubits-toast ubits-toast--{type}',
              example: 'showToast(\'success\', \'Â¡OperaciÃ³n exitosa!\');',
              hasPreview: true
            },
            {
              name: 'Spinner',
              description: 'Componente spinner/loader para mostrar estados de carga. Soporta mÃºltiples tamaÃ±os, variantes de color y puede mostrarse con o sin etiqueta.',
              files: {
                css: 'addons/spinner/src/styles/spinner.css',
                ts: 'addons/spinner/src/SpinnerProvider.ts'
              },
              variants: ['primary', 'secondary', 'success', 'warning', 'error', 'info'],
              sizes: ['xs', 'sm', 'md', 'lg', 'xl'],
              states: ['default', 'animated', 'static'],
              features: ['5 tamaÃ±os (xs, sm, md, lg, xl)', '6 variantes de color', 'AnimaciÃ³n opcional', 'Label opcional', 'Modo fullscreen', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-spinner ubits-spinner--{size} ubits-spinner--{variant}',
              example: 'renderSpinner({\n  size: \'md\',\n  variant: \'primary\',\n  animated: true,\n  label: \'Cargando...\'\n})',
              hasPreview: true
            },
            {
              name: 'Empty State',
              description: 'Componente empty state para mostrar estados vacÃ­os en la interfaz. Soporta imagen o icono, tÃ­tulo, descripciÃ³n y botones de acciÃ³n con controladores booleanos.',
              files: {
                css: 'addons/empty-state/src/styles/empty-state.css',
                ts: 'addons/empty-state/src/EmptyStateProvider.ts'
              },
              variants: ['default'],
              sizes: [],
              states: ['default'],
              features: ['Variante default', 'Soporte para imagen o icono (icono 25px con fondo 41px bg-2)', 'TÃ­tulo body-md semibold y descripciÃ³n body-md regular', 'Botones de acciÃ³n con controladores booleanos (showPrimaryButton, showSecondaryButton)', 'Responsive', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-empty-state ubits-empty-state--default',
              example: 'renderEmptyState({\n  title: \'No hay resultados\',\n  description: \'Intenta ajustar tus filtros de bÃºsqueda\',\n  icon: \'inbox\',\n  actionLabel: \'Buscar\',\n  showPrimaryButton: true,\n  secondaryActionLabel: \'Cancelar\',\n  showSecondaryButton: false,\n  onAction: () => {}\n})',
              hasPreview: true
            },
            {
              name: 'Skeleton',
              description: 'Componente skeleton loader para mostrar placeholders de carga. Soporta mÃºltiples variantes (text, circle, rectangle, custom), tamaÃ±os y animaciÃ³n opcional.',
              files: {
                css: 'addons/skeleton/src/styles/skeleton.css',
                ts: 'addons/skeleton/src/SkeletonProvider.ts'
              },
              variants: ['text', 'circle', 'rectangle', 'custom'],
              sizes: ['xs', 'sm', 'md', 'lg', 'xl'],
              states: ['default', 'animated', 'static'],
              features: ['4 variantes (text, circle, rectangle, custom)', '5 tamaÃ±os (xs, sm, md, lg, xl)', 'MÃºltiples lÃ­neas de texto', 'Ancho y alto personalizables', 'AnimaciÃ³n opcional', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-skeleton ubits-skeleton--{variant} ubits-skeleton--{size}',
              example: 'renderSkeleton({\n  variant: \'text\',\n  size: \'md\',\n  lines: 3,\n  animated: true,\n  width: \'full\'\n})',
              hasPreview: true
            },
            {
              name: 'Tooltip',
              description: 'Componente tooltip con tail (flecha) para mostrar informaciÃ³n contextual. Similar al Popover pero mÃ¡s simple, con tÃ­tulo, descripciÃ³n y botones de acciÃ³n (primario, secundario y terciario). Tiene diferentes tamaÃ±os (sm: 240px, md: 320px, lg: 400px) y posiciones de tail (top, bottom, left, right). Incluye controles para mostrar/ocultar cada botÃ³n y opciÃ³n de iconos en los botones.',
              files: {
                css: 'addons/tooltip/src/styles/tooltip.css',
                ts: 'addons/tooltip/src/TooltipProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['closed', 'open'],
              features: ['3 tamaÃ±os (sm: 240px, md: 320px, lg: 400px)', 'Tail (flecha) posicionable (top, bottom, left, right)', 'TÃ­tulo opcional (body-md semibold)', 'DescripciÃ³n opcional (body-md regular)', 'Botones opcionales (primario, secundario, terciario) con controladores booleanos', 'Iconos opcionales en cada botÃ³n', 'Posicionamiento absoluto o relativo a elemento de referencia', 'Cierre con clic fuera', 'Animaciones suaves de apertura/cierre', 'Responsive (100% en mÃ³vil)', 'MÃ©todos open/close/updatePosition/destroy', 'Usa tokens UBITS exclusivamente', 'Usa componente Button existente para footer'],
              class: 'ubits-tooltip ubits-tooltip--open',
              example: 'createTooltip({\n  title: \'TÃ­tulo del tooltip\',\n  description: \'DescripciÃ³n del tooltip\',\n  width: \'md\',\n  tailPosition: \'top\',\n  primaryButtonLabel: \'Aceptar\',\n  showPrimaryButton: true,\n  secondaryButtonLabel: \'Cancelar\',\n  showSecondaryButton: true,\n  tertiaryButtonLabel: \'MÃ¡s info\',\n  showTertiaryButton: false,\n  position: { top: 100, left: 100 },\n  onClose: () => {}\n})',
              hasPreview: true
            }
          ],
          'UI': [
            {
              name: 'Button',
              description: 'Componente de botÃ³n con mÃºltiples variantes, tamaÃ±os y estados. Incluye preview interactivo.',
              files: {
                css: 'addons/button/src/styles/button.css',
                ts: 'addons/button/src/ButtonComponent.ts'
              },
              variants: ['primary', 'secondary', 'tertiary'],
              sizes: ['xs', 'sm', 'md', 'lg', 'xl'],
              states: ['default', 'hover', 'active', 'focus', 'disabled', 'loading'],
              modifiers: ['icon-only', 'full-width', 'block', 'icon-right'],
              features: ['5 variantes', '5 tamaÃ±os', '6 estados', 'Badge opcional', 'Loading spinner'],
              class: 'ubits-button ubits-button--{variant} ubits-button--{size}',
              example: '<button class="ubits-button ubits-button--primary ubits-button--md">\n  <i class="far fa-check"></i>\n  <span>Texto</span>\n</button>',
              hasPreview: true
            },
            {
              name: 'Contenedor',
              description: 'Componente contenedor bÃ¡sico con fondo bg-1, bordes redondeados de 8px y padding interno de 12px. Usa tokens UBITS para mantener consistencia visual.',
              files: {
                css: 'Tokens UBITS (inline styles)',
                ts: 'N/A'
              },
              variants: [],
              sizes: [],
              states: ['default'],
              features: ['Fondo bg-1', 'Border-radius de 8px', 'Padding interno de 12px', 'Usa tokens UBITS', 'Responsive'],
              class: 'ubits-container',
              example: '<div class="ubits-container">\n  Contenido del contenedor\n</div>',
              hasPreview: true
            },
            {
              name: 'Badge',
              description: 'Componente de badge para mostrar notificaciones, contadores o indicadores. Puede usarse standalone o dentro de botones.',
              files: {
                css: 'addons/badge/src/styles/badge.css',
                ts: 'addons/badge/src/index.ts'
              },
              variants: ['primary', 'secondary', 'success', 'warning', 'error', 'info'],
              sizes: ['xs', 'sm', 'md', 'lg'],
              features: ['Badge standalone', 'Badge en botones', 'Badge con contenido', 'Solo bolita (dot)', 'Con nÃºmeros', 'PosiciÃ³n absoluta'],
              class: 'ubits-badge ubits-badge--{size} ubits-badge--{variant}',
              example: '<!-- Standalone con nÃºmero -->\n<span class="ubits-badge ubits-badge--md">5</span>\n\n<!-- Solo bolita -->\n<span class="ubits-badge ubits-badge--dot"></span>\n\n<!-- En botÃ³n -->\n<button class="ubits-button ubits-button--primary">\n  <span>Notificaciones</span>\n  <span class="ubits-button__badge"></span>\n</button>',
              hasPreview: true
            },
            {
              name: 'Status Tag',
              description: 'Componente de tag de estado con icono izquierdo (punto de color), texto y icono derecho opcional. MÃºltiples estados con colores diferenciados usando tokens UBITS.',
              files: {
                css: 'addons/status-tag/src/styles/status-tag.css',
                ts: 'addons/status-tag/src/StatusTagProvider.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md'],
              states: ['completed', 'published', 'fulfilled', 'created', 'active', 'not-fulfilled', 'denied', 'draft', 'in-progress', 'syncing', 'pending', 'pending-approval', 'not-started', 'finished', 'archived', 'disabled', 'paused', 'hidden'],
              features: ['3 tamaÃ±os (xs, sm, md)', '19 estados predefinidos', 'Icono izquierdo (punto de color)', 'Icono derecho opcional', 'Colores segÃºn estado (verde, rojo, azul, naranja, gris)', 'Clickeable opcional', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-status-tag ubits-status-tag--{size}',
              example: 'renderStatusTag({\n  label: \'Completado\',\n  size: \'md\',\n  status: \'completed\',\n  rightIcon: \'chevron-down\',\n  clickable: true\n})',
              hasPreview: true
            },
            {
              name: 'Chip',
              description: 'Componente chip para mostrar etiquetas o tags interactivas. MÃºltiples tamaÃ±os, estados y soporte para iconos izquierdo y derecho (botÃ³n de cerrar). Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/chip/src/styles/chip.css',
                ts: 'addons/chip/src/ChipProvider.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: ['default', 'hover', 'active', 'pressed', 'focus', 'disabled'],
              features: ['4 tamaÃ±os (xs: 20px, sm: 24px, md: 28px, lg: 36px)', '6 estados (default, hover, active, pressed, focus, disabled)', 'Icono izquierdo opcional', 'Icono derecho opcional (botÃ³n cerrar)', 'Clickeable opcional', 'BotÃ³n de cerrar (closable)', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-chip ubits-chip--{size} ubits-chip--{state}',
              example: 'renderChip({\n  label: \'Chip\',\n  size: \'md\',\n  state: \'default\',\n  leftIcon: \'tag\',\n  closable: true,\n  clickable: true\n})',
              hasPreview: true
            },
            {
              name: 'Avatar',
              description: 'Componente de avatar con soporte para imagen, iniciales e icono. MÃºltiples tamaÃ±os y badge opcional. Usa tokens UBITS exclusivamente.',
              files: {
                css: 'addons/avatar/src/styles/avatar.css',
                ts: 'addons/avatar/src/AvatarProvider.ts'
              },
              variants: ['photo', 'initials', 'icon'],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: [],
              features: ['4 tamaÃ±os (xs: 20px, sm: 28px, md: 36px, lg: 40px)', '3 variantes (Photo, Initials, Icon)', 'Badge opcional con colores', 'Clickeable opcional', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-avatar ubits-avatar--{size} ubits-avatar--{variant}',
              example: 'renderAvatar({\n  imageUrl: \'https://example.com/photo.jpg\',\n  size: \'md\',\n  badgeColor: \'green\'\n})',
              hasPreview: true
            },
            {
              name: 'Progress Bar',
              description: 'Componente de barra de progreso con 4 tamaÃ±os y variante multi-color. Permite mostrar progreso simple o mÃºltiples segmentos con diferentes colores (yellow, green, gray, info, error). Incluye indicador opcional de texto/porcentaje.',
              files: {
                css: 'addons/progress/src/styles/progress.css',
                ts: 'addons/progress/src/ProgressProvider.ts'
              },
              variants: ['default', 'multi-color'],
              sizes: ['xs', 'sm', 'md', 'lg'],
              states: [],
              features: ['4 tamaÃ±os (xs: 4px, sm: 8px, md: 16px, lg: 20px)', '2 variantes (default, multi-color)', 'Progreso simple con valor 0-100', 'MÃºltiples segmentos con colores (yellow, green, gray, info, error)', 'Indicador opcional (texto o porcentaje)', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-progress-bar ubits-progress-bar--{size} ubits-progress-bar--{variant}',
              example: 'createProgressBar({\n  size: \'md\',\n  value: 75,\n  variant: \'default\',\n  indicator: true\n})',
              hasPreview: true
            }
          ],
          'Tablas y Datos': [
            {
              name: 'DataView',
              description: 'Componente DataView UBITS para mostrar listas de productos con imagen, categorÃ­a, nombre, rating, precio, botÃ³n de favoritos y botÃ³n de compra. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/data-view/src/styles/data-view.css',
                ts: 'addons/data-view/src/DataViewProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['3 tamaÃ±os (sm: imagen 80px, md: imagen 120px, lg: imagen 160px)', 'Imagen del producto con badge de stock', 'CategorÃ­a del producto opcional', 'Rating con estrellas opcional', 'Precio formateado opcional', 'BotÃ³n de favoritos (wishlist) opcional', 'BotÃ³n de compra opcional', 'Estados de stock (INSTOCK, LOWSTOCK, OUTOFSTOCK)', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-data-view ubits-data-view--md',
              example: 'createDataView({\n  products: [\n    { id: \'1\', image: \'/path/to/image.jpg\', category: \'Accessories\', name: \'Bamboo Watch\', rating: 5, price: 65, stockStatus: \'INSTOCK\', inWishlist: false },\n    { id: \'2\', image: \'/path/to/image.jpg\', category: \'Fitness\', name: \'Blue Band\', rating: 4, price: 79, stockStatus: \'LOWSTOCK\', inWishlist: false }\n  ],\n  size: \'md\',\n  showCategory: true,\n  showRating: true,\n  showPrice: true,\n  showWishlist: true,\n  showBuyButton: true,\n  buyButtonText: \'Buy Now\',\n  buyButtonIcon: \'shopping-cart\',\n  wishlistIcon: \'heart\'\n})',
              hasPreview: true
            },
            {
              name: 'Data Table',
              description: 'Componente Data Table - Tabla bÃ¡sica con estructura de columnas separadas: drag handle, expand icon, checkbox (con columna propia y header), y columnas de datos.',
              files: {
                css: 'addons/data-table/src/styles/data-table.css',
                ts: 'addons/data-table/src/DataTableProvider.ts'
              },
              variants: [],
              sizes: [],
              states: [],
              features: ['Columna 1: Drag handle para reordenar filas', 'Columna 2: Expand icon (chevron) para expandir/colapsar', 'Columna 3: Checkbox con header propio (select all)', 'Columnas de datos configurables', 'Drag & drop de columnas y filas', 'Filas expandibles', 'SelecciÃ³n mÃºltiple', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-data-table',
              example: 'createDataTable({\n  columns: [...],\n  rows: [...],\n  columnReorderable: true,\n  rowReorderable: true,\n  onRowSelect: (rowId, selected) => {},\n  onSelectAll: (selected) => {},\n  onRowExpand: (rowId, expanded) => {}\n})',
              hasPreview: true
            },
            {
              name: 'Pagination',
              description: 'Componente Pagination UBITS para paginaciÃ³n de datos usando tokens UBITS, tipografÃ­a UBITS y componentes UBITS. Ideal para tablas y listas de datos.',
              files: {
                css: 'addons/pagination/src/styles/pagination.css',
                ts: 'addons/pagination/src/PaginationProvider.ts'
              },
              variants: ['default', 'compact', 'minimal'],
              sizes: ['sm', 'md', 'lg'],
              states: [],
              features: ['Botones de navegaciÃ³n (primera, anterior, siguiente, Ãºltima)', 'PÃ¡ginas visibles con elipsis', 'InformaciÃ³n de items (1-10 de 100)', 'Selector de items por pÃ¡gina', 'Variantes: default, compact, minimal', 'TamaÃ±os: sm, md, lg', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-pagination',
              example: 'createPagination({\n  currentPage: 5,\n  totalPages: 20,\n  totalItems: 200,\n  itemsPerPage: 10,\n  variant: \'default\',\n  size: \'md\',\n  showInfo: true,\n  showItemsPerPage: true,\n  onPageChange: (page) => {},\n  onItemsPerPageChange: (itemsPerPage) => {}\n})',
              hasPreview: true
            },
            {
              name: 'Timeline',
              description: 'Componente Timeline UBITS para mostrar secuencias de eventos o fases. Soporta avatar, fecha, tÃ­tulo, descripciÃ³n, iconos y alineaciÃ³n izquierda o centrada. Usa tokens UBITS.',
              files: {
                css: 'addons/timeline/src/styles/timeline.css',
                ts: 'addons/timeline/src/TimelineProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'filled'],
              features: ['Avatar opcional en cada item', 'Fecha opcional', 'TÃ­tulo y descripciÃ³n', 'Iconos opcionales en marcadores', '2 alineaciones (left, center)', 'Estados de marcador (default, filled)', '4 items de ejemplo configurables', 'Usa tokens UBITS exclusivamente', 'Usa componente Avatar UBITS'],
              class: 'ubits-timeline ubits-timeline--{alignment}',
              example: 'renderTimeline({\n  showAvatar: false,\n  showDate: true,\n  showDescription: true,\n  showIcon: true,\n  alignment: \'left\',\n  filledItems: 2\n})',
              hasPreview: true
            },
            {
              name: 'Accordion',
              description: 'Componente Accordion UBITS con mÃºltiples variantes: lista simple, tipo caja, chevron izquierda/derecha, iconos opcionales y sub-headers.',
              files: {
                css: 'addons/accordion/src/styles/accordion.css',
                ts: 'addons/accordion/src/AccordionProvider.ts'
              },
              variants: ['list', 'boxed'],
              sizes: [],
              states: [],
              features: ['2 variantes (list, boxed)', 'Chevron izquierda/derecha', 'Iconos opcionales', 'Sub-headers opcionales', 'MÃºltiples items abiertos simultÃ¡neamente', 'Items abiertos por defecto', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-accordion ubits-accordion--{variant}',
              example: 'createAccordion(container, {\n  items: [\n    { id: \'1\', title: \'TÃ­tulo\', content: \'Contenido\', icon: \'command\', subHeader: \'Sub-header\' }\n  ],\n  variant: \'list\',\n  chevronPosition: \'right\',\n  allowMultiple: false,\n  showIcons: true\n})',
              hasPreview: true
            },
          ],
          'Contenido': [
            {
              name: 'Card Content',
              description: 'Componente para mostrar cards de contenido de aprendizaje. Incluye imagen, tÃ­tulo, proveedor, competencia, nivel, duraciÃ³n, idioma y barra de progreso. Soporta 11 tipos de contenido, 35 competencias oficiales y 3 estados (default, progress, completed).',
              files: {
                css: 'addons/card/src/styles/card.css',
                ts: 'addons/card/src/index.ts'
              },
              variants: [],
              sizes: [],
              states: ['default', 'progress', 'completed'],
              types: ['Curso', 'CÃ¡psula', 'Charla', 'ArtÃ­culo', 'Podcast', 'Libro', 'Ideas de libro', 'Caso de estudio', 'Documento tÃ©cnico', 'Ejercicios de prÃ¡ctica', 'Ruta de aprendizaje'],
              features: ['11 tipos de contenido', '35 competencias oficiales', '18 proveedores oficiales', '3 niveles (BÃ¡sico, Intermedio, Avanzado)', '9 duraciones oficiales', '3 idiomas', '3 estados', 'Barra de progreso animada', 'Imagen con zoom en hover', 'Aspect ratio 16:9', 'Avatar circular del proveedor', 'Iconos FontAwesome para specs'],
              class: 'course-card course-card[data-progress="{progress}"] course-card[data-status="{status}"]',
              example: 'loadCardContent({\n  containerId: \'cards-container\',\n  cards: [{\n    type: \'CÃ¡psula\',\n    title: \'Mi contenido\',\n    provider: \'UBITS\',\n    providerLogo: \'images/Favicons/UBITS.jpg\',\n    duration: \'15 min\',\n    level: \'BÃ¡sico\',\n    progress: 50,\n    status: \'progress\',\n    image: \'images/cards-learn/imagen.jpg\',\n    competency: \'Product design\',\n    language: \'EspaÃ±ol\'\n  }]\n})',
              hasPreview: true
            },
            {
              name: 'Selection Card',
              description: 'Componente Selection Card UBITS para mostrar opciones seleccionables. Soporta selecciÃ³n Ãºnica o mÃºltiple, estados (default, selected, disabled), y tamaÃ±os (sm, md, lg). Incluye un radio button visual a la derecha que refleja el estado de selecciÃ³n.',
              files: {
                css: 'addons/selection-card/src/styles/selection-card.css',
                ts: 'addons/selection-card/src/SelectionCardProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default', 'selected', 'disabled'],
              features: ['3 tamaÃ±os (sm, md, lg)', '3 estados (default, selected, disabled)', 'Icono opcional', 'DescripciÃ³n opcional', 'Contador de selecciÃ³n', 'Radio button visual', 'SelecciÃ³n Ãºnica o mÃºltiple', 'Usa tokens UBITS exclusivamente'],
              class: 'ubits-selection-card ubits-selection-card--{size} ubits-selection-card--{state}',
              example: 'createSelectionCard({\n  id: \'card-1\',\n  title: \'Asignar toda la empresa\',\n  description: \'Agregaras a todos los colaboradores...\',\n  icon: \'building\',\n  iconStyle: \'regular\',\n  selectionCount: { current: 0, total: 290 },\n  state: \'default\',\n  size: \'md\'\n})',
              hasPreview: true
            },
            {
              name: 'Simple Card',
              description: 'Componente Simple Card UBITS con header decorativo, contenido y botones de acciÃ³n. Usa tokens UBITS para colores, tipografÃ­a y espaciado. Incluye controladores completos para personalizar todos los aspectos del componente.',
              files: {
                css: 'addons/card/src/styles/simple-card.css',
                ts: 'addons/card/src/SimpleCardProvider.ts'
              },
              variants: ['default', 'elevated', 'bordered', 'flat'],
              sizes: ['sm', 'md', 'lg', 'xl'],
              states: ['default'],
              features: ['4 variantes (default, elevated, bordered, flat)', '4 tamaÃ±os (sm: 280px, md: 400px, lg: 560px, xl: 720px)', 'Header decorativo opcional con burbujas', 'TÃ­tulo, subtÃ­tulo y contenido personalizables', 'Botones de acciÃ³n configurables (primary, secondary, tertiary)', 'Controladores para tokens de color, tipografÃ­a y espaciado', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-simple-card ubits-simple-card--{variant} ubits-simple-card--{size}',
              example: 'createSimpleCard({\n  title: \'Advanced Card\',\n  subtitle: \'Card subtitle\',\n  content: \'Lorem ipsum...\',\n  showHeader: true,\n  headerDecorations: true,\n  variant: \'default\',\n  size: \'md\',\n  buttons: [\n    { label: \'Cancel\', variant: \'secondary\', size: \'md\' },\n    { label: \'Save\', variant: \'primary\', size: \'md\' }\n  ]\n})',
              hasPreview: true
            },
            {
              name: 'Carousel',
              description: 'Componente Carousel UBITS para mostrar mÃºltiples items (Simple Cards) en un carrusel navegable. Incluye flechas de navegaciÃ³n, indicadores de paginaciÃ³n (dots), autoplay, loop infinito y controladores completos. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/carousel/src/styles/carousel.css',
                ts: 'addons/carousel/src/CarouselProvider.ts'
              },
              variants: [],
              sizes: [],
              states: ['default'],
              features: ['Items basados en Simple Card', 'NÃºmero de items visibles configurable', 'Flechas de navegaciÃ³n opcionales (inside/outside)', 'Indicadores de paginaciÃ³n opcionales (top/bottom)', 'Autoplay configurable con intervalo', 'Loop infinito opcional', 'Espacio entre items configurable (gap)', 'Pausa en hover', 'Usa tokens UBITS exclusivamente', 'Usa componente Simple Card UBITS'],
              class: 'ubits-carousel ubits-carousel--arrows-inside ubits-carousel--dots-top',
              example: 'createCarousel({\n  items: [\n    { id: 1, title: \'Card 1\', subtitle: \'Subtitle 1\', content: \'Content 1\', variant: \'default\', size: \'md\' },\n    { id: 2, title: \'Card 2\', subtitle: \'Subtitle 2\', content: \'Content 2\', variant: \'default\', size: \'md\' },\n    { id: 3, title: \'Card 3\', subtitle: \'Subtitle 3\', content: \'Content 3\', variant: \'default\', size: \'md\' }\n  ],\n  itemsPerView: 3,\n  showArrows: true,\n  showDots: true,\n  autoplay: false,\n  loop: false,\n  gap: 16,\n  arrowPosition: \'outside\',\n  dotPosition: \'bottom\'\n})',
              hasPreview: true
            },
            {
              name: 'Gallery',
              description: 'Componente Gallery UBITS para mostrar imÃ¡genes en diferentes layouts (grid, masonry, list) con mÃºltiples tamaÃ±os, soporte para lightbox, lazy loading y thumbnails. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/gallery/src/styles/gallery.css',
                ts: 'addons/gallery/src/GalleryProvider.ts'
              },
              variants: [],
              sizes: ['xs', 'sm', 'md', 'lg', 'xl'],
              states: ['default'],
              features: ['3 layouts (grid, masonry, list)', '5 tamaÃ±os (xs, sm, md, lg, xl)', 'Lightbox con navegaciÃ³n y thumbnails', 'Lazy loading opcional', 'Thumbnails opcionales', 'Aspect ratio configurable', 'NÃºmero de columnas configurable', 'Gap configurable', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-gallery ubits-gallery--grid ubits-gallery--md',
              example: 'createGallery({\n  items: [\n    { id: 1, image: \'/path/to/image1.jpg\', thumbnail: \'/path/to/thumb1.jpg\', title: \'Imagen 1\', description: \'DescripciÃ³n\', alt: \'Alt text\' },\n    { id: 2, image: \'/path/to/image2.jpg\', thumbnail: \'/path/to/thumb2.jpg\', title: \'Imagen 2\', description: \'DescripciÃ³n\', alt: \'Alt text\' }\n  ],\n  layout: \'grid\',\n  size: \'md\',\n  columns: 3,\n  gap: 16,\n  showThumbnails: false,\n  lazyLoad: false,\n  lightbox: true,\n  aspectRatio: undefined\n})',
              hasPreview: true
            }
          ],
          'Charts': [
            {
              name: 'Text Metric Card',
              description: 'Componente Text Metric Card UBITS para mostrar mÃ©tricas numÃ©ricas. Usa tokens UBITS para colores, tipografÃ­a y espaciado. Soporta iconos, tamaÃ±os y es completamente personalizable.',
              files: {
                css: 'addons/metric-card/src/styles/metric-card.css',
                ts: 'addons/metric-card/src/MetricCardProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['3 tamaÃ±os (sm, md, lg)', 'Icono opcional en tÃ­tulo', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Valor numÃ©rico o texto', 'Label descriptivo', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS'],
              class: 'ubits-metric-card ubits-metric-card--md',
              example: 'createMetricCard({\n  title: \'Net confidence score\',\n  value: \'200 / 204\',\n  label: \'Colaboradores\',\n  titleIcon: \'user\',\n  titleIconStyle: \'regular\',\n  showInfoIcon: true,\n  showActionButton: true,\n  size: \'md\'\n})',
              hasPreview: true
            },
            {
              name: 'Bar Metric Card',
              description: 'Componente Bar Metric Card UBITS para mostrar mÃ©tricas con grÃ¡fico de barras y categorÃ­as. Soporta layout vertical y horizontal, mÃºltiples tamaÃ±os, valores positivos y negativos, y controles completos para personalizaciÃ³n. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/bar-metric-card/src/styles/bar-metric-card.css',
                ts: 'addons/bar-metric-card/src/BarMetricCardProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['Layout vertical y horizontal', '3 tamaÃ±os (sm, md, lg)', 'GrÃ¡fico de barras con valores positivos y negativos', 'CategorÃ­as con barras de progreso', 'LÃ­neas de guÃ­a (grid lines) opcionales', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Cantidad de respuestas opcional', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Progress Bar UBITS'],
              class: 'ubits-bar-metric-card ubits-bar-metric-card--vertical ubits-bar-metric-card--md',
              example: 'createBarMetricCard({\n  title: \'MÃ©tricas\',\n  responseCount: 120,\n  showResponseCount: true,\n  barData: [20, 30, -10, 40, 15],\n  barLabels: [\'Ene\', \'Feb\', \'Mar\', \'Abr\', \'May\'],\n  categories: [\n    { label: \'Ãrea\', current: 3, total: 20 },\n    { label: \'Equipo\', current: 5, total: 20 },\n    { label: \'Propio\', current: 12, total: 20 }\n  ],\n  layout: \'vertical\',\n  size: \'md\',\n  showTitle: true,\n  showBarChart: true,\n  showCategories: true\n})',
              hasPreview: true
            },
            {
              name: 'CSAT Metric Card',
              description: 'Componente CSAT Metric Card UBITS para mostrar mÃ©tricas CSAT (Customer Satisfaction) con caritas. Incluye tÃ­tulo, estadÃ­sticas (respuestas y promedio), grÃ¡fico de 5 caritas con textos. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/csat-metric-card/src/styles/csat-metric-card.css',
                ts: 'addons/csat-metric-card/src/CSATMetricCardProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['3 tamaÃ±os (sm, md, lg)', 'GrÃ¡fico de 5 caritas (Muy malo, Malo, Regular, Bueno, Muy bueno)', 'Score de 0-5 mapeado a caritas', 'EstadÃ­sticas de respuestas y promedio', 'Icono de tÃ­tulo opcional', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-csat-metric-card ubits-csat-metric-card--md',
              example: 'createCSATMetricCard({\n  title: \'Califica el producto\',\n  totalResponses: 7,\n  responsesLabel: \'respuestas\',\n  average: 4.00,\n  averageLabel: \'Promedio:\',\n  score: 3,\n  showInfoIcon: true,\n  showActionButton: true,\n  size: \'md\'\n})',
              hasPreview: true
            },
            {
              name: 'NPS Card',
              description: 'Componente NPS Card UBITS para mostrar mÃ©tricas NPS (Net Promoter Score) con gauge semicircular. Incluye segmentos de color (rojo, amarillo, verde), aguja indicadora, categorÃ­as con porcentajes y contador de respuestas. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/nps-card/src/styles/nps-card.css',
                ts: 'addons/nps-card/src/NPSCardProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['3 tamaÃ±os (sm, md, lg)', 'Gauge semicircular con segmentos de color', 'Score de 0-100 con aguja indicadora', 'CategorÃ­as con porcentajes', 'Contador de respuestas', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-nps-card ubits-nps-card--md',
              example: 'createNPSCard({\n  title: \'Nivel de confianza\',\n  score: 56,\n  scoreLabel: \'PuntuaciÃ³n\',\n  totalResponses: 290,\n  responsesLabel: \'respuestas\',\n  categories: [\n    { label: \'No tienen confianza\', current: 50, total: 100, color: \'var(--ubits-semantic-error)\' },\n    { label: \'Neutrales\', current: 10, total: 100, color: \'var(--ubits-semantic-warning)\' },\n    { label: \'Tienen confianza\', current: 30, total: 100, color: \'var(--ubits-semantic-success)\' }\n  ],\n  size: \'md\',\n  showTitle: true,\n  showResponsesCount: true,\n  showGauge: true,\n  showCategories: true\n})',
              hasPreview: true
            },
            {
              name: 'Circle Metric Card',
              description: 'Componente ProgressGeneralCard UBITS para mostrar progreso general con indicador circular (donut chart) y categorÃ­as de progreso. Soporta layout vertical y horizontal, mÃºltiples tamaÃ±os y controles completos para personalizaciÃ³n. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/progress-general-card/src/styles/progress-general-card.css',
                ts: 'addons/progress-general-card/src/ProgressGeneralCardProvider.ts'
              },
              variants: ['vertical', 'horizontal'],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['Layout vertical y horizontal', '3 tamaÃ±os (sm, md, lg)', 'Indicador circular (donut chart)', 'Porcentaje principal con etiqueta', 'Hasta 3 categorÃ­as de progreso', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Colores personalizables con tokens UBITS', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-progress-general-card ubits-progress-general-card--vertical ubits-progress-general-card--md',
              example: 'createProgressGeneralCard({\n  title: \'Progreso general\',\n  mainPercentage: 50,\n  mainLabel: \'Ciclos\',\n  categories: [\n    { label: \'Ãrea\', current: 3, total: 20 },\n    { label: \'Equipo\', current: 8, total: 50 },\n    { label: \'Propio\', current: 5, total: 30 }\n  ],\n  layout: \'horizontal\',\n  size: \'md\',\n  showTitle: true,\n  showCircularProgress: true,\n  showCategories: true,\n  showInfoIcon: true,\n  showActionButton: true\n})',
              hasPreview: true
            },
            {
              name: 'Score Card Metrics',
              description: 'Componente ScoreCardMetrics UBITS para mostrar mÃ©tricas de calificaciÃ³n con estrellas. Incluye tÃ­tulo, estadÃ­sticas (respuestas y promedio), grÃ¡fico de 5 estrellas, etiquetas y descripciÃ³n. Usa tokens UBITS para colores, tipografÃ­a y espaciado.',
              files: {
                css: 'addons/score-card-metrics/src/styles/score-card-metrics.css',
                ts: 'addons/score-card-metrics/src/ScoreCardMetricsProvider.ts'
              },
              variants: [],
              sizes: ['sm', 'md', 'lg'],
              states: ['default'],
              features: ['3 tamaÃ±os (sm, md, lg)', 'GrÃ¡fico de 5 estrellas con score', 'EstadÃ­sticas de respuestas y promedio', 'Etiquetas izquierda y derecha configurables', 'Icono de tÃ­tulo opcional', 'Icono de informaciÃ³n opcional', 'BotÃ³n de acciÃ³n opcional', 'Usa tokens UBITS exclusivamente', 'Usa tipografÃ­a UBITS', 'Usa componente Button UBITS'],
              class: 'ubits-score-card-metrics ubits-score-card-metrics--md',
              example: 'createScoreCardMetrics({\n  title: \'Califica el producto\',\n  totalResponses: 7,\n  responsesLabel: \'respuestas\',\n  average: 4.00,\n  averageLabel: \'Promedio:\',\n  score: 3,\n  leftLabel: \'0\',\n  rightLabel: \'5\',\n  showInfoIcon: true,\n  showActionButton: true,\n  size: \'md\'\n})',
              hasPreview: true
            }
          ]
        };
        
        // Componente activo actualmente
        let activeComponent = null;

        // Generar navegaciÃ³n lateral de componentes usando TreeMenu
        function generateComponentsNav() {
          console.log('ğŸ”„ generateComponentsNav llamado');
          
          // Re-obtener el elemento por si cambiÃ³
          const nav = document.getElementById('components-nav');
          if (!nav) {
            console.error('âŒ components-nav NO encontrado en DOM');
            return false;
          }

          console.log('âœ… components-nav encontrado, generando TreeMenu...');

          const categories = Object.keys(componentsInventory);
          let firstComponentId = null;
          let activeComponentId = activeComponent;

          // Convertir estructura a TreeMenu
          const treeData = categories.map((category, catIndex) => {
            const components = componentsInventory[category];
            const categoryId = category.toLowerCase().replace(/\s+/g, '-');
            const isFirstCategory = catIndex === 0;
            const isExpanded = isFirstCategory 
              ? (localStorage.getItem(`category-${categoryId}-expanded`) !== 'false')
              : (localStorage.getItem(`category-${categoryId}-expanded`) === 'true');
            
            const children = components.map((component, compIndex) => {
              const componentId = component.name.toLowerCase().replace(/\s+/g, '-');
              
              const isFirst = catIndex === 0 && compIndex === 0;
              if (isFirst && !firstComponentId) {
                firstComponentId = componentId;
              }
              
              return {
                label: component.name,
                id: componentId,
                dataId: componentId,
                defaultExpanded: false
              };
            });
            
            return {
              label: category,
              id: categoryId,
              dataId: categoryId,
              defaultExpanded: isExpanded,
              children: children
            };
          });

          // Renderizar TreeMenu
          renderTreeMenuFromData('components-nav', treeData, {
            showIcons: false,
            showChevron: true,
            size: 'md',
            cascade: true,
            activeNodeId: activeComponentId || firstComponentId,
            onNodeClick: (itemId, content) => {
              // Verificar si es un componente (no una categorÃ­a)
              const allComponents = Object.values(componentsInventory).flat();
              const isComponent = allComponents.some(comp => comp.name.toLowerCase().replace(/\s+/g, '-') === itemId);
              
              if (isComponent) {
                handleComponentNavClick(null, itemId);
              } else {
                // Es una categorÃ­a, guardar estado de expansiÃ³n
                const categoryId = itemId;
                const nodeId = content.getAttribute('data-node-id');
                const children = nav.querySelector(`[data-children-id="${nodeId}"]`);
                const isExpanded = children && children.style.display !== 'none';
                localStorage.setItem(`category-${categoryId}-expanded`, isExpanded);
              }
            }
          });
          
          const linkCount = Object.values(componentsInventory).flat().length;
          console.log(`âœ… TreeMenu generado: ${linkCount} componentes`);
          
          // Actualizar contador del tÃ­tulo principal "CategorÃ­as"
          const componentsCategoryTitle = document.getElementById('components-category-title');
          if (componentsCategoryTitle) {
            const total = Object.values(componentsInventory).flat().length;
            const countSpan = componentsCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              countSpan.textContent = `${total} ${total === 1 ? 'componente' : 'componentes'}`;
            }
          }

          return firstComponentId;
        }
        
        // FunciÃ³n para toggle de categorÃ­as (colapsar/expandir) - debe ser global
        window.toggleCategory = function(categoryId) {
          const categoryContent = document.querySelector(`.category-content[data-category="${categoryId}"]`);
          const categoryTitle = document.querySelector(`.category-toggle[data-category="${categoryId}"]`);
          
          if (!categoryContent || !categoryTitle) return;
          
          const isExpanded = categoryContent.style.display !== 'none';
          const chevron = categoryTitle.querySelector('i');
          
          if (isExpanded) {
            categoryContent.style.display = 'none';
            if (chevron) {
              chevron.classList.remove('fa-chevron-down');
              chevron.classList.add('fa-chevron-right');
            }
            localStorage.setItem(`category-${categoryId}-expanded`, 'false');
          } else {
            categoryContent.style.display = 'flex';
            categoryContent.style.flexDirection = 'column';
            categoryContent.style.gap = '6px';
            if (chevron) {
              chevron.classList.remove('fa-chevron-right');
              chevron.classList.add('fa-chevron-down');
            }
            localStorage.setItem(`category-${categoryId}-expanded`, 'true');
          }
        }
        
        // FunciÃ³n global para manejar clicks en navegaciÃ³n (mÃ¡s robusta)
        // FunciÃ³n para cargar dinÃ¡micamente un componente (como los colores)
        function loadComponent(componentId) {
          console.log('ğŸ“¦ Cargando componente:', componentId);
          
          // Ocultar todos los componentes
          document.querySelectorAll('[id^="component-"]').forEach(el => {
            el.style.display = 'none';
          });
          
          // Actualizar estado activo en el sidebar
          document.querySelectorAll('#components-nav .side-link').forEach(link => {
            link.classList.remove('active');
          });
          const activeLink = document.querySelector(`#components-nav .side-link[data-component="${componentId}"]`);
          if (activeLink) {
            activeLink.classList.add('active');
          }
          
          // Buscar y mostrar el componente solicitado
          const component = Object.values(componentsInventory).flat().find(c => {
            const id = c.name.toLowerCase().replace(/\s+/g, '-');
            return id === componentId;
          });
          
          if (component) {
            const componentElement = document.getElementById(`component-${componentId}`);
            if (componentElement) {
              componentElement.style.display = '';
              
              // Si tiene preview, inicializarlo
              if (component.hasPreview) {
                setTimeout(() => {
                  if (componentId === 'button' && typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  } else if (componentId === 'badge' && typeof window.updateBadgePreview === 'function') {
                    window.updateBadgePreview('badge');
                  } else if (componentId === 'status-tag' && typeof window.updateStatusTagPreview === 'function') {
                    window.updateStatusTagPreview('status-tag');
                  } else if (componentId === 'chip' && typeof window.updateChipPreview === 'function') {
                    window.updateChipPreview('chip');
                  } else if (componentId === 'radio-button' && typeof window.updateRadioButtonPreview === 'function') {
                    window.updateRadioButtonPreview('radio-button');
                  } else if (componentId === 'checkbox' && typeof window.updateCheckboxPreview === 'function') {
                    window.updateCheckboxPreview('checkbox');
                  } else if (componentId === 'toggle' && typeof window.updateTogglePreview === 'function') {
                    window.updateTogglePreview('toggle');
                  } else if (componentId === 'search-button' && typeof window.updateSearchButtonPreview === 'function') {
                    window.updateSearchButtonPreview('search-button');
                  } else if (componentId === 'data-table') {
                    if (typeof window.updateDataTablePreview === 'function') {
                      window.updateDataTablePreview('data-table');
                    }
                    setTimeout(() => {
                      if (typeof window.initDataTableAccordions === 'function') {
                        window.initDataTableAccordions('data-table');
                      }
                    }, 150);
                  } else if (componentId === 'pagination' && typeof window.updatePaginationPreview === 'function') {
                    window.updatePaginationPreview('pagination');
                  } else if (componentId === 'accordion' && typeof window.updateAccordionPreview === 'function') {
                    window.updateAccordionPreview('accordion');
                  } else if (componentId === 'selection-card' && typeof window.updateSelectionCardPreview === 'function') {
                    window.updateSelectionCardPreview('selection-card');
                  } else if (componentId === 'stepper' && typeof window.updateStepperPreview === 'function') {
                    window.updateStepperPreview('stepper');
                  } else if (componentId === 'timeline' && typeof window.updateTimelinePreview === 'function') {
                    window.updateTimelinePreview('timeline');
                  } else if (componentId === 'avatar' && typeof window.updateAvatarPreview === 'function') {
                    window.updateAvatarPreview('avatar');
                  } else if (componentId === 'drawer-navigation' && typeof window.updateDrawerPreview === 'function') {
                    window.updateDrawerPreview('drawer-navigation');
                  } else if (componentId === 'modal' && typeof window.updateModalPreview === 'function') {
                    window.updateModalPreview('modal');
                  } else if (componentId === 'popover' && typeof window.updatePopoverPreview === 'function') {
                    window.updatePopoverPreview('popover');
                  } else if (componentId === 'tooltip' && typeof window.updateTooltipPreview === 'function') {
                    window.updateTooltipPreview('tooltip');
                  } else if (componentId === 'scrollbar' && typeof window.updateScrollbarPreview === 'function') {
                    window.updateScrollbarPreview('scrollbar');
                  } else if (componentId === 'calendar' && typeof window.updateCalendarPreview === 'function') {
                    window.updateCalendarPreview('calendar');
                  } else if (componentId === 'slider' && typeof window.updateSliderPreview === 'function') {
                    try {
                      window.updateSliderPreview('slider');
                    } catch (e) {
                      // Silently handle errors
                    }
                  } else if (componentId === 'progress-bar' && typeof window.updateProgressBarPreview === 'function') {
                    window.updateProgressBarPreview('progress-bar');
                  } else if (componentId === 'file-upload' && typeof window.updateFileUploadPreview === 'function') {
                    window.updateFileUploadPreview('file-upload');
                  } else if (componentId === 'alert' && typeof window.updateAlertPreview === 'function') {
                    window.updateAlertPreview('alert');
                    initializeAlertPreview('alert');
                  } else if (componentId === 'spinner' && typeof window.updateSpinnerPreview === 'function') {
                    window.updateSpinnerPreview('spinner');
                  } else if (componentId === 'empty-state' && typeof window.updateEmptyStatePreview === 'function') {
                    window.updateEmptyStatePreview('empty-state');
                  } else if (componentId === 'skeleton' && typeof window.updateSkeletonPreview === 'function') {
                    window.updateSkeletonPreview('skeleton');
                  } else if (componentId === 'toast') {
                    // Toast se inicializa automÃ¡ticamente cuando se hace clic en los botones
                    ensureToastContainer();
                  } else if (componentId === 'input' && typeof window.updateInputPreview === 'function') {
                    window.updateInputPreview('input');
                  } else if (componentId === 'list' && typeof window.updateListPreview === 'function') {
                    window.updateListPreview('list');
                  } else if (componentId === 'sidebar' && typeof window.updateSidebarPreview === 'function') {
                    window.updateSidebarPreview('sidebar');
                  } else if (componentId === 'subnav' && typeof window.updateSubNavPreview === 'function') {
                    window.updateSubNavPreview('subnav');
                  } else if (componentId === 'tabbar' && typeof window.updateTabBarPreview === 'function') {
                    window.updateTabBarPreview('tabbar');
                    // Inicializar estado del controlador de variante
                    setTimeout(() => {
                      const state = window.initTabBarPreviewState ? window.initTabBarPreviewState('tabbar') : { variant: 'colaborador' };
                      const buttons = document.querySelectorAll('[data-component="tabbar"][data-option="variant"]');
                      buttons.forEach(btn => {
                        if (btn.getAttribute('data-value') === state.variant) {
                          btn.classList.add('active');
                        } else {
                          btn.classList.remove('active');
                        }
                      });
                    }, 150);
                  } else if (componentId === 'tabs' && typeof window.updateTabsPreview === 'function') {
                    window.updateTabsPreview('tabs');
                  } else if (componentId === 'segment-control' && typeof window.updateSegmentControlPreview === 'function') {
                    window.updateSegmentControlPreview('segment-control');
                  } else if (componentId === 'breadcrumb' && typeof window.updateBreadcrumbPreview === 'function') {
                    window.updateBreadcrumbPreview('breadcrumb');
                  } else if (componentId === 'card-content' && typeof window.updateCardPreview === 'function') {
                    window.updateCardPreview('card-content');
                  } else if (componentId === 'simple-card' && typeof window.updateSimpleCardPreview === 'function') {
                    window.updateSimpleCardPreview('simple-card');
                  } else if (componentId === 'carousel' && typeof window.updateCarouselPreview === 'function') {
                    window.updateCarouselPreview('carousel');
                  } else if (componentId === 'bar-metric-card' && typeof window.updateBarMetricCardPreview === 'function') {
                    window.updateBarMetricCardPreview('bar-metric-card');
                  } else if (componentId === 'text-metric-card' && typeof window.updateTextMetricCardPreview === 'function') {
                    window.updateTextMetricCardPreview('text-metric-card');
                  } else if (componentId === 'nps-card' && typeof window.updateNPSCardPreview === 'function') {
                    window.updateNPSCardPreview('nps-card');
                  } else if (componentId === 'csat-metric-card' && typeof window.updateCSATMetricCardPreview === 'function') {
                    window.updateCSATMetricCardPreview('csat-metric-card');
                  } else if (componentId === 'circle-metric-card' && typeof window.updateCircleMetricCardPreview === 'function') {
                    if (typeof initCircleMetricCardPreviewState === 'function') {
                      initCircleMetricCardPreviewState('circle-metric-card');
                    }
                    window.updateCircleMetricCardPreview('circle-metric-card');
                  } else if (componentId === 'score-card-metrics' && typeof window.updateScoreCardMetricsPreview === 'function') {
                    if (typeof initScoreCardMetricsPreviewState === 'function') {
                      initScoreCardMetricsPreviewState('score-card-metrics');
                    }
                    window.updateScoreCardMetricsPreview('score-card-metrics');
                  } else if (componentId === 'dataview' && typeof window.updateDataViewPreview === 'function') {
                    window.updateDataViewPreview('dataview');
                  } else if (componentId === 'gallery' && typeof window.updateGalleryPreview === 'function') {
                    window.updateGalleryPreview('gallery');
                  } else if (componentId === 'menu' && typeof window.updateMenuPreview === 'function') {
                    window.updateMenuPreview('menu');
                  } else if (componentId === 'menubar' && typeof window.updateMenubarPreview === 'function') {
                    window.updateMenubarPreview('menubar');
                  } else if (componentId === 'treemenu' && typeof window.updateTreeMenuPreview === 'function') {
                    window.updateTreeMenuPreview('treemenu');
                  } else if (componentId === 'menu-de-participantes' && typeof window.updateParticipantsMenuPreview === 'function') {
                    window.updateParticipantsMenuPreview('menu-de-participantes');
                  } else if (componentId === 'contenedor' && typeof window.updateContenedorPreview === 'function') {
                    window.updateContenedorPreview('contenedor');
                  }
                }, 100);
              }
              
              activeComponent = componentId;
              
              // Actualizar estado activo en TreeMenu
              const nav = document.getElementById('components-nav');
              if (nav) {
                const treeMenu = nav.querySelector('.ubits-tree-menu');
                if (treeMenu) {
                  // Remover active de todos los nodos
                  treeMenu.querySelectorAll('.ubits-tree-node__content').forEach(node => {
                    node.classList.remove('ubits-tree-node__content--active');
                    node.removeAttribute('aria-selected');
                  });
                  
                  // Agregar active al nodo correspondiente
                  const activeNode = treeMenu.querySelector(`[data-item-id="${componentId}"]`);
                  if (activeNode) {
                    activeNode.classList.add('ubits-tree-node__content--active');
                    activeNode.setAttribute('aria-selected', 'true');
                    
                    // Expandir categorÃ­a padre si estÃ¡ colapsada
                    const parentChildren = activeNode.closest('.ubits-tree-node__children');
                    if (parentChildren && parentChildren.style.display === 'none') {
                      const childrenId = parentChildren.getAttribute('data-children-id');
                      // Buscar el nodo padre que tiene este childrenId
                      const parentContent = treeMenu.querySelector(`.ubits-tree-node__content[data-node-id="${childrenId}"]`);
                      if (parentContent && parentContent.classList.contains('ubits-tree-node__content--expandable')) {
                        // Expandir la categorÃ­a
                        parentChildren.style.display = 'block';
                        parentContent.setAttribute('data-expanded', 'true');
                        parentContent.setAttribute('aria-expanded', 'true');
                        const chevron = parentContent.querySelector('.ubits-tree-node__chevron i');
                        if (chevron) {
                          chevron.className = 'far fa-chevron-down';
                        }
                      }
                    }
                  }
                }
              }
              
              return true;
            } else {
              console.error('âŒ Elemento del componente no encontrado:', `component-${componentId}`);
              return false;
            }
          } else {
            console.error('âŒ Componente no encontrado en inventario:', componentId);
            return false;
          }
        }
        
        // FunciÃ³n para manejar clicks en navegaciÃ³n de componentes
        window.handleComponentNavClick = function(event, componentId) {
          console.log('ğŸ¯ handleComponentNavClick llamado con:', componentId);
          
          if (!componentId) {
            console.error('âŒ componentId no proporcionado');
            return;
          }
          
          // Prevenir comportamiento por defecto del link
          if (event) {
            event.preventDefault();
            event.stopPropagation();
          }
          
          // Cargar el componente dinÃ¡micamente (como los colores)
          loadComponent(componentId);
        };

        // Scroll a componente (mantenido por compatibilidad)
        function scrollToComponent(componentId) {
          console.log('ğŸ“œ scrollToComponent llamado para:', componentId);
          
          if (!componentId) {
            console.error('âŒ componentId no proporcionado');
            return;
          }
          
          const elementId = `component-${componentId}`;
          console.log('ğŸ” Buscando elemento:', elementId);
          
          let element = document.getElementById(elementId);
          
          // Si no se encuentra, intentar despuÃ©s de un pequeÃ±o delay (por si aÃºn se estÃ¡ renderizando)
          if (!element) {
            console.warn('âš ï¸ Elemento no encontrado inmediatamente, esperando 100ms...');
            setTimeout(() => {
              element = document.getElementById(elementId);
              if (element) {
                performScroll(element, componentId);
              } else {
                console.error(`âŒ No se encontrÃ³ elemento: ${elementId}`);
                console.log('ğŸ“‹ Elementos disponibles:', Array.from(document.querySelectorAll('[id^="component-"]')).map(el => el.id));
              }
            }, 100);
            return;
          }
          
          performScroll(element, componentId);
        }
        
        // FunciÃ³n auxiliar para realizar el scroll
        function performScroll(element, componentId) {
          console.log('ğŸ“ Realizando scroll a:', element.id);
          
          // Scroll con offset para el header sticky
          const offset = 100;
          const rect = element.getBoundingClientRect();
          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          const elementPosition = rect.top + scrollTop;
          const offsetPosition = elementPosition - offset;

          // MÃºltiples mÃ©todos de scroll para mÃ¡xima compatibilidad
          try {
            window.scrollTo({
              top: offsetPosition,
              behavior: 'smooth'
            });
          } catch (e) {
            window.scrollTo(0, offsetPosition);
          }
          
          // Fallback adicional
          setTimeout(() => {
            element.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start', 
              inline: 'nearest' 
            });
          }, 50);
          
          // Resaltar el elemento (opcional, ayuda visual)
          element.style.transition = 'box-shadow 0.3s ease';
          element.style.boxShadow = '0 0 0 3px var(--ubits-button-focus-ring, rgba(82, 151, 244, 0.3))';
          setTimeout(() => {
            element.style.boxShadow = '';
          }, 1000);
          
          // Si es Button, inicializar el preview despuÃ©s del scroll
          if (componentId === 'button') {
            console.log('ğŸ¯ Componente Button detectado, inicializando preview...');
            setTimeout(() => {
              const buttonPreview = document.getElementById('button-preview-button');
              console.log('ğŸ” Preview encontrado despuÃ©s de scroll:', buttonPreview ? 'âœ…' : 'âŒ');
              
              if (buttonPreview) {
                const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
                console.log('ğŸ“‹ Preview tiene contenido:', hasContent);
                
                if (!hasContent) {
                  console.log('ğŸ”„ Inicializando preview de Button despuÃ©s de scroll...');
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  } else {
                    console.error('âŒ window.updateButtonPreview no estÃ¡ disponible');
                  }
                } else {
                  console.log('âœ… Preview ya tiene contenido');
                }
              } else {
                console.warn('âš ï¸ Preview no encontrado, reintentando...');
                setTimeout(() => {
                  const retry = document.getElementById('button-preview-button');
                  if (retry && retry.innerHTML.trim() === '') {
                    if (typeof window.updateButtonPreview === 'function') {
                      window.updateButtonPreview('button');
                    }
                  }
                }, 300);
              }
            }, 600);
          }
        }

        // Renderizar inventario de componentes
        function renderComponents() {
          if (!componentsContainer) {
            console.error('âŒ components-container no encontrado en renderComponents');
            return;
          }
          
          console.log('ğŸ¨ ========== INICIANDO RENDERIZADO DE COMPONENTES ==========');
          console.log('ğŸ“¦ Contenedor:', componentsContainer);
          console.log('ğŸ“¦ Contenedor ID:', componentsContainer.id);
          console.log('ğŸ“¦ Contenedor padre:', componentsContainer.parentElement?.id || 'N/A');

          const categories = Object.keys(componentsInventory);
          console.log('ğŸ“Š CategorÃ­as encontradas:', categories);
          console.log('ğŸ“Š Inventario completo:', componentsInventory);
          
          const htmlString = categories.map(category => {
            const components = componentsInventory[category];
            return components.map(component => {
              const componentId = component.name.toLowerCase().replace(/\s+/g, '-');
              const hasPreview = component.hasPreview === true;
              return `
                    <div id="component-${componentId}" style="display: none; border: none; border-radius: 12px; padding: 24px; background: var(--ubits-bg-1); scroll-margin-top: 80px;">
                      <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 16px;">
                        <div>
                          <h3 style="margin: 0 0 8px 0; color: var(--ubits-fg-1-high); font-size: 20px; font-weight: 600;">
                            ${component.name}
                          </h3>
                          <p style="margin: 0; color: var(--ubits-fg-1-medium); font-size: 14px; line-height: 1.5;">
                            ${component.description}
                          </p>
                        </div>
                      </div>
                      
                      ${hasPreview && component.name === 'Button' ? `
                        <!-- Preview Section for Button - REDISEÃ‘ADO -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="primary" onclick="setButtonControl('variant', 'primary', '${componentId}')">
                                    <span>Primario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="secondary" onclick="setButtonControl('variant', 'secondary', '${componentId}')">
                                    <span>Secundario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="tertiary" onclick="setButtonControl('variant', 'tertiary', '${componentId}')">
                                    <span>Terciario</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="size-select-${componentId}" onchange="setButtonControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="xs">XS (24px)</option>
                                  <option value="sm">SM (32px)</option>
                                  <option value="md" selected>MD (36px)</option>
                                  <option value="lg">LG (48px)</option>
                                </select>
                              </div>
                              
                              <!-- Icono -->
                              <div style="flex: 1 1 auto; min-width: 280px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="icon" data-value="left" onclick="setButtonControl('icon', 'left', '${componentId}')">
                                    <i class="far fa-align-left" style="font-size: 12px;"></i>
                                    <span>Izquierda</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="right" onclick="setButtonControl('icon', 'right', '${componentId}')">
                                    <i class="far fa-align-right" style="font-size: 12px;"></i>
                                    <span>Derecha</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="only" onclick="setButtonControl('icon', 'only', '${componentId}')">
                                    <i class="far fa-circle" style="font-size: 12px;"></i>
                                    <span>Solo Icono</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="icon" data-value="none" onclick="setButtonControl('icon', 'none', '${componentId}')">
                                    <span>Sin Icono</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Badge -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Badge</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="badge-toggle-${componentId}" onchange="setButtonControl('badge', this.checked ? 'yes' : 'no', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="badge-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Loading -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Cargando</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="loading-toggle-${componentId}" onchange="setButtonControl('loading', this.checked ? 'yes' : 'no', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="loading-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Dropdown -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Dropdown</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="dropdown-toggle-${componentId}" onchange="setButtonControl('dropdown', this.checked ? 'yes' : 'no', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="dropdown-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Tooltip (solo visible cuando iconPosition === 'only') -->
                              <div id="tooltip-control-${componentId}" style="flex: 1 1 auto; min-width: 280px; display: none;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tooltip (Solo Icono)</label>
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                  <div style="display: flex; align-items: center; gap: 12px;">
                                    <label class="ubits-toggle ubits-toggle--md">
                                      <input type="checkbox" class="ubits-toggle__input" id="tooltip-toggle-${componentId}" onchange="setButtonControl('tooltip', this.checked ? 'yes' : 'no', '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span id="tooltip-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                  </div>
                                  <input type="text" id="tooltip-text-input-${componentId}" value="Tooltip del botÃ³n" onchange="setButtonControl('tooltipText', this.value, '${componentId}')" placeholder="Texto del tooltip" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                              
                              <!-- Estado Visual -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado Visual</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="state" data-value="default" onclick="setButtonControl('state', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="hover" onclick="setButtonControl('state', 'hover', '${componentId}')">
                                    <span>Hover</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="active" onclick="setButtonControl('state', 'active', '${componentId}')">
                                    <span>Active</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="focus" onclick="setButtonControl('state', 'focus', '${componentId}')">
                                    <span>Focus</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="disabled" onclick="setButtonControl('state', 'disabled', '${componentId}')">
                                    <span>Disabled</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="loading" onclick="setButtonControl('state', 'loading', '${componentId}')">
                                    <span>Loading</span>
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="button-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Badge' ? `
                        <!-- Preview Section for Badge -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Dot vs Number) -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="number" onclick="setBadgeControl('type', 'number', '${componentId}')">
                                    <span>Con NÃºmero</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="dot" onclick="setBadgeControl('type', 'dot', '${componentId}')">
                                    <span>Solo Bolita</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="success" onclick="setBadgeControl('variant', 'success', '${componentId}')">
                                    <span>Ã‰xito</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="warning" onclick="setBadgeControl('variant', 'warning', '${componentId}')">
                                    <span>Advertencia</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="error" onclick="setBadgeControl('variant', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="info" onclick="setBadgeControl('variant', 'info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="badge-size-select-${componentId}" onchange="setBadgeControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- Contenido (solo si es tipo number) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contenido</label>
                                <input type="text" id="badge-content-input-${componentId}" value="5" onchange="setBadgeControl('content', this.value, '${componentId}')" placeholder="5" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                            </div>
                            
                            <!-- Segunda fila de controles: Label -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-top: 24px;">
                              <!-- Mostrar Label (Toggle) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Label</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="badge-show-label-toggle-${componentId}" onchange="setBadgeControl('showLabel', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="badge-label-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Texto del Label -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto del Label</label>
                                <input type="text" id="badge-label-input-${componentId}" value="Notificaciones" onchange="setBadgeControl('label', this.value, '${componentId}')" placeholder="Notificaciones" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- TipografÃ­a del Label -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TipografÃ­a Label</label>
                                <select id="badge-label-typography-select-${componentId}" onchange="setBadgeControl('labelTypography', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="ubits-body-sm-regular">Body SM Regular</option>
                                  <option value="ubits-body-sm-semibold">Body SM Semibold</option>
                                  <option value="ubits-body-sm-bold">Body SM Bold</option>
                                  <option value="ubits-body-md-regular" selected>Body MD Regular</option>
                                  <option value="ubits-body-md-semibold">Body MD Semibold</option>
                                  <option value="ubits-body-md-bold">Body MD Bold</option>
                                  <option value="ubits-heading-h1">Heading H1</option>
                                  <option value="ubits-heading-h2">Heading H2</option>
                                </select>
                              </div>
                            </div>
                            
                            <!-- Tercera fila de controles: Variante 2 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-top: 24px;">
                              <!-- Variante 2 -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante 2</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant2" data-value="light" onclick="setBadgeControl('variant2', 'light', '${componentId}')">
                                    <span>Light</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant2" data-value="neutral" onclick="setBadgeControl('variant2', 'neutral', '${componentId}')">
                                    <span>Neutral</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant2" data-value="bold" onclick="setBadgeControl('variant2', 'bold', '${componentId}')">
                                    <span>Bold</span>
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="badge-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Status Tag' ? `
                        <!-- Preview Section for Status Tag -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="status-tag-size-select-${componentId}" onchange="setStatusTagControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="status-tag-status-select-${componentId}" onchange="setStatusTagControl('status', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="completed">Completado</option>
                                  <option value="published">Publicado</option>
                                  <option value="fulfilled">CumpliÃ³</option>
                                  <option value="created">Creado</option>
                                  <option value="active">Activo</option>
                                  <option value="not-fulfilled">No cumpliÃ³</option>
                                  <option value="denied">Denegado</option>
                                  <option value="draft">Borrador</option>
                                  <option value="in-progress">En progreso</option>
                                  <option value="syncing">Sincronizando</option>
                                  <option value="pending">Pendiente</option>
                                  <option value="pending-approval">Por aprobar</option>
                                  <option value="not-started">Por iniciar</option>
                                  <option value="finished">Finalizado</option>
                                  <option value="archived">Archivado</option>
                                  <option value="disabled">Desactivado</option>
                                  <option value="paused">Pausado</option>
                                  <option value="hidden">Oculto</option>
                                </select>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px; max-width: 100%; box-sizing: border-box;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto</label>
                                <input type="text" id="status-tag-label-input-${componentId}" value="Completado" onchange="setStatusTagControl('label', this.value, '${componentId}')" placeholder="Texto del tag" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono Izquierdo -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Izquierdo</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="status-tag-left-icon-toggle-${componentId}" checked onchange="setStatusTagControl('leftIcon', this.checked ? 'grid-2' : null, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="status-tag-left-icon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Icono Derecho -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Derecho</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="status-tag-right-icon-toggle-${componentId}" checked onchange="setStatusTagControl('rightIcon', this.checked ? 'chevron-down' : null, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="status-tag-right-icon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Clickeable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Clickeable</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="status-tag-clickable-toggle-${componentId}" onchange="setStatusTagControl('clickable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="status-tag-clickable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="status-tag-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Chip' ? `
                        <!-- Preview Section for Chip -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="chip-size-select-${componentId}" onchange="setChipControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS (20px)</option>
                                  <option value="sm">SM (24px)</option>
                                  <option value="md" selected>MD (28px)</option>
                                  <option value="lg">LG (36px)</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="chip-state-select-${componentId}" onchange="setChipControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="pressed">Pressed</option>
                                  <option value="focus">Focus</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto</label>
                                <input type="text" id="chip-label-input-${componentId}" value="Chip" onchange="setChipControl('label', this.value, '${componentId}')" placeholder="Texto del chip" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono izquierdo -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Izquierdo</label>
                                <input type="text" id="chip-left-icon-input-${componentId}" value="" onchange="const toggle = document.getElementById('chip-left-icon-toggle-${componentId}'); if (this.value) { toggle.checked = true; setChipControl('leftIcon', this.value, '${componentId}'); } else { toggle.checked = false; setChipControl('leftIcon', null, '${componentId}'); }" placeholder="tag, user, etc." style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 8px;">
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="chip-left-icon-toggle-${componentId}" onchange="const input = document.getElementById('chip-left-icon-input-${componentId}'); const iconValue = this.checked ? (input.value || 'tag') : null; setChipControl('leftIcon', iconValue, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="chip-left-icon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                              
                              <!-- Closable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Cerrar</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="chip-closable-toggle-${componentId}" onchange="setChipControl('closable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="chip-closable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                              
                              <!-- Clickeable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Clickeable</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="chip-clickable-toggle-${componentId}" onchange="setChipControl('clickable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="chip-clickable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="chip-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Radio Button' ? `
                        <!-- Preview Section for Radio Button -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="radio-button-size-select-${componentId}" onchange="setRadioButtonControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (16px)</option>
                                  <option value="md" selected>MD (20px)</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="radio-button-state-select-${componentId}" onchange="setRadioButtonControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                <input type="text" id="radio-button-label-input-${componentId}" value="Label" onchange="setRadioButtonControl('label', this.value, '${componentId}')" placeholder="Texto del label" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Complementary Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto Complementario</label>
                                <input type="text" id="radio-button-complementary-text-input-${componentId}" value="" onchange="setRadioButtonControl('complementaryText', this.value, '${componentId}')" placeholder="Texto complementario (opcional)" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Checked -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Seleccionado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="radio-button-checked-toggle-${componentId}" onchange="setRadioButtonControl('checked', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="radio-button-checked-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="radio-button-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Checkbox' ? `
                        <!-- Preview Section for Checkbox -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="checkbox-size-select-${componentId}" onchange="setCheckboxControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (16px)</option>
                                  <option value="md" selected>MD (20px)</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="checkbox-state-select-${componentId}" onchange="setCheckboxControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                  <option value="indeterminate">Indeterminado</option>
                                </select>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                <input type="text" id="checkbox-label-input-${componentId}" value="Label" onchange="setCheckboxControl('label', this.value, '${componentId}')" placeholder="Texto del label" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Complementary Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto Complementario</label>
                                <input type="text" id="checkbox-complementary-text-input-${componentId}" value="" onchange="setCheckboxControl('complementaryText', this.value, '${componentId}')" placeholder="Texto complementario (opcional)" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Checked -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Seleccionado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="checkbox-checked-toggle-${componentId}" onchange="setCheckboxControl('checked', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="checkbox-checked-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                              
                              <!-- Indeterminate -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Indeterminado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="checkbox-indeterminate-toggle-${componentId}" onchange="setCheckboxControl('indeterminate', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="checkbox-indeterminate-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="checkbox-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Toggle' ? `
                        <!-- Preview Section for Toggle -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="toggle-size-select-${componentId}" onchange="setToggleControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (33x16px)</option>
                                  <option value="md" selected>MD (36x20px)</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="toggle-state-select-${componentId}" onchange="setToggleControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                <input type="text" id="toggle-label-input-${componentId}" value="Label" onchange="setToggleControl('label', this.value, '${componentId}')" placeholder="Texto del label" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Complementary Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto Complementario</label>
                                <input type="text" id="toggle-complementary-text-input-${componentId}" value="" onchange="setToggleControl('complementaryText', this.value, '${componentId}')" placeholder="Texto complementario (opcional)" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Checked -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Activado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="toggle-checked-toggle-${componentId}" onchange="setToggleControl('checked', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="toggle-checked-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="toggle-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Search Button' ? `
                        <!-- Preview Section for Search Button -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Active Mode -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Modo</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="search-button-active-toggle-${componentId}" onchange="setSearchButtonControl('active', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="search-button-active-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">BotÃ³n</span>
                                </label>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="search-button-size-select-${componentId}" onchange="setSearchButtonControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (32px)</option>
                                  <option value="md" selected>MD (40px)</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="search-button-state-select-${componentId}" onchange="setSearchButtonControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Placeholder (solo cuando active) -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Placeholder</label>
                                <input type="text" id="search-button-placeholder-input-${componentId}" value="" onchange="setSearchButtonControl('placeholder', this.value, '${componentId}')" placeholder="Buscar..." style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Value (solo cuando active) -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Valor</label>
                                <input type="text" id="search-button-value-input-${componentId}" value="" onchange="setSearchButtonControl('value', this.value, '${componentId}')" placeholder="Valor del input" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Width (solo cuando active) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ancho (px)</label>
                                <input type="number" id="search-button-width-input-${componentId}" value="248" onchange="setSearchButtonControl('width', parseInt(this.value) || 248, '${componentId}')" min="100" max="500" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="search-button-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Data Table' ? `
                        <!-- Preview Section for Data Table -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES CON ACORDEONES -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- AcordeÃ³n: Controles de Tabla -->
                            <div class="ubits-accordion-item" style="margin-bottom: 12px;" id="data-table-controls-accordion-${componentId}">
                              <div class="ubits-accordion-header" data-header-id="table-${componentId}">
                                <div class="ubits-accordion-header-content">
                                  <span class="ubits-accordion-title">Controles de Tabla</span>
                                </div>
                                <i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="table-${componentId}"></i>
                              </div>
                              <div class="ubits-accordion-body" data-body-id="table-${componentId}" style="display: none;">
                                <div class="ubits-accordion-body-content" style="padding: 20px;">
                                <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Arrastrar Columnas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Arrastrar Columnas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-column-reorderable-${componentId}" checked onchange="setDataTableControl('columnReorderable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-column-reorderable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Arrastrar Filas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Arrastrar Filas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-row-reorderable-${componentId}" checked onchange="setDataTableControl('rowReorderable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-row-reorderable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Checkbox -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Columna Checkbox</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-checkbox-${componentId}" checked onchange="setDataTableControl('showCheckbox', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-checkbox-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- NÃºmero de Columnas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Columnas</label>
                                <input type="number" id="data-table-columns-count-${componentId}" value="3" min="1" max="10" onchange="setDataTableControl('columnsCount', parseInt(this.value) || 3, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Ordenamiento de Columnas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ordenamiento Columnas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-column-sortable-${componentId}" checked onchange="setDataTableControl('columnSortable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-column-sortable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Habilitado</span>
                                </label>
                              </div>
                              
                              <!-- Expandir Filas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Expandir Filas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-row-expandable-${componentId}" checked onchange="setDataTableControl('rowExpandable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-row-expandable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Habilitado</span>
                                </label>
                              </div>
                              
                              <!-- Scrollbar Vertical -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Scrollbar Vertical</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-vertical-scrollbar-${componentId}" onchange="setDataTableControl('showVerticalScrollbar', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-vertical-scrollbar-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                              </div>
                              <!-- Scrollbar Horizontal -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Scrollbar Horizontal</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-horizontal-scrollbar-${componentId}" onchange="setDataTableControl('showHorizontalScrollbar', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-horizontal-scrollbar-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                              </div>
                              
                              <!-- MenÃº de Columnas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">MenÃº de Columnas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-column-menu-${componentId}" checked onchange="setDataTableControl('showColumnMenu', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-column-menu-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- MenÃº Contextual (Click Derecho) -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">MenÃº Contextual</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-context-menu-${componentId}" checked onchange="setDataTableControl('showContextMenu', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-context-menu-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- Checkbox Sticky -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Checkbox Sticky</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-checkbox-sticky-${componentId}" onchange="setDataTableControl('checkboxSticky', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-checkbox-sticky-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                              </div>
                              
                              <!-- Drag Handle Sticky -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mover Filas Sticky</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-drag-handle-sticky-${componentId}" onchange="setDataTableControl('dragHandleSticky', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-drag-handle-sticky-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                              </div>
                              
                              <!-- Expand Sticky -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Desplegar Filas Sticky</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-expand-sticky-${componentId}" onchange="setDataTableControl('expandSticky', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-expand-sticky-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                              </div>
                              
                              <!-- Show Pagination -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Paginador</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-pagination-${componentId}" onchange="setDataTableControl('showPagination', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-pagination-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Deshabilitado</span>
                                </label>
                                </div>
                                </div>
                              </div>
                            </div>
                            
                            <!-- AcordeÃ³n: Controles del Header -->
                            <div class="ubits-accordion-item" style="margin-bottom: 12px;">
                              <div class="ubits-accordion-header" data-header-id="header-${componentId}">
                                <div class="ubits-accordion-header-content">
                                  <span class="ubits-accordion-title">Controles del Header</span>
                                </div>
                                <i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="header-${componentId}"></i>
                              </div>
                              <div class="ubits-accordion-body" data-body-id="header-${componentId}" style="display: none;">
                                <div class="ubits-accordion-body-content" style="padding: 20px;">
                                  <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                                  <!-- TÃ­tulo del Header -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar TÃ­tulo</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-title-${componentId}" checked onchange="setDataTableControl('showHeaderTitle', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-title-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- Contador del Header -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Contador</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-bottom: 12px;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-counter-${componentId}" checked onchange="setDataTableControl('showHeaderCounter', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-counter-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                                
                                <!-- Modo del contador -->
                                <div style="margin-bottom: 12px;">
                                  <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px;">Modo del Contador</label>
                                  <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="radio" name="data-table-header-counter-mode-${componentId}" value="full" checked onchange="setDataTableControl('headerCounterMode', 'full', '${componentId}')" style="cursor: pointer;">
                                      <span style="font-size: 13px; color: var(--ubits-fg-1-high);">100/100 resultados</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="radio" name="data-table-header-counter-mode-${componentId}" value="total-only" onchange="setDataTableControl('headerCounterMode', 'total-only', '${componentId}')" style="cursor: pointer;">
                                      <span style="font-size: 13px; color: var(--ubits-fg-1-high);">100 resultados</span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- Input para cantidad mostrada (X) - visible en modo full -->
                                <div id="data-table-header-displayed-items-container-${componentId}" style="margin-bottom: 12px;">
                                  <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px;">Cantidad Mostrada (X)</label>
                                  <input type="number" id="data-table-header-displayed-items-${componentId}" value="100" min="0" onchange="setDataTableControl('headerDisplayedItems', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 8px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Input para cantidad total (Y) - visible en modo full y total-only -->
                                <div id="data-table-header-total-items-container-${componentId}" style="margin-bottom: 12px;">
                                  <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px;">Cantidad Total (Y)</label>
                                  <input type="number" id="data-table-header-total-items-${componentId}" value="100" min="0" onchange="setDataTableControl('headerTotalItems', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 8px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                              
                              <!-- BotÃ³n de BÃºsqueda -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n BÃºsqueda</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-search-button-${componentId}" checked onchange="setDataTableControl('showHeaderSearchButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-search-button-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- BotÃ³n de Filtros -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Filtros</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-filter-button-${componentId}" checked onchange="setDataTableControl('showHeaderFilterButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-filter-button-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- BotÃ³n Selector de Columnas -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Selector Columnas</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-column-selector-button-${componentId}" checked onchange="setDataTableControl('showHeaderColumnSelectorButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-column-selector-button-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- Botones Secundarios -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Botones Secundarios</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-secondary-buttons-${componentId}" checked onchange="setDataTableControl('showHeaderSecondaryButtons', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-secondary-buttons-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- BotÃ³n Primario -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Primario</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="data-table-show-header-primary-button-${componentId}" checked onchange="setDataTableControl('showHeaderPrimaryButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="data-table-show-header-primary-button-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                </label>
                              </div>
                              
                              <!-- TÃ­tulo del Header (Input) -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto del TÃ­tulo</label>
                                <input type="text" id="data-table-header-title-${componentId}" value="Tabla de datos" onchange="setDataTableControl('headerTitle', this.value, '${componentId}')" placeholder="TÃ­tulo del header" style="width: 100%; padding: 10px 12px; border: 1px solid var(--ubits-border-1); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            
                            <!-- AcordeÃ³n: Controladores de la Columna -->
                            <div class="ubits-accordion-item" style="margin-bottom: 12px;">
                              <div class="ubits-accordion-header" data-header-id="columns-${componentId}">
                                <div class="ubits-accordion-header-content">
                                  <span class="ubits-accordion-title">Controladores de la Columna</span>
                                </div>
                                <i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="columns-${componentId}"></i>
                              </div>
                              <div class="ubits-accordion-body" data-body-id="columns-${componentId}" style="display: none;">
                                <div class="ubits-accordion-body-content" style="padding: 20px;">
                                  <div style="flex: 0 0 100%;">
                                    <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Tipos de Columna</h5>
                                    <div id="data-table-column-types-${componentId}" style="display: flex; flex-wrap: wrap; gap: 16px;">
                                      <!-- Se generarÃ¡ dinÃ¡micamente -->
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            
                            <!-- AcordeÃ³n: Controladores de las Acciones -->
                            <div class="ubits-accordion-item" style="margin-bottom: 12px;">
                              <div class="ubits-accordion-header" data-header-id="actions-${componentId}">
                                <div class="ubits-accordion-header-content">
                                  <span class="ubits-accordion-title">Controladores de las Acciones</span>
                                </div>
                                <i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="actions-${componentId}"></i>
                              </div>
                              <div class="ubits-accordion-body" data-body-id="actions-${componentId}" style="display: none;">
                                <div class="ubits-accordion-body-content" style="padding: 20px;">
                                <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                                  <!-- Ver Seleccionados -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ver Seleccionados</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-view-selected-${componentId}" checked onchange="setDataTableControl('showViewSelected', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-view-selected-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Notificaciones (Campanita) -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Notificaciones</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-notifications-${componentId}" checked onchange="setDataTableControl('showNotifications', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-notifications-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Copiar -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Copiar</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-copy-${componentId}" checked onchange="setDataTableControl('showCopy', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-copy-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Ver/Ojo -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ver</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-view-${componentId}" checked onchange="setDataTableControl('showView', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-view-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Editar -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Editar</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-edit-${componentId}" checked onchange="setDataTableControl('showEdit', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-edit-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Descargar -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Descargar</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-download-${componentId}" checked onchange="setDataTableControl('showDownload', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-download-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                  
                                  <!-- Eliminar -->
                                  <div style="flex: 0 0 auto; min-width: 200px;">
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Eliminar</label>
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="data-table-show-delete-${componentId}" checked onchange="setDataTableControl('showDelete', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                      <span id="data-table-show-delete-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Visible</span>
                                    </label>
                                  </div>
                                </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 24px; border-radius: 8px; border: none; min-height: 400px;">
                            <div id="data-table-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Pagination' ? `
                        <!-- Preview Section for Pagination -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- PÃ¡gina Actual -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PÃ¡gina Actual</label>
                                <input type="number" id="pagination-current-page-${componentId}" value="5" min="1" max="100" onchange="setPaginationControl('currentPage', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Total de PÃ¡ginas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total PÃ¡ginas</label>
                                <input type="number" id="pagination-total-pages-${componentId}" value="20" min="1" max="100" onchange="setPaginationControl('totalPages', parseInt(this.value) || 10, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Total Items -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total Items</label>
                                <input type="number" id="pagination-total-items-${componentId}" value="200" min="0" onchange="setPaginationControl('totalItems', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Items por PÃ¡gina -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Items/PÃ¡gina</label>
                                <input type="number" id="pagination-items-per-page-${componentId}" value="10" min="1" onchange="setPaginationControl('itemsPerPage', parseInt(this.value) || 10, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <select id="pagination-variant-select-${componentId}" onchange="setPaginationControl('variant', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="compact">Compact</option>
                                  <option value="minimal">Minimal</option>
                                </select>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="pagination-size-select-${componentId}" onchange="setPaginationControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- MÃ¡ximo PÃ¡ginas Visibles -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">MÃ¡x. PÃ¡ginas</label>
                                <input type="number" id="pagination-max-visible-${componentId}" value="7" min="3" max="15" onchange="setPaginationControl('maxVisiblePages', parseInt(this.value) || 7, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Mostrar Primera -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Primera</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="pagination-show-first-${componentId}" checked onchange="setPaginationControl('showFirst', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="pagination-show-first-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Ãšltima -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ãšltima</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="pagination-show-last-${componentId}" checked onchange="setPaginationControl('showLast', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="pagination-show-last-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Anterior/Siguiente -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Anterior/Siguiente</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="pagination-show-prev-next-${componentId}" checked onchange="setPaginationControl('showPrevNext', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="pagination-show-prev-next-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Info -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">InformaciÃ³n</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="pagination-show-info-${componentId}" checked onchange="setPaginationControl('showInfo', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="pagination-show-info-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Items por PÃ¡gina -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Selector Items</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="pagination-show-items-per-page-${componentId}" checked onchange="setPaginationControl('showItemsPerPage', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="pagination-show-items-per-page-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="pagination-preview-${componentId}" style="width: 100%; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Accordion' ? `
                        <!-- Preview Section for Accordion -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <select id="accordion-variant-select-${componentId}" onchange="setAccordionControl('variant', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="list" selected>List</option>
                                  <option value="boxed">Boxed</option>
                                </select>
                              </div>
                              
                              <!-- PosiciÃ³n Chevron -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PosiciÃ³n Chevron</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="chevronPosition" data-value="right" onclick="setAccordionControl('chevronPosition', 'right', '${componentId}')">
                                    <span>Derecha</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="chevronPosition" data-value="left" onclick="setAccordionControl('chevronPosition', 'left', '${componentId}')">
                                    <span>Izquierda</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Permitir MÃºltiples -->
                              <div style="flex: 0 0 auto; min-width: 180px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">MÃºltiples Abiertos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="accordion-allow-multiple-toggle-${componentId}" onchange="setAccordionControl('allowMultiple', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="accordion-allow-multiple-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Iconos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Iconos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="accordion-show-icons-toggle-${componentId}" checked onchange="setAccordionControl('showIcons', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="accordion-show-icons-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="accordion-preview-${componentId}" style="width: 100%; max-width: 800px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Avatar' ? `
                        <!-- Preview Section for Avatar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <select id="avatar-variant-select-${componentId}" onchange="setAvatarControl('variant', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="photo" selected>Photo</option>
                                  <option value="initials">Initials</option>
                                  <option value="icon">Icon</option>
                                </select>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="avatar-size-select-${componentId}" onchange="setAvatarControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS (20px)</option>
                                  <option value="sm">SM (28px)</option>
                                  <option value="md" selected>MD (36px)</option>
                                  <option value="lg">LG (40px)</option>
                                </select>
                              </div>
                              
                              <!-- URL de Imagen (si variante es Photo) -->
                              <div id="avatar-image-url-container-${componentId}" style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">URL de Imagen</label>
                                <input type="text" id="avatar-image-url-input-${componentId}" value="../assets/images/Profile-image.jpg" onchange="setAvatarControl('imageUrl', this.value, '${componentId}')" placeholder="../assets/images/Profile-image.jpg" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Iniciales (si variante es Initials) -->
                              <div id="avatar-initials-container-${componentId}" style="flex: 1 1 auto; min-width: 200px; display: none;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Iniciales</label>
                                <input type="text" id="avatar-initials-input-${componentId}" value="JD" onchange="setAvatarControl('initials', this.value, '${componentId}')" placeholder="John Doe" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono (si variante es Icon) -->
                              <div id="avatar-icon-container-${componentId}" style="flex: 1 1 auto; min-width: 200px; display: none;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono</label>
                                <input type="text" id="avatar-icon-input-${componentId}" value="user" onchange="setAvatarControl('icon', this.value, '${componentId}')" placeholder="user" style="width: 100%; max-width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Badge Color -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Badge</label>
                                <select id="avatar-badge-select-${componentId}" onchange="setAvatarControl('badgeColor', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="">Sin badge</option>
                                  <option value="green">Verde</option>
                                  <option value="red">Rojo</option>
                                  <option value="blue">Azul</option>
                                  <option value="orange">Naranja</option>
                                  <option value="gray">Gris</option>
                                </select>
                              </div>
                              
                              <!-- Badge Content (solo visible si hay badge) -->
                              <div id="avatar-badge-content-container-${componentId}" style="flex: 0 0 auto; min-width: 200px; display: none;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contenido Badge</label>
                                <input type="text" id="avatar-badge-content-input-${componentId}" value="" onchange="setAvatarControl('badgeContent', this.value, '${componentId}')" placeholder="5, 99+, Nuevo..." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                <small style="display: block; margin-top: 6px; font-size: 11px; color: var(--ubits-fg-1-medium);">Dejar vacÃ­o para solo punto</small>
                              </div>
                              
                              <!-- Clickeable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Clickeable</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="avatar-clickable-toggle-${componentId}" onchange="setAvatarControl('clickable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="avatar-clickable-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="avatar-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Drawer Navigation' ? `
                        <!-- Preview Section for Drawer Navigation -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-end;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="drawer-title-input-${componentId}" value="Crear dato demogrÃ¡fico" onchange="setDrawerControl('title', this.value, '${componentId}')" placeholder="TÃ­tulo del drawer" style="width: 100%; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Texto Complementario -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto Complementario</label>
                                <input type="text" id="drawer-complementary-input-${componentId}" value="" onchange="setDrawerControl('complementaryText', this.value, '${componentId}')" placeholder="Texto opcional debajo del tÃ­tulo" style="width: 100%; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Ancho -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ancho</label>
                                <select id="drawer-width-select-${componentId}" onchange="setDrawerControl('width', parseInt(this.value), '${componentId}')" style="width: 100%; padding: var(--ubits-spacing-sm) 32px var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="100">100%</option>
                                  <option value="80">80%</option>
                                  <option value="60">60%</option>
                                  <option value="50">50%</option>
                                  <option value="40" selected>40%</option>
                                  <option value="30">30%</option>
                                </select>
                              </div>
                              
                              <!-- BotÃ³n Abrir/Cerrar -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <button class="ubits-button ubits-button--primary ubits-button--md" onclick="toggleDrawer('${componentId}')" style="width: 100%;">
                                  <span id="drawer-toggle-button-text-${componentId}">Abrir Drawer</span>
                                </button>
                              </div>
                            </div>
                            
                            <!-- Botones del Footer -->
                            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ubits-border-1);">
                              <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Botones del Footer</h5>
                              <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                                <!-- BotÃ³n Tertiary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tertiary (Izquierda)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="drawer-tertiary-label-input-${componentId}" value="Cancelar" onchange="setDrawerControl('tertiaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="drawer-tertiary-toggle-${componentId}" checked onchange="setDrawerControl('tertiaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Secondary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Secondary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="drawer-secondary-label-input-${componentId}" value="Guardar" onchange="setDrawerControl('secondaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="drawer-secondary-toggle-${componentId}" checked onchange="setDrawerControl('secondaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Primary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Primary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="drawer-primary-label-input-${componentId}" value="Crear" onchange="setDrawerControl('primaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="drawer-primary-toggle-${componentId}" checked onchange="setDrawerControl('primaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 400px; position: relative;">
                            <div id="drawer-preview-container-${componentId}" style="width: 100%; height: 100%; position: relative;">
                              <!-- El drawer se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Modal' ? `
                        <!-- Preview Section for Modal -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-end;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="modal-title-input-${componentId}" value="TÃ­tulo del modal" onchange="setModalControl('title', this.value, '${componentId}')" placeholder="TÃ­tulo del modal" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="modal-size-select-${componentId}" onchange="setModalControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (320px)</option>
                                  <option value="md" selected>MD (480px)</option>
                                  <option value="lg">LG (640px)</option>
                                  <option value="xl">XL (800px)</option>
                                  <option value="full">Full (1280px)</option>
                                </select>
                              </div>
                              
                              <!-- Full Screen -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Full Screen</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="modal-fullscreen-toggle-${componentId}" onchange="setModalControl('fullScreen', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                </label>
                              </div>
                              
                              <!-- BotÃ³n Abrir/Cerrar -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <button class="ubits-button ubits-button--primary ubits-button--md" onclick="toggleModal('${componentId}')" style="width: 100%;">
                                  <span id="modal-toggle-button-text-${componentId}">Abrir Modal</span>
                                </button>
                              </div>
                            </div>
                            
                            <!-- Botones del Footer -->
                            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ubits-border-1);">
                              <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Botones del Footer</h5>
                              <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                                <!-- BotÃ³n Tertiary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tertiary (Izquierda)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="modal-tertiary-label-input-${componentId}" value="Cancelar" onchange="setModalControl('tertiaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="modal-tertiary-toggle-${componentId}" checked onchange="setModalControl('tertiaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Secondary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Secondary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="modal-secondary-label-input-${componentId}" value="Guardar" onchange="setModalControl('secondaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="modal-secondary-toggle-${componentId}" checked onchange="setModalControl('secondaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Primary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Primary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="modal-primary-label-input-${componentId}" value="Aplicar" onchange="setModalControl('primaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="modal-primary-toggle-${componentId}" checked onchange="setModalControl('primaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 400px; position: relative;">
                            <div id="modal-preview-container-${componentId}" style="width: 100%; height: 100%; position: relative;">
                              <!-- El modal se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Popover' ? `
                        <!-- Preview Section for Popover -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-end;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="popover-title-input-${componentId}" value="Title" onchange="setPopoverControl('title', this.value, '${componentId}')" placeholder="TÃ­tulo del popover" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="popover-width-select-${componentId}" onchange="setPopoverControl('width', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (240px)</option>
                                  <option value="md" selected>MD (320px)</option>
                                  <option value="lg">LG (400px)</option>
                                  <option value="xl">XL (480px)</option>
                                </select>
                              </div>
                              
                              <!-- PosiciÃ³n del Tail -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PosiciÃ³n Tail</label>
                                <select id="popover-tail-position-select-${componentId}" onchange="setPopoverControl('tailPosition', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="top" selected>Top</option>
                                  <option value="bottom">Bottom</option>
                                  <option value="left">Left</option>
                                  <option value="right">Right</option>
                                </select>
                              </div>
                              
                              <!-- BotÃ³n Abrir/Cerrar -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <button class="ubits-button ubits-button--primary ubits-button--md" onclick="togglePopoverComponent('${componentId}')" style="width: 100%;">
                                  <span id="popover-toggle-button-text-${componentId}">Abrir Popover</span>
                                </button>
                              </div>
                            </div>
                            
                            <!-- Botones del Footer -->
                            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ubits-border-1);">
                              <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Botones del Footer</h5>
                              <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                                <!-- BotÃ³n Tertiary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tertiary (Izquierda)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="popover-tertiary-label-input-${componentId}" value="Tertiary" onchange="setPopoverControl('tertiaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="popover-tertiary-toggle-${componentId}" checked onchange="setPopoverControl('tertiaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Secondary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Secondary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="popover-secondary-label-input-${componentId}" value="Secondary" onchange="setPopoverControl('secondaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="popover-secondary-toggle-${componentId}" checked onchange="setPopoverControl('secondaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                                
                                <!-- BotÃ³n Primary -->
                                <div style="flex: 0 0 auto; min-width: 200px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Primary (Derecha)</label>
                                  <div style="display: flex; gap: 8px;">
                                    <input type="text" id="popover-primary-label-input-${componentId}" value="Primary" onchange="setPopoverControl('primaryLabel', this.value, '${componentId}')" placeholder="Label" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box;">
                                    <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                      <input type="checkbox" class="ubits-toggle__input" id="popover-primary-toggle-${componentId}" checked onchange="setPopoverControl('primaryEnabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 400px; position: relative;">
                            <div id="popover-preview-container-${componentId}" style="position: relative; width: 100%; height: 100%;">
                              <!-- El popover se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Tooltip' ? `
                        <!-- Preview Section for Tooltip -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-end;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="tooltip-title-input-${componentId}" value="TÃ­tulo del tooltip" onchange="setTooltipControl('title', this.value, '${componentId}')" placeholder="TÃ­tulo del tooltip" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-title-toggle-${componentId}" checked onchange="setTooltipControl('showTitle', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar tÃ­tulo</span>
                                </label>
                              </div>
                              
                              <!-- DescripciÃ³n -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">DescripciÃ³n</label>
                                <input type="text" id="tooltip-description-input-${componentId}" value="DescripciÃ³n del tooltip que proporciona informaciÃ³n adicional al usuario." onchange="setTooltipControl('description', this.value, '${componentId}')" placeholder="DescripciÃ³n del tooltip" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-description-toggle-${componentId}" checked onchange="setTooltipControl('showDescription', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar descripciÃ³n</span>
                                </label>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="tooltip-width-select-${componentId}" onchange="setTooltipControl('width', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="sm">SM (240px)</option>
                                  <option value="md" selected>MD (320px)</option>
                                  <option value="lg">LG (400px)</option>
                                </select>
                              </div>
                              
                              <!-- PosiciÃ³n del Tail -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PosiciÃ³n Tail</label>
                                <select id="tooltip-tail-position-select-${componentId}" onchange="setTooltipControl('tailPosition', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="top" selected>Top</option>
                                  <option value="bottom">Bottom</option>
                                  <option value="left">Left</option>
                                  <option value="right">Right</option>
                                </select>
                              </div>
                              
                              <!-- BotÃ³n Abrir/Cerrar -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <button class="ubits-button ubits-button--primary ubits-button--md" onclick="toggleTooltipComponent('${componentId}')" style="width: 100%;">
                                  <span id="tooltip-toggle-button-text-${componentId}">Abrir Tooltip</span>
                                </button>
                              </div>
                            </div>
                            
                            <!-- Botones del Footer -->
                            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ubits-border-1);">
                              <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Botones del Footer</h5>
                              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: flex-start;">
                                <!-- BotÃ³n Primario -->
                                <div>
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Primario (opcional)</label>
                                  <input type="text" id="tooltip-primary-label-input-${componentId}" value="Aceptar" onchange="setTooltipControl('primaryButtonLabel', this.value, '${componentId}')" placeholder="Aceptar" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                  <input type="text" id="tooltip-primary-icon-input-${componentId}" value="check" onchange="setTooltipControl('primaryButtonIcon', this.value, '${componentId}')" placeholder="check" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-primary-toggle-${componentId}" onchange="setTooltipControl('showPrimaryButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar botÃ³n primario</span>
                                  </label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-primary-icon-toggle-${componentId}" onchange="setTooltipControl('showPrimaryButtonIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar icono en botÃ³n primario</span>
                                  </label>
                                </div>
                                
                                <!-- BotÃ³n Secundario -->
                                <div>
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Secundario (opcional)</label>
                                  <input type="text" id="tooltip-secondary-label-input-${componentId}" value="Cancelar" onchange="setTooltipControl('secondaryButtonLabel', this.value, '${componentId}')" placeholder="Cancelar" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                  <input type="text" id="tooltip-secondary-icon-input-${componentId}" value="times" onchange="setTooltipControl('secondaryButtonIcon', this.value, '${componentId}')" placeholder="times" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-secondary-toggle-${componentId}" onchange="setTooltipControl('showSecondaryButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar botÃ³n secundario</span>
                                  </label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-secondary-icon-toggle-${componentId}" onchange="setTooltipControl('showSecondaryButtonIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar icono en botÃ³n secundario</span>
                                  </label>
                                </div>
                                
                                <!-- BotÃ³n Terciario -->
                                <div style="grid-column: 1 / -1;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Terciario (opcional)</label>
                                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                    <div>
                                      <input type="text" id="tooltip-tertiary-label-input-${componentId}" value="MÃ¡s info" onchange="setTooltipControl('tertiaryButtonLabel', this.value, '${componentId}')" placeholder="MÃ¡s info" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                    </div>
                                    <div>
                                      <input type="text" id="tooltip-tertiary-icon-input-${componentId}" value="info-circle" onchange="setTooltipControl('tertiaryButtonIcon', this.value, '${componentId}')" placeholder="info-circle" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                    </div>
                                  </div>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-tertiary-toggle-${componentId}" onchange="setTooltipControl('showTertiaryButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar botÃ³n terciario</span>
                                  </label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px;">
                                    <input type="checkbox" class="ubits-toggle__input" id="tooltip-show-tertiary-icon-toggle-${componentId}" onchange="setTooltipControl('showTertiaryButtonIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar icono en botÃ³n terciario</span>
                                  </label>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 600px; position: relative; overflow: visible;">
                            <div id="tooltip-preview-container-${componentId}" style="position: relative; width: 100%; height: 100%; min-height: 500px; overflow: visible; padding: 40px;">
                              <!-- El tooltip se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Calendar' ? `
                        <!-- Preview Section for Calendar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Modo -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Modo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="mode" data-value="single" onclick="setCalendarControl('mode', 'single', '${componentId}')">
                                    <span>SelecciÃ³n Ãºnica</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="mode" data-value="range" onclick="setCalendarControl('mode', 'range', '${componentId}')">
                                    <span>Rango</span>
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 400px; position: relative;">
                            <div id="calendar-preview-container-${componentId}" style="position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                              <!-- El calendario se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Slider' ? `
                        <!-- Preview Section for Slider -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Modo -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Modo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="mode" data-value="single" onclick="setSliderControl('mode', 'single', '${componentId}')">
                                    <span>Single</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="mode" data-value="range" onclick="setSliderControl('mode', 'range', '${componentId}')">
                                    <span>Range</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- OrientaciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">OrientaciÃ³n</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="orientation" data-value="horizontal" onclick="setSliderControl('orientation', 'horizontal', '${componentId}')">
                                    <span>Horizontal</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="orientation" data-value="vertical" onclick="setSliderControl('orientation', 'vertical', '${componentId}')">
                                    <span>Vertical</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="slider-size-select-${componentId}" onchange="setSliderControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="state" data-value="default" onclick="setSliderControl('state', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="disabled" onclick="setSliderControl('state', 'disabled', '${componentId}')">
                                    <span>Disabled</span>
                                  </button>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Segunda fila: ConfiguraciÃ³n de valores -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Min -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Min</label>
                                <input type="number" id="slider-min-input-${componentId}" value="0" onchange="setSliderControl('min', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Max -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Max</label>
                                <input type="number" id="slider-max-input-${componentId}" value="100" onchange="setSliderControl('max', parseInt(this.value) || 100, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Step -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Step</label>
                                <input type="number" id="slider-step-input-${componentId}" value="1" min="0.1" step="0.1" onchange="setSliderControl('step', parseFloat(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                <input type="text" id="slider-label-input-${componentId}" value="Rango de precio" onchange="setSliderControl('label', this.value, '${componentId}')" placeholder="Label del slider" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Helper Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Helper Text</label>
                                <input type="text" id="slider-helper-input-${componentId}" value="" onchange="setSliderControl('helperText', this.value, '${componentId}')" placeholder="Texto de ayuda (opcional)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Mostrar Inputs -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Inputs</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="slider-show-inputs-toggle-${componentId}" onchange="setSliderControl('showInputs', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="slider-show-inputs-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Marcas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Marcas</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="slider-show-marks-toggle-${componentId}" onchange="setSliderControl('showMarks', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="slider-show-marks-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar GuÃ­a de Rango -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">GuÃ­a de Rango</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="slider-show-range-guide-toggle-${componentId}" onchange="setSliderControl('showRangeGuide', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="slider-show-range-guide-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Label -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Label</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="slider-show-label-toggle-${componentId}" checked onchange="setSliderControl('showLabel', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="slider-show-label-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Helper -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Helper</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="slider-show-helper-toggle-${componentId}" onchange="setSliderControl('showHelper', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="slider-show-helper-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 200px;">
                            <div id="slider-preview-container-${componentId}" style="width: 100%; max-width: 600px; min-height: 200px;">
                              <!-- El slider se renderizarÃ¡ aquÃ­ -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Scrollbar' ? `
                        <!-- Preview Section for Scrollbar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- OrientaciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">OrientaciÃ³n</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="orientation" data-value="vertical" onclick="setScrollbarControl('orientation', 'vertical', '${componentId}')">
                                    <span>Vertical</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="orientation" data-value="horizontal" onclick="setScrollbarControl('orientation', 'horizontal', '${componentId}')">
                                    <span>Horizontal</span>
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 400px; position: relative;">
                            <div id="scrollbar-preview-container-${componentId}" style="width: 100%; height: 100%; position: relative;">
                              <!-- Contenedor scrollable vertical con su scrollbar -->
                              <div id="scrollbar-wrapper-vertical-${componentId}" style="display: flex; align-items: stretch; gap: 8px; height: 300px;">
                                <div id="scrollbar-scrollable-vertical-${componentId}" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding: 16px; background: var(--ubits-bg-2); border-radius: 8px; border: 1px solid var(--ubits-border-1); -ms-overflow-style: none; scrollbar-width: none;">
                                  <div style="height: 800px; padding: 16px;">
                                    <p style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size, 16px);">Contenido scrollable vertical</p>
                                    <p style="margin: 0 0 16px 0; color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size, 13px);">Este es un ejemplo de contenido largo que requiere scroll vertical. El scrollbar aparecerÃ¡ a la derecha cuando pases el mouse sobre el contenedor.</p>
                                    <div style="display: flex; flex-direction: column; gap: 12px;">
                                      ${Array.from({ length: 20 }, (_, i) => `
                                        <div style="padding: 12px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                          <p style="margin: 0; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px);">Elemento ${i + 1}</p>
                                        </div>
                                      `).join('')}
                                    </div>
                                  </div>
                                </div>
                                <!-- Scrollbar vertical -->
                                <div id="scrollbar-vertical-${componentId}" style="height: 100%;"></div>
                              </div>
                              
                              <!-- Contenedor scrollable horizontal con su scrollbar -->
                              <div id="scrollbar-wrapper-horizontal-${componentId}" style="display: none; flex-direction: column; gap: 8px; width: 100%; height: 200px;">
                                <div id="scrollbar-scrollable-horizontal-${componentId}" style="flex: 1; overflow-x: auto; overflow-y: hidden; padding: 16px; background: var(--ubits-bg-2); border-radius: 8px; border: 1px solid var(--ubits-border-1); -ms-overflow-style: none; scrollbar-width: none;">
                                  <div style="width: 1200px; padding: 16px;">
                                    <p style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: var(--font-body-md-size, 16px);">Contenido scrollable horizontal</p>
                                    <p style="margin: 0 0 16px 0; color: var(--ubits-fg-1-medium); font-size: var(--font-body-sm-size, 13px);">Este es un ejemplo de contenido ancho que requiere scroll horizontal. El scrollbar aparecerÃ¡ abajo cuando pases el mouse sobre el contenedor.</p>
                                    <div style="display: flex; gap: 12px;">
                                      ${Array.from({ length: 15 }, (_, i) => `
                                        <div style="min-width: 150px; padding: 12px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                          <p style="margin: 0; color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px);">Elemento ${i + 1}</p>
                                        </div>
                                      `).join('')}
                                    </div>
                                  </div>
                                </div>
                                <!-- Scrollbar horizontal -->
                                <div id="scrollbar-horizontal-${componentId}" style="width: 100%;"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Progress Bar' ? `
                        <!-- Preview Section for Progress Bar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Size -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="size" data-value="xs" onclick="setProgressBarControl('size', 'xs', '${componentId}')">
                                    <span>XS (4px)</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="size" data-value="sm" onclick="setProgressBarControl('size', 'sm', '${componentId}')">
                                    <span>SM (8px)</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="size" data-value="md" onclick="setProgressBarControl('size', 'md', '${componentId}')">
                                    <span>MD (16px)</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="size" data-value="lg" onclick="setProgressBarControl('size', 'lg', '${componentId}')">
                                    <span>LG (20px)</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Variant -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="default" onclick="setProgressBarControl('variant', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="multi-color" onclick="setProgressBarControl('variant', 'multi-color', '${componentId}')">
                                    <span>Multi-color</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Value (solo para default) -->
                              <div style="flex: 0 0 auto; min-width: 200px;" id="progress-value-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Valor (%)</label>
                                <input type="range" id="progress-value-input-${componentId}" min="0" max="100" value="75" oninput="setProgressBarControl('value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                <div style="display: flex; justify-content: space-between; margin-top: 4px;">
                                  <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0</span>
                                  <span id="progress-value-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">75%</span>
                                  <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100</span>
                                </div>
                              </div>
                              
                              <!-- Indicator -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Indicador</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="progress-indicator-toggle-${componentId}" checked onchange="setProgressBarControl('indicator', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="progress-indicator-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                            </div>
                            
                            <!-- Controles Multi-color (solo visible cuando variant es multi-color) -->
                            <div id="progress-multicolor-controls-${componentId}" style="display: none; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ubits-border-1);">
                              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                                <h5 style="margin: 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Segmentos Multi-color</h5>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de segmentos:</label>
                                  <select id="progress-segments-count-${componentId}" onchange="setProgressBarSegmentCount(parseInt(this.value), '${componentId}')" style="padding: 8px 28px 8px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 16px;">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4" selected>4</option>
                                    <option value="5">5</option>
                                  </select>
                                </div>
                              </div>
                              <div id="progress-segments-container-${componentId}" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <!-- Segmento 1 -->
                                <div id="progress-segment-1-wrapper-${componentId}" style="display: flex; flex-direction: column; gap: 12px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento 1</label>
                                  <select id="progress-segment-1-color-${componentId}" onchange="setProgressBarSegmentControl(1, 'color', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="green">Green</option>
                                    <option value="info" selected>Info (Blue)</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="error">Error (Red)</option>
                                    <option value="gray">Gray</option>
                                  </select>
                                  <input type="range" id="progress-segment-1-value-${componentId}" min="0" max="100" value="30" oninput="setProgressBarSegmentControl(1, 'value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                  <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0%</span>
                                    <span id="progress-segment-1-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">30%</span>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100%</span>
                                  </div>
                                </div>
                                
                                <!-- Segmento 2 -->
                                <div id="progress-segment-2-wrapper-${componentId}" style="display: flex; flex-direction: column; gap: 12px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento 2</label>
                                  <select id="progress-segment-2-color-${componentId}" onchange="setProgressBarSegmentControl(2, 'color', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="green">Green</option>
                                    <option value="info">Info (Blue)</option>
                                    <option value="yellow" selected>Yellow</option>
                                    <option value="error">Error (Red)</option>
                                    <option value="gray">Gray</option>
                                  </select>
                                  <input type="range" id="progress-segment-2-value-${componentId}" min="0" max="100" value="25" oninput="setProgressBarSegmentControl(2, 'value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                  <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0%</span>
                                    <span id="progress-segment-2-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">25%</span>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100%</span>
                                  </div>
                                </div>
                                
                                <!-- Segmento 3 -->
                                <div id="progress-segment-3-wrapper-${componentId}" style="display: flex; flex-direction: column; gap: 12px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento 3</label>
                                  <select id="progress-segment-3-color-${componentId}" onchange="setProgressBarSegmentControl(3, 'color', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="green" selected>Green</option>
                                    <option value="info">Info (Blue)</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="error">Error (Red)</option>
                                    <option value="gray">Gray</option>
                                  </select>
                                  <input type="range" id="progress-segment-3-value-${componentId}" min="0" max="100" value="20" oninput="setProgressBarSegmentControl(3, 'value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                  <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0%</span>
                                    <span id="progress-segment-3-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">20%</span>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100%</span>
                                  </div>
                                </div>
                                
                                <!-- Segmento 4 -->
                                <div id="progress-segment-4-wrapper-${componentId}" style="display: flex; flex-direction: column; gap: 12px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento 4</label>
                                  <select id="progress-segment-4-color-${componentId}" onchange="setProgressBarSegmentControl(4, 'color', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="green">Green</option>
                                    <option value="info">Info (Blue)</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="error" selected>Error (Red)</option>
                                    <option value="gray">Gray</option>
                                  </select>
                                  <input type="range" id="progress-segment-4-value-${componentId}" min="0" max="100" value="25" oninput="setProgressBarSegmentControl(4, 'value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                  <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0%</span>
                                    <span id="progress-segment-4-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">25%</span>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100%</span>
                                  </div>
                                </div>
                                
                                <!-- Segmento 5 -->
                                <div id="progress-segment-5-wrapper-${componentId}" style="display: none; flex-direction: column; gap: 12px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento 5</label>
                                  <select id="progress-segment-5-color-${componentId}" onchange="setProgressBarSegmentControl(5, 'color', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="green">Green</option>
                                    <option value="info">Info (Blue)</option>
                                    <option value="yellow">Yellow</option>
                                    <option value="error">Error (Red)</option>
                                    <option value="gray">Gray</option>
                                  </select>
                                  <input type="range" id="progress-segment-5-value-${componentId}" min="0" max="100" value="0" oninput="setProgressBarSegmentControl(5, 'value', parseInt(this.value), '${componentId}')" style="width: 100%;">
                                  <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">0%</span>
                                    <span id="progress-segment-5-display-${componentId}" style="font-size: 11px; color: var(--ubits-fg-1-high); font-weight: 600;">0%</span>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">100%</span>
                                  </div>
                                </div>
                              </div>
                              <div style="margin-top: 16px; padding: 12px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                <p style="margin: 0; font-size: 12px; color: var(--ubits-fg-1-medium); line-height: 1.5;">
                                  <strong style="color: var(--ubits-fg-1-high);">Nota:</strong> El segmento gris se calcula automÃ¡ticamente como el resto que falta para llegar a 100%. Solo se muestra si la suma de los segmentos activos es menor a 100%.
                                </p>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 200px;">
                            <div id="progress-bar-preview-${componentId}" style="width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Alert' ? `
                        <!-- Preview Section for Alert -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Success, Info, Warning, Error) -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="success" onclick="setAlertControl('type', 'success', '${componentId}')">
                                    <span>Success</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="info" onclick="setAlertControl('type', 'info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="warning" onclick="setAlertControl('type', 'warning', '${componentId}')">
                                    <span>Warning</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="error" onclick="setAlertControl('type', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Mensaje -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mensaje</label>
                                <input type="text" id="alert-message-input-${componentId}" value="Los cambios se han guardado correctamente." onchange="setAlertControl('message', this.value, '${componentId}')" placeholder="Mensaje del alert" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                              
                              <!-- Closable -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Cerrar</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="alert-closable-toggle-${componentId}" checked onchange="setAlertControl('closable', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 120px;">
                            <div id="alert-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Spinner' ? `
                        <!-- Preview Section for Spinner -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="spinner-size-select-${componentId}" onchange="setSpinnerControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                  <option value="xl">XL</option>
                                </select>
                              </div>
                              
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="primary" onclick="setSpinnerControl('variant', 'primary', '${componentId}')">
                                    <span>Primario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="secondary" onclick="setSpinnerControl('variant', 'secondary', '${componentId}')">
                                    <span>Secundario</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="success" onclick="setSpinnerControl('variant', 'success', '${componentId}')">
                                    <span>Ã‰xito</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="warning" onclick="setSpinnerControl('variant', 'warning', '${componentId}')">
                                    <span>Advertencia</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="error" onclick="setSpinnerControl('variant', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="info" onclick="setSpinnerControl('variant', 'info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Animado -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Animado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="spinner-animated-toggle-${componentId}" checked onchange="setSpinnerControl('animated', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="spinner-animated-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label (opcional)</label>
                                <input type="text" id="spinner-label-input-${componentId}" value="" onchange="setSpinnerControl('label', this.value, '${componentId}')" placeholder="Cargando..." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Fullscreen -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Fullscreen</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="spinner-fullscreen-toggle-${componentId}" onchange="setSpinnerControl('fullScreen', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="spinner-fullscreen-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 200px;">
                            <div id="spinner-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Empty State' ? `
                        <!-- Preview Section for Empty State -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="empty-state-title-input-${componentId}" value="No hay resultados" onchange="setEmptyStateControl('title', this.value, '${componentId}')" placeholder="TÃ­tulo" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- DescripciÃ³n -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">DescripciÃ³n</label>
                                <input type="text" id="empty-state-description-input-${componentId}" value="Intenta ajustar tus filtros de bÃºsqueda" onchange="setEmptyStateControl('description', this.value, '${componentId}')" placeholder="DescripciÃ³n (opcional)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono (opcional)</label>
                                <input type="text" id="empty-state-icon-input-${componentId}" value="inbox" onchange="setEmptyStateControl('icon', this.value, '${componentId}')" placeholder="inbox" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- BotÃ³n Primario -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Primario (opcional)</label>
                                <input type="text" id="empty-state-action-label-input-${componentId}" value="Buscar" onchange="setEmptyStateControl('actionLabel', this.value, '${componentId}')" placeholder="Buscar" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <input type="text" id="empty-state-primary-button-icon-input-${componentId}" value="search" onchange="setEmptyStateControl('primaryButtonIcon', this.value, '${componentId}')" placeholder="search" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px; margin-bottom: 10px;">
                                  <input type="checkbox" class="ubits-toggle__input" id="empty-state-show-primary-toggle-${componentId}" onchange="setEmptyStateControl('showPrimaryButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar botÃ³n primario</span>
                                </label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px;">
                                  <input type="checkbox" class="ubits-toggle__input" id="empty-state-show-primary-icon-toggle-${componentId}" onchange="setEmptyStateControl('showPrimaryButtonIcon', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar icono en botÃ³n primario</span>
                                </label>
                              </div>
                              
                              <!-- BotÃ³n Secundario -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Secundario (opcional)</label>
                                <input type="text" id="empty-state-secondary-action-label-input-${componentId}" value="Cancelar" onchange="setEmptyStateControl('secondaryActionLabel', this.value, '${componentId}')" placeholder="Cancelar" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <input type="text" id="empty-state-secondary-button-icon-input-${componentId}" value="times" onchange="setEmptyStateControl('secondaryButtonIcon', this.value, '${componentId}')" placeholder="times" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; margin-bottom: 10px;">
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px; margin-bottom: 10px;">
                                  <input type="checkbox" class="ubits-toggle__input" id="empty-state-show-secondary-toggle-${componentId}" onchange="setEmptyStateControl('showSecondaryButton', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar botÃ³n secundario</span>
                                </label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 10px;">
                                  <input type="checkbox" class="ubits-toggle__input" id="empty-state-show-secondary-icon-toggle-${componentId}" onchange="setEmptyStateControl('showSecondaryButtonIcon', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Mostrar icono en botÃ³n secundario</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 300px;">
                            <div id="empty-state-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Skeleton' ? `
                        <!-- Preview Section for Skeleton -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="text" onclick="setSkeletonControl('variant', 'text', '${componentId}')">
                                    <span>Text</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="circle" onclick="setSkeletonControl('variant', 'circle', '${componentId}')">
                                    <span>Circle</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="rectangle" onclick="setSkeletonControl('variant', 'rectangle', '${componentId}')">
                                    <span>Rectangle</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="custom" onclick="setSkeletonControl('variant', 'custom', '${componentId}')">
                                    <span>Custom</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="skeleton-size-select-${componentId}" onchange="setSkeletonControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                  <option value="xl">XL</option>
                                </select>
                              </div>
                              
                              <!-- LÃ­neas (solo para text) -->
                              <div style="flex: 0 0 auto; min-width: 150px;" id="skeleton-lines-container-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">LÃ­neas</label>
                                <input type="number" id="skeleton-lines-input-${componentId}" value="1" min="1" max="10" onchange="setSkeletonControl('lines', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Ancho -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Ancho</label>
                                <input type="text" id="skeleton-width-input-${componentId}" value="full" onchange="setSkeletonControl('width', this.value, '${componentId}')" placeholder="full, 100px, 50%" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Alto (solo para rectangle y custom) -->
                              <div style="flex: 1 1 auto; min-width: 200px; display: none;" id="skeleton-height-container-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Alto</label>
                                <input type="text" id="skeleton-height-input-${componentId}" value="" onchange="setSkeletonControl('height', this.value, '${componentId}')" placeholder="100px, 50%" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Animado -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Animado</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="skeleton-animated-toggle-${componentId}" checked onchange="setSkeletonControl('animated', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="skeleton-animated-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 200px; display: flex; align-items: center; justify-content: center;">
                            <div id="skeleton-preview-${componentId}" style="width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'File Upload' ? `
                        <!-- Preview Section for File Upload -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Vista -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Vista</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="view" data-value="dropzone" onclick="setFileUploadControl('view', 'dropzone', '${componentId}')">
                                    <span>Drop Zone</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="view" data-value="files-list" onclick="setFileUploadControl('view', 'files-list', '${componentId}')">
                                    <span>Files List</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Estado (solo para drop zone) -->
                              <div style="flex: 0 0 auto; min-width: 200px;" id="file-upload-state-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="state" data-value="default" onclick="setFileUploadControl('state', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="dragging" onclick="setFileUploadControl('state', 'dragging', '${componentId}')">
                                    <span>Dragging</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="error" onclick="setFileUploadControl('state', 'error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="state" data-value="disabled" onclick="setFileUploadControl('state', 'disabled', '${componentId}')">
                                    <span>Disabled</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Max Files -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Max Files</label>
                                <input type="number" id="file-upload-maxfiles-input-${componentId}" value="6" min="1" max="20" onchange="setFileUploadControl('maxFiles', parseInt(this.value), '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Max Size (MB) -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Max Size (MB)</label>
                                <input type="number" id="file-upload-maxsize-input-${componentId}" value="5" min="1" max="100" onchange="setFileUploadControl('maxSize', parseFloat(this.value) * 1024 * 1024, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Drop Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;" id="file-upload-droptext-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto de Drop</label>
                                <input type="text" id="file-upload-droptext-input-${componentId}" value="Arrastra tus archivos aquÃ­" onchange="setFileUploadControl('dropText', this.value, '${componentId}')" placeholder="Arrastra tus archivos aquÃ­" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Select Button Text -->
                              <div style="flex: 1 1 auto; min-width: 200px;" id="file-upload-selecttext-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto del BotÃ³n</label>
                                <input type="text" id="file-upload-selecttext-input-${componentId}" value="Seleccionar archivos" onchange="setFileUploadControl('selectButtonText', this.value, '${componentId}')" placeholder="Seleccionar archivos" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Mostrar Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;" id="file-upload-icon-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Icono</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="file-upload-showicon-toggle-${componentId}" onchange="setFileUploadControl('showIcon', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="file-upload-showicon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                              
                              <!-- Mostrar Progreso -->
                              <div style="flex: 0 0 auto; min-width: 150px;" id="file-upload-progress-control-${componentId}">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Progreso</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="file-upload-showprogress-toggle-${componentId}" checked onchange="setFileUploadControl('showProgress', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="file-upload-showprogress-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                </label>
                              </div>
                              
                              <!-- Acciones para Files List -->
                              <div style="flex: 0 0 100%; display: none;" id="file-upload-files-actions-${componentId}">
                                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--primary ubits-button--sm" onclick="addExampleFiles('${componentId}')">
                                    <i class="far fa-plus"></i> Agregar Archivos de Ejemplo
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm" onclick="clearFiles('${componentId}')">
                                    <i class="far fa-trash"></i> Limpiar Archivos
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 200px;">
                            <div id="file-upload-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Toast' ? `
                        <!-- Preview Section for Toast -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Tipo (Success, Info, Warning, Error) -->
                              <div style="flex: 0 0 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tipo</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="type" data-value="success" onclick="showToastPreview('success', '${componentId}')">
                                    <span>Success</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="info" onclick="showToastPreview('info', '${componentId}')">
                                    <span>Info</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="warning" onclick="showToastPreview('warning', '${componentId}')">
                                    <span>Warning</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="type" data-value="error" onclick="showToastPreview('error', '${componentId}')">
                                    <span>Error</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Mensaje -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mensaje</label>
                                <input type="text" id="toast-message-input-${componentId}" value="Â¡OperaciÃ³n exitosa!" onchange="setToastMessage(this.value, '${componentId}')" placeholder="Mensaje del toast" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                              
                              <!-- BotÃ³n de AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="toast-action-toggle-${componentId}" onchange="setToastControl('action', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="toast-action-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 120px; position: relative;">
                            <p style="text-align: center; color: var(--ubits-fg-1-medium); margin: 0; font-size: 14px;">
                              Haz clic en los botones de tipo arriba para mostrar toasts en tiempo real. Los toasts aparecerÃ¡n arriba al centro de la pantalla.
                            </p>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Input' ? `
                        <!-- Preview Section for Input -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: start;">
                              <!-- Columna Izquierda -->
                              <div style="display: flex; flex-direction: column; gap: 20px; align-items: stretch;">
                                <!-- Label -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-label-toggle-${componentId}" checked onchange="setInputControl('showLabel', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-label-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-label-input-${componentId}" value="Label" onchange="setInputControl('label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Helper Text -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Helper Text</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-helper-toggle-${componentId}" checked onchange="setInputControl('showHelper', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-helper-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-helper-input-${componentId}" value="Helper text" onchange="setInputControl('helperText', this.value, '${componentId}')" placeholder="Helper text" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Left Icon -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Left Icon</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-lefticon-toggle-${componentId}" checked onchange="setInputControl('leftIcon', this.checked ? 'user' : '', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-lefticon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-lefticon-input-${componentId}" value="user" onchange="setInputControl('leftIcon', this.value, '${componentId}')" placeholder="fa-user" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Size -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Size</label>
                                  <select id="input-size-select-${componentId}" onchange="setInputControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="xs">XS (28px)</option>
                                    <option value="sm">SM (32px)</option>
                                    <option value="md" selected>MD (36px)</option>
                                    <option value="lg">LG (48px)</option>
                                  </select>
                                </div>
                                
                                <!-- Type -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Type</label>
                                  <select id="input-type-select-${componentId}" onchange="setInputControl('type', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="text" selected>Text</option>
                                    <option value="email">Email</option>
                                    <option value="password">Password</option>
                                    <option value="number">Number</option>
                                    <option value="tel">Tel</option>
                                    <option value="url">URL</option>
                                    <option value="select">Select</option>
                                    <option value="textarea">Textarea</option>
                                    <option value="search">Search</option>
                                    <option value="autocomplete">Autocomplete</option>
                                    <option value="calendar">Calendar</option>
                                  </select>
                                </div>
                              </div>
                              
                              <!-- Columna Derecha -->
                              <div style="display: flex; flex-direction: column; gap: 20px; align-items: stretch;">
                                <!-- Mandatory/Optional -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Mandatory/Optional</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-mandatory-toggle-${componentId}" onchange="setInputControl('mandatory', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-mandatory-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                  </label>
                                  <select id="input-mandatory-type-select-${componentId}" onchange="setInputControl('mandatoryType', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="obligatorio">Obligatorio</option>
                                    <option value="opcional" selected>Opcional</option>
                                  </select>
                                </div>
                                
                                <!-- Character Counter -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Character Counter</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-counter-toggle-${componentId}" checked onchange="setInputControl('showCounter', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-counter-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="number" id="input-maxlength-input-${componentId}" value="50" onchange="setInputControl('maxLength', parseInt(this.value), '${componentId}')" placeholder="50" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Right Icon -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Right Icon</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-righticon-toggle-${componentId}" checked onchange="setInputControl('rightIcon', this.checked ? 'check' : '', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-righticon-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-righticon-input-${componentId}" value="check" onchange="setInputControl('rightIcon', this.value, '${componentId}')" placeholder="fa-check" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- State -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">State</label>
                                  <select id="input-state-select-${componentId}" onchange="setInputControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                    <option value="default" selected>Default</option>
                                    <option value="hover">Hover</option>
                                    <option value="focus">Focus</option>
                                    <option value="active">Active</option>
                                    <option value="invalid">Invalid</option>
                                    <option value="disabled">Disabled</option>
                                  </select>
                                </div>
                                
                                <!-- Placeholder -->
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Placeholder</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-placeholder-toggle-${componentId}" checked onchange="setInputControl('placeholder', this.checked ? 'Placeholder text' : '', '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-placeholder-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Activado</span>
                                  </label>
                                  <input type="text" id="input-placeholder-input-${componentId}" value="Placeholder text" onchange="setInputControl('placeholder', this.value, '${componentId}')" placeholder="Placeholder text" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Rich Text Toolbar (solo para textarea) -->
                                <div id="input-richtext-toolbar-container-${componentId}" style="display: none; flex-direction: column; gap: 8px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Barra de Enriquecimiento</label>
                                  <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" class="ubits-toggle__input" id="input-richtext-toggle-${componentId}" onchange="setInputControl('showRichTextToolbar', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                    <span id="input-richtext-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                  </label>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 200px;">
                            <div id="input-preview-${componentId}">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'List' ? `
                        <!-- Preview Section for List -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Size -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="list-size-select-${componentId}" onchange="setListControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="xs">XS (28px)</option>
                                  <option value="sm">SM (32px)</option>
                                  <option value="md" selected>MD (36px)</option>
                                  <option value="lg">LG (48px)</option>
                                </select>
                              </div>
                              
                              <!-- Item 1 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 1 Estado</label>
                                <select id="list-item1-state-select-${componentId}" onchange="setListControl('item1State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 2 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 2 Estado</label>
                                <select id="list-item2-state-select-${componentId}" onchange="setListControl('item2State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default">Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active" selected>Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 3 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 3 Estado</label>
                                <select id="list-item3-state-select-${componentId}" onchange="setListControl('item3State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default">Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled" selected>Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Item 4 State -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Item 4 Estado</label>
                                <select id="list-item4-state-select-${componentId}" onchange="setListControl('item4State', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="hover">Hover</option>
                                  <option value="active">Active</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- Max Height -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Altura MÃ¡xima</label>
                                <input type="text" id="list-maxheight-input-${componentId}" value="400px" onchange="setListControl('maxHeight', this.value, '${componentId}')" placeholder="400px" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Show Scrollbar -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Scrollbar</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="list-scrollbar-toggle-${componentId}" onchange="setListControl('showScrollbar', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span id="list-scrollbar-status-${componentId}" style="font-size: 14px; color: var(--ubits-fg-1-high);">Desactivado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 300px;">
                            <div id="list-preview-${componentId}" style="width: 100%; max-width: 400px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Sidebar' ? `
                        <!-- Preview Section for Sidebar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Variante -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="colaborador" onclick="setSidebarControl('variant', 'colaborador', '${componentId}')">
                                    <span>Colaborador</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="admin" onclick="setSidebarControl('variant', 'admin', '${componentId}')">
                                    <span>Admin</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- BotÃ³n Activo (Colaborador) -->
                              <div id="sidebar-active-colaborador-${componentId}" style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Activo</label>
                                <select id="sidebar-active-button-colaborador-${componentId}" onchange="setSidebarControl('activeButton', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="">Ninguno</option>
                                  <option value="admin">Administrador</option>
                                  <option value="aprendizaje">Aprendizaje</option>
                                  <option value="diagnÃ³stico">DiagnÃ³stico</option>
                                  <option value="desempeÃ±o">DesempeÃ±o</option>
                                  <option value="encuestas">Encuestas</option>
                                  <option value="reclutamiento">Reclutamiento</option>
                                  <option value="tareas">Tareas</option>
                                  <option value="ubits-ai">UBITS AI</option>
                                </select>
                              </div>
                              
                              <!-- BotÃ³n Activo (Admin) -->
                              <div id="sidebar-active-admin-${componentId}" style="display: none; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n Activo</label>
                                <select id="sidebar-active-button-admin-${componentId}" onchange="setSidebarControl('activeButton', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="">Ninguno</option>
                                  <option value="inicio">Inicio</option>
                                  <option value="empresa">Empresa</option>
                                  <option value="aprendizaje">Aprendizaje</option>
                                  <option value="diagnÃ³stico">DiagnÃ³stico</option>
                                  <option value="desempeÃ±o">DesempeÃ±o</option>
                                  <option value="encuestas">Encuestas</option>
                                </select>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 650px; position: relative;">
                            <div id="sidebar-preview-${componentId}" style="position: relative; overflow: visible !important;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'SubNav' ? `
                        <!-- Preview Section for SubNav -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Variante -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <select id="subnav-variant-select-${componentId}" onchange="setSubNavControl('variant', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="template" selected>Template</option>
                                  <option value="aprendizaje">Aprendizaje</option>
                                  <option value="desempeno">DesempeÃ±o</option>
                                  <option value="encuestas">Encuestas</option>
                                  <option value="tareas">Tareas</option>
                                  <option value="empresa">Empresa</option>
                                  <option value="admin-aprendizaje">Admin - Aprendizaje</option>
                                  <option value="admin-desempeno">Admin - DesempeÃ±o</option>
                                </select>
                              </div>
                              
                              <!-- Tab Activo -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Tab Activo</label>
                                <select id="subnav-active-tab-select-${componentId}" onchange="setSubNavControl('activeTabId', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <!-- Se actualizarÃ¡ dinÃ¡micamente segÃºn la variante -->
                                </select>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 24px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                            <div id="subnav-preview-${componentId}" style="width: 100%; max-width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'TabBar' ? `
                        <!-- Preview Section for TabBar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Variante -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="colaborador" onclick="setTabBarControl('variant', 'colaborador', '${componentId}')">
                                    <span>Colaborador</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="admin" onclick="setTabBarControl('variant', 'admin', '${componentId}')">
                                    <span>Admin</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- Tab Activo -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Tab Activo</label>
                                <select id="tabbar-active-tab-select-${componentId}" onchange="setTabBarControl('activeTabId', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="modulos" selected>MÃ³dulos</option>
                                  <option value="perfil">Mi perfil</option>
                                  <option value="modo-oscuro">Modo oscuro</option>
                                </select>
                              </div>
                              
                              <!-- Dark Mode Toggle -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Dark Mode Toggle</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="tabbar-darkmode-toggle-${componentId}" checked onchange="setTabBarControl('darkModeEnabled', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Habilitado</span>
                                </label>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 80px; display: flex; align-items: flex-end; justify-content: center; position: relative;">
                            <div id="tabbar-preview-${componentId}" class="ubits-tabbar-preview-container" style="width: 100%; max-width: 400px; position: relative;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Tabs' ? `
                        <!-- Preview Section for Tabs -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Tab Activo -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Tab Activo</label>
                                <select id="tabs-active-tab-select-${componentId}" onchange="setTabsControl('activeTabId', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="tab-1" selected>Label 1</option>
                                  <option value="tab-2">Label 2</option>
                                  <option value="tab-3">Label 3</option>
                                  <option value="tab-4">Label 4</option>
                                  <option value="tab-5">Label 5</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar Iconos -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Iconos</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="tabs-show-icons-toggle-${componentId}" checked onchange="setTabsControl('showIcons', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Habilitado</span>
                                </label>
                              </div>
                              
                              <!-- NÃºmero de Tabs -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Tabs</label>
                                <input type="number" id="tabs-count-input-${componentId}" min="1" max="10" value="5" onchange="setTabsControl('tabCount', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 24px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                            <div id="tabs-preview-${componentId}" style="width: 100%; max-width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Segment Control' ? `
                        <!-- Preview Section for Segment Control -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- Segmento Activo -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Segmento Activo</label>
                                <select id="segment-control-active-segment-select-${componentId}" onchange="setSegmentControlControl('activeSegmentId', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="segment-1" selected>Label 1</option>
                                  <option value="segment-2">Label 2</option>
                                  <option value="segment-3">Label 3</option>
                                  <option value="segment-4">Label 4</option>
                                  <option value="segment-5">Label 5</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar Iconos -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Iconos</label>
                                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                  <input type="checkbox" class="ubits-toggle__input" id="segment-control-show-icons-toggle-${componentId}" checked onchange="setSegmentControlControl('showIcons', this.checked, '${componentId}')">
                                  <span class="ubits-toggle__track">
                                    <span class="ubits-toggle__thumb"></span>
                                  </span>
                                  <span style="font-size: 14px; color: var(--ubits-fg-1-high);">Habilitado</span>
                                </label>
                              </div>
                              
                              <!-- NÃºmero de Segmentos -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Segmentos</label>
                                <input type="number" id="segment-control-count-input-${componentId}" min="1" max="10" value="5" onchange="setSegmentControlControl('segmentCount', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 24px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                            <div id="segment-control-preview-${componentId}" style="width: 100%; max-width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Breadcrumb' ? `
                        <!-- Preview Section for Breadcrumb -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                              <!-- NÃºmero de Items -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Items</label>
                                <input type="number" id="breadcrumb-count-input-${componentId}" min="2" max="8" value="5" onchange="setBreadcrumbControl('itemCount', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                              
                              <!-- Separador -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Separador</label>
                                <input type="text" id="breadcrumb-separator-input-${componentId}" value=">" onchange="setBreadcrumbControl('separator', this.value, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans);">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 24px; border-radius: 8px; border: none; margin-bottom: 24px; min-height: 80px; display: flex; align-items: center; justify-content: flex-start;">
                            <div id="breadcrumb-preview-${componentId}" style="width: 100%; max-width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Contenedor' ? `
                        <!-- Preview Section for Contenedor -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Variante de Fondo -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante de Fondo</label>
                                <select id="contenedor-background-variant-select-${componentId}" onchange="setContenedorControl('backgroundVariant', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: var(--font-body-sm-size, 13px); font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="bg1" selected>BG-1</option>
                                  <option value="bg2">BG-2</option>
                                  <option value="bg3">BG-3</option>
                                  <option value="bg4">BG-4</option>
                                </select>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: center; justify-content: center; min-height: 120px;">
                            <div id="contenedor-preview-${componentId}" style="width: 100%; max-width: 600px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Card Content' ? `
                        <!-- Preview Section for Card Content -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 16px;">
                              <!-- Estado -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="card-status-select-${componentId}" onchange="setCardControl('status', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="default" selected>Default</option>
                                  <option value="progress">En progreso</option>
                                  <option value="completed">Completado</option>
                                </select>
                              </div>
                              
                              <!-- Progreso -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Progreso</label>
                                <select id="card-progress-select-${componentId}" onchange="setCardControl('progress', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="0" selected>Default (0%)</option>
                                  <option value="25">25%</option>
                                  <option value="50">50%</option>
                                  <option value="75">75%</option>
                                  <option value="100">100%</option>
                                </select>
                              </div>
                              
                              <!-- Aliado -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Aliado</label>
                                <select id="card-provider-select-${componentId}" onchange="setCardControl('provider', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="UBITS" selected>UBITS</option>
                                  <option value="Microsoft">Microsoft</option>
                                  <option value="Hubspot">Hubspot</option>
                                  <option value="Harvard Business Publishing">Harvard Business Publishing</option>
                                  <option value="TED">TED</option>
                                  <option value="AWS">AWS</option>
                                  <option value="Universidad de Los Andes">Universidad de Los Andes</option>
                                  <option value="Advanced English">Advanced English</option>
                                  <option value="IE University">IE University</option>
                                  <option value="CÃ³digo Facilito">CÃ³digo Facilito</option>
                                  <option value="Hackers del Talento">Hackers del Talento</option>
                                  <option value="All Ears English">All Ears English</option>
                                  <option value="American & British Academy">American & British Academy</option>
                                  <option value="Bureau Veritas">Bureau Veritas</option>
                                  <option value="Welu">Welu</option>
                                  <option value="Figsha Smart Consulting">Figsha Smart Consulting</option>
                                  <option value="Instafit">Instafit</option>
                                  <option value="WOBI">WOBI</option>
                                </select>
                              </div>
                              
                              <!-- Competencia -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Competencia</label>
                                <select id="card-competency-select-${componentId}" onchange="setCardControl('competency', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="Product design" selected>Product design</option>
                                  <option value="Accountability">Accountability</option>
                                  <option value="AdministraciÃ³n de negocios">AdministraciÃ³n de negocios</option>
                                  <option value="Agilidad">Agilidad</option>
                                  <option value="ComunicaciÃ³n">ComunicaciÃ³n</option>
                                  <option value="Cumplimiento (Compliance)">Cumplimiento (Compliance)</option>
                                  <option value="Data skills">Data skills</option>
                                  <option value="Desarrollo de software">Desarrollo de software</option>
                                  <option value="Desarrollo web">Desarrollo web</option>
                                  <option value="Digital skills">Digital skills</option>
                                  <option value="e-Commerce">e-Commerce</option>
                                  <option value="Emprendimiento">Emprendimiento</option>
                                  <option value="Experiencia del cliente">Experiencia del cliente</option>
                                  <option value="GestiÃ³n de procesos y operaciones">GestiÃ³n de procesos y operaciones</option>
                                  <option value="GestiÃ³n de proyectos">GestiÃ³n de proyectos</option>
                                  <option value="GestiÃ³n de recursos tecnolÃ³gicos">GestiÃ³n de recursos tecnolÃ³gicos</option>
                                  <option value="GestiÃ³n del cambio">GestiÃ³n del cambio</option>
                                  <option value="GestiÃ³n del riesgo">GestiÃ³n del riesgo</option>
                                  <option value="GestiÃ³n financiera">GestiÃ³n financiera</option>
                                  <option value="Herramientas tecnolÃ³gicas">Herramientas tecnolÃ³gicas</option>
                                  <option value="InglÃ©s">InglÃ©s</option>
                                  <option value="InnovaciÃ³n">InnovaciÃ³n</option>
                                  <option value="Inteligencia emocional">Inteligencia emocional</option>
                                  <option value="Lenguajes de ProgramaciÃ³n">Lenguajes de ProgramaciÃ³n</option>
                                  <option value="Liderazgo">Liderazgo</option>
                                  <option value="Marketing">Marketing</option>
                                  <option value="Marketing digital">Marketing digital</option>
                                  <option value="NegociaciÃ³n">NegociaciÃ³n</option>
                                  <option value="People management">People management</option>
                                  <option value="Productividad">Productividad</option>
                                  <option value="ResoluciÃ³n de problemas">ResoluciÃ³n de problemas</option>
                                  <option value="Trabajo en equipo">Trabajo en equipo</option>
                                  <option value="Ventas">Ventas</option>
                                  <option value="Wellness">Wellness</option>
                                </select>
                              </div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                              <!-- Tipo de contenido -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Tipo de contenido</label>
                                <select id="card-type-select-${componentId}" onchange="setCardControl('type', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="Curso" selected>Curso</option>
                                  <option value="CÃ¡psula">CÃ¡psula</option>
                                  <option value="Charla">Charla</option>
                                  <option value="ArtÃ­culo">ArtÃ­culo</option>
                                  <option value="Podcast">Podcast</option>
                                  <option value="Libro">Libro</option>
                                  <option value="Ideas de libro">Ideas de libro</option>
                                  <option value="Caso de estudio">Caso de estudio</option>
                                  <option value="Documento tÃ©cnico">Documento tÃ©cnico</option>
                                  <option value="Ejercicios de prÃ¡ctica">Ejercicios de prÃ¡ctica</option>
                                  <option value="Ruta de aprendizaje">Ruta de aprendizaje</option>
                                </select>
                              </div>
                              
                              <!-- Nivel -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Nivel</label>
                                <select id="card-level-select-${componentId}" onchange="setCardControl('level', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="BÃ¡sico" selected>BÃ¡sico</option>
                                  <option value="Intermedio">Intermedio</option>
                                  <option value="Avanzado">Avanzado</option>
                                </select>
                              </div>
                              
                              <!-- Idioma -->
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); text-transform: uppercase; letter-spacing: 0.5px;">Idioma</label>
                                <select id="card-language-select-${componentId}" onchange="setCardControl('language', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; box-sizing: border-box; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;">
                                  <option value="EspaÃ±ol" selected>EspaÃ±ol</option>
                                  <option value="InglÃ©s">InglÃ©s</option>
                                  <option value="PortuguÃ©s">PortuguÃ©s</option>
                                </select>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW EN EL MEDIO -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="card-preview-${componentId}" style="max-width: 360px; width: 100%;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Selection Card' ? `
                        <!-- Preview Section for Selection Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 250px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="selection-card-title-input-${componentId}" value="Asignar toda la empresa" onchange="setSelectionCardControl('title', this.value, '${componentId}')" placeholder="Asignar toda la empresa" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- DescripciÃ³n -->
                              <div style="flex: 1 1 auto; min-width: 300px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">DescripciÃ³n</label>
                                <input type="text" id="selection-card-description-input-${componentId}" value="Agregaras a todos los colaboradores de la empresa que tengas en la plataforma." onchange="setSelectionCardControl('description', this.value, '${componentId}')" placeholder="DescripciÃ³n de la card" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Mostrar DescripciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar DescripciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="selection-card-show-description-toggle-${componentId}" checked onchange="setSelectionCardControl('showDescription', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="selection-card-show-description-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Segunda fila -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-top: 24px;">
                              <!-- Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono</label>
                                <input type="text" id="selection-card-icon-input-${componentId}" value="building" onchange="setSelectionCardControl('icon', this.value, '${componentId}')" placeholder="building" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Mostrar Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Icono</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="selection-card-show-icon-toggle-${componentId}" checked onchange="setSelectionCardControl('showIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="selection-card-show-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Estilo del Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estilo Icono</label>
                                <select id="selection-card-icon-style-select-${componentId}" onchange="setSelectionCardControl('iconStyle', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="regular" selected>Regular</option>
                                  <option value="solid">Solid</option>
                                </select>
                              </div>
                              
                              <!-- Estado -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                                <select id="selection-card-state-select-${componentId}" onchange="setSelectionCardControl('state', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="default" selected>Default</option>
                                  <option value="selected">Selected</option>
                                  <option value="disabled">Disabled</option>
                                </select>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="selection-card-size-select-${componentId}" onchange="setSelectionCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Contador de selecciÃ³n -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-top: 24px;">
                              <!-- Contador Actual -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contador Actual</label>
                                <input type="number" id="selection-card-count-current-input-${componentId}" value="0" min="0" max="1000" onchange="setSelectionCardControl('selectionCountCurrent', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Contador Total -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contador Total</label>
                                <input type="number" id="selection-card-count-total-input-${componentId}" value="290" min="0" max="1000" onchange="setSelectionCardControl('selectionCountTotal', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Mostrar Contador -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Contador</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="selection-card-show-count-toggle-${componentId}" checked onchange="setSelectionCardControl('showSelectionCount', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="selection-card-show-count-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="selection-card-preview-${componentId}" style="width: 100%; max-width: 500px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Stepper' ? `
                        <!-- Preview Section for Stepper -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n general -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- OrientaciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">OrientaciÃ³n</label>
                                <select id="stepper-orientation-select-${componentId}" onchange="setStepperControl('orientation', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="horizontal" selected>Horizontal</option>
                                  <option value="vertical">Vertical</option>
                                </select>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="stepper-size-select-${componentId}" onchange="setStepperControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- NÃºmero de Pasos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Pasos</label>
                                <select id="stepper-num-steps-select-${componentId}" onchange="setStepperControl('numSteps', parseInt(this.value), '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="2">2 Pasos</option>
                                  <option value="3" selected>3 Pasos</option>
                                  <option value="4">4 Pasos</option>
                                  <option value="5">5 Pasos</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar TÃ­tulos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar TÃ­tulos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="stepper-show-title-toggle-${componentId}" checked onchange="setStepperControl('showTitle', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="stepper-show-title-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Descripciones -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Descripciones</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="stepper-show-description-toggle-${componentId}" checked onchange="setStepperControl('showDescription', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="stepper-show-description-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Controles dinÃ¡micos para cada paso (se generarÃ¡n con JavaScript) -->
                            <div id="stepper-steps-controls-${componentId}" style="display: flex; flex-direction: column; gap: 24px;">
                              <!-- Se generarÃ¡n dinÃ¡micamente -->
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="stepper-preview-${componentId}" style="width: 100%; max-width: 800px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Timeline' ? `
                        <!-- Preview Section for Timeline -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n general -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- AlineaciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">AlineaciÃ³n</label>
                                <select id="timeline-alignment-select-${componentId}" onchange="setTimelineControl('alignment', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="left" selected>Izquierda</option>
                                  <option value="center">Centrada</option>
                                </select>
                              </div>
                              
                              <!-- Items Rellenos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Items Rellenos</label>
                                <select id="timeline-filled-items-select-${componentId}" onchange="setTimelineControl('filledItems', parseInt(this.value), '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="0">0 Items</option>
                                  <option value="1">1 Item</option>
                                  <option value="2" selected>2 Items</option>
                                  <option value="3">3 Items</option>
                                  <option value="4">4 Items</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar Avatar -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Avatar</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="timeline-show-avatar-toggle-${componentId}" onchange="setTimelineControl('showAvatar', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="timeline-show-avatar-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Fecha -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Fecha</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="timeline-show-date-toggle-${componentId}" checked onchange="setTimelineControl('showDate', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="timeline-show-date-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar DescripciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar DescripciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="timeline-show-description-toggle-${componentId}" checked onchange="setTimelineControl('showDescription', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="timeline-show-description-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Icono</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="timeline-show-icon-toggle-${componentId}" checked onchange="setTimelineControl('showIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="timeline-show-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="timeline-preview-${componentId}" style="width: 100%; max-width: 800px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'TreeMenu' ? `
                        <!-- Preview Section for TreeMenu -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n general -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="tree-menu-size-select-${componentId}" onchange="setTreeMenuControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- Niveles MÃ¡ximos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Niveles MÃ¡ximos</label>
                                <select id="tree-menu-max-levels-select-${componentId}" onchange="setTreeMenuControl('maxLevels', parseInt(this.value), '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="1">1 Nivel</option>
                                  <option value="2">2 Niveles</option>
                                  <option value="3" selected>3 Niveles</option>
                                  <option value="4">4 Niveles</option>
                                  <option value="5">5 Niveles</option>
                                </select>
                              </div>
                              
                              <!-- Modo -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Modo</label>
                                <select id="tree-menu-cascade-select-${componentId}" onchange="setTreeMenuControl('cascade', this.value === 'true', '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="true" selected>Cascada</option>
                                  <option value="false">Vertical</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar Iconos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Iconos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="tree-menu-show-icons-toggle-${componentId}" checked onchange="setTreeMenuControl('showIcons', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="tree-menu-show-icons-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Chevron -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Chevron</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="tree-menu-show-chevron-toggle-${componentId}" checked onchange="setTreeMenuControl('showChevron', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="tree-menu-show-chevron-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Expandir por Defecto -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Expandir por Defecto</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="tree-menu-default-expanded-toggle-${componentId}" onchange="setTreeMenuControl('defaultExpanded', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="tree-menu-default-expanded-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="tree-menu-preview-${componentId}" style="width: 100%; max-width: 600px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Simple Card' ? `
                        <!-- Preview Section for Simple Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: Variante y TamaÃ±o -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Variante -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Variante</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="variant" data-value="default" onclick="setSimpleCardControl('variant', 'default', '${componentId}')">
                                    <span>Default</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="elevated" onclick="setSimpleCardControl('variant', 'elevated', '${componentId}')">
                                    <span>Elevated</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="bordered" onclick="setSimpleCardControl('variant', 'bordered', '${componentId}')">
                                    <span>Bordered</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="variant" data-value="flat" onclick="setSimpleCardControl('variant', 'flat', '${componentId}')">
                                    <span>Flat</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="simple-card-size-select-${componentId}" onchange="setSimpleCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM (280px)</option>
                                  <option value="md" selected>MD (400px)</option>
                                  <option value="lg">LG (560px)</option>
                                  <option value="xl">XL (720px)</option>
                                </select>
                              </div>
                              
                              <!-- Mostrar Header -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Header</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="simple-card-show-header-toggle-${componentId}" checked onchange="setSimpleCardControl('showHeader', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="simple-card-show-header-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Decoraciones Header -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Decoraciones</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="simple-card-header-decorations-toggle-${componentId}" checked onchange="setSimpleCardControl('headerDecorations', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="simple-card-header-decorations-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Botones -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Botones</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="simple-card-show-buttons-toggle-${componentId}" checked onchange="setSimpleCardControl('showButtons', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="simple-card-show-buttons-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Contenido -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="simple-card-title-input-${componentId}" value="Advanced Card" onchange="setSimpleCardControl('title', this.value, '${componentId}')" placeholder="Advanced Card" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- SubtÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">SubtÃ­tulo</label>
                                <input type="text" id="simple-card-subtitle-input-${componentId}" value="Card subtitle" onchange="setSimpleCardControl('subtitle', this.value, '${componentId}')" placeholder="Card subtitle" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Contenido -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start;">
                              <!-- Contenido -->
                              <div style="flex: 1 1 auto; min-width: 100%;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Contenido</label>
                                <textarea id="simple-card-content-input-${componentId}" onchange="setSimpleCardControl('content', this.value, '${componentId}')" placeholder="Lorem ipsum dolor sit amet..." rows="3" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; resize: vertical;">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore sed consequuntur error repudiandae numquam deserunt quisquam repellat libero asperiores earum nam nobis, culpa ratione quam perferendis esse, cupiditate neque quas!</textarea>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 300px;">
                            <div id="simple-card-preview-${componentId}" style="width: 100%; max-width: 800px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Carousel' ? `
                        <!-- Preview Section for Carousel -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o de Cards -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o Cards</label>
                                <select id="carousel-card-size-select-${componentId}" onchange="setCarouselControl('cardSize', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM (280px)</option>
                                  <option value="md" selected>MD (400px)</option>
                                  <option value="lg">LG (560px)</option>
                                  <option value="xl">XL (720px)</option>
                                </select>
                              </div>
                              
                              <!-- Items por Vista -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Items por Vista</label>
                                <select id="carousel-items-per-view-select-${componentId}" onchange="setCarouselControl('itemsPerView', parseInt(this.value), '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="1">1 Item</option>
                                  <option value="2">2 Items</option>
                                  <option value="3" selected>3 Items</option>
                                  <option value="4">4 Items</option>
                                </select>
                              </div>
                              
                              <!-- Gap (Espacio entre items) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Gap (px)</label>
                                <input type="number" id="carousel-gap-input-${componentId}" value="16" min="0" max="48" step="4" onchange="setCarouselControl('gap', parseInt(this.value) || 16, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- PosiciÃ³n Flechas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PosiciÃ³n Flechas</label>
                                <select id="carousel-arrow-position-select-${componentId}" onchange="setCarouselControl('arrowPosition', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="outside" selected>Outside</option>
                                  <option value="inside">Inside</option>
                                </select>
                              </div>
                              
                              <!-- PosiciÃ³n Dots -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">PosiciÃ³n Dots</label>
                                <select id="carousel-dot-position-select-${componentId}" onchange="setCarouselControl('dotPosition', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="bottom" selected>Bottom</option>
                                  <option value="top">Top</option>
                                </select>
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Flechas -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Flechas</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="carousel-show-arrows-toggle-${componentId}" checked onchange="setCarouselControl('showArrows', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="carousel-show-arrows-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Dots -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Dots</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="carousel-show-dots-toggle-${componentId}" checked onchange="setCarouselControl('showDots', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="carousel-show-dots-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Autoplay -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Autoplay</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="carousel-autoplay-toggle-${componentId}" onchange="setCarouselControl('autoplay', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="carousel-autoplay-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Loop -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Loop</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="carousel-loop-toggle-${componentId}" onchange="setCarouselControl('loop', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="carousel-loop-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Intervalo Autoplay -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Intervalo (ms)</label>
                                <input type="number" id="carousel-autoplay-interval-input-${componentId}" value="3000" min="1000" max="10000" step="500" onchange="setCarouselControl('autoplayInterval', parseInt(this.value) || 3000, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-1); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="carousel-preview-${componentId}" style="width: 100%; max-width: 1200px;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Bar Metric Card' ? `
                        <!-- Preview Section for Bar Metric Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: Layout y TamaÃ±o -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Layout -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Layout</label>
                                <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn active" data-component="${componentId}" data-option="layout" data-value="vertical" onclick="setBarMetricCardControl('layout', 'vertical', '${componentId}')">
                                    <span>Vertical</span>
                                  </button>
                                  <button class="ubits-button ubits-button--secondary ubits-button--sm preview-control-btn" data-component="${componentId}" data-option="layout" data-value="horizontal" onclick="setBarMetricCardControl('layout', 'horizontal', '${componentId}')">
                                    <span>Horizontal</span>
                                  </button>
                                </div>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="bar-metric-card-size-select-${componentId}" onchange="setBarMetricCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="bar-metric-card-title-input-${componentId}" value="Nombre de la pregunta" onchange="setBarMetricCardControl('title', this.value, '${componentId}')" placeholder="Nombre de la pregunta" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Response Count -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Respuestas</label>
                                <input type="number" id="bar-metric-card-response-count-input-${componentId}" value="7" min="0" step="1" onchange="setBarMetricCardControl('responseCount', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles principales -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar TÃ­tulo</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-title-toggle-${componentId}" checked onchange="setBarMetricCardControl('showTitle', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-title-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Respuestas</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-response-count-toggle-${componentId}" checked onchange="setBarMetricCardControl('showResponseCount', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-response-count-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar GrÃ¡fico -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar GrÃ¡fico</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-bar-chart-toggle-${componentId}" checked onchange="setBarMetricCardControl('showBarChart', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-bar-chart-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar CategorÃ­as -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar CategorÃ­as</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-categories-toggle-${componentId}" checked onchange="setBarMetricCardControl('showCategories', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-categories-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-info-icon-toggle-${componentId}" onchange="setBarMetricCardControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-action-button-toggle-${componentId}" onchange="setBarMetricCardControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Valores Negativos -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Valores Negativos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-negative-values-toggle-${componentId}" checked onchange="setBarMetricCardControl('showNegativeValues', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-negative-values-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- LÃ­neas de GuÃ­a -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">LÃ­neas GuÃ­a</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="bar-metric-card-show-grid-lines-toggle-${componentId}" checked onchange="setBarMetricCardControl('showGridLines', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="bar-metric-card-show-grid-lines-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Datos del GrÃ¡fico -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Bar Data -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Datos Barras (separados por comas)</label>
                                <input type="text" id="bar-metric-card-bar-data-input-${componentId}" value="-25,-15,15,25,35,45,55,5,25,-15,-30,-50" onchange="setBarMetricCardControl('barData', this.value, '${componentId}')" placeholder="-25,-15,15,25,35" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Bar Labels -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Etiquetas Barras (separadas por comas)</label>
                                <input type="text" id="bar-metric-card-bar-labels-input-${componentId}" value="Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago" onchange="setBarMetricCardControl('barLabels', this.value, '${componentId}')" placeholder="Ene,Feb,Mar,Abr,May" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Max Value -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Max Value</label>
                                <input type="number" id="bar-metric-card-max-value-input-${componentId}" value="60" min="-100" max="100" step="10" onchange="setBarMetricCardControl('maxValue', parseInt(this.value) || 60, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Min Value -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Min Value</label>
                                <input type="number" id="bar-metric-card-min-value-input-${componentId}" value="-60" min="-100" max="100" step="10" onchange="setBarMetricCardControl('minValue', parseInt(this.value) || -60, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: CategorÃ­as -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- CategorÃ­a 1 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 1</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="bar-metric-card-category1-label-input-${componentId}" value="Ãrea" onchange="setBarMetricCardControl('category1Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="bar-metric-card-category1-current-input-${componentId}" value="3" min="0" step="1" onchange="setBarMetricCardControl('category1Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="bar-metric-card-category1-total-input-${componentId}" value="20" min="0" step="1" onchange="setBarMetricCardControl('category1Total', parseInt(this.value) || 0, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                </div>
                              </div>
                              
                              <!-- CategorÃ­a 2 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 2</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="bar-metric-card-category2-label-input-${componentId}" value="Equipo" onchange="setBarMetricCardControl('category2Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="bar-metric-card-category2-current-input-${componentId}" value="5" min="0" step="1" onchange="setBarMetricCardControl('category2Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="bar-metric-card-category2-total-input-${componentId}" value="15" min="0" step="1" onchange="setBarMetricCardControl('category2Total', parseInt(this.value) || 0, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                </div>
                              </div>
                              
                              <!-- CategorÃ­a 3 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 3</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="bar-metric-card-category3-label-input-${componentId}" value="Propio" onchange="setBarMetricCardControl('category3Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="bar-metric-card-category3-current-input-${componentId}" value="2" min="0" step="1" onchange="setBarMetricCardControl('category3Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="bar-metric-card-category3-total-input-${componentId}" value="10" min="0" step="1" onchange="setBarMetricCardControl('category3Total', parseInt(this.value) || 0, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="bar-metric-card-preview-${componentId}" style="width: 100%; max-width: 1200px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Text Metric Card' ? `
                        <!-- Preview Section for Text Metric Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="text-metric-card-size-select-${componentId}" onchange="setTextMetricCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="text-metric-card-title-input-${componentId}" value="Net confidence score" onchange="setTextMetricCardControl('title', this.value, '${componentId}')" placeholder="Net confidence score" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Valor -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Valor</label>
                                <input type="text" id="text-metric-card-value-input-${componentId}" value="200 / 204" onchange="setTextMetricCardControl('value', this.value, '${componentId}')" placeholder="200 / 204" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label</label>
                                <input type="text" id="text-metric-card-label-input-${componentId}" value="Colaboradores" onchange="setTextMetricCardControl('label', this.value, '${componentId}')" placeholder="Colaboradores" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Icono TÃ­tulo -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Icono TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono TÃ­tulo</label>
                                <input type="text" id="text-metric-card-title-icon-input-${componentId}" value="user" onchange="setTextMetricCardControl('titleIcon', this.value, '${componentId}')" placeholder="user, chart-line, etc." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Estilo Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estilo Icono</label>
                                <select id="text-metric-card-title-icon-style-select-${componentId}" onchange="setTextMetricCardControl('titleIconStyle', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="regular" selected>Regular</option>
                                  <option value="solid">Solid</option>
                                </select>
                              </div>
                              
                              <!-- Color Icono -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Color Icono</label>
                                <input type="text" id="text-metric-card-title-icon-color-input-${componentId}" value="" onchange="setTextMetricCardControl('titleIconColor', this.value, '${componentId}')" placeholder="var(--ubits-fg-2-medium)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="text-metric-card-show-info-icon-toggle-${componentId}" checked onchange="setTextMetricCardControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="text-metric-card-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="text-metric-card-show-action-button-toggle-${componentId}" checked onchange="setTextMetricCardControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="text-metric-card-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="text-metric-card-preview-${componentId}" style="width: 100%; max-width: 500px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'CSAT Metric Card' ? `
                        <!-- Preview Section for CSAT Metric Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="csat-metric-card-size-select-${componentId}" onchange="setCSATMetricCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="csat-metric-card-title-input-${componentId}" value="Califica el producto" onchange="setCSATMetricCardControl('title', this.value, '${componentId}')" placeholder="Califica el producto" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Total Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total Respuestas</label>
                                <input type="number" id="csat-metric-card-total-responses-input-${componentId}" value="7" min="0" step="1" onchange="setCSATMetricCardControl('totalResponses', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Etiqueta Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Etiqueta Respuestas</label>
                                <input type="text" id="csat-metric-card-responses-label-input-${componentId}" value="respuestas" onchange="setCSATMetricCardControl('responsesLabel', this.value, '${componentId}')" placeholder="respuestas" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Promedio y Score -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Promedio -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Promedio (0-5)</label>
                                <input type="number" id="csat-metric-card-average-input-${componentId}" value="4.00" min="0" max="5" step="0.01" onchange="setCSATMetricCardControl('average', parseFloat(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Etiqueta Promedio -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Etiqueta Promedio</label>
                                <input type="text" id="csat-metric-card-average-label-input-${componentId}" value="Promedio:" onchange="setCSATMetricCardControl('averageLabel', this.value, '${componentId}')" placeholder="Promedio:" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Score (0-5) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Score (0-5)</label>
                                <input type="number" id="csat-metric-card-score-input-${componentId}" value="3" min="0" max="5" step="0.5" onchange="setCSATMetricCardControl('score', parseFloat(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Icono TÃ­tulo -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Icono TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono TÃ­tulo</label>
                                <input type="text" id="csat-metric-card-title-icon-input-${componentId}" value="" onchange="setCSATMetricCardControl('titleIcon', this.value, '${componentId}')" placeholder="star, chart-line, etc." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Estilo Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estilo Icono</label>
                                <select id="csat-metric-card-title-icon-style-select-${componentId}" onchange="setCSATMetricCardControl('titleIconStyle', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="regular" selected>Regular</option>
                                  <option value="solid">Solid</option>
                                </select>
                              </div>
                              
                              <!-- Color Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Color Icono</label>
                                <input type="text" id="csat-metric-card-title-icon-color-input-${componentId}" value="" onchange="setCSATMetricCardControl('titleIconColor', this.value, '${componentId}')" placeholder="var(--ubits-fg-2-medium)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="csat-metric-card-show-info-icon-toggle-${componentId}" checked onchange="setCSATMetricCardControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="csat-metric-card-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="csat-metric-card-show-action-button-toggle-${componentId}" checked onchange="setCSATMetricCardControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="csat-metric-card-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="csat-metric-card-preview-${componentId}" style="width: 100%; max-width: 500px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'NPS Card' ? `
                        <!-- Preview Section for NPS Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="nps-card-size-select-${componentId}" onchange="setNPSCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="nps-card-title-input-${componentId}" value="Nivel de confianza" onchange="setNPSCardControl('title', this.value, '${componentId}')" placeholder="Nivel de confianza" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Score (0-100) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Score (0-100)</label>
                                <input type="number" id="nps-card-score-input-${componentId}" value="56" min="0" max="100" step="1" onchange="setNPSCardControl('score', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Score Label -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Score Label</label>
                                <input type="text" id="nps-card-score-label-input-${componentId}" value="PuntuaciÃ³n" onchange="setNPSCardControl('scoreLabel', this.value, '${componentId}')" placeholder="PuntuaciÃ³n" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Respuestas -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Total Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total Respuestas</label>
                                <input type="number" id="nps-card-total-responses-input-${componentId}" value="290" min="0" step="1" onchange="setNPSCardControl('totalResponses', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Responses Label -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Responses Label</label>
                                <input type="text" id="nps-card-responses-label-input-${componentId}" value="respuestas" onchange="setNPSCardControl('responsesLabel', this.value, '${componentId}')" placeholder="respuestas" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: CategorÃ­as -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- CategorÃ­a 1 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 1</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="nps-card-category1-label-input-${componentId}" value="No tienen confianza" onchange="setNPSCardControl('category1Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="nps-card-category1-current-input-${componentId}" value="50" min="0" step="1" onchange="setNPSCardControl('category1Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="nps-card-category1-total-input-${componentId}" value="100" min="1" step="1" onchange="setNPSCardControl('category1Total', parseInt(this.value) || 1, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <input type="text" id="nps-card-category1-color-input-${componentId}" value="var(--ubits-semantic-error, #E53E3E)" onchange="setNPSCardControl('category1Color', this.value, '${componentId}')" placeholder="Color" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                              
                              <!-- CategorÃ­a 2 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 2</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="nps-card-category2-label-input-${componentId}" value="Neutrales" onchange="setNPSCardControl('category2Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="nps-card-category2-current-input-${componentId}" value="10" min="0" step="1" onchange="setNPSCardControl('category2Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="nps-card-category2-total-input-${componentId}" value="100" min="1" step="1" onchange="setNPSCardControl('category2Total', parseInt(this.value) || 1, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <input type="text" id="nps-card-category2-color-input-${componentId}" value="var(--ubits-semantic-warning, #F6AD55)" onchange="setNPSCardControl('category2Color', this.value, '${componentId}')" placeholder="Color" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                              
                              <!-- CategorÃ­a 3 -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 3</label>
                                <div style="display: flex; gap: 8px; flex-direction: column;">
                                  <input type="text" id="nps-card-category3-label-input-${componentId}" value="Tienen confianza" onchange="setNPSCardControl('category3Label', this.value, '${componentId}')" placeholder="Label" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  <div style="display: flex; gap: 8px;">
                                    <input type="number" id="nps-card-category3-current-input-${componentId}" value="30" min="0" step="1" onchange="setNPSCardControl('category3Current', parseInt(this.value) || 0, '${componentId}')" placeholder="Current" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                    <input type="number" id="nps-card-category3-total-input-${componentId}" value="100" min="1" step="1" onchange="setNPSCardControl('category3Total', parseInt(this.value) || 1, '${componentId}')" placeholder="Total" style="flex: 1; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <input type="text" id="nps-card-category3-color-input-${componentId}" value="var(--ubits-semantic-success, #38A169)" onchange="setNPSCardControl('category3Color', this.value, '${componentId}')" placeholder="Color" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar TÃ­tulo</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-title-toggle-${componentId}" checked onchange="setNPSCardControl('showTitle', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-title-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Respuestas</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-responses-count-toggle-${componentId}" checked onchange="setNPSCardControl('showResponsesCount', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-responses-count-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Gauge -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Gauge</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-gauge-toggle-${componentId}" checked onchange="setNPSCardControl('showGauge', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-gauge-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar CategorÃ­as -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar CategorÃ­as</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-categories-toggle-${componentId}" checked onchange="setNPSCardControl('showCategories', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-categories-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-info-icon-toggle-${componentId}" checked onchange="setNPSCardControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="nps-card-show-action-button-toggle-${componentId}" checked onchange="setNPSCardControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="nps-card-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Quinta fila: Colores del Gauge -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Low Color -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Low Color (0-20)</label>
                                <input type="text" id="nps-card-low-color-input-${componentId}" value="var(--ubits-semantic-error, #E53E3E)" onchange="setNPSCardControl('lowColor', this.value, '${componentId}')" placeholder="var(--ubits-semantic-error)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Medium Color -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Medium Color (20-60)</label>
                                <input type="text" id="nps-card-medium-color-input-${componentId}" value="var(--ubits-semantic-warning, #F6AD55)" onchange="setNPSCardControl('mediumColor', this.value, '${componentId}')" placeholder="var(--ubits-semantic-warning)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- High Color -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">High Color (60-100)</label>
                                <input type="text" id="nps-card-high-color-input-${componentId}" value="var(--ubits-semantic-success, #38A169)" onchange="setNPSCardControl('highColor', this.value, '${componentId}')" placeholder="var(--ubits-semantic-success)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Gauge Background Color -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Gauge Background</label>
                                <input type="text" id="nps-card-gauge-background-color-input-${componentId}" value="var(--ubits-bg-3)" onchange="setNPSCardControl('gaugeBackgroundColor', this.value, '${componentId}')" placeholder="var(--ubits-bg-3)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 500px;">
                            <div id="nps-card-preview-${componentId}" style="width: 100%; max-width: 500px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Circle Metric Card' ? `
                        <!-- Preview Section for Circle Metric Card -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Layout -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Layout</label>
                                <div style="display: flex; gap: 8px;">
                                  <button id="circle-metric-card-layout-vertical-${componentId}" onclick="setCircleMetricCardControl('layout', 'vertical', '${componentId}')" class="ubits-button ubits-button--secondary ubits-button--sm" style="flex: 1;">Vertical</button>
                                  <button id="circle-metric-card-layout-horizontal-${componentId}" onclick="setCircleMetricCardControl('layout', 'horizontal', '${componentId}')" class="ubits-button ubits-button--primary ubits-button--sm" style="flex: 1;">Horizontal</button>
                                </div>
                              </div>
                              
                              <!-- Size -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="circle-metric-card-size-select-${componentId}" onchange="setCircleMetricCardControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">Small</option>
                                  <option value="md" selected>Medium</option>
                                  <option value="lg">Large</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="circle-metric-card-title-input-${componentId}" value="Progreso general" onchange="setCircleMetricCardControl('title', this.value, '${componentId}')" placeholder="Progreso general" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Porcentaje Principal -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Porcentaje</label>
                                <input type="number" id="circle-metric-card-main-percentage-input-${componentId}" value="50" min="0" max="100" step="1" onchange="setCircleMetricCardControl('mainPercentage', parseInt(this.value) || 50, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label Principal -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label Principal</label>
                                <input type="text" id="circle-metric-card-main-label-input-${componentId}" value="Ciclos" onchange="setCircleMetricCardControl('mainLabel', this.value, '${componentId}')" placeholder="Ciclos" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles principales -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar TÃ­tulo</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="circle-metric-card-show-title-toggle-${componentId}" checked onchange="setCircleMetricCardControl('showTitle', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="circle-metric-card-show-title-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Progreso Circular -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Progreso Circular</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="circle-metric-card-show-circular-progress-toggle-${componentId}" checked onchange="setCircleMetricCardControl('showCircularProgress', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="circle-metric-card-show-circular-progress-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar CategorÃ­as -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar CategorÃ­as</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="circle-metric-card-show-categories-toggle-${componentId}" checked onchange="setCircleMetricCardControl('showCategories', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="circle-metric-card-show-categories-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="circle-metric-card-show-info-icon-toggle-${componentId}" onchange="setCircleMetricCardControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="circle-metric-card-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="circle-metric-card-show-action-button-toggle-${componentId}" onchange="setCircleMetricCardControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="circle-metric-card-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Colores -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Color Progreso -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Color Progreso</label>
                                <input type="text" id="circle-metric-card-progress-color-input-${componentId}" value="var(--ubits-chart-color-bg-neutral-blue-base, #557593)" onchange="setCircleMetricCardControl('progressColor', this.value, '${componentId}')" placeholder="var(--ubits-chart-color-bg-neutral-blue-base)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Color Fondo CÃ­rculo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Color Fondo CÃ­rculo</label>
                                <input type="text" id="circle-metric-card-circle-background-color-input-${componentId}" value="var(--ubits-bg-3)" onchange="setCircleMetricCardControl('circleBackgroundColor', this.value, '${componentId}')" placeholder="var(--ubits-bg-3)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: CategorÃ­a 1 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 1 - Label</label>
                                <input type="text" id="circle-metric-card-category1-label-input-${componentId}" value="Ãrea" onchange="setCircleMetricCardControl('category1Label', this.value, '${componentId}')" placeholder="Ãrea" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Current</label>
                                <input type="number" id="circle-metric-card-category1-current-input-${componentId}" value="3" min="0" step="1" onchange="setCircleMetricCardControl('category1Current', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total</label>
                                <input type="number" id="circle-metric-card-category1-total-input-${componentId}" value="20" min="1" step="1" onchange="setCircleMetricCardControl('category1Total', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Quinta fila: CategorÃ­a 2 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 2 - Label</label>
                                <input type="text" id="circle-metric-card-category2-label-input-${componentId}" value="Equipo" onchange="setCircleMetricCardControl('category2Label', this.value, '${componentId}')" placeholder="Equipo" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Current</label>
                                <input type="number" id="circle-metric-card-category2-current-input-${componentId}" value="8" min="0" step="1" onchange="setCircleMetricCardControl('category2Current', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total</label>
                                <input type="number" id="circle-metric-card-category2-total-input-${componentId}" value="50" min="1" step="1" onchange="setCircleMetricCardControl('category2Total', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Sexta fila: CategorÃ­a 3 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">CategorÃ­a 3 - Label</label>
                                <input type="text" id="circle-metric-card-category3-label-input-${componentId}" value="Propio" onchange="setCircleMetricCardControl('category3Label', this.value, '${componentId}')" placeholder="Propio" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Current</label>
                                <input type="number" id="circle-metric-card-category3-current-input-${componentId}" value="5" min="0" step="1" onchange="setCircleMetricCardControl('category3Current', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              <div style="flex: 0 0 auto; min-width: 100px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total</label>
                                <input type="number" id="circle-metric-card-category3-total-input-${componentId}" value="30" min="1" step="1" onchange="setCircleMetricCardControl('category3Total', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="circle-metric-card-preview-${componentId}" style="width: 100%; max-width: 800px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Score Card Metrics' ? `
                        <!-- Preview Section for Score Card Metrics -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Size -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="score-card-metrics-size-select-${componentId}" onchange="setScoreCardMetricsControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">Small</option>
                                  <option value="md" selected>Medium</option>
                                  <option value="lg">Large</option>
                                </select>
                              </div>
                              
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="score-card-metrics-title-input-${componentId}" value="Califica el producto" onchange="setScoreCardMetricsControl('title', this.value, '${componentId}')" placeholder="Califica el producto" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Total Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Total Respuestas</label>
                                <input type="number" id="score-card-metrics-total-responses-input-${componentId}" value="7" min="0" step="1" onchange="setScoreCardMetricsControl('totalResponses', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label Respuestas -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label Respuestas</label>
                                <input type="text" id="score-card-metrics-responses-label-input-${componentId}" value="respuestas" onchange="setScoreCardMetricsControl('responsesLabel', this.value, '${componentId}')" placeholder="respuestas" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Promedio y Score -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Promedio -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Promedio</label>
                                <input type="number" id="score-card-metrics-average-input-${componentId}" value="4.00" min="0" max="5" step="0.01" onchange="setScoreCardMetricsControl('average', parseFloat(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label Promedio -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label Promedio</label>
                                <input type="text" id="score-card-metrics-average-label-input-${componentId}" value="Promedio:" onchange="setScoreCardMetricsControl('averageLabel', this.value, '${componentId}')" placeholder="Promedio:" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Score -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Score (0-5)</label>
                                <input type="number" id="score-card-metrics-score-input-${componentId}" value="3" min="0" max="5" step="0.5" onchange="setScoreCardMetricsControl('score', parseFloat(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label Izquierda -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label Izquierda</label>
                                <input type="text" id="score-card-metrics-left-label-input-${componentId}" value="0" onchange="setScoreCardMetricsControl('leftLabel', this.value, '${componentId}')" placeholder="0" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Label Derecha -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Label Derecha</label>
                                <input type="text" id="score-card-metrics-right-label-input-${componentId}" value="5" onchange="setScoreCardMetricsControl('rightLabel', this.value, '${componentId}')" placeholder="5" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Icono TÃ­tulo -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Icono TÃ­tulo -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono TÃ­tulo</label>
                                <input type="text" id="score-card-metrics-title-icon-input-${componentId}" value="" onchange="setScoreCardMetricsControl('titleIcon', this.value, '${componentId}')" placeholder="star" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Estilo Icono -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estilo Icono</label>
                                <select id="score-card-metrics-title-icon-style-select-${componentId}" onchange="setScoreCardMetricsControl('titleIconStyle', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="regular" selected>Regular</option>
                                  <option value="solid">Solid</option>
                                </select>
                              </div>
                              
                              <!-- Color Icono -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Color Icono</label>
                                <input type="text" id="score-card-metrics-title-icon-color-input-${componentId}" value="" onchange="setScoreCardMetricsControl('titleIconColor', this.value, '${componentId}')" placeholder="var(--ubits-fg-2-medium)" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Icono Info -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Info</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="score-card-metrics-show-info-icon-toggle-${componentId}" onchange="setScoreCardMetricsControl('showInfoIcon', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="score-card-metrics-show-info-icon-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- BotÃ³n AcciÃ³n -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">BotÃ³n AcciÃ³n</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="score-card-metrics-show-action-button-toggle-${componentId}" onchange="setScoreCardMetricsControl('showActionButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="score-card-metrics-show-action-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="score-card-metrics-preview-${componentId}" style="width: 100%; max-width: 500px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'DataView' ? `
                        <!-- Preview Section for DataView -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="data-view-size-select-${componentId}" onchange="setDataViewControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                </select>
                              </div>
                              
                              <!-- NÃºmero de Productos -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Productos</label>
                                <input type="number" id="data-view-product-count-input-${componentId}" value="5" min="1" max="10" step="1" onchange="setDataViewControl('productCount', parseInt(this.value) || 1, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Estado Stock por Defecto -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Estado Stock</label>
                                <select id="data-view-stock-status-select-${componentId}" onchange="setDataViewControl('defaultStockStatus', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="INSTOCK" selected>INSTOCK</option>
                                  <option value="LOWSTOCK">LOWSTOCK</option>
                                  <option value="OUTOFSTOCK">OUTOFSTOCK</option>
                                </select>
                              </div>
                              
                              <!-- Rating por Defecto -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Rating (0-5)</label>
                                <input type="number" id="data-view-rating-input-${componentId}" value="4" min="0" max="5" step="0.5" onchange="setDataViewControl('defaultRating', parseFloat(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Precio por Defecto -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Precio</label>
                                <input type="number" id="data-view-price-input-${componentId}" value="50" min="0" step="1" onchange="setDataViewControl('defaultPrice', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Botones -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Texto BotÃ³n Compra -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Texto BotÃ³n Compra</label>
                                <input type="text" id="data-view-buy-button-text-input-${componentId}" value="Buy Now" onchange="setDataViewControl('buyButtonText', this.value, '${componentId}')" placeholder="Buy Now" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono BotÃ³n Compra -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono BotÃ³n Compra</label>
                                <input type="text" id="data-view-buy-button-icon-input-${componentId}" value="shopping-cart" onchange="setDataViewControl('buyButtonIcon', this.value, '${componentId}')" placeholder="shopping-cart" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Icono Wishlist -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Icono Wishlist</label>
                                <input type="text" id="data-view-wishlist-icon-input-${componentId}" value="heart" onchange="setDataViewControl('wishlistIcon', this.value, '${componentId}')" placeholder="heart" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Tercera fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar CategorÃ­a -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar CategorÃ­a</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="data-view-show-category-toggle-${componentId}" checked onchange="setDataViewControl('showCategory', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="data-view-show-category-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Rating -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Rating</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="data-view-show-rating-toggle-${componentId}" checked onchange="setDataViewControl('showRating', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="data-view-show-rating-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Precio -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Precio</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="data-view-show-price-toggle-${componentId}" checked onchange="setDataViewControl('showPrice', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="data-view-show-price-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Wishlist -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Wishlist</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="data-view-show-wishlist-toggle-${componentId}" checked onchange="setDataViewControl('showWishlist', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="data-view-show-wishlist-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar BotÃ³n Compra -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar BotÃ³n Compra</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="data-view-show-buy-button-toggle-${componentId}" checked onchange="setDataViewControl('showBuyButton', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="data-view-show-buy-button-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="data-view-preview-${componentId}" style="width: 100%; max-width: 800px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Menu' ? `
                        <!-- Preview Section for Menu -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: Header -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Logo Image -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Logo Image URL</label>
                                <input type="text" id="menu-logo-image-input-${componentId}" value="../assets/images/autoframe-logo-light.svg" onchange="setMenuControl('logoImage', this.value, '${componentId}')" placeholder="../assets/images/autoframe-logo-light.svg" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- App Name -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">App Name</label>
                                <input type="text" id="menu-app-name-input-${componentId}" value="AUTOFROME" onchange="setMenuControl('appName', this.value, '${componentId}')" placeholder="AUTOFROME" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Logo Href -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Logo Href</label>
                                <input type="text" id="menu-logo-href-input-${componentId}" value="#" onchange="setMenuControl('logoHref', this.value, '${componentId}')" placeholder="#" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Width -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Width (px)</label>
                                <input type="number" id="menu-width-input-${componentId}" value="280" min="200" max="400" step="10" onchange="setMenuControl('width', parseInt(this.value) || 280, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: SecciÃ³n 1 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 100%; padding: 16px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">SecciÃ³n 1</h5>
                                
                                <!-- TÃ­tulo SecciÃ³n 1 -->
                                <div style="margin-bottom: 16px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                  <input type="text" id="menu-section1-title-input-${componentId}" value="Documents" onchange="setMenuControl('section1Title', this.value, '${componentId}')" placeholder="Documents" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Item 1 SecciÃ³n 1 -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 12px;">
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Item 1 Label</label>
                                    <input type="text" id="menu-section1-item1-label-input-${componentId}" value="New" onchange="setMenuControl('section1Item1Label', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon</label>
                                    <input type="text" id="menu-section1-item1-icon-input-${componentId}" value="plus" onchange="setMenuControl('section1Item1Icon', this.value, '${componentId}')" placeholder="plus" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon Style</label>
                                    <select id="menu-section1-item1-icon-style-select-${componentId}" onchange="setMenuControl('section1Item1IconStyle', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="regular" selected>Regular</option>
                                      <option value="solid">Solid</option>
                                    </select>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section1-item1-active-toggle-${componentId}" onchange="setMenuControl('section1Item1Active', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Active</span>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section1-item1-disabled-toggle-${componentId}" onchange="setMenuControl('section1Item1Disabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Disabled</span>
                                  </div>
                                </div>
                                
                                <!-- Item 2 SecciÃ³n 1 -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Item 2 Label</label>
                                    <input type="text" id="menu-section1-item2-label-input-${componentId}" value="Search" onchange="setMenuControl('section1Item2Label', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon</label>
                                    <input type="text" id="menu-section1-item2-icon-input-${componentId}" value="search" onchange="setMenuControl('section1Item2Icon', this.value, '${componentId}')" placeholder="search" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon Style</label>
                                    <select id="menu-section1-item2-icon-style-select-${componentId}" onchange="setMenuControl('section1Item2IconStyle', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="regular" selected>Regular</option>
                                      <option value="solid">Solid</option>
                                    </select>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section1-item2-active-toggle-${componentId}" onchange="setMenuControl('section1Item2Active', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Active</span>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section1-item2-disabled-toggle-${componentId}" onchange="setMenuControl('section1Item2Disabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Disabled</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Tercera fila: SecciÃ³n 2 -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 100%; padding: 16px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">SecciÃ³n 2</h5>
                                
                                <!-- TÃ­tulo SecciÃ³n 2 -->
                                <div style="margin-bottom: 16px;">
                                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                  <input type="text" id="menu-section2-title-input-${componentId}" value="Profile" onchange="setMenuControl('section2Title', this.value, '${componentId}')" placeholder="Profile" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                </div>
                                
                                <!-- Item 1 SecciÃ³n 2 -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 12px;">
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Item 1 Label</label>
                                    <input type="text" id="menu-section2-item1-label-input-${componentId}" value="Settings" onchange="setMenuControl('section2Item1Label', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon</label>
                                    <input type="text" id="menu-section2-item1-icon-input-${componentId}" value="gear" onchange="setMenuControl('section2Item1Icon', this.value, '${componentId}')" placeholder="gear" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon Style</label>
                                    <select id="menu-section2-item1-icon-style-select-${componentId}" onchange="setMenuControl('section2Item1IconStyle', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="regular" selected>Regular</option>
                                      <option value="solid">Solid</option>
                                    </select>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item1-active-toggle-${componentId}" checked onchange="setMenuControl('section2Item1Active', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Active</span>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item1-disabled-toggle-${componentId}" onchange="setMenuControl('section2Item1Disabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Disabled</span>
                                  </div>
                                </div>
                                
                                <!-- Item 2 SecciÃ³n 2 (con badge) -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 12px;">
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Item 2 Label</label>
                                    <input type="text" id="menu-section2-item2-label-input-${componentId}" value="Messages" onchange="setMenuControl('section2Item2Label', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon</label>
                                    <input type="text" id="menu-section2-item2-icon-input-${componentId}" value="envelope" onchange="setMenuControl('section2Item2Icon', this.value, '${componentId}')" placeholder="envelope" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon Style</label>
                                    <select id="menu-section2-item2-icon-style-select-${componentId}" onchange="setMenuControl('section2Item2IconStyle', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="regular" selected>Regular</option>
                                      <option value="solid">Solid</option>
                                    </select>
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Badge</label>
                                    <input type="number" id="menu-section2-item2-badge-input-${componentId}" value="2" min="0" max="99" step="1" onchange="setMenuControl('section2Item2Badge', parseInt(this.value) || 0, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Badge Variant</label>
                                    <select id="menu-section2-item2-badge-variant-select-${componentId}" onchange="setMenuControl('section2Item2BadgeVariant', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="primary" selected>Primary</option>
                                      <option value="secondary">Secondary</option>
                                      <option value="success">Success</option>
                                      <option value="warning">Warning</option>
                                      <option value="error">Error</option>
                                      <option value="info">Info</option>
                                    </select>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item2-active-toggle-${componentId}" onchange="setMenuControl('section2Item2Active', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Active</span>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item2-disabled-toggle-${componentId}" onchange="setMenuControl('section2Item2Disabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Disabled</span>
                                  </div>
                                </div>
                                
                                <!-- Item 3 SecciÃ³n 2 -->
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Item 3 Label</label>
                                    <input type="text" id="menu-section2-item3-label-input-${componentId}" value="Logout" onchange="setMenuControl('section2Item3Label', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon</label>
                                    <input type="text" id="menu-section2-item3-icon-input-${componentId}" value="sign-out" onchange="setMenuControl('section2Item3Icon', this.value, '${componentId}')" placeholder="sign-out" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 11px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 6px;">Icon Style</label>
                                    <select id="menu-section2-item3-icon-style-select-${componentId}" onchange="setMenuControl('section2Item3IconStyle', this.value, '${componentId}')" style="width: 100%; padding: 8px 10px; border: none; border-radius: 6px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 8px center; background-size: 14px; box-sizing: border-box;">
                                      <option value="regular" selected>Regular</option>
                                      <option value="solid">Solid</option>
                                    </select>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item3-active-toggle-${componentId}" onchange="setMenuControl('section2Item3Active', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Active</span>
                                  </div>
                                  <div style="display: flex; align-items: center; gap: 8px; padding-top: 20px;">
                                    <label class="ubits-toggle ubits-toggle--sm">
                                      <input type="checkbox" class="ubits-toggle__input" id="menu-section2-item3-disabled-toggle-${componentId}" onchange="setMenuControl('section2Item3Disabled', this.checked, '${componentId}')">
                                      <span class="ubits-toggle__track">
                                        <span class="ubits-toggle__thumb"></span>
                                      </span>
                                    </label>
                                    <span style="font-size: 11px; color: var(--ubits-fg-1-medium);">Disabled</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            
                            <!-- Cuarta fila: Usuario -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <div style="flex: 1 1 100%; padding: 16px; background: var(--ubits-bg-1); border-radius: 8px; border: 1px solid var(--ubits-border-1);">
                                <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">InformaciÃ³n de Usuario</h5>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                                  <div>
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Avatar Image URL</label>
                                    <input type="text" id="menu-user-avatar-image-input-${componentId}" value="../assets/images/Profile-image.jpg" onchange="setMenuControl('userAvatarImage', this.value, '${componentId}')" placeholder="../assets/images/Profile-image.jpg" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">User Name</label>
                                    <input type="text" id="menu-user-name-input-${componentId}" value="Amy Elsner" onchange="setMenuControl('userName', this.value, '${componentId}')" placeholder="Amy Elsner" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                  <div>
                                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">User Role</label>
                                    <input type="text" id="menu-user-role-input-${componentId}" value="Admin" onchange="setMenuControl('userRole', this.value, '${componentId}')" placeholder="Admin" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 600px;">
                            <div id="menu-preview-${componentId}" style="width: 100%; max-width: 1200px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Menubar' ? `
                        <!-- Preview Section for Menubar -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Item Count -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero de Items</label>
                                <input type="number" id="menubar-item-count-input-${componentId}" value="4" min="1" max="10" step="1" onchange="setMenubarControl('itemCount', parseInt(this.value) || 4, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Active Item ID -->
                              <div style="flex: 0 0 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Item Activo ID</label>
                                <input type="text" id="menubar-active-item-id-input-${componentId}" value="projects" onchange="setMenubarControl('activeItemId', this.value, '${componentId}')" placeholder="projects, home, features, etc." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Iconos -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Iconos</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="menubar-show-icons-toggle-${componentId}" checked onchange="setMenubarControl('showIcons', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="menubar-show-icons-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Tener Dropdowns -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Tener Dropdowns</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="menubar-has-dropdowns-toggle-${componentId}" checked onchange="setMenubarControl('hasDropdowns', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="menubar-has-dropdowns-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- SubmenÃºs Anidados -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">SubmenÃºs Anidados</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="menubar-has-nested-submenus-toggle-${componentId}" onchange="setMenubarControl('hasNestedSubmenus', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="menubar-has-nested-submenus-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 200px;">
                            <div id="menubar-preview-${componentId}" style="width: 100%; max-width: 1200px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Menu de Participantes' ? `
                        <!-- Preview Section for Participants Menu -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- TÃ­tulo -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                                <input type="text" id="participants-menu-title-input-${componentId}" value="Participantes" onchange="setParticipantsMenuControl('title', this.value, '${componentId}')" placeholder="Participantes" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Search Placeholder -->
                              <div style="flex: 1 1 auto; min-width: 200px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Search Placeholder</label>
                                <input type="text" id="participants-menu-search-placeholder-input-${componentId}" value="Buscar participan..." onchange="setParticipantsMenuControl('searchPlaceholder', this.value, '${componentId}')" placeholder="Buscar participan..." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- NÃºmero de Participantes -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">NÃºmero Participantes</label>
                                <input type="number" id="participants-menu-participant-count-input-${componentId}" value="9" min="1" max="20" step="1" onchange="setParticipantsMenuControl('participantCount', parseInt(this.value) || 9, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Selected Participant ID -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Participante Seleccionado</label>
                                <input type="text" id="participants-menu-selected-participant-id-input-${componentId}" value="1" onchange="setParticipantsMenuControl('selectedParticipantId', this.value || undefined, '${componentId}')" placeholder="1, 2, 3..." style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Avatar -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Avatar</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="participants-menu-show-avatar-toggle-${componentId}" checked onchange="setParticipantsMenuControl('showAvatar', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="participants-menu-show-avatar-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Rol -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Rol</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="participants-menu-show-role-toggle-${componentId}" checked onchange="setParticipantsMenuControl('showRole', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="participants-menu-show-role-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Mostrar Status Tag -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Mostrar Status Tag</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="participants-menu-show-status-tag-toggle-${componentId}" checked onchange="setParticipantsMenuControl('showStatusTag', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="participants-menu-show-status-tag-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                              
                              <!-- Enable Scrollbar -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Enable Scrollbar</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="participants-menu-enable-scrollbar-toggle-${componentId}" checked onchange="setParticipantsMenuControl('enableScrollbar', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="participants-menu-enable-scrollbar-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 600px;">
                            <div id="participants-menu-preview-${componentId}" style="width: 100%; max-width: 320px; height: 600px; display: flex; justify-content: center; background: var(--ubits-bg-1); border-radius: 8px; overflow: hidden;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      ${hasPreview && component.name === 'Gallery' ? `
                        <!-- Preview Section for Gallery -->
                        <div style="background: var(--ubits-bg-2); padding: 24px; border-radius: 12px; border: none; margin-bottom: 24px;">
                          <!-- CONTROLES ARRIBA -->
                          <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 20px 0; color: var(--ubits-fg-1-high); font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                              <i class="far fa-sliders-h" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                              Controles
                            </h4>
                            
                            <!-- Primera fila: ConfiguraciÃ³n bÃ¡sica -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Layout -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Layout</label>
                                <select id="gallery-layout-select-${componentId}" onchange="setGalleryControl('layout', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="grid" selected>Grid</option>
                                  <option value="masonry">Masonry</option>
                                  <option value="list">List</option>
                                </select>
                              </div>
                              
                              <!-- TamaÃ±o -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">TamaÃ±o</label>
                                <select id="gallery-size-select-${componentId}" onchange="setGalleryControl('size', this.value, '${componentId}')" style="width: 100%; padding: 10px 32px 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                                  <option value="xs">XS</option>
                                  <option value="sm">SM</option>
                                  <option value="md" selected>MD</option>
                                  <option value="lg">LG</option>
                                  <option value="xl">XL</option>
                                </select>
                              </div>
                              
                              <!-- Columnas (solo para grid) -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Columnas</label>
                                <input type="number" id="gallery-columns-input-${componentId}" value="3" min="1" max="12" step="1" onchange="setGalleryControl('columns', parseInt(this.value) || 3, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Gap -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Gap (px)</label>
                                <input type="number" id="gallery-gap-input-${componentId}" value="16" min="0" max="48" step="4" onchange="setGalleryControl('gap', parseInt(this.value) || 16, '${componentId}')" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                              
                              <!-- Aspect Ratio -->
                              <div style="flex: 0 0 auto; min-width: 150px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Aspect Ratio</label>
                                <input type="text" id="gallery-aspect-ratio-input-${componentId}" value="" onchange="setGalleryControl('aspectRatio', this.value || undefined, '${componentId}')" placeholder="16/9, 1/1, 4/3" style="width: 100%; padding: 10px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box;">
                              </div>
                            </div>
                            
                            <!-- Segunda fila: Toggles -->
                            <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: flex-start; margin-bottom: 24px;">
                              <!-- Mostrar Thumbnails -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Thumbnails</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="gallery-show-thumbnails-toggle-${componentId}" onchange="setGalleryControl('showThumbnails', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="gallery-show-thumbnails-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Lazy Load -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Lazy Load</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="gallery-lazy-load-toggle-${componentId}" onchange="setGalleryControl('lazyLoad', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="gallery-lazy-load-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Desactivado</span>
                                </div>
                              </div>
                              
                              <!-- Lightbox -->
                              <div style="flex: 0 0 auto; min-width: 120px;">
                                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Lightbox</label>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                  <label class="ubits-toggle ubits-toggle--md">
                                    <input type="checkbox" class="ubits-toggle__input" id="gallery-lightbox-toggle-${componentId}" checked onchange="setGalleryControl('lightbox', this.checked, '${componentId}')">
                                    <span class="ubits-toggle__track">
                                      <span class="ubits-toggle__thumb"></span>
                                    </span>
                                  </label>
                                  <span id="gallery-lightbox-status-${componentId}" style="font-size: 13px; color: var(--ubits-fg-1-medium);">Activado</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <!-- PREVIEW -->
                          <div style="background: var(--ubits-bg-2); padding: 48px; border-radius: 8px; border: none; margin-bottom: 24px; display: flex; align-items: flex-start; justify-content: center; min-height: 400px;">
                            <div id="gallery-preview-${componentId}" style="width: 100%; max-width: 1200px; display: flex; justify-content: center;">
                              <!-- Se generarÃ¡ dinÃ¡micamente -->
                            </div>
                          </div>
                        </div>
                      ` : ''}
                      
                      <!-- INFORMACIÃ“N DEL COMPONENTE -->
                      <div style="margin-top: 32px; padding-top: 32px; border-top: 2px solid var(--ubits-border-1);">
                        <h4 style="margin: 0 0 24px 0; color: var(--ubits-fg-1-high); font-size: 18px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                          <i class="far fa-info-circle" style="color: var(--ubits-accent-brand-static-inverted);"></i>
                          InformaciÃ³n del Componente
                        </h4>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                          ${component.files ? `
                            <div style="background: var(--ubits-bg-2); padding: 20px; border-radius: 12px; border: none;">
                              <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px;">
                                <i class="far fa-file-code" style="font-size: 14px;"></i>
                                Archivos
                              </div>
                              <div style="display: flex; flex-direction: column; gap: 8px;">
                                ${Object.entries(component.files).map(([type, path]) => `
                                  <div style="display: flex; align-items: start; gap: 8px; padding: 10px; background: var(--ubits-bg-1); border-radius: 8px; border: none;">
                                    <span style="font-size: 11px; font-weight: 600; color: var(--ubits-accent-brand-static-inverted); text-transform: uppercase; min-width: 50px;">${type}</span>
                                    <code style="font-size: 13px; color: var(--ubits-fg-1-high); font-family: 'Monaco', 'Menlo', monospace; flex: 1; word-break: break-all;">${path}</code>
                                  </div>
                                `).join('')}
                              </div>
                            </div>
                          ` : ''}
                          
                          ${component.class ? `
                            <div style="background: var(--ubits-bg-2); padding: 20px; border-radius: 12px; border: none;">
                              <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px;">
                                <i class="far fa-code" style="font-size: 14px;"></i>
                                Clase CSS
                              </div>
                              <div style="padding: 12px; background: var(--ubits-bg-1); border-radius: 8px; border: none;">
                                <code style="font-size: 13px; color: var(--ubits-fg-1-high); font-family: 'Monaco', 'Menlo', monospace; word-break: break-all;">${component.class}</code>
                              </div>
                            </div>
                          ` : ''}
                          
                          ${component.features && component.features.length > 0 ? `
                            <div style="background: var(--ubits-bg-2); padding: 20px; border-radius: 12px; border: none;">
                              <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px;">
                                <i class="far fa-star" style="font-size: 14px;"></i>
                                CaracterÃ­sticas
                              </div>
                              <div style="display: flex; flex-direction: column; gap: 6px;">
                                ${component.features.map(feature => `
                                  <div style="display: flex; align-items: start; gap: 8px; padding: 8px; background: var(--ubits-bg-1); border-radius: 6px; border: none;">
                                    <i class="far fa-check-circle" style="font-size: 12px; color: var(--ubits-accent-brand-static-inverted); margin-top: 2px; flex-shrink: 0;"></i>
                                    <span style="font-size: 13px; color: var(--ubits-fg-1-high); line-height: 1.4;">${feature}</span>
                                  </div>
                                `).join('')}
                              </div>
                            </div>
                          ` : ''}
                          
                          ${component.example ? `
                            <div style="background: var(--ubits-bg-2); padding: 20px; border-radius: 12px; border: none; grid-column: 1 / -1;">
                              <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 6px;">
                                <i class="far fa-file-code" style="font-size: 14px;"></i>
                                Ejemplo de cÃ³digo
                              </div>
                              <div style="position: relative;">
                                <pre style="margin: 0; padding: 16px; background: var(--ubits-bg-1); border-radius: 8px; border: none; overflow-x: auto;"><code style="font-size: 13px; color: var(--ubits-fg-1-high); font-family: 'Monaco', 'Menlo', monospace; white-space: pre-wrap; word-wrap: break-word;">${component.example}</code></pre>
                                <button onclick="copyComponentCode(this)" data-code="${encodeURIComponent(component.example)}" style="position: absolute; top: 8px; right: 8px; background: var(--ubits-bg-2); border: none; border-radius: 6px; padding: 6px 12px; cursor: pointer; font-size: 12px; color: var(--ubits-fg-1-medium); transition: all 0.2s ease; display: flex; align-items: center; gap: 6px;" onmouseover="this.style.background='var(--ubits-bg-1)'; this.style.color='var(--ubits-fg-1-high)';" onmouseout="this.style.background='var(--ubits-bg-2)'; this.style.color='var(--ubits-fg-1-medium)';">
                                  <i class="far fa-copy"></i>
                                  Copiar
                                </button>
                              </div>
                            </div>
                          ` : ''}
                        </div>
                      </div>
                      
                      
                      ${component.competencies ? `
                          <div style="grid-column: 1 / -1;">
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Competencias (35)
                            </div>
                            <div style="font-size: 12px; color: var(--ubits-fg-1-high); max-height: 200px; overflow-y: auto; padding: 8px; background: var(--ubits-bg-2); border-radius: 6px; border: none; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 4px;">
                              ${component.competencies.map(c => `<div style="padding: 2px 0;">â€¢ ${c}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.providers ? `
                          <div style="grid-column: 1 / -1;">
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Proveedores (18)
                            </div>
                            <div style="font-size: 12px; color: var(--ubits-fg-1-high); max-height: 150px; overflow-y: auto; padding: 8px; background: var(--ubits-bg-2); border-radius: 6px; border: none; display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 4px;">
                              ${component.providers.map(p => `<div style="padding: 2px 0;">â€¢ ${p}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.levels ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Niveles
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.levels.map(l => `<div style="padding: 4px 0;">â€¢ ${l}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.durations ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Duraciones
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.durations.map(d => `<div style="padding: 4px 0;">â€¢ ${d}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.languages ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Idiomas
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.languages.map(l => `<div style="padding: 4px 0;">â€¢ ${l}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        ${component.statuses ? `
                          <div>
                            <div style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">
                              Estados
                            </div>
                            <div style="font-size: 13px; color: var(--ubits-fg-1-high);">
                              ${component.statuses.map(s => `<div style="padding: 4px 0;">â€¢ ${s}</div>`).join('')}
                            </div>
                          </div>
                        ` : ''}
                        
                        </div>
                      </div>
                      
                    </div>
                  `;
                    }).join('');
          }).flat().join('');
          
          console.log('âœ… HTML generado, longitud:', htmlString.length);
          
          // Verificar que el HTML contiene el componente Button ANTES de asignar
          const htmlContainsButton = htmlString.includes('component-button');
          console.log('ğŸ” HTML generado contiene component-button:', htmlContainsButton);
          
          if (!htmlContainsButton) {
            console.error('âŒ ERROR CRÃTICO: El HTML generado NO contiene component-button');
            console.log('ğŸ“‹ Buscando "Button" en HTML:', htmlString.includes('Button'));
            console.log('ğŸ“‹ Primeras 1000 caracteres del HTML:', htmlString.substring(0, 1000));
          } else {
            console.log('âœ… HTML contiene component-button, asignando al DOM...');
          }
          
          // ASIGNAR al contenedor
          componentsContainer.innerHTML = htmlString;
          console.log('âœ… HTML asignado al contenedor, longitud del innerHTML:', componentsContainer.innerHTML.length);
          
          // Ocultar todos los componentes inicialmente
          document.querySelectorAll('[id^="component-"]').forEach(el => {
            el.style.display = 'none';
          });
          
          // Verificar en el DOM despuÃ©s de un momento
          setTimeout(() => {
            const buttonEl = document.getElementById('component-button');
            console.log('ğŸ” VerificaciÃ³n en DOM - component-button existe:', buttonEl !== null);
            if (buttonEl) {
              console.log('âœ… Elemento Button encontrado en DOM:', {
                id: buttonEl.id,
                visible: buttonEl.offsetHeight > 0,
                parent: buttonEl.parentElement?.id || 'N/A'
              });
            } else {
              console.error('âŒ Elemento component-button NO encontrado en el DOM despuÃ©s de renderizar');
              console.log('ğŸ“‹ Elementos con id que contienen "component":', 
                Array.from(document.querySelectorAll('[id*="component"]')).map(el => el.id));
            }
          }, 50);
          
          // Generar navegaciÃ³n despuÃ©s de renderizar
          generateComponentsNav();
          
          // Cargar Button por defecto al inicio
          setTimeout(() => {
            if (!activeComponent) {
              loadComponent('button');
            }
          }, 200);
          
          // Inicializar preview del Button INMEDIATAMENTE despuÃ©s de renderizar
          setTimeout(() => {
            const buttonComponent = document.getElementById('component-button');
            const buttonPreview = document.getElementById('button-preview-button');
            
            console.log('ğŸ” Buscando preview de Button...');
            console.log('  - component-button:', buttonComponent ? 'âœ… encontrado' : 'âŒ no encontrado');
            console.log('  - button-preview-button:', buttonPreview ? 'âœ… encontrado' : 'âŒ no encontrado');
            
            if (buttonPreview) {
              const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
              console.log('  - Preview tiene contenido:', hasContent);
              
              if (!hasContent) {
                console.log('âœ… Inicializando preview de Button despuÃ©s de render...');
                if (typeof window.updateButtonPreview === 'function') {
                  window.updateButtonPreview('button');
                } else {
                  console.error('âŒ updateButtonPreview no estÃ¡ disponible');
                }
              } else {
                console.log('âœ… Preview ya tiene contenido');
              }
            } else {
              console.warn('âš ï¸ button-preview-button no encontrado despuÃ©s de render');
              // Intentar de nuevo despuÃ©s de mÃ¡s tiempo
              setTimeout(() => {
                const retryPreview = document.getElementById('button-preview-button');
                if (retryPreview && retryPreview.innerHTML.trim() === '') {
                  console.log('ğŸ”„ Reintentando inicializaciÃ³n de preview...');
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  }
                }
              }, 500);
            }
          }, 300);
        }

        // FunciÃ³n para copiar cÃ³digo de componente
        window.copyComponentCode = function(element) {
          const code = decodeURIComponent(element.getAttribute('data-code'));
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(code).then(() => {
              showToast('success', 'CÃ³digo copiado', { title: 'Copiado' });
            });
          } else {
            const textArea = document.createElement('textarea');
            textArea.value = code;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showToast('success', 'CÃ³digo copiado', { title: 'Copiado' });
          }
        };
        
        // FunciÃ³n para filtrar componentes por bÃºsqueda
        function filterComponents(searchTerm) {
          const searchLower = searchTerm.toLowerCase().trim();
          const allComponents = document.querySelectorAll('[id^="component-"]');
          const emptyState = document.getElementById('components-empty-state');
          const container = document.getElementById('components-container');
          const componentsCategoryTitle = document.getElementById('components-category-title');
          const clearBtn = document.getElementById('components-clear-search');
          
          let visibleCount = 0;
          let hasMatches = false;
          
          // TambiÃ©n filtrar en el sidebar
          const navLinks = document.querySelectorAll('#components-nav .side-link');
          
          // Si no hay bÃºsqueda, restaurar el componente activo y salir
          if (!searchLower) {
            // Restaurar visibilidad de todos los links del sidebar
            navLinks.forEach(link => {
              link.style.display = '';
            });
            
            // Restaurar visibilidad de todas las categorÃ­as
            document.querySelectorAll('#components-nav .side-title').forEach(catTitle => {
              catTitle.style.display = '';
            });
            
            // Mostrar solo el componente activo
            if (activeComponent) {
              document.querySelectorAll('[id^="component-"]').forEach(el => {
                if (el.id === `component-${activeComponent}`) {
                  el.style.display = '';
                  // Restaurar el texto original sin resaltado
                  const nameEl = el.querySelector('h3');
                  if (nameEl && el.dataset.originalName) {
                    nameEl.textContent = el.dataset.originalName;
                  }
                } else {
                  el.style.display = 'none';
                }
              });
              
              // Asegurar que el link activo estÃ© marcado
              document.querySelectorAll('#components-nav .side-link').forEach(link => {
                link.classList.remove('active');
              });
              const activeLink = document.querySelector(`#components-nav .side-link[data-component="${activeComponent}"]`);
              if (activeLink) {
                activeLink.classList.add('active');
              }
            }
            
            // Ocultar estado vacÃ­o
            if (emptyState) emptyState.style.display = 'none';
            if (container) container.style.display = '';
            
            // Actualizar contador en el tÃ­tulo del menÃº lateral
            const total = Object.values(componentsInventory).flat().length;
            if (componentsCategoryTitle) {
              const countSpan = componentsCategoryTitle.querySelector('span:last-child');
              if (countSpan) {
                countSpan.textContent = `${total} ${total === 1 ? 'componente' : 'componentes'}`;
              }
            }
            
            // Ocultar botÃ³n limpiar
            if (clearBtn) {
              clearBtn.style.display = 'none';
            }
            
            return;
          }
          
          // Si hay bÃºsqueda, filtrar componentes
          allComponents.forEach(componentEl => {
            const componentName = componentEl.querySelector('h3');
            const componentNameText = componentName?.textContent || componentName?.innerText || '';
            const componentDesc = componentEl.querySelector('p')?.textContent || '';
            const componentId = componentEl.id.replace('component-', '');
            
            // Guardar el texto original si no estÃ¡ guardado
            if (!componentEl.dataset.originalName && componentName) {
              componentEl.dataset.originalName = componentNameText;
            }
            
            const matches = componentNameText.toLowerCase().includes(searchLower) ||
              componentDesc.toLowerCase().includes(searchLower) ||
              componentId.toLowerCase().includes(searchLower);
            
            if (matches) {
              componentEl.style.display = '';
              visibleCount++;
              hasMatches = true;
              
              // Resaltar el tÃ©rmino de bÃºsqueda en el nombre
              if (componentName) {
                const originalText = componentEl.dataset.originalName || componentNameText;
                if (originalText) {
                  const regex = new RegExp(`(${searchLower.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                  componentName.innerHTML = originalText.replace(regex, '<mark style="background: var(--ubits-accent-brand-static-inverted); color: white; padding: 2px 4px; border-radius: 4px;">$1</mark>');
                }
              }
            } else {
              componentEl.style.display = 'none';
            }
            
            // Actualizar visibilidad del link en sidebar (solo si hay bÃºsqueda activa)
            const matchingLink = Array.from(navLinks).find(link => {
              return link.getAttribute('data-component') === componentId;
            });
            
            if (matchingLink) {
              if (matches) {
                matchingLink.style.display = '';
              } else {
                matchingLink.style.display = 'none';
              }
            }
          });
          
          // Ocultar categorÃ­as vacÃ­as en el sidebar
          const categories = document.querySelectorAll('#components-nav .side-title');
          categories.forEach(catTitle => {
            const category = catTitle.textContent.trim();
            const nextTitle = catTitle.nextElementSibling;
            const categoryLinks = [];
            let current = nextTitle;
            
            while (current && !current.classList.contains('side-title')) {
              if (current.classList.contains('side-link')) {
                categoryLinks.push(current);
              }
              current = current.nextElementSibling;
            }
            
            const hasVisibleLinks = categoryLinks.some(link => link.style.display !== 'none');
            catTitle.style.display = hasVisibleLinks ? '' : 'none';
          });
          
          // Mostrar/ocultar estado vacÃ­o
          if (searchLower && !hasMatches) {
            if (emptyState) emptyState.style.display = 'block';
            if (container) container.style.display = 'none';
          } else {
            if (emptyState) emptyState.style.display = 'none';
            if (container) container.style.display = '';
          }
          
          // Actualizar contador en el tÃ­tulo del menÃº lateral
          const total = Object.values(componentsInventory).flat().length;
          if (componentsCategoryTitle) {
            const countSpan = componentsCategoryTitle.querySelector('span:last-child');
            if (countSpan) {
              if (searchLower) {
                countSpan.textContent = `${visibleCount} de ${total} ${total === 1 ? 'componente' : 'componentes'}`;
              } else {
                countSpan.textContent = `${total} ${total === 1 ? 'componente' : 'componentes'}`;
              }
            }
          }
          
          // Mostrar/ocultar botÃ³n limpiar
          if (clearBtn) {
            clearBtn.style.display = searchLower ? 'block' : 'none';
          }
        }
        
        // Inicializar bÃºsqueda de componentes
        function initComponentsSearch() {
          const searchInput = document.getElementById('components-search-input');
          const clearBtn = document.getElementById('components-clear-search');
          const countEl = document.getElementById('components-count');
          
          if (!searchInput) return;
          
          // Actualizar contador inicial
          if (countEl) {
            const total = Object.values(componentsInventory).flat().length;
            countEl.textContent = `${total} componentes`;
          }
          
          // Event listener para bÃºsqueda
          searchInput.addEventListener('input', (e) => {
            filterComponents(e.target.value);
          });
          
          // Event listener para botÃ³n limpiar
          if (clearBtn) {
            clearBtn.addEventListener('click', () => {
              searchInput.value = '';
              filterComponents(''); // Esto restaurarÃ¡ automÃ¡ticamente el componente activo
              searchInput.focus();
            });
          }
          
          // Limpiar bÃºsqueda al cambiar de secciÃ³n
          const componentesSection = document.getElementById('section-componentes');
          if (componentesSection) {
            const observer = new MutationObserver((mutations) => {
              mutations.forEach((mutation) => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                  const isVisible = componentesSection.style.display !== 'none';
                  if (!isVisible && searchInput) {
                    searchInput.value = '';
                    filterComponents('');
                  }
                }
              });
            });
            observer.observe(componentesSection, { attributes: true, attributeFilter: ['style'] });
          }
        }

        // FunciÃ³n para inicializar completamente (REESCRITO)
        function initializeComponentsSection() {
          console.log('ğŸš€ ========== INICIALIZANDO SECCIÃ“N COMPONENTES ==========');
          
          // Re-obtener referencias por si cambiÃ³ el DOM
          const container = document.getElementById('components-container');
          const nav = document.getElementById('components-nav');
          
          console.log('ğŸ“¦ components-container:', container ? 'âœ… encontrado' : 'âŒ NO encontrado');
          console.log('ğŸ“¦ components-nav:', nav ? 'âœ… encontrado' : 'âŒ NO encontrado');
          
          if (!container) {
            console.error('âŒ No se puede inicializar: components-container no existe');
            return;
          }
          
          if (!nav) {
            console.error('âŒ No se puede inicializar: components-nav no existe');
            return;
          }
          
          // 1. Verificar si los componentes estÃ¡n realmente renderizados
          const buttonElement = document.getElementById('component-button');
          const containerHTML = container.innerHTML.trim();
          
          console.log('ğŸ“Š Estado del contenedor:', {
            tieneHTML: containerHTML.length > 0,
            tieneButtonElement: buttonElement !== null,
            longitudHTML: containerHTML.length
          });
          
          // Si no existe el elemento button, forzar renderizado
          if (!buttonElement || containerHTML.length === 0) {
            console.log('ğŸ”„ Forzando renderizado de componentes (elemento no encontrado o contenedor vacÃ­o)...');
            renderComponents();
            
            // Verificar despuÃ©s del render
            setTimeout(() => {
              const verifyButton = document.getElementById('component-button');
              if (verifyButton) {
                console.log('âœ… Componente Button renderizado correctamente');
              } else {
                console.error('âŒ ERROR: Componente Button NO se renderizÃ³ despuÃ©s de llamar renderComponents()');
              }
            }, 100);
          } else {
            console.log('âœ… Contenedor ya tiene contenido vÃ¡lido');
          }
          
          // 2. Generar navegaciÃ³n (despuÃ©s de render, para que los elementos existan)
          let firstComponentId = null;
          if (nav.innerHTML.trim() === '' || nav.querySelectorAll('.side-link').length === 0) {
            console.log('ğŸ“ Generando navegaciÃ³n lateral...');
            firstComponentId = generateComponentsNav();
            if (firstComponentId) {
              console.log('âœ… NavegaciÃ³n generada exitosamente, primer componente:', firstComponentId);
            } else {
              console.error('âŒ Error al generar navegaciÃ³n');
            }
          } else {
            console.log('ğŸ“ NavegaciÃ³n ya existe, re-agregando listeners...');
            // Re-agregar listeners por si acaso
            nav.addEventListener('click', function(e) {
              const link = e.target.closest('.side-link');
              if (link) {
                e.preventDefault();
                const componentId = link.getAttribute('data-component');
                if (componentId) {
                  handleComponentNavClick(e, componentId);
                }
              }
            });
            // Obtener el primer componente activo
            const firstActiveLink = nav.querySelector('.side-link.active');
            if (firstActiveLink) {
              firstComponentId = firstActiveLink.getAttribute('data-component');
            }
          }
          
          // 2.5. Cargar el primer componente automÃ¡ticamente
          if (firstComponentId) {
            console.log('ğŸš€ Cargando primer componente automÃ¡ticamente:', firstComponentId);
            setTimeout(() => {
              loadComponent(firstComponentId);
            }, 100);
          }
          
          // 3. Inicializar preview del Button si existe y es visible
          setTimeout(() => {
            const buttonComponent = document.getElementById('component-button');
            const buttonPreview = document.getElementById('button-preview-button');
            
            if (buttonComponent && buttonPreview && buttonPreview.innerHTML.trim() === '') {
              console.log('ğŸ¯ Inicializando preview de Button despuÃ©s de inicializaciÃ³n...');
              if (typeof window.updateButtonPreview === 'function') {
                window.updateButtonPreview('button');
              } else {
                console.warn('âš ï¸ updateButtonPreview no disponible todavÃ­a, reintentando...');
                setTimeout(() => {
                  if (typeof window.updateButtonPreview === 'function') {
                    window.updateButtonPreview('button');
                  }
                }, 500);
              }
            }
          }, 500);
          
          // 4. Inicializar bÃºsqueda de componentes
          initComponentsSearch();
          
          console.log('âœ… ========== INICIALIZACIÃ“N COMPLETA ==========');
        }

        // Inicializar cuando se muestre la secciÃ³n
        const componentesSection = document.getElementById('section-componentes');
        if (componentesSection) {
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const isVisible = componentesSection.style.display !== 'none';
                if (isVisible) {
                  console.log('ğŸ”„ SecciÃ³n componentes visible, inicializando...');
                  setTimeout(() => initializeComponentsSection(), 50);
                }
              }
            });
          });
          observer.observe(componentesSection, { attributes: true, attributeFilter: ['style'] });

          // Inicializar inmediatamente si ya estÃ¡ visible
          if (componentesSection.style.display !== 'none') {
            setTimeout(() => initializeComponentsSection(), 50);
          }
        }

        // TambiÃ©n cargar cuando se hace click en el menÃº
        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[data-target="section-componentes"]');
          if (link) {
            setTimeout(() => {
              console.log('ğŸ”„ Click en componentes detectado, inicializando...');
              initializeComponentsSection();
            }, 150);
          }
        });
      })();
      */

      // Inicializar secciÃ³n de Add-ons cuando se muestra
      (function() {
        const addonsSection = document.getElementById('section-addons');
        if (addonsSection) {
          console.log('âœ… SecciÃ³n Add-ons encontrada, configurando observer...');
          
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const isVisible = addonsSection.style.display !== 'none';
                console.log('ğŸ”„ Cambio detectado en section-addons, visible:', isVisible);
                if (isVisible) {
                  console.log('ğŸ”„ SecciÃ³n Add-ons visible, inicializando...');
                  setTimeout(() => {
                    initializeAddonsSection();
                  }, 100);
                }
              }
            });
          });
          observer.observe(addonsSection, { attributes: true, attributeFilter: ['style'] });

          // Inicializar si ya estÃ¡ visible al cargar
          if (addonsSection.style.display !== 'none') {
            console.log('âœ… SecciÃ³n Add-ons ya visible al cargar, inicializando...');
            setTimeout(() => initializeAddonsSection(), 100);
          }
        } else {
          console.error('âŒ section-addons no encontrado en DOM');
        }

        // TambiÃ©n cargar cuando se hace click en el menÃº
        document.addEventListener('click', (e) => {
          const link = e.target.closest('a[data-target="section-addons"]');
          if (link) {
            console.log('ğŸ”„ Click en add-ons detectado, inicializando...');
            setTimeout(() => {
              initializeAddonsSection();
            }, 200);
          }
        });
      })();
      
      // ========================================
      // BUTTON PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Button
      const buttonPreviewState = {};
      
      // Inicializar estado por componente
      function initButtonPreviewState(componentId) {
        if (!buttonPreviewState[componentId]) {
          buttonPreviewState[componentId] = {
            variant: 'primary',
            size: 'md',
            iconPosition: 'left',
            showBadge: false,
            isLoading: false,
            text: 'BotÃ³n de ejemplo',
            dropdown: false,
            showTooltip: false,
            tooltipText: 'Tooltip del botÃ³n',
            state: 'default',
            dropdownOptions: [
              { label: 'OpciÃ³n 1', value: 'opt1' },
              { label: 'OpciÃ³n 2', value: 'opt2' },
              { label: 'OpciÃ³n 3', value: 'opt3' }
            ]
          };
        }
        return buttonPreviewState[componentId];
      }
      
      // FunciÃ³n auxiliar para generar HTML de botÃ³n (UN SOLO BOTÃ“N)
      function generateButtonHTML(state, componentId) {
        const { variant, size, iconPosition, showBadge, isLoading, text, dropdown, showTooltip, tooltipText } = state;
        
        console.log('ğŸ” [generateButtonHTML] ===== INICIO =====');
        console.log('ğŸ” [generateButtonHTML] Estado completo recibido:', JSON.stringify(state, null, 2));
        console.log('ğŸ” [generateButtonHTML] Valores extraÃ­dos:', {
          variant,
          size,
          iconPosition,
          showBadge,
          isLoading,
          text,
          dropdown,
          showTooltip,
          tooltipText
        });
        
        const badgeHTML = showBadge ? `<span class="ubits-button__badge"></span>` : '';
        console.log('ğŸ” [generateButtonHTML] Badge:', {
          showBadge,
          badgeHTML
        });
        
        let iconHTML = `<i class="far fa-check"></i>`;
        console.log('ğŸ” [generateButtonHTML] Icono HTML:', iconHTML);
        
        // Generar spinner de UBITS en lugar de FontAwesome
        // Mapear tamaÃ±o del botÃ³n al tamaÃ±o del spinner
        const spinnerSizeMap = { xs: 'xs', sm: 'sm', md: 'sm', lg: 'md', xl: 'lg' };
        const spinnerSize = spinnerSizeMap[size] || 'sm';
        
        // Mapear variante del botÃ³n a variante del spinner
        const spinnerVariantMap = { primary: 'primary', secondary: 'secondary', tertiary: 'secondary', active: 'primary' };
        const spinnerVariant = spinnerVariantMap[variant] || 'primary';
        
        // Generar HTML del spinner de UBITS
        let spinnerHTML = '';
        if (isLoading) {
          spinnerHTML = `
            <div class="ubits-spinner ubits-spinner--${spinnerSize} ubits-spinner--${spinnerVariant} ubits-spinner--animated ubits-button__spinner">
              <div class="ubits-spinner__circle">
                <div class="ubits-spinner__segment"></div>
                <div class="ubits-spinner__segment"></div>
                <div class="ubits-spinner__segment"></div>
                <div class="ubits-spinner__segment"></div>
              </div>
            </div>
          `.trim();
        }
        
        const chevronHTML = `<i class="far fa-chevron-down"></i>`;
        
        // Determinar contenido segÃºn posiciÃ³n del icono
        let content = '';
        let classes = `ubits-button ubits-button--${variant} ubits-button--${size}`;
        
        // Agregar clase de loading si estÃ¡ activo
        if (isLoading) {
          classes += ' ubits-button--loading';
        }
        
        // Agregar clase de dropdown si estÃ¡ activo
        if (dropdown) {
          classes += ' ubits-button--dropdown';
        }
        
        console.log('ğŸ” [generateButtonHTML] Evaluando iconPosition:', iconPosition);
        
        if (iconPosition === 'only') {
          // En modo icon-only, si estÃ¡ loading, mostrar solo spinner
          content = isLoading ? spinnerHTML : iconHTML;
          // Si dropdown estÃ¡ activo, agregar chevron
          if (dropdown && !isLoading) {
            content = `${iconHTML}${chevronHTML}`;
          }
          classes += ' ubits-button--icon-only';
          console.log('ğŸ” [generateButtonHTML] Modo icon-only, content:', content);
        } else if (iconPosition === 'none') {
          // Sin icono: mostrar texto normal, y si estÃ¡ loading, agregar spinner despuÃ©s del texto
          if (isLoading) {
            content = `<span class="button-text">${text}</span>${spinnerHTML}`;
          } else if (dropdown) {
            // Si dropdown, agregar chevron a la derecha
            content = `<span>${text}</span>${chevronHTML}`;
          } else {
            content = `<span>${text}</span>`;
          }
          console.log('ğŸ” [generateButtonHTML] Modo sin icono, content:', content);
        } else if (iconPosition === 'right') {
          // Icono a la derecha: la clase ubits-button--icon-right aplicarÃ¡ flex-direction: row-reverse
          // IMPORTANTE: Con row-reverse, el orden visual es inverso al orden HTML
          // Queremos ver visualmente: texto | icono | chevron (de izquierda a derecha)
          // Entonces en HTML debemos poner: chevron | icono | texto
          if (isLoading) {
            // Con row-reverse: HTML = spinner | texto, Visual = texto | spinner
            content = `${spinnerHTML}<span class="button-text">${text}</span>`;
          } else if (dropdown) {
            // Con row-reverse: HTML = chevron | icono | texto, Visual = texto | icono | chevron
            content = `${chevronHTML}${iconHTML}<span>${text}</span>`;
          } else {
            // Con row-reverse: HTML = icono | texto, Visual = texto | icono
            content = `${iconHTML}<span>${text}</span>`;
          }
          classes += ' ubits-button--icon-right';
          console.log('ğŸ” [generateButtonHTML] Modo icono derecha, content:', content);
        } else { // left (default)
          // Icono a la izquierda: poner spinner/icono primero, luego el texto
          if (isLoading) {
            content = `${spinnerHTML}<span class="button-text">${text}</span>`;
          } else if (dropdown) {
            // Si dropdown, icono izquierdo + texto + chevron derecho
            content = `${iconHTML}<span>${text}</span>${chevronHTML}`;
          } else {
            content = `${iconHTML}<span>${text}</span>`;
          }
          console.log('ğŸ” [generateButtonHTML] Modo icono izquierda (default), content:', content);
        }
        
        // NO agregar atributo title - usamos tooltip UBITS en su lugar
        // El tooltip UBITS se aplicarÃ¡ despuÃ©s en applyTooltipToButton
        
        console.log('ğŸ” [generateButtonHTML] EvaluaciÃ³n del tooltip:', {
          iconPosition,
          isIconOnly: iconPosition === 'only',
          showTooltip,
          tooltipText,
          willUseUBITSTooltip: iconPosition === 'only' && showTooltip && tooltipText
        });
        
        const disabledAttr = isLoading ? 'disabled' : '';
        
        const buttonHTML = `<button class="${classes}" ${disabledAttr}>
          ${content}
          ${badgeHTML}
        </button>`.trim();
        
        console.log('ğŸ” [generateButtonHTML] HTML completo generado:', buttonHTML);
        console.log('ğŸ” [generateButtonHTML] Clases:', classes);
        console.log('ğŸ” [generateButtonHTML] Contenido:', content);
        console.log('ğŸ” [generateButtonHTML] Badge HTML:', badgeHTML);
        console.log('ğŸ” [generateButtonHTML] ===== FIN =====');
        
        return buttonHTML;
      }
      
      // FunciÃ³n helper para aplicar estados visuales al botÃ³n (similar a Storybook)
      function applyButtonState(button, state) {
        if (!button || !state) return;
        
        // Remover estados anteriores (solo clases visuales, no tocar contenido)
        button.classList.remove('ubits-button--hover', 'ubits-button--focus', 'ubits-button--pressed');
        // Solo remover loading si no es el estado que queremos aplicar
        if (state !== 'loading') {
          button.classList.remove('ubits-button--loading');
          button.removeAttribute('data-loading');
        }
        // Solo remover disabled si no es el estado que queremos aplicar
        if (state !== 'disabled') {
          button.disabled = false;
        }
        
        // Detectar variante del botÃ³n
        const isPrimary = button.classList.contains('ubits-button--primary') || (!button.classList.contains('ubits-button--secondary') && !button.classList.contains('ubits-button--tertiary'));
        const isSecondary = button.classList.contains('ubits-button--secondary');
        const isTertiary = button.classList.contains('ubits-button--tertiary');
        const isActive = button.classList.contains('ubits-button--active');
        
        // Si el botÃ³n estÃ¡ en estado active, asegurar que el color del texto sea azul
        if (isActive) {
          button.style.color = 'var(--ubits-button-active-fg, var(--ubits-accent-brand-static))';
          
          const spans = button.querySelectorAll('span');
          spans.forEach((span) => {
            span.style.color = 'var(--ubits-accent-brand-static)';
          });
          
          const icons = button.querySelectorAll('i');
          icons.forEach((icon) => {
            icon.style.color = 'var(--ubits-accent-brand-static)';
          });
        }
        
        switch (state) {
          case 'hover':
            button.classList.add('ubits-button--hover');
            // Simular hover con estilos inline
            if (isActive) {
              // Si es active, mantener el estilo active
              button.style.background = 'var(--ubits-bg-active-button), var(--ubits-bg-1)';
              button.style.color = 'var(--ubits-button-active-fg, var(--ubits-accent-brand-static))';
              button.style.border = 'none';
            } else if (isPrimary) {
              button.style.background = 'var(--ubits-button-primary-hover)';
              button.style.borderColor = 'var(--ubits-button-primary-hover)';
            } else if (isSecondary) {
              button.style.background = 'var(--ubits-btn-secondary-bg-hover)';
            } else if (isTertiary) {
              button.style.background = 'var(--ubits-btn-tertiary-bg-hover)';
            }
            break;
            
          case 'focus':
            button.classList.add('ubits-button--focus');
            button.focus();
            // El focus ring se aplica automÃ¡ticamente con CSS
            if (isActive) {
              button.style.color = 'var(--ubits-button-active-fg, var(--ubits-accent-brand-static))';
            }
            break;
            
          case 'active':
            // Estado active: usar estilo del modificador active (fondo azul 0C5BEF al 15% + texto azul)
            button.classList.add('ubits-button--active');
            
            // Obtener valores de tokens
            const rootEl = document.documentElement;
            const bgActiveButtonValue = getComputedStyle(rootEl).getPropertyValue('--ubits-bg-active-button').trim() || 'var(--ubits-bg-active-button)';
            const bg1Value = getComputedStyle(rootEl).getPropertyValue('--ubits-bg-1').trim() || '#ffffff';
            
            // El formato background: color1, color2 NO funciona con colores sÃ³lidos
            // Necesitamos usar background-color para el fondo base y background-image para la capa semitransparente
            // O mejor aÃºn, usar un pseudo-elemento ::before
            const styleId = 'button-active-override';
            let styleEl = document.getElementById(styleId);
            if (!styleEl) {
              styleEl = document.createElement('style');
              styleEl.id = styleId;
              document.head.appendChild(styleEl);
            }
            
            // Usar selector especÃ­fico para cada variante
            const variantClass = isPrimary ? 'ubits-button--primary' : isSecondary ? 'ubits-button--secondary' : 'ubits-button--tertiary';
            
            const cssRule = `
              .${variantClass}.ubits-button--active {
                position: relative !important;
                background-color: ${bg1Value} !important;
                color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static)) !important;
                border: none !important;
              }
              .${variantClass}.ubits-button--active::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: ${bgActiveButtonValue};
                border-radius: inherit;
                pointer-events: none;
                z-index: 0;
              }
              .${variantClass}.ubits-button--active span {
                color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static)) !important;
                position: relative;
                z-index: 1;
              }
              .${variantClass}.ubits-button--active i {
                color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static)) !important;
                position: relative;
                z-index: 1;
              }
            `;
            styleEl.textContent = cssRule;
            
            // Aplicar color a spans e iconos
            const spansActive = button.querySelectorAll('span');
            spansActive.forEach((span) => {
              span.style.color = 'var(--ubits-accent-brand-static)';
            });
            const iconsActive = button.querySelectorAll('i');
            iconsActive.forEach((icon) => {
              icon.style.color = 'var(--ubits-accent-brand-static)';
            });
            break;
            
          case 'disabled':
            button.disabled = true;
            button.style.background = '';
            button.style.borderColor = '';
            button.style.transform = '';
            button.style.color = '';
            break;
            
          case 'loading':
            button.classList.add('ubits-button--loading');
            button.setAttribute('data-loading', 'true');
            button.style.background = '';
            button.style.borderColor = '';
            button.style.transform = '';
            if (isActive) {
              button.style.color = 'var(--ubits-button-active-fg, var(--ubits-accent-brand-static))';
            }
            break;
            
          case 'default':
          default:
            // Resetear estilos pero mantener active si estÃ¡ activo
            if (!isActive) {
              button.style.background = '';
              button.style.borderColor = '';
              button.style.transform = '';
              button.style.color = '';
            } else {
              // Si es active, mantener el estilo active
              button.style.background = 'var(--ubits-bg-active-button), var(--ubits-bg-1)';
              button.style.color = 'var(--ubits-button-active-fg, var(--ubits-accent-brand-static))';
              button.style.border = 'none';
            }
            break;
        }
      }
      
      // FunciÃ³n para actualizar el preview del botÃ³n (UN SOLO BOTÃ“N)
      window.updateButtonPreview = function(componentId) {
        console.log('ğŸš€ [updateButtonPreview] ===== INICIO =====');
        console.log('ğŸš€ [updateButtonPreview] Iniciando actualizaciÃ³n para:', componentId);
        
        const state = initButtonPreviewState(componentId);
        console.log('ğŸ“Š [updateButtonPreview] Estado completo obtenido:', JSON.stringify(state, null, 2));
        console.log('ğŸ“Š [updateButtonPreview] Valores clave:', {
          iconPosition: state.iconPosition,
          showBadge: state.showBadge,
          isLoading: state.isLoading,
          variant: state.variant,
          size: state.size,
          text: state.text,
          state: state.state
        });
        
        const preview = document.getElementById(`button-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ [updateButtonPreview] Preview no encontrado:', `button-preview-${componentId}`);
          console.log('ğŸš€ [updateButtonPreview] ===== FIN (ERROR) =====');
          return;
        }
        
        console.log('âœ… [updateButtonPreview] Preview encontrado:', preview);
        
        // Si dropdown estÃ¡ activo, usar createButton para inicializar funcionalidad
        if (state.dropdown && state.dropdownOptions && state.dropdownOptions.length > 0) {
          // Limpiar preview y crear wrapper
          preview.innerHTML = '';
          const wrapper = document.createElement('div');
          wrapper.style.position = 'relative';
          wrapper.style.display = 'inline-block';
          preview.appendChild(wrapper);
          
          // Preparar opciones para createButton
          const buttonOptions = {
            variant: state.variant,
            size: state.size,
            text: state.text,
            icon: state.iconPosition !== 'none' && state.iconPosition !== 'only' ? 'check' : undefined,
            iconStyle: 'regular',
            iconPosition: state.iconPosition === 'right' ? 'right' : 'left',
            iconOnly: state.iconPosition === 'only',
            disabled: false,
            loading: state.isLoading,
            badge: state.showBadge,
            dropdown: state.dropdown,
            showTooltip: state.showTooltip,
            tooltipText: state.tooltipText,
            dropdownOptions: state.dropdownOptions.map(opt => ({
              label: opt.label,
              value: opt.value || opt.label,
              onClick: (e, item) => {
                console.log('Dropdown option clicked:', item);
              }
            }))
          };
          
          // Usar requestAnimationFrame para asegurar que el DOM estÃ© listo
          requestAnimationFrame(() => {
            requestAnimationFrame(() => {
              try {
                // Intentar usar createButton si estÃ¡ disponible
                if (typeof window.createButtonHelper === 'function') {
                  window.createButtonHelper(buttonOptions, wrapper, state);
                  // Aplicar estado despuÃ©s de crear el botÃ³n (con delay para asegurar que el DOM estÃ© listo)
                  setTimeout(() => {
                    const button = wrapper.querySelector('.ubits-button');
                    if (button && state.state && state.state !== 'default') {
                      // Solo aplicar estado si no es 'loading' o si realmente estÃ¡ en loading
                      // Si el estado visual es 'loading' pero isLoading es false, no aplicar la clase loading
                      if (state.state === 'loading' && !state.isLoading) {
                        // No aplicar estado loading si el botÃ³n no estÃ¡ realmente en loading
                        // Aplicar estado default en su lugar (resetear estilos)
                        applyButtonState(button, 'default');
                      } else {
                        applyButtonState(button, state.state);
                      }
                    } else if (button && state.state === 'default') {
                      // Si el estado es 'default', solo resetear estilos sin aplicar nada especial
                      applyButtonState(button, 'default');
                    }
                  }, 50);
                } else {
                  // Fallback: usar generateButtonHTML
                  const buttonHTML = generateButtonHTML(state, componentId);
                  wrapper.innerHTML = buttonHTML;
                  // Aplicar tooltip despuÃ©s de insertar HTML
                  applyTooltipToButton(wrapper, state, componentId);
                  // Aplicar estado despuÃ©s de insertar HTML (con delay para asegurar que el DOM estÃ© listo)
                  setTimeout(() => {
                    const button = wrapper.querySelector('.ubits-button');
                    if (button && state.state && state.state !== 'default') {
                      // Solo aplicar estado si no es 'loading' o si realmente estÃ¡ en loading
                      // Si el estado visual es 'loading' pero isLoading es false, no aplicar la clase loading
                      if (state.state === 'loading' && !state.isLoading) {
                        // No aplicar estado loading si el botÃ³n no estÃ¡ realmente en loading
                        // Aplicar estado default en su lugar (resetear estilos)
                        applyButtonState(button, 'default');
                      } else {
                        applyButtonState(button, state.state);
                      }
                    } else if (button && state.state === 'default') {
                      // Si el estado es 'default', solo resetear estilos sin aplicar nada especial
                      applyButtonState(button, 'default');
                    }
                  }, 50);
                }
              } catch (error) {
                console.warn('Error creating button with dropdown, using fallback:', error);
                const buttonHTML = generateButtonHTML(state, componentId);
                wrapper.innerHTML = buttonHTML;
                // Aplicar tooltip despuÃ©s de insertar HTML
                applyTooltipToButton(wrapper, state, componentId);
                // Aplicar estado despuÃ©s de insertar HTML
                setTimeout(() => {
                  const button = wrapper.querySelector('.ubits-button');
                  if (button && state.state && state.state !== 'default') {
                    applyButtonState(button, state.state);
                  }
                }, 0);
              }
            });
          });
        } else {
          // Sin dropdown, generar HTML normalmente
          console.log('ğŸ“ [updateButtonPreview] Generando HTML sin dropdown');
          console.log('ğŸ“ [updateButtonPreview] Estado que se pasa a generateButtonHTML:', JSON.stringify(state, null, 2));
          
          const buttonHTML = generateButtonHTML(state, componentId);
          console.log('ğŸ“ [updateButtonPreview] HTML generado, longitud:', buttonHTML.length);
          console.log('ğŸ“ [updateButtonPreview] HTML generado (primeros 500 chars):', buttonHTML.substring(0, 500));
          
          console.log('ğŸ“ [updateButtonPreview] Insertando HTML en preview...');
          preview.innerHTML = buttonHTML;
          
          // Verificar que el HTML se insertÃ³ correctamente
          const insertedButton = preview.querySelector('.ubits-button');
          console.log('ğŸ“ [updateButtonPreview] BotÃ³n insertado encontrado:', !!insertedButton);
          if (insertedButton) {
            console.log('ğŸ“ [updateButtonPreview] Contenido del botÃ³n insertado:', insertedButton.innerHTML);
            console.log('ğŸ“ [updateButtonPreview] Clases del botÃ³n:', insertedButton.className);
            const iconInButton = insertedButton.querySelector('i');
            const badgeInButton = insertedButton.querySelector('.ubits-button__badge');
            console.log('ğŸ“ [updateButtonPreview] Icono encontrado en botÃ³n:', !!iconInButton);
            console.log('ğŸ“ [updateButtonPreview] Badge encontrado en botÃ³n:', !!badgeInButton);
          }
          
          console.log('ğŸ“ [updateButtonPreview] HTML insertado, aplicando tooltip');
          // Aplicar tooltip despuÃ©s de insertar HTML
          applyTooltipToButton(preview, state, componentId);
          // Aplicar estado despuÃ©s de insertar HTML (con delay para asegurar que el DOM estÃ© listo)
          setTimeout(() => {
            const button = preview.querySelector('.ubits-button');
            if (button && state.state && state.state !== 'default') {
              // Solo aplicar estado si no es 'loading' o si realmente estÃ¡ en loading
              // Si el estado visual es 'loading' pero isLoading es false, no aplicar la clase loading
              if (state.state === 'loading' && !state.isLoading) {
                // No aplicar estado loading si el botÃ³n no estÃ¡ realmente en loading
                // Aplicar estado default en su lugar (resetear estilos)
                applyButtonState(button, 'default');
              } else {
                applyButtonState(button, state.state);
              }
            } else if (button && state.state === 'default') {
              // Si el estado es 'default', solo resetear estilos sin aplicar nada especial
              applyButtonState(button, 'default');
            }
          }, 50);
        }
        
        // Mostrar/ocultar controlador de tooltip segÃºn iconPosition
        const tooltipControl = document.getElementById(`tooltip-control-${componentId}`);
        if (tooltipControl) {
          tooltipControl.style.display = state.iconPosition === 'only' ? 'block' : 'none';
        }
        
        // FunciÃ³n auxiliar para aplicar tooltip al botÃ³n usando componente Tooltip de UBITS
        function applyTooltipToButton(container, state, componentId) {
          console.log('ğŸ”§ [applyTooltipToButton] Iniciando aplicaciÃ³n de tooltip');
          console.log('ğŸ”§ [applyTooltipToButton] Container:', container);
          console.log('ğŸ”§ [applyTooltipToButton] Estado:', {
            iconPosition: state.iconPosition,
            showTooltip: state.showTooltip,
            tooltipText: state.tooltipText
          });
          
          // Esperar un momento para que el DOM se actualice
          setTimeout(() => {
            console.log('ğŸ”§ [applyTooltipToButton] Buscando botÃ³n en container...');
            const buttonElement = container.querySelector('.ubits-button');
            console.log('ğŸ”§ [applyTooltipToButton] BotÃ³n encontrado:', buttonElement);
            
            if (buttonElement) {
              // Limpiar tooltip anterior si existe (buscar por ID y por data attribute)
              const existingTooltipId = buttonElement.dataset.tooltipInstance;
              if (existingTooltipId) {
                const existingTooltip = document.getElementById(existingTooltipId);
                if (existingTooltip) {
                  console.log('ğŸ§¹ [applyTooltipToButton] Limpiando tooltip anterior:', existingTooltipId);
                  existingTooltip.remove();
                }
                delete buttonElement.dataset.tooltipInstance;
              }
              
              // TambiÃ©n buscar por el ID estÃ¡ndar
              const standardTooltipId = `button-tooltip-${componentId}`;
              const standardTooltip = document.getElementById(standardTooltipId);
              if (standardTooltip) {
                console.log('ğŸ§¹ [applyTooltipToButton] Limpiando tooltip estÃ¡ndar:', standardTooltipId);
                standardTooltip.remove();
              }
              
              // Remover listeners anteriores
              const oldMouseEnter = buttonElement._tooltipMouseEnter;
              const oldMouseLeave = buttonElement._tooltipMouseLeave;
              if (oldMouseEnter) {
                console.log('ğŸ§¹ [applyTooltipToButton] Removiendo listener mouseenter anterior');
                buttonElement.removeEventListener('mouseenter', oldMouseEnter);
                delete buttonElement._tooltipMouseEnter;
              }
              if (oldMouseLeave) {
                console.log('ğŸ§¹ [applyTooltipToButton] Removiendo listener mouseleave anterior');
                buttonElement.removeEventListener('mouseleave', oldMouseLeave);
                delete buttonElement._tooltipMouseLeave;
              }
              
              console.log('ğŸ”§ [applyTooltipToButton] BotÃ³n existe, verificando condiciones...');
              console.log('ğŸ”§ [applyTooltipToButton] Condiciones:', {
                isIconOnly: state.iconPosition === 'only',
                showTooltip: state.showTooltip,
                hasTooltipText: !!state.tooltipText,
                allConditionsMet: state.iconPosition === 'only' && state.showTooltip && state.tooltipText
              });
              
              if (state.iconPosition === 'only' && state.showTooltip && state.tooltipText) {
                console.log('âœ… [applyTooltipToButton] Aplicando tooltip UBITS...');
                
                // Remover atributo title nativo si existe (para evitar tooltip del navegador)
                if (buttonElement.hasAttribute('title')) {
                  console.log('ğŸ§¹ [applyTooltipToButton] Removiendo atributo title nativo');
                  buttonElement.removeAttribute('title');
                }
                
                // Asegurar que el CSS del tooltip estÃ© cargado
                const existingTooltipLink = document.querySelector('link[href*="tooltip.css"]');
                if (!existingTooltipLink) {
                  console.log('ğŸ“¦ [applyTooltipToButton] Cargando CSS del tooltip...');
                  const link = document.createElement('link');
                  link.rel = 'stylesheet';
                  link.href = '../../addons/tooltip/src/styles/tooltip.css';
                  link.onload = () => {
                    console.log('âœ… [applyTooltipToButton] CSS del tooltip cargado');
                  };
                  link.onerror = () => {
                    console.error('âŒ [applyTooltipToButton] Error al cargar CSS del tooltip');
                  };
                  document.head.appendChild(link);
                } else {
                  console.log('âœ… [applyTooltipToButton] CSS del tooltip ya estÃ¡ cargado');
                }
                
                // Crear tooltip HTML (solo descripciÃ³n, sin botones)
                // Escapar HTML para prevenir XSS
                const escapedText = state.tooltipText
                  .replace(/&/g, '&amp;')
                  .replace(/</g, '&lt;')
                  .replace(/>/g, '&gt;')
                  .replace(/"/g, '&quot;')
                  .replace(/'/g, '&#39;');
                
                const tooltipHTML = `
                  <div class="ubits-tooltip ubits-tooltip--tail-bottom" id="button-tooltip-${componentId}" style="position: fixed; z-index: 10000; opacity: 0; visibility: hidden; display: none; width: auto; min-width: fit-content; max-width: 240px;">
                    <div class="ubits-tooltip__tail">
                      <div class="ubits-tooltip__tail-inner"></div>
                    </div>
                    <div class="ubits-tooltip__content" style="width: auto; min-width: fit-content;">
                      <div class="ubits-tooltip__body" style="white-space: nowrap;">
                        <div class="ubits-tooltip__body-content">
                          <p class="ubits-body-md" style="margin: 0; white-space: nowrap;">${escapedText}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                `;
                
                // Crear wrapper para parsear HTML
                const wrapper = document.createElement('div');
                wrapper.innerHTML = tooltipHTML;
                const tooltipElement = wrapper.firstElementChild;
                
                if (tooltipElement) {
                  // Obtener referencia al tail
                  const tailElement = tooltipElement.querySelector('.ubits-tooltip__tail');
                  
                  console.log('ğŸ”§ [Tooltip Init] Tooltip creado:', {
                    tooltipId: tooltipElement.id,
                    tooltipClasses: tooltipElement.className,
                    tooltipStyles: tooltipElement.style.cssText,
                    hasTail: !!tailElement,
                    tailElement: tailElement ? {
                      classes: tailElement.className,
                      styles: tailElement.style.cssText,
                      computedLeft: window.getComputedStyle(tailElement).left,
                      computedTransform: window.getComputedStyle(tailElement).transform,
                      computedPosition: window.getComputedStyle(tailElement).position
                    } : null
                  });
                  
                  // Agregar al body
                  document.body.appendChild(tooltipElement);
                  
                  // FunciÃ³n para centrar el tail
                  const centerTail = () => {
                    if (!tailElement) return;
                    
                    // Remover cualquier estilo inline que pueda interferir
                    tailElement.style.removeProperty('left');
                    tailElement.style.removeProperty('right');
                    tailElement.style.removeProperty('top');
                    tailElement.style.removeProperty('bottom');
                    tailElement.style.removeProperty('transform');
                    tailElement.style.removeProperty('margin-left');
                    tailElement.style.removeProperty('margin-right');
                    
                    // Aplicar estilos para centrar
                    tailElement.style.left = '50%';
                    tailElement.style.right = 'auto';
                    tailElement.style.transform = 'translateX(-50%) rotate(180deg)';
                    
                    // Forzar reflow
                    void tailElement.offsetHeight;
                  };
                  
                  // Observar cambios en el tamaÃ±o del tooltip para recalcular el tail
                  if (typeof ResizeObserver !== 'undefined' && tailElement) {
                    try {
                      const resizeObserver = new ResizeObserver(() => {
                        console.log('ğŸ“ [Tooltip ResizeObserver] Tooltip cambiÃ³ de tamaÃ±o, recalculando tail...');
                        centerTail();
                      });
                      resizeObserver.observe(tooltipElement);
                      
                      // Guardar referencia para poder desconectarlo despuÃ©s
                      tooltipElement._tailResizeObserver = resizeObserver;
                    } catch (error) {
                      console.warn('âš ï¸ [Tooltip Init] Error al crear ResizeObserver:', error);
                    }
                  }
                  
                  // FunciÃ³n para mostrar tooltip
                  const showTooltip = () => {
                    console.log('ğŸ–±ï¸ [showTooltip] Mouse enter detectado, mostrando tooltip...');
                    const buttonRect = buttonElement.getBoundingClientRect();
                    
                    // Calcular posiciÃ³n: tooltip arriba del botÃ³n (tail apunta hacia abajo)
                    // Hacer el tooltip temporalmente visible pero fuera del viewport para calcular su tamaÃ±o
                    tooltipElement.style.top = '-9999px';
                    tooltipElement.style.left = '0';
                    tooltipElement.style.transform = 'none';
                    tooltipElement.style.visibility = 'visible';
                    tooltipElement.style.opacity = '0';
                    tooltipElement.style.display = 'block';
                    tooltipElement.classList.add('ubits-tooltip--open');
                    
                    // Forzar reflow para que el navegador calcule las dimensiones
                    void tooltipElement.offsetHeight;
                    
                    const tooltipRect = tooltipElement.getBoundingClientRect();
                    const tooltipHeight = tooltipRect.height;
                    const tooltipWidth = tooltipRect.width;
                    
                    // Verificar estado del tail ANTES de posicionar
                    if (tailElement) {
                      const tailRect = tailElement.getBoundingClientRect();
                      const tailComputed = window.getComputedStyle(tailElement);
                      console.log('ğŸ”º [showTooltip] Estado del tail ANTES de posicionar:', {
                        tailRect: { left: tailRect.left, top: tailRect.top, width: tailRect.width, height: tailRect.height },
                        tailComputed: {
                          left: tailComputed.left,
                          top: tailComputed.top,
                          bottom: tailComputed.bottom,
                          transform: tailComputed.transform,
                          position: tailComputed.position,
                          width: tailComputed.width,
                          height: tailComputed.height
                        },
                        tailStyles: tailElement.style.cssText,
                        tooltipWidth: tooltipWidth,
                        tooltipCenter: tooltipWidth / 2
                      });
                    }
                    
                    console.log('ğŸ“ [showTooltip] Dimensiones calculadas:', {
                      buttonRect: { top: buttonRect.top, left: buttonRect.left, width: buttonRect.width, height: buttonRect.height },
                      tooltipRect: { height: tooltipHeight, width: tooltipWidth }
                    });
                    
                    // Restaurar estilos y calcular posiciÃ³n final
                    const top = buttonRect.top - tooltipHeight - 9; // 9px es la altura del tail
                    const buttonCenterX = buttonRect.left + (buttonRect.width / 2);
                    const left = buttonCenterX - (tooltipWidth / 2); // Centrar el tooltip sobre el botÃ³n
                    
                    tooltipElement.style.top = `${top}px`;
                    tooltipElement.style.left = `${left}px`;
                    tooltipElement.style.transform = 'none'; // No usar translateX ya que calculamos left directamente
                    tooltipElement.style.display = 'block';
                    tooltipElement.style.visibility = 'visible';
                    tooltipElement.style.opacity = '1';
                    tooltipElement.style.transition = 'none'; // Sin transiciÃ³n para apariciÃ³n inmediata
                    // La clase ubits-tooltip--open ya estÃ¡ aplicada
                    
                    // Forzar otro reflow despuÃ©s de posicionar
                    void tooltipElement.offsetHeight;
                    
                    // Asegurar que el tail estÃ© centrado despuÃ©s de posicionar
                    if (tailElement) {
                      centerTail();
                    }
                    
                    // Verificar estado del tail DESPUÃ‰S de posicionar
                    if (tailElement) {
                      const tailRectAfter = tailElement.getBoundingClientRect();
                      const tailComputedAfter = window.getComputedStyle(tailElement);
                      const tooltipRectAfter = tooltipElement.getBoundingClientRect();
                      const tooltipComputed = window.getComputedStyle(tooltipElement);
                      const expectedTailLeft = tooltipRectAfter.left + (tooltipRectAfter.width / 2) - (tailRectAfter.width / 2);
                      
                      // Calcular posiciÃ³n relativa del tail dentro del tooltip
                      const tailRelativeLeft = tailRectAfter.left - tooltipRectAfter.left;
                      const tooltipCenterRelative = tooltipRectAfter.width / 2;
                      const tailCenterRelative = tailRelativeLeft + (tailRectAfter.width / 2);
                      
                      console.log('ğŸ”º [showTooltip] Estado del tail DESPUÃ‰S de posicionar:', {
                        tailRect: { left: tailRectAfter.left, top: tailRectAfter.top, width: tailRectAfter.width, height: tailRectAfter.height },
                        tailComputed: {
                          left: tailComputedAfter.left,
                          top: tailComputedAfter.top,
                          bottom: tailComputedAfter.bottom,
                          right: tailComputedAfter.right,
                          transform: tailComputedAfter.transform,
                          position: tailComputedAfter.position,
                          width: tailComputedAfter.width,
                          height: tailComputedAfter.height,
                          marginLeft: tailComputedAfter.marginLeft,
                          marginRight: tailComputedAfter.marginRight
                        },
                        tooltipRect: { left: tooltipRectAfter.left, top: tooltipRectAfter.top, width: tooltipRectAfter.width, height: tooltipRectAfter.height },
                        tooltipComputed: {
                          position: tooltipComputed.position,
                          left: tooltipComputed.left,
                          top: tooltipComputed.top,
                          width: tooltipComputed.width,
                          transform: tooltipComputed.transform
                        },
                        tooltipCenter: tooltipRectAfter.left + (tooltipRectAfter.width / 2),
                        expectedTailLeft: expectedTailLeft,
                        actualTailLeft: tailRectAfter.left,
                        difference: tailRectAfter.left - expectedTailLeft,
                        buttonCenterX: buttonCenterX,
                        tailShouldBeAt: buttonCenterX - (tailRectAfter.width / 2),
                        // PosiciÃ³n relativa
                        tailRelativeLeft: tailRelativeLeft,
                        tooltipCenterRelative: tooltipCenterRelative,
                        tailCenterRelative: tailCenterRelative,
                        differenceRelative: tailCenterRelative - tooltipCenterRelative,
                        // Verificar si el tail estÃ¡ centrado dentro del tooltip
                        isCentered: Math.abs(tailCenterRelative - tooltipCenterRelative) < 2
                      });
                      
                      // Si el tail no estÃ¡ centrado, intentar corregirlo
                      if (Math.abs(tailCenterRelative - tooltipCenterRelative) >= 2) {
                        console.warn('âš ï¸ [showTooltip] Tail NO estÃ¡ centrado, diferencia:', Math.abs(tailCenterRelative - tooltipCenterRelative), 'px');
                        console.warn('âš ï¸ [showTooltip] Intentando corregir posicionamiento del tail...');
                        
                        // Remover cualquier estilo inline que pueda interferir
                        tailElement.style.removeProperty('left');
                        tailElement.style.removeProperty('right');
                        tailElement.style.removeProperty('top');
                        tailElement.style.removeProperty('bottom');
                        tailElement.style.removeProperty('transform');
                        tailElement.style.removeProperty('margin-left');
                        tailElement.style.removeProperty('margin-right');
                        
                        // Forzar recalculo del tail usando solo CSS
                        tailElement.style.left = '50%';
                        tailElement.style.right = 'auto';
                        tailElement.style.transform = 'translateX(-50%) rotate(180deg)';
                        
                        // Forzar reflow mÃºltiples veces para asegurar que se recalcule
                        void tooltipElement.offsetHeight;
                        void tailElement.offsetHeight;
                        void tooltipElement.offsetWidth;
                        void tailElement.offsetWidth;
                        
                        // Verificar despuÃ©s de un breve delay
                        setTimeout(() => {
                          const tailRectCorrected = tailElement.getBoundingClientRect();
                          const tooltipRectCorrected = tooltipElement.getBoundingClientRect();
                          const tailRelativeLeftCorrected = tailRectCorrected.left - tooltipRectCorrected.left;
                          const tailCenterRelativeCorrected = tailRelativeLeftCorrected + (tailRectCorrected.width / 2);
                          const tooltipCenterRelativeCorrected = tooltipRectCorrected.width / 2;
                          
                          console.log('ğŸ”§ [showTooltip] Tail despuÃ©s de correcciÃ³n:', {
                            tailRelativeLeft: tailRelativeLeftCorrected,
                            tailCenterRelative: tailCenterRelativeCorrected,
                            tooltipCenterRelative: tooltipCenterRelativeCorrected,
                            difference: tailCenterRelativeCorrected - tooltipCenterRelativeCorrected,
                            isCentered: Math.abs(tailCenterRelativeCorrected - tooltipCenterRelativeCorrected) < 2,
                            tailComputed: {
                              left: window.getComputedStyle(tailElement).left,
                              transform: window.getComputedStyle(tailElement).transform,
                              position: window.getComputedStyle(tailElement).position
                            }
                          });
                        }, 10);
                      } else {
                        console.log('âœ… [showTooltip] Tail estÃ¡ correctamente centrado');
                      }
                    }
                    
                    // Restaurar transiciÃ³n despuÃ©s de un breve momento para la animaciÃ³n de salida
                    setTimeout(() => {
                      tooltipElement.style.transition = '';
                    }, 50);
                    
                    console.log('âœ… [showTooltip] Tooltip posicionado:', {
                      top: `${top}px`,
                      left: `${left}px`,
                      tooltipWidth: tooltipWidth,
                      tooltipHeight: tooltipHeight,
                      hasOpenClass: tooltipElement.classList.contains('ubits-tooltip--open'),
                      computedOpacity: window.getComputedStyle(tooltipElement).opacity,
                      computedVisibility: window.getComputedStyle(tooltipElement).visibility,
                      computedDisplay: window.getComputedStyle(tooltipElement).display
                    });
                  };
                  
                  // FunciÃ³n para ocultar tooltip
                  const hideTooltip = () => {
                    console.log('ğŸ–±ï¸ [hideTooltip] Mouse leave detectado, ocultando tooltip...');
                    tooltipElement.classList.remove('ubits-tooltip--open');
                    // Restaurar estilos para ocultar completamente
                    tooltipElement.style.opacity = '0';
                    tooltipElement.style.visibility = 'hidden';
                    tooltipElement.style.display = 'none';
                    console.log('âœ… [hideTooltip] Tooltip ocultado, clase removida y estilos restaurados');
                  };
                  
                  // Agregar eventos
                  const mouseEnterHandler = (e) => {
                    console.log('ğŸ–±ï¸ [mouseEnterHandler] Evento mouseenter disparado', e);
                    e.stopPropagation();
                    showTooltip();
                  };
                  
                  const mouseLeaveHandler = (e) => {
                    console.log('ğŸ–±ï¸ [mouseLeaveHandler] Evento mouseleave disparado', e);
                    e.stopPropagation();
                    hideTooltip();
                  };
                  
                  console.log('ğŸ“Œ [applyTooltipToButton] Agregando event listeners al botÃ³n');
                  buttonElement.addEventListener('mouseenter', mouseEnterHandler, false);
                  buttonElement.addEventListener('mouseleave', mouseLeaveHandler, false);
                  console.log('âœ… [applyTooltipToButton] Event listeners agregados');
                  
                  // Guardar referencias para poder limpiarlas despuÃ©s
                  buttonElement._tooltipMouseEnter = mouseEnterHandler;
                  buttonElement._tooltipMouseLeave = mouseLeaveHandler;
                  buttonElement.dataset.tooltipInstance = `button-tooltip-${componentId}`;
                  
                  console.log('âœ… [applyTooltipToButton] Tooltip UBITS aplicado:', {
                    iconPosition: state.iconPosition,
                    showTooltip: state.showTooltip,
                    tooltipText: state.tooltipText,
                    tooltipId: `button-tooltip-${componentId}`,
                    tooltipElement: tooltipElement,
                    tooltipInDOM: document.body.contains(tooltipElement),
                    tooltipStyles: {
                      position: tooltipElement.style.position,
                      top: tooltipElement.style.top,
                      left: tooltipElement.style.left,
                      opacity: window.getComputedStyle(tooltipElement).opacity,
                      visibility: window.getComputedStyle(tooltipElement).visibility,
                      zIndex: window.getComputedStyle(tooltipElement).zIndex
                    }
                  });
                }
              } else {
                console.log('âŒ [applyTooltipToButton] Removiendo tooltip (condiciones no cumplidas)');
                // Limpiar tooltip si existe
                const existingTooltipId = buttonElement.dataset.tooltipInstance;
                if (existingTooltipId) {
                  const tooltipElement = document.getElementById(existingTooltipId);
                  if (tooltipElement) {
                    tooltipElement.remove();
                  }
                  delete buttonElement.dataset.tooltipInstance;
                }
                // Remover listeners
                const oldMouseEnter = buttonElement._tooltipMouseEnter;
                const oldMouseLeave = buttonElement._tooltipMouseLeave;
                if (oldMouseEnter) {
                  buttonElement.removeEventListener('mouseenter', oldMouseEnter);
                  delete buttonElement._tooltipMouseEnter;
                }
                if (oldMouseLeave) {
                  buttonElement.removeEventListener('mouseleave', oldMouseLeave);
                  delete buttonElement._tooltipMouseLeave;
                }
                console.log('âŒ [applyTooltipToButton] Tooltip removido:', {
                  iconPosition: state.iconPosition,
                  showTooltip: state.showTooltip,
                  tooltipText: state.tooltipText
                });
              }
            } else {
              console.warn('âš ï¸ [applyTooltipToButton] BotÃ³n no encontrado en container');
              console.warn('âš ï¸ [applyTooltipToButton] Container HTML:', container.innerHTML.substring(0, 500));
            }
          }, 10);
        }
        
        // Aplicar tooltip tambiÃ©n despuÃ©s de un pequeÃ±o delay para asegurar que el DOM estÃ© listo
        setTimeout(() => {
          console.log('â° [updateButtonPreview] Timeout ejecutado, verificando tooltip nuevamente');
          // Re-aplicar tooltip en caso de que no se haya aplicado correctamente
          applyTooltipToButton(preview, state, componentId);
        }, 50);
        
        // Log para debug
        const finalButtonElement = preview.querySelector('.ubits-button');
        const tooltipInstanceId = finalButtonElement ? finalButtonElement.dataset.tooltipInstance : null;
        const tooltipElement = tooltipInstanceId ? document.getElementById(tooltipInstanceId) : null;
        console.log('âœ… Preview actualizado:', {
          size: state.size,
          variant: state.variant,
          dropdown: state.dropdown,
          iconPosition: state.iconPosition,
          showTooltip: state.showTooltip,
          tooltipText: state.tooltipText,
          hasTooltipInstance: !!tooltipInstanceId,
          tooltipElementExists: !!tooltipElement,
          classes: finalButtonElement?.className
        });
      };
      
      // Helper para crear botÃ³n con dropdown usando createButton
      window.createButtonHelper = function(options, container, state) {
        // Importar createButton dinÃ¡micamente o usar la implementaciÃ³n inline
        // Por ahora, implementamos la funcionalidad inline
        const buttonState = state || {
          variant: options.variant,
          size: options.size,
          text: options.text,
          iconPosition: options.iconOnly ? 'only' : (options.iconPosition || 'left'),
          showBadge: options.badge,
          isLoading: options.loading,
          dropdown: options.dropdown,
          showTooltip: options.showTooltip || false,
          tooltipText: options.tooltipText || ''
        };
        
        const buttonHTML = generateButtonHTML(buttonState, 'button');
        
        container.innerHTML = buttonHTML;
        const button = container.querySelector('button');
        
        if (!button) return;
        
        // Aplicar tooltip UBITS si estÃ¡ habilitado
        if (buttonState.iconPosition === 'only' && buttonState.showTooltip && buttonState.tooltipText) {
          // Usar la misma funciÃ³n applyTooltipToButton pero adaptada para este contexto
          const tooltipId = `button-tooltip-dropdown-${Math.random().toString(36).substr(2, 9)}`;
          
          // Asegurar que el CSS del tooltip estÃ© cargado
          const existingTooltipLink = document.querySelector('link[href*="tooltip.css"]');
          if (!existingTooltipLink) {
            console.log('ğŸ“¦ [applyTooltipToButton] Cargando CSS del tooltip...');
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/tooltip/src/styles/tooltip.css';
            link.onload = () => {
              console.log('âœ… [applyTooltipToButton] CSS del tooltip cargado');
            };
            link.onerror = () => {
              console.error('âŒ [applyTooltipToButton] Error al cargar CSS del tooltip');
            };
            document.head.appendChild(link);
          } else {
            console.log('âœ… [applyTooltipToButton] CSS del tooltip ya estÃ¡ cargado');
          }
          
          // Crear tooltip HTML (solo descripciÃ³n, sin botones)
          // Escapar HTML para prevenir XSS
          const escapedText = buttonState.tooltipText
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;');
          
          const tooltipHTML = `
            <div class="ubits-tooltip ubits-tooltip--tail-bottom" id="${tooltipId}" style="position: fixed; z-index: 10000; opacity: 0; visibility: hidden; display: none; width: auto; min-width: fit-content; max-width: 240px;">
              <div class="ubits-tooltip__tail">
                <div class="ubits-tooltip__tail-inner"></div>
              </div>
              <div class="ubits-tooltip__content" style="width: auto; min-width: fit-content;">
                <div class="ubits-tooltip__body" style="white-space: nowrap;">
                  <div class="ubits-tooltip__body-content">
                    <p class="ubits-body-md" style="margin: 0; white-space: nowrap;">${escapedText}</p>
                  </div>
                </div>
              </div>
            </div>
          `;
          
          // Crear wrapper para parsear HTML
          const wrapper = document.createElement('div');
          wrapper.innerHTML = tooltipHTML;
          const tooltipElement = wrapper.firstElementChild;
          
          if (tooltipElement) {
            // Obtener referencia al tail
            const tailElement = tooltipElement.querySelector('.ubits-tooltip__tail');
            
            console.log('ğŸ”§ [Tooltip Init createButtonHelper] Tooltip creado:', {
              tooltipId: tooltipElement.id,
              tooltipClasses: tooltipElement.className,
              tooltipStyles: tooltipElement.style.cssText,
              hasTail: !!tailElement,
              tailElement: tailElement ? {
                classes: tailElement.className,
                styles: tailElement.style.cssText,
                computedLeft: window.getComputedStyle(tailElement).left,
                computedTransform: window.getComputedStyle(tailElement).transform,
                computedPosition: window.getComputedStyle(tailElement).position
              } : null
            });
            
            // Agregar al body
            document.body.appendChild(tooltipElement);
            
            // FunciÃ³n para centrar el tail
            const centerTail = () => {
              if (!tailElement) return;
              
              // Remover cualquier estilo inline que pueda interferir
              tailElement.style.removeProperty('left');
              tailElement.style.removeProperty('right');
              tailElement.style.removeProperty('top');
              tailElement.style.removeProperty('bottom');
              tailElement.style.removeProperty('transform');
              tailElement.style.removeProperty('margin-left');
              tailElement.style.removeProperty('margin-right');
              
              // Aplicar estilos para centrar
              tailElement.style.left = '50%';
              tailElement.style.right = 'auto';
              tailElement.style.transform = 'translateX(-50%) rotate(180deg)';
              
              // Forzar reflow
              void tailElement.offsetHeight;
            };
            
            // Observar cambios en el tamaÃ±o del tooltip para recalcular el tail
            if (typeof ResizeObserver !== 'undefined' && tailElement) {
              try {
                const resizeObserver = new ResizeObserver(() => {
                  console.log('ğŸ“ [Tooltip ResizeObserver createButtonHelper] Tooltip cambiÃ³ de tamaÃ±o, recalculando tail...');
                  centerTail();
                });
                resizeObserver.observe(tooltipElement);
                
                // Guardar referencia para poder desconectarlo despuÃ©s
                tooltipElement._tailResizeObserver = resizeObserver;
              } catch (error) {
                console.warn('âš ï¸ [Tooltip Init createButtonHelper] Error al crear ResizeObserver:', error);
              }
            }
            
            // FunciÃ³n para mostrar tooltip
            const showTooltip = () => {
              console.log('ğŸ–±ï¸ [showTooltip] Mouse enter detectado (createButtonHelper), mostrando tooltip...');
              const buttonRect = button.getBoundingClientRect();
              
              // Remover atributo title nativo si existe
              if (button.hasAttribute('title')) {
                console.log('ğŸ§¹ [showTooltip] Removiendo atributo title nativo (createButtonHelper)');
                button.removeAttribute('title');
              }
              
              // Calcular posiciÃ³n: tooltip arriba del botÃ³n (tail apunta hacia abajo)
              // Hacer el tooltip temporalmente visible pero fuera del viewport para calcular su tamaÃ±o
              tooltipElement.style.top = '-9999px';
              tooltipElement.style.left = '0';
              tooltipElement.style.transform = 'none';
              tooltipElement.style.visibility = 'visible';
              tooltipElement.style.opacity = '0';
              tooltipElement.style.display = 'block';
              tooltipElement.classList.add('ubits-tooltip--open');
              
              // Forzar reflow para que el navegador calcule las dimensiones
              void tooltipElement.offsetHeight;
              
              const tooltipRect = tooltipElement.getBoundingClientRect();
              const tooltipHeight = tooltipRect.height;
              const tooltipWidth = tooltipRect.width;
              
              // Verificar estado del tail ANTES de posicionar
              if (tailElement) {
                const tailRect = tailElement.getBoundingClientRect();
                const tailComputed = window.getComputedStyle(tailElement);
                console.log('ğŸ”º [showTooltip createButtonHelper] Estado del tail ANTES de posicionar:', {
                  tailRect: { left: tailRect.left, top: tailRect.top, width: tailRect.width, height: tailRect.height },
                  tailComputed: {
                    left: tailComputed.left,
                    top: tailComputed.top,
                    bottom: tailComputed.bottom,
                    transform: tailComputed.transform,
                    position: tailComputed.position,
                    width: tailComputed.width,
                    height: tailComputed.height
                  },
                  tailStyles: tailElement.style.cssText,
                  tooltipWidth: tooltipWidth,
                  tooltipCenter: tooltipWidth / 2
                });
              }
              
              console.log('ğŸ“ [showTooltip] Dimensiones calculadas (createButtonHelper):', {
                buttonRect: { top: buttonRect.top, left: buttonRect.left, width: buttonRect.width, height: buttonRect.height },
                tooltipRect: { height: tooltipHeight, width: tooltipWidth }
              });
              
              // Restaurar estilos y calcular posiciÃ³n final
              const top = buttonRect.top - tooltipHeight - 9; // 9px es la altura del tail
              const buttonCenterX = buttonRect.left + (buttonRect.width / 2);
              const left = buttonCenterX - (tooltipWidth / 2); // Centrar el tooltip sobre el botÃ³n
              
              tooltipElement.style.top = `${top}px`;
              tooltipElement.style.left = `${left}px`;
              tooltipElement.style.transform = 'none'; // No usar translateX ya que calculamos left directamente
              tooltipElement.style.display = 'block';
              tooltipElement.style.visibility = 'visible';
              tooltipElement.style.opacity = '1';
              tooltipElement.style.transition = 'none'; // Sin transiciÃ³n para apariciÃ³n inmediata
              // La clase ubits-tooltip--open ya estÃ¡ aplicada
              
              // Forzar otro reflow despuÃ©s de posicionar
              void tooltipElement.offsetHeight;
              
              // Asegurar que el tail estÃ© centrado despuÃ©s de posicionar
              if (tailElement) {
                centerTail();
              }
              
              // Verificar estado del tail DESPUÃ‰S de posicionar
              if (tailElement) {
                const tailRectAfter = tailElement.getBoundingClientRect();
                const tailComputedAfter = window.getComputedStyle(tailElement);
                const tooltipRectAfter = tooltipElement.getBoundingClientRect();
                const tooltipComputed = window.getComputedStyle(tooltipElement);
                const expectedTailLeft = tooltipRectAfter.left + (tooltipRectAfter.width / 2) - (tailRectAfter.width / 2);
                
                // Calcular posiciÃ³n relativa del tail dentro del tooltip
                const tailRelativeLeft = tailRectAfter.left - tooltipRectAfter.left;
                const tooltipCenterRelative = tooltipRectAfter.width / 2;
                const tailCenterRelative = tailRelativeLeft + (tailRectAfter.width / 2);
                
                console.log('ğŸ”º [showTooltip createButtonHelper] Estado del tail DESPUÃ‰S de posicionar:', {
                  tailRect: { left: tailRectAfter.left, top: tailRectAfter.top, width: tailRectAfter.width, height: tailRectAfter.height },
                  tailComputed: {
                    left: tailComputedAfter.left,
                    top: tailComputedAfter.top,
                    bottom: tailComputedAfter.bottom,
                    right: tailComputedAfter.right,
                    transform: tailComputedAfter.transform,
                    position: tailComputedAfter.position,
                    width: tailComputedAfter.width,
                    height: tailComputedAfter.height,
                    marginLeft: tailComputedAfter.marginLeft,
                    marginRight: tailComputedAfter.marginRight
                  },
                  tooltipRect: { left: tooltipRectAfter.left, top: tooltipRectAfter.top, width: tooltipRectAfter.width, height: tooltipRectAfter.height },
                  tooltipComputed: {
                    position: tooltipComputed.position,
                    left: tooltipComputed.left,
                    top: tooltipComputed.top,
                    width: tooltipComputed.width,
                    transform: tooltipComputed.transform
                  },
                  tooltipCenter: tooltipRectAfter.left + (tooltipRectAfter.width / 2),
                  expectedTailLeft: expectedTailLeft,
                  actualTailLeft: tailRectAfter.left,
                  difference: tailRectAfter.left - expectedTailLeft,
                  buttonCenterX: buttonCenterX,
                  tailShouldBeAt: buttonCenterX - (tailRectAfter.width / 2),
                  // PosiciÃ³n relativa
                  tailRelativeLeft: tailRelativeLeft,
                  tooltipCenterRelative: tooltipCenterRelative,
                  tailCenterRelative: tailCenterRelative,
                  differenceRelative: tailCenterRelative - tooltipCenterRelative,
                  // Verificar si el tail estÃ¡ centrado dentro del tooltip
                  isCentered: Math.abs(tailCenterRelative - tooltipCenterRelative) < 2
                });
                
                // Si el tail no estÃ¡ centrado, intentar corregirlo
                if (Math.abs(tailCenterRelative - tooltipCenterRelative) >= 2) {
                  console.warn('âš ï¸ [showTooltip createButtonHelper] Tail NO estÃ¡ centrado, diferencia:', Math.abs(tailCenterRelative - tooltipCenterRelative), 'px');
                  console.warn('âš ï¸ [showTooltip createButtonHelper] Intentando corregir posicionamiento del tail...');
                  
                  // Remover cualquier estilo inline que pueda interferir
                  tailElement.style.removeProperty('left');
                  tailElement.style.removeProperty('right');
                  tailElement.style.removeProperty('top');
                  tailElement.style.removeProperty('bottom');
                  tailElement.style.removeProperty('transform');
                  tailElement.style.removeProperty('margin-left');
                  tailElement.style.removeProperty('margin-right');
                  
                  // Forzar recalculo del tail usando solo CSS
                  tailElement.style.left = '50%';
                  tailElement.style.right = 'auto';
                  tailElement.style.transform = 'translateX(-50%) rotate(180deg)';
                  
                  // Forzar reflow mÃºltiples veces para asegurar que se recalcule
                  void tooltipElement.offsetHeight;
                  void tailElement.offsetHeight;
                  void tooltipElement.offsetWidth;
                  void tailElement.offsetWidth;
                  
                  // Verificar despuÃ©s de un breve delay
                  setTimeout(() => {
                    const tailRectCorrected = tailElement.getBoundingClientRect();
                    const tooltipRectCorrected = tooltipElement.getBoundingClientRect();
                    const tailRelativeLeftCorrected = tailRectCorrected.left - tooltipRectCorrected.left;
                    const tailCenterRelativeCorrected = tailRelativeLeftCorrected + (tailRectCorrected.width / 2);
                    const tooltipCenterRelativeCorrected = tooltipRectCorrected.width / 2;
                    
                    console.log('ğŸ”§ [showTooltip createButtonHelper] Tail despuÃ©s de correcciÃ³n:', {
                      tailRelativeLeft: tailRelativeLeftCorrected,
                      tailCenterRelative: tailCenterRelativeCorrected,
                      tooltipCenterRelative: tooltipCenterRelativeCorrected,
                      difference: tailCenterRelativeCorrected - tooltipCenterRelativeCorrected,
                      isCentered: Math.abs(tailCenterRelativeCorrected - tooltipCenterRelativeCorrected) < 2,
                      tailComputed: {
                        left: window.getComputedStyle(tailElement).left,
                        transform: window.getComputedStyle(tailElement).transform,
                        position: window.getComputedStyle(tailElement).position
                      }
                    });
                  }, 10);
                } else {
                  console.log('âœ… [showTooltip createButtonHelper] Tail estÃ¡ correctamente centrado');
                }
              }
              
              // Restaurar transiciÃ³n despuÃ©s de un breve momento para la animaciÃ³n de salida
              setTimeout(() => {
                tooltipElement.style.transition = '';
              }, 50);
              
              console.log('âœ… [showTooltip] Tooltip posicionado (createButtonHelper):', {
                top: `${top}px`,
                left: `${left}px`,
                transform: 'translateX(-50%)',
                hasOpenClass: tooltipElement.classList.contains('ubits-tooltip--open'),
                computedOpacity: window.getComputedStyle(tooltipElement).opacity,
                computedVisibility: window.getComputedStyle(tooltipElement).visibility,
                computedDisplay: window.getComputedStyle(tooltipElement).display
              });
            };
            
            // FunciÃ³n para ocultar tooltip
            const hideTooltip = () => {
              console.log('ğŸ–±ï¸ [hideTooltip] Mouse leave detectado (createButtonHelper), ocultando tooltip...');
              tooltipElement.classList.remove('ubits-tooltip--open');
              // Restaurar estilos para ocultar completamente
              tooltipElement.style.opacity = '0';
              tooltipElement.style.visibility = 'hidden';
              tooltipElement.style.display = 'none';
              console.log('âœ… [hideTooltip] Tooltip ocultado (createButtonHelper), clase removida y estilos restaurados');
            };
            
            // Agregar eventos
            const mouseEnterHandler = (e) => {
              console.log('ğŸ–±ï¸ [mouseEnterHandler] Evento mouseenter disparado (createButtonHelper)', e);
              e.stopPropagation();
              showTooltip();
            };
            
            const mouseLeaveHandler = (e) => {
              console.log('ğŸ–±ï¸ [mouseLeaveHandler] Evento mouseleave disparado (createButtonHelper)', e);
              e.stopPropagation();
              hideTooltip();
            };
            
            console.log('ğŸ“Œ [createButtonHelper] Agregando event listeners al botÃ³n');
            button.addEventListener('mouseenter', mouseEnterHandler, false);
            button.addEventListener('mouseleave', mouseLeaveHandler, false);
            console.log('âœ… [createButtonHelper] Event listeners agregados');
            
            // Guardar referencias para poder limpiarlas despuÃ©s
            button._tooltipMouseEnter = mouseEnterHandler;
            button._tooltipMouseLeave = mouseLeaveHandler;
            button.dataset.tooltipInstance = tooltipId;
            
            console.log('âœ… Tooltip UBITS aplicado en createButtonHelper:', {
              iconPosition: buttonState.iconPosition,
              showTooltip: buttonState.showTooltip,
              tooltipText: buttonState.tooltipText,
              tooltipId: tooltipId
            });
          }
        } else {
          // Limpiar tooltip si existe
          const existingTooltipId = button.dataset.tooltipInstance;
          if (existingTooltipId) {
            const tooltipElement = document.getElementById(existingTooltipId);
            if (tooltipElement) {
              tooltipElement.remove();
            }
            delete button.dataset.tooltipInstance;
          }
          // Remover listeners
          const oldMouseEnter = button._tooltipMouseEnter;
          const oldMouseLeave = button._tooltipMouseLeave;
          if (oldMouseEnter) {
            button.removeEventListener('mouseenter', oldMouseEnter);
            delete button._tooltipMouseEnter;
          }
          if (oldMouseLeave) {
            button.removeEventListener('mouseleave', oldMouseLeave);
            delete button._tooltipMouseLeave;
          }
        }
        
        // Si dropdown estÃ¡ activo, crear el dropdown
        if (options.dropdown && options.dropdownOptions && options.dropdownOptions.length > 0) {
          const dropdownContainer = document.createElement('div');
          dropdownContainer.className = 'ubits-button-dropdown-container';
          dropdownContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
            min-width: 100%;
          `;
          container.appendChild(dropdownContainer);
          
          // Mapear tamaÃ±o del botÃ³n al tamaÃ±o del List
          const listSize = options.size === 'xs' ? 'xs' : options.size === 'sm' ? 'sm' : options.size === 'md' ? 'md' : 'lg';
          
          // Convertir dropdownOptions a ListItems
          const listItems = options.dropdownOptions.map(option => ({
            label: option.label,
            state: 'default',
            value: option.value || option.label,
            selected: false
          }));
          
          let isOpen = false;
          
          const toggleDropdown = () => {
            if (isOpen) {
              dropdownContainer.style.display = 'none';
              isOpen = false;
              return;
            }
            
            // Crear o actualizar la lista usando el componente List
            const listId = `button-dropdown-${Math.random().toString(36).substr(2, 9)}`;
            dropdownContainer.id = listId;
            dropdownContainer.innerHTML = '';
            
            // Generar HTML del List manualmente
            let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
            listItems.forEach((item) => {
              listHTML += `
                <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                  ${item.label}
                </div>
              `;
            });
            listHTML += '</div>';
            
            dropdownContainer.innerHTML = listHTML;
            
            // Agregar event listeners a los items
            const listItemsElements = dropdownContainer.querySelectorAll('.ubits-list-item');
            listItemsElements.forEach((itemEl, idx) => {
              const item = listItems[idx];
              if (item) {
                itemEl.addEventListener('click', () => {
                  if (options.dropdownOptions && options.dropdownOptions[idx] && options.dropdownOptions[idx].onClick) {
                    options.dropdownOptions[idx].onClick(new MouseEvent('click'), { label: item.label, value: item.value });
                  }
                  dropdownContainer.style.display = 'none';
                  isOpen = false;
                });
              }
            });
            
            dropdownContainer.style.display = 'block';
            isOpen = true;
          };
          
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            if (!options.disabled && !options.loading) {
              toggleDropdown();
            }
          });
          
          // Cerrar dropdown al hacer click fuera
          document.addEventListener('click', (e) => {
            if (!container.contains(e.target)) {
              dropdownContainer.style.display = 'none';
              isOpen = false;
            }
          });
        }
      };
      
      // Nueva funciÃ³n unificada para todos los controles
      window.setButtonControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ [setButtonControl] ===== INICIO =====');
        console.log('ğŸ›ï¸ [setButtonControl] ParÃ¡metros recibidos:', {
          option,
          value,
          componentId
        });
        
        const state = initButtonPreviewState(componentId);
        console.log('ğŸ›ï¸ [setButtonControl] Estado inicial:', JSON.stringify(state, null, 2));
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'variant') {
          state.variant = value;
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'badge') {
          console.log('ğŸ›ï¸ [setButtonControl] Cambiando badge:', {
            option,
            value,
            valorAnterior: state.showBadge
          });
          state.showBadge = value === 'yes';
          console.log('ğŸ›ï¸ [setButtonControl] Nuevo valor showBadge:', state.showBadge);
          
          const toggle = document.getElementById(`badge-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showBadge;
            console.log('ğŸ›ï¸ [setButtonControl] Toggle actualizado:', toggle.checked);
          } else {
            console.warn('âš ï¸ [setButtonControl] Toggle badge no encontrado');
          }
          
          // Actualizar texto del estado del badge
          const badgeStatus = document.getElementById(`badge-status-${componentId}`);
          if (badgeStatus) {
            badgeStatus.textContent = state.showBadge ? 'Activado' : 'Desactivado';
            console.log('ğŸ›ï¸ [setButtonControl] Estado badge actualizado:', badgeStatus.textContent);
          } else {
            console.warn('âš ï¸ [setButtonControl] Badge status no encontrado');
          }
        } else if (option === 'loading') {
          state.isLoading = value === 'yes';
          const toggle = document.getElementById(`loading-toggle-${componentId}`);
          if (toggle) toggle.checked = state.isLoading;
          
          // Actualizar texto del estado del loading
          const loadingStatus = document.getElementById(`loading-status-${componentId}`);
          if (loadingStatus) {
            loadingStatus.textContent = state.isLoading ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'dropdown') {
          state.dropdown = value === 'yes';
          const toggle = document.getElementById(`dropdown-toggle-${componentId}`);
          if (toggle) toggle.checked = state.dropdown;
          
          // Actualizar texto del estado del dropdown
          const dropdownStatus = document.getElementById(`dropdown-status-${componentId}`);
          if (dropdownStatus) {
            dropdownStatus.textContent = state.dropdown ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'tooltip') {
          console.log('ğŸ›ï¸ [setButtonControl] Cambiando tooltip:', {
            option,
            value,
            componentId,
            currentState: JSON.stringify(state, null, 2)
          });
          state.showTooltip = value === 'yes';
          console.log('ğŸ›ï¸ [setButtonControl] Nuevo showTooltip:', state.showTooltip);
          const toggle = document.getElementById(`tooltip-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showTooltip;
            console.log('ğŸ›ï¸ [setButtonControl] Toggle actualizado:', toggle.checked);
          } else {
            console.warn('âš ï¸ [setButtonControl] Toggle no encontrado');
          }
          
          // Actualizar texto del estado del tooltip
          const tooltipStatus = document.getElementById(`tooltip-status-${componentId}`);
          if (tooltipStatus) {
            tooltipStatus.textContent = state.showTooltip ? 'Activado' : 'Desactivado';
            console.log('ğŸ›ï¸ [setButtonControl] Estado actualizado:', tooltipStatus.textContent);
          }
          
          // Forzar actualizaciÃ³n del preview para aplicar el tooltip
          console.log('ğŸ›ï¸ [setButtonControl] Llamando updateButtonPreview...');
        updateButtonPreview(componentId);
        } else if (option === 'tooltipText') {
          console.log('ğŸ›ï¸ [setButtonControl] Cambiando tooltipText:', {
            option,
            value,
            componentId,
            currentState: JSON.stringify(state, null, 2)
          });
          state.tooltipText = value || 'Tooltip del botÃ³n';
          console.log('ğŸ›ï¸ [setButtonControl] Nuevo tooltipText:', state.tooltipText);
          const input = document.getElementById(`tooltip-text-input-${componentId}`);
          if (input && input.value !== value) {
            input.value = value;
            console.log('ğŸ›ï¸ [setButtonControl] Input actualizado');
          }
          
          // Forzar actualizaciÃ³n del preview si el tooltip estÃ¡ activo
          if (state.showTooltip && state.iconPosition === 'only') {
            console.log('ğŸ›ï¸ [setButtonControl] Llamando updateButtonPreview (tooltip activo)...');
            updateButtonPreview(componentId);
          } else {
            console.log('ğŸ›ï¸ [setButtonControl] No se actualiza preview (tooltip no activo o no es icon-only)');
          }
        } else if (option === 'icon') {
          console.log('ğŸ›ï¸ [setButtonControl] Cambiando iconPosition:', {
            option,
            value,
            valorAnterior: state.iconPosition,
            componentId
          });
          
          state.iconPosition = value;
          console.log('ğŸ›ï¸ [setButtonControl] Nuevo iconPosition:', state.iconPosition);
          console.log('ğŸ›ï¸ [setButtonControl] Estado completo despuÃ©s del cambio:', JSON.stringify(state, null, 2));
          
          // Actualizar botones activos de icono
          const iconButtons = document.querySelectorAll(`[data-component="${componentId}"][data-option="icon"]`);
          console.log('ğŸ›ï¸ [setButtonControl] Botones de icono encontrados:', iconButtons.length);
          iconButtons.forEach(btn => {
            const btnValue = btn.getAttribute('data-value');
            const isActive = btnValue === value;
            btn.classList.toggle('active', isActive);
            console.log('ğŸ›ï¸ [setButtonControl] BotÃ³n icono:', {
              value: btnValue,
              isActive,
              tieneClaseActive: btn.classList.contains('active')
            });
          });
          
          // Mostrar/ocultar controlador de tooltip segÃºn iconPosition
          const tooltipControl = document.getElementById(`tooltip-control-${componentId}`);
          if (tooltipControl) {
            tooltipControl.style.display = value === 'only' ? 'block' : 'none';
            console.log('ğŸ›ï¸ [setButtonControl] Tooltip control visibility:', tooltipControl.style.display);
          } else {
            console.warn('âš ï¸ [setButtonControl] Tooltip control no encontrado');
          }
          
          // Forzar actualizaciÃ³n del preview para aplicar cambios
          console.log('ğŸ›ï¸ [setButtonControl] Llamando updateButtonPreview despuÃ©s de cambiar iconPosition...');
          updateButtonPreview(componentId);
        } else if (option === 'state') {
          state.state = value;
          // Actualizar botones activos de estado
          document.querySelectorAll(`[data-component="${componentId}"][data-option="state"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Actualizar preview para aplicar el estado
          updateButtonPreview(componentId);
        }
        
        // Actualizar preview (solo si no se actualizÃ³ ya en el bloque de 'icon', 'tooltip', 'tooltipText' o 'state')
        if (option !== 'icon' && option !== 'tooltip' && option !== 'tooltipText' && option !== 'state') {
          console.log('ğŸ›ï¸ [setButtonControl] Llamando updateButtonPreview (opciÃ³n no manejada especÃ­ficamente)');
          updateButtonPreview(componentId);
        }
        
        console.log('ğŸ›ï¸ [setButtonControl] Estado final:', JSON.stringify(state, null, 2));
        console.log('ğŸ›ï¸ [setButtonControl] ===== FIN =====');
      };
      
      // FunciÃ³n para cambiar el preview del botÃ³n
      window.setButtonPreviewOption = function(option, componentId) {
        // Remover clase active de todos los botones de control de este componente
        document.querySelectorAll(`[data-component="${componentId}"].preview-control-btn`).forEach(btn => {
          btn.classList.remove('active');
        });
        
        // Agregar clase active al botÃ³n clickeado
        event.target.closest('.preview-control-btn').classList.add('active');
        
        // Deshabilitar badge toggle si estÃ¡ en modo disabled
        const badgeToggle = document.getElementById(`badge-toggle-${componentId}`);
        if (option === 'disabled') {
          if (badgeToggle) {
            badgeToggle.disabled = true;
            badgeToggle.checked = false;
          }
        } else {
          if (badgeToggle) badgeToggle.disabled = false;
        }
        
        // Actualizar el preview
        updateButtonPreview(option, componentId);
      };
      
      // FunciÃ³n para toggle de iconos
      window.toggleButtonIcons = function(componentId) {
        const activeButton = document.querySelector(`[data-component="${componentId}"].preview-control-btn.active`);
        if (activeButton) {
          const option = activeButton.textContent.trim().toLowerCase();
          if (option === 'primario') {
            updateButtonPreview(componentId);
          } else if (option === 'secundario') {
            updateButtonPreview(componentId);
          } else if (option === 'terciario') {
            updateButtonPreview(componentId);
          } else if (option === 'disabled') {
            updateButtonPreview(componentId);
          }
        }
      };
      
      // ========================================
      // BADGE PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Badge
      const badgePreviewState = {};
      
      // Inicializar estado del Badge
      function initBadgePreviewState(componentId) {
        if (!badgePreviewState[componentId]) {
          badgePreviewState[componentId] = {
            type: 'number',
            variant: 'success', // Cambiar de 'primary' a 'success'
            variant2: 'light', // Variante 2 por defecto: light
            size: 'md',
            content: '5',
            style: undefined, // Sin estilo por defecto para que funcione como badge normal
            showLabel: false,
            label: 'Notificaciones',
            labelTypography: 'ubits-body-md-regular'
          };
        }
        return badgePreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del badge
      function generateBadgeHTML(state, componentId) {
        const { type, variant, variant2, size, content, style, showLabel, label, labelTypography } = state;
        
        console.log('ğŸ”µ generateBadgeHTML - INICIO:', { state, componentId });
        
        // Si hay variant2, usarlo para determinar el style
        let finalStyle = style;
        if (variant2) {
          if (variant2 === 'light') {
            finalStyle = 'light';
          } else if (variant2 === 'neutral') {
            finalStyle = 'neutral'; // Neutral tiene borde (border 1)
          } else if (variant2 === 'bold') {
            finalStyle = 'bold'; // Bold tiene fondo de color y texto/dot con buen contraste
          }
        }
        
        console.log('ğŸ”µ generateBadgeHTML - finalStyle:', finalStyle);
        console.log('ğŸ”µ generateBadgeHTML - window.renderBadge existe?', typeof window.renderBadge);
        
        // Cargar Badge UMD si no estÃ¡ disponible
        if (typeof window.renderBadge === 'undefined') {
          const existingBadgeScript = document.querySelector('script[src*="badge.umd.js"]');
          if (!existingBadgeScript) {
            const badgeScript = document.createElement('script');
            badgeScript.src = '../../addons/badge/dist/badge.umd.js?v=' + Date.now();
            badgeScript.onload = () => {
              console.log('âœ… Badge UMD cargado');
              console.log('ğŸ”µ window.UBITSBadge:', window.UBITSBadge);
              // Exponer renderBadge al window
              if (window.UBITSBadge) {
                if (window.UBITSBadge.renderBadge) {
                  window.renderBadge = window.UBITSBadge.renderBadge;
                } else if (window.UBITSBadge.default && window.UBITSBadge.default.renderBadge) {
                  window.renderBadge = window.UBITSBadge.default.renderBadge;
                } else {
                  // Intentar acceder directamente a las propiedades exportadas
                  const exports = window.UBITSBadge;
                  if (exports.renderBadge) {
                    window.renderBadge = exports.renderBadge;
                  }
                }
                console.log('âœ… window.renderBadge expuesto:', typeof window.renderBadge);
                // Re-renderizar despuÃ©s de cargar
                if (typeof window.updateBadgePreview === 'function') {
                  window.updateBadgePreview(componentId);
                }
              } else {
                console.error('âŒ window.UBITSBadge no estÃ¡ disponible');
              }
            };
            badgeScript.onerror = () => {
              console.error('âŒ Error cargando badge.umd.js');
            };
            document.head.appendChild(badgeScript);
            // Retornar HTML temporal mientras carga
            // Calcular badgeContent temporal para el fallback
            let tempBadgeContent;
            if (type === 'dot') {
              tempBadgeContent = undefined;
            } else if (type === 'number') {
              tempBadgeContent = (content && content.toString().trim() !== '') ? content : '5';
            } else {
              tempBadgeContent = content || undefined;
            }
            return `<span class="ubits-badge ubits-badge--${size} ubits-badge--${type} ubits-badge--${variant}${finalStyle ? ` ubits-badge--${finalStyle}` : ''}">${type === 'number' ? (tempBadgeContent || '5') : ''}</span>`;
          }
        }
        
        // Usar renderBadge si estÃ¡ disponible
        if (typeof window.renderBadge === 'function') {
          // Si el tipo es dot, pasar undefined/null para que no muestre contenido
          // Si el tipo es number, asegurarse de que haya contenido vÃ¡lido
          let badgeContent;
          if (type === 'dot') {
            badgeContent = undefined; // No pasar contenido para dot
          } else if (type === 'number') {
            // Para number, usar el contenido o un valor por defecto
            badgeContent = (content && content.toString().trim() !== '') ? content : '5';
          } else {
            badgeContent = content || undefined;
          }
          
          const badgeOptions = {
            type: type, // Pasar explÃ­citamente el tipo para que BadgeProvider lo respete
            variant: variant,
            size: size,
            content: badgeContent,
            style: finalStyle, // Usar el style determinado por variant2 o el style original
            showLabel: showLabel,
            label: showLabel ? label : undefined, // Solo pasar label si showLabel estÃ¡ activado
            labelTypography: labelTypography
          };
          
          console.log('ğŸ”µ generateBadgeHTML - Badge options:', badgeOptions);
          console.log('ğŸ”µ generateBadgeHTML - State:', state);
          
          return window.renderBadge(badgeOptions);
        }
        
        // Fallback si renderBadge no estÃ¡ disponible
        const classes = [
          'ubits-badge',
          `ubits-badge--${size}`,
          `ubits-badge--${type}`,
          `ubits-badge--${variant}`, // Siempre agregar la clase de variante
          style ? `ubits-badge--${style}` : 'ubits-badge--light' // Agregar clase de estilo
        ].filter(Boolean).join(' ');
        
        // Si el tipo es dot, no mostrar contenido; si es number, mostrar el contenido
        const badgeContent = type === 'number' && content ? String(content) : '';
        
        let badgeHTML = `<span class="${classes}">${badgeContent}</span>`;
        
        // Solo mostrar label si showLabel estÃ¡ activado Y hay label definido
        if (label && showLabel) {
          badgeHTML = `<div class="ubits-badge-wrapper">
            ${badgeHTML}
            <span class="${labelTypography}">${label}</span>
          </div>`;
        }
        
        return badgeHTML;
      }
      
      // FunciÃ³n para actualizar el preview del badge
      window.updateBadgePreview = function(componentId) {
        console.log('ğŸ”µ updateBadgePreview - INICIO:', componentId);
        const state = initBadgePreviewState(componentId);
        console.log('ğŸ”µ updateBadgePreview - State:', state);
        const preview = document.getElementById(`badge-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Badge no encontrado:', `badge-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”µ updateBadgePreview - Llamando generateBadgeHTML...');
        const badgeHTML = generateBadgeHTML(state, componentId);
        console.log('ğŸ”µ updateBadgePreview - HTML generado:', badgeHTML);
        preview.innerHTML = badgeHTML;
        
        // Inicializar toggle si existe
        const toggle = document.getElementById(`badge-show-label-toggle-${componentId}`);
        if (toggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(toggle);
        }
        
        // Inicializar texto de estado del toggle
        const statusSpan = document.getElementById(`badge-label-status-${componentId}`);
        if (statusSpan) {
          statusSpan.textContent = state.showLabel ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… Badge preview actualizado:', {
          type: state.type,
          variant: state.variant,
          variant2: state.variant2,
          size: state.size,
          content: state.content,
          style: state.style,
          showLabel: state.showLabel,
          label: state.label,
          labelTypography: state.labelTypography
        });
      };
      
      // FunciÃ³n unificada para controles del Badge
      window.setBadgeControl = function(option, value, componentId) {
        const state = initBadgePreviewState(componentId);
        
        if (option === 'type') {
          state.type = value;
          // Si cambia a dot, limpiar el contenido
          if (value === 'dot') {
            state.content = '';
          } else if (value === 'number') {
            // Si cambia a number, asegurarse de que haya contenido vÃ¡lido
            if (!state.content || state.content.toString().trim() === '') {
              state.content = '5';
            }
            const contentInput = document.getElementById(`badge-content-input-${componentId}`);
            if (contentInput) {
              // Asegurarse de que el input tenga un valor vÃ¡lido
              if (!contentInput.value || contentInput.value.trim() === '') {
                contentInput.value = state.content;
              }
            }
          }
          // Actualizar botones activos de tipo
          document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Mostrar/ocultar input de contenido segÃºn tipo
          const contentInput = document.getElementById(`badge-content-input-${componentId}`);
          if (contentInput) {
            contentInput.style.display = value === 'number' ? 'block' : 'none';
          }
        } else if (option === 'variant') {
          state.variant = value;
          console.log('ğŸ”µ setBadgeControl - Variant changed:', { option, value, componentId, currentState: state });
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`badge-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'content') {
          state.content = value || '5';
          const input = document.getElementById(`badge-content-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showLabel') {
          state.showLabel = value === true || value === 'true';
          const toggle = document.getElementById(`badge-show-label-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showLabel;
            // Actualizar estado visual del toggle
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          // Actualizar texto de estado
          const statusSpan = document.getElementById(`badge-label-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showLabel ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'label') {
          state.label = value || 'Notificaciones';
          const input = document.getElementById(`badge-label-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'labelTypography') {
          state.labelTypography = value || 'ubits-body-md-regular';
          const select = document.getElementById(`badge-label-typography-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'style') {
          state.style = value || 'light';
          // Actualizar botones activos de estilo
          document.querySelectorAll(`[data-component="${componentId}"][data-option="style"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'variant2') {
          state.variant2 = value || 'light';
          // Actualizar botones activos de variante 2
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant2"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Mapear variant2 a style para el BadgeProvider
          if (value === 'light') {
            state.style = 'light';
          } else if (value === 'neutral') {
            state.style = 'neutral'; // Neutral tiene borde (border 1)
          } else if (value === 'bold') {
            state.style = 'bold'; // Bold tiene fondo de color y texto/dot con buen contraste
          }
        }
        
        // Actualizar preview
        if (typeof window.updateBadgePreview === 'function') {
          window.updateBadgePreview(componentId);
        }
      };
      
      // FunciÃ³n para toggle de badge
      window.toggleButtonBadge = function(componentId) {
        console.log('ğŸ·ï¸ toggleButtonBadge llamado para:', componentId);
        
        const activeButton = document.querySelector(`[data-component="${componentId}"].preview-control-btn.active`);
        const badgeToggle = document.getElementById(`badge-toggle-${componentId}`);
        
        console.log('ğŸ“‹ Estado del toggle badge:', {
          activeButton: activeButton ? activeButton.textContent.trim() : 'no encontrado',
          badgeToggleChecked: badgeToggle ? badgeToggle.checked : 'no encontrado'
        });
        
        if (activeButton) {
          const option = activeButton.textContent.trim().toLowerCase();
          console.log('ğŸ¯ OpciÃ³n detectada:', option);
          
          // Determinar la opciÃ³n correcta basada en el texto del botÃ³n activo
          let previewOption = 'primary';
          if (option === 'primario') {
            previewOption = 'primary';
          } else if (option === 'secundario') {
            previewOption = 'secondary';
          } else if (option === 'terciario') {
            previewOption = 'tertiary';
          } else if (option === 'disabled' || option === 'deshabilitado') {
            previewOption = 'disabled';
          }
          
          console.log('ğŸ”„ Actualizando preview con opciÃ³n:', previewOption);
          updateButtonPreview(previewOption, componentId);
        } else {
          console.warn('âš ï¸ No se encontrÃ³ botÃ³n activo para el componente:', componentId);
        }
      };
      
      // ========================================
      // SPINNER PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Spinner
      const spinnerPreviewState = {};
      
      // Inicializar estado del Spinner
      function initSpinnerPreviewState(componentId) {
        if (!spinnerPreviewState[componentId]) {
          spinnerPreviewState[componentId] = {
            size: 'md',
            variant: 'primary',
            animated: true,
            label: '',
            fullScreen: false
          };
        }
        return spinnerPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Spinner
      function generateSpinnerHTML(state, componentId) {
        const { size, variant, animated, label, fullScreen } = state;
        
        const classes = [
          'ubits-spinner',
          `ubits-spinner--${size}`,
          `ubits-spinner--${variant}`,
          animated ? 'ubits-spinner--animated' : '',
          fullScreen ? 'ubits-spinner--fullscreen' : ''
        ].filter(Boolean).join(' ');
        
        // Estilos inline para asegurar que el fullscreen estÃ© por encima del menÃº
        const fullscreenStyle = fullScreen ? `
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          width: 100% !important;
          height: 100% !important;
          z-index: 100000 !important;
        ` : '';
        
        return `
          <div class="${classes}" style="${fullscreenStyle}">
            <div class="ubits-spinner__circle">
              <div class="ubits-spinner__segment"></div>
              <div class="ubits-spinner__segment"></div>
              <div class="ubits-spinner__segment"></div>
              <div class="ubits-spinner__segment"></div>
            </div>
            ${label ? `<span class="ubits-spinner__label">${label}</span>` : ''}
          </div>
        `;
      }
      
      // FunciÃ³n para crear/remover botÃ³n de cerrar en fullscreen
      function manageSpinnerCloseButton(componentId, show) {
        const buttonId = `spinner-close-btn-${componentId}`;
        let closeButton = document.getElementById(buttonId);
        
        if (show) {
          // Crear botÃ³n si no existe
          if (!closeButton) {
            closeButton = document.createElement('button');
            closeButton.id = buttonId;
            closeButton.className = 'ubits-spinner__close-btn';
            closeButton.setAttribute('aria-label', 'Cerrar spinner');
            closeButton.style.cssText = `
              position: fixed !important;
              top: 20px !important;
              right: 20px !important;
              width: 40px !important;
              height: 40px !important;
              border: none !important;
              border-radius: 50% !important;
              background: var(--ubits-bg-1) !important;
              color: var(--ubits-fg-1-high) !important;
              cursor: pointer !important;
              display: flex !important;
              align-items: center !important;
              justify-content: center !important;
              font-size: 20px !important;
              box-shadow: var(--ubits-effects-elevation-3) !important;
              transition: all 0.2s ease !important;
              z-index: 100001 !important;
              pointer-events: auto !important;
            `;
            closeButton.innerHTML = '<i class="far fa-times" style="font-size: 18px;"></i>';
            closeButton.onclick = function(e) {
              e.preventDefault();
              e.stopPropagation();
              setSpinnerControl('fullScreen', false, componentId);
            };
            closeButton.onmouseover = function() {
              this.style.background = 'var(--ubits-bg-2)';
              this.style.transform = 'scale(1.1)';
            };
            closeButton.onmouseout = function() {
              this.style.background = 'var(--ubits-bg-1)';
              this.style.transform = 'scale(1)';
            };
            document.body.appendChild(closeButton);
          }
          closeButton.style.display = 'flex';
          closeButton.style.zIndex = '100001';
          closeButton.style.pointerEvents = 'auto';
        } else {
          // Ocultar o remover botÃ³n
          if (closeButton) {
            closeButton.style.display = 'none';
          }
        }
      }
      
      // FunciÃ³n para actualizar el preview del Spinner
      window.updateSpinnerPreview = function(componentId) {
        const state = initSpinnerPreviewState(componentId);
        const preview = document.getElementById(`spinner-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Spinner no encontrado:', `spinner-preview-${componentId}`);
          return;
        }
        
        // Si estÃ¡ en modo fullscreen, mover el spinner directamente al body
        const fullscreenSpinnerId = `spinner-fullscreen-${componentId}`;
        let fullscreenSpinner = document.getElementById(fullscreenSpinnerId);
        
        if (state.fullScreen) {
          // Remover spinner del preview normal
          preview.innerHTML = '';
          
          // Crear o actualizar spinner fullscreen en el body
          if (!fullscreenSpinner) {
            fullscreenSpinner = document.createElement('div');
            fullscreenSpinner.id = fullscreenSpinnerId;
            document.body.appendChild(fullscreenSpinner);
          }
          
          const spinnerHTML = generateSpinnerHTML(state, componentId);
          fullscreenSpinner.innerHTML = spinnerHTML;
          
          // Asegurar que el contenedor fullscreen tenga el z-index correcto
          const spinnerElement = fullscreenSpinner.querySelector('.ubits-spinner--fullscreen');
          if (spinnerElement) {
            spinnerElement.style.cssText += `
              position: fixed !important;
              top: 0 !important;
              left: 0 !important;
              right: 0 !important;
              bottom: 0 !important;
              width: 100% !important;
              height: 100% !important;
              z-index: 100000 !important;
            `;
          }
        } else {
          // Remover spinner fullscreen del body si existe
          if (fullscreenSpinner) {
            fullscreenSpinner.remove();
          }
          
          // Renderizar spinner normal en el preview
          const spinnerHTML = generateSpinnerHTML(state, componentId);
          preview.innerHTML = spinnerHTML;
        }
        
        // Gestionar botÃ³n de cerrar en fullscreen
        manageSpinnerCloseButton(componentId, state.fullScreen);
        
        console.log('âœ… Spinner preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Spinner
      window.setSpinnerControl = function(option, value, componentId) {
        const state = initSpinnerPreviewState(componentId);
        
        if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`spinner-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'variant') {
          state.variant = value;
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'animated') {
          state.animated = value;
          const status = document.getElementById(`spinner-animated-status-${componentId}`);
          if (status) status.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'label') {
          state.label = value || '';
          const input = document.getElementById(`spinner-label-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'fullScreen') {
          state.fullScreen = value;
          const status = document.getElementById(`spinner-fullscreen-status-${componentId}`);
          if (status) status.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        window.updateSpinnerPreview(componentId);
      };
      
      // ========================================
      // SKELETON PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Skeleton
      const skeletonPreviewState = {};
      
      // Inicializar estado del Skeleton
      function initSkeletonPreviewState(componentId) {
        if (!skeletonPreviewState[componentId]) {
          skeletonPreviewState[componentId] = {
            variant: 'text',
            size: 'md',
            width: 'full',
            height: '',
            lines: 1,
            animated: true
          };
        }
        return skeletonPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Skeleton
      function generateSkeletonHTML(state, componentId) {
        const { variant, size, width, height, lines, animated } = state;
        
        const classes = [
          'ubits-skeleton',
          `ubits-skeleton--${variant}`,
          size !== 'md' ? `ubits-skeleton--${size}` : '',
          animated ? 'ubits-skeleton--animated' : ''
        ].filter(Boolean).join(' ');
        
        // Calcular estilos de tamaÃ±o
        const sizeStyles = [];
        if (width) {
          if (width === 'full') {
            sizeStyles.push('width: 100%');
          } else if (typeof width === 'number') {
            sizeStyles.push(`width: ${width}px`);
          } else {
            sizeStyles.push(`width: ${width}`);
          }
        }
        if (height) {
          if (typeof height === 'number') {
            sizeStyles.push(`height: ${height}px`);
          } else {
            sizeStyles.push(`height: ${height}`);
          }
        }
        const styleAttr = sizeStyles.length > 0 ? ` style="${sizeStyles.join('; ')}"` : '';
        
        // Renderizar segÃºn la variante
        if (variant === 'text') {
          const lineElements = Array.from({ length: lines }, (_, index) => {
            const isLastLine = index === lines - 1;
            const lineWidth = isLastLine && lines > 1 ? '60%' : '100%';
            return `<span class="ubits-skeleton__line" style="width: ${lineWidth}"></span>`;
          }).join('');
          return `<div class="${classes}"${styleAttr}>${lineElements}</div>`;
        }
        
        return `<div class="${classes}"${styleAttr}></div>`;
      }
      
      // FunciÃ³n para actualizar el preview del Skeleton
      window.updateSkeletonPreview = function(componentId) {
        const state = initSkeletonPreviewState(componentId);
        const preview = document.getElementById(`skeleton-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Skeleton no encontrado:', `skeleton-preview-${componentId}`);
          return;
        }
        
        const skeletonHTML = generateSkeletonHTML(state, componentId);
        preview.innerHTML = skeletonHTML;
        
        console.log('âœ… Skeleton preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Skeleton
      window.setSkeletonControl = function(option, value, componentId) {
        const state = initSkeletonPreviewState(componentId);
        
        if (option === 'variant') {
          state.variant = value;
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Mostrar/ocultar controles segÃºn variante
          const linesContainer = document.getElementById(`skeleton-lines-container-${componentId}`);
          const heightContainer = document.getElementById(`skeleton-height-container-${componentId}`);
          if (linesContainer) {
            linesContainer.style.display = value === 'text' ? 'block' : 'none';
          }
          if (heightContainer) {
            heightContainer.style.display = (value === 'rectangle' || value === 'custom') ? 'block' : 'none';
          }
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`skeleton-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'width') {
          state.width = value || 'full';
          const input = document.getElementById(`skeleton-width-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'height') {
          state.height = value || '';
          const input = document.getElementById(`skeleton-height-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'lines') {
          state.lines = Math.max(1, Math.min(10, parseInt(value) || 1));
          const input = document.getElementById(`skeleton-lines-input-${componentId}`);
          if (input && input.value !== state.lines) input.value = state.lines;
        } else if (option === 'animated') {
          state.animated = value;
          const status = document.getElementById(`skeleton-animated-status-${componentId}`);
          if (status) status.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        window.updateSkeletonPreview(componentId);
      };
      
      // ========================================
      // EMPTY STATE PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Empty State
      const emptyStatePreviewState = {};
      
      // Inicializar estado del Empty State
      function initEmptyStatePreviewState(componentId) {
        if (!emptyStatePreviewState[componentId]) {
          emptyStatePreviewState[componentId] = {
            title: 'No hay resultados',
            description: 'Intenta ajustar tus filtros de bÃºsqueda',
            imageUrl: '',
            icon: 'inbox',
            actionLabel: 'Buscar',
            showPrimaryButton: false,
            primaryButtonIcon: 'search',
            showPrimaryButtonIcon: false,
            secondaryActionLabel: 'Cancelar',
            showSecondaryButton: false,
            secondaryButtonIcon: 'times',
            showSecondaryButtonIcon: false
          };
        }
        return emptyStatePreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Empty State
      function generateEmptyStateHTML(state, componentId) {
        const { title, description, imageUrl, icon, actionLabel, showPrimaryButton, primaryButtonIcon, showPrimaryButtonIcon, secondaryActionLabel, showSecondaryButton, secondaryButtonIcon, showSecondaryButtonIcon } = state;
        
        const classes = [
          'ubits-empty-state',
          'ubits-empty-state--default'
        ].filter(Boolean).join(' ');
        
        // Renderizar imagen o icono
        let visualElement = '';
        if (imageUrl) {
          visualElement = `
            <div class="ubits-empty-state__image">
              <img src="${imageUrl}" alt="${title}" />
            </div>
          `;
        } else if (icon) {
          visualElement = `
            <div class="ubits-empty-state__icon">
              <i class="far fa-${icon}"></i>
            </div>
          `;
        }
        
        // Renderizar botones de acciÃ³n
        let actionsHTML = '';
        let primaryButtonContent = actionLabel || '';
        if (showPrimaryButtonIcon && primaryButtonIcon) {
          primaryButtonContent = `<i class="far fa-${primaryButtonIcon}"></i> ${primaryButtonContent}`;
        }
        
        let secondaryButtonContent = secondaryActionLabel || '';
        if (showSecondaryButtonIcon && secondaryButtonIcon) {
          secondaryButtonContent = `<i class="far fa-${secondaryButtonIcon}"></i> ${secondaryButtonContent}`;
        }
        
        const primaryButton = (showPrimaryButton && actionLabel) 
          ? `<button class="ubits-button ubits-button--primary ubits-button--md" type="button">${primaryButtonContent}</button>`
          : '';
        
        const secondaryButton = (showSecondaryButton && secondaryActionLabel)
          ? `<button class="ubits-button ubits-button--secondary ubits-button--md" type="button">${secondaryButtonContent}</button>`
            : '';

          if (primaryButton || secondaryButton) {
            actionsHTML = `
              <div class="ubits-empty-state__actions">
                ${secondaryButton}
              ${primaryButton}
              </div>
            `;
        }
        
        return `
          <div class="${classes}">
            ${visualElement}
            <div class="ubits-empty-state__content">
              <h3 class="ubits-empty-state__title">${title}</h3>
              ${description ? `<p class="ubits-empty-state__description">${description}</p>` : ''}
            </div>
            ${actionsHTML}
          </div>
        `;
      }
      
      // FunciÃ³n para actualizar el preview del Empty State
      window.updateEmptyStatePreview = function(componentId) {
        const state = initEmptyStatePreviewState(componentId);
        const preview = document.getElementById(`empty-state-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Empty State no encontrado:', `empty-state-preview-${componentId}`);
          return;
        }
        
        const emptyStateHTML = generateEmptyStateHTML(state, componentId);
        preview.innerHTML = emptyStateHTML;
        
        console.log('âœ… Empty State preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Empty State
      window.setEmptyStateControl = function(option, value, componentId) {
        const state = initEmptyStatePreviewState(componentId);
        
        if (option === 'title') {
          state.title = value || 'No hay resultados';
          const input = document.getElementById(`empty-state-title-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'description') {
          state.description = value || '';
          const input = document.getElementById(`empty-state-description-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'icon') {
          state.icon = value || '';
          state.imageUrl = ''; // Limpiar imagen si se usa icono
          const input = document.getElementById(`empty-state-icon-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'actionLabel') {
          state.actionLabel = value || '';
          const input = document.getElementById(`empty-state-action-label-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showPrimaryButton') {
          state.showPrimaryButton = value || false;
          const toggle = document.getElementById(`empty-state-show-primary-toggle-${componentId}`);
          if (toggle && toggle.checked !== value) toggle.checked = value;
        } else if (option === 'primaryButtonIcon') {
          state.primaryButtonIcon = value || '';
          const input = document.getElementById(`empty-state-primary-button-icon-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showPrimaryButtonIcon') {
          state.showPrimaryButtonIcon = value || false;
          const toggle = document.getElementById(`empty-state-show-primary-icon-toggle-${componentId}`);
          if (toggle && toggle.checked !== value) toggle.checked = value;
        } else if (option === 'secondaryActionLabel') {
          state.secondaryActionLabel = value || '';
          const input = document.getElementById(`empty-state-secondary-action-label-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showSecondaryButton') {
          state.showSecondaryButton = value || false;
          const toggle = document.getElementById(`empty-state-show-secondary-toggle-${componentId}`);
          if (toggle && toggle.checked !== value) toggle.checked = value;
        } else if (option === 'secondaryButtonIcon') {
          state.secondaryButtonIcon = value || '';
          const input = document.getElementById(`empty-state-secondary-button-icon-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showSecondaryButtonIcon') {
          state.showSecondaryButtonIcon = value || false;
          const toggle = document.getElementById(`empty-state-show-secondary-icon-toggle-${componentId}`);
          if (toggle && toggle.checked !== value) toggle.checked = value;
        }
        
        // Actualizar preview
        window.updateEmptyStatePreview(componentId);
      };
      
      // ========================================
      // STATUS TAG PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Status Tag
      const statusTagPreviewState = {};
      
      // Mapeo de labels por estado
      const statusTagLabels = {
        'completed': 'Completado',
        'published': 'Publicado',
        'fulfilled': 'CumpliÃ³',
        'created': 'Creado',
        'active': 'Activo',
        'not-fulfilled': 'No cumpliÃ³',
        'denied': 'Denegado',
        'draft': 'Borrador',
        'in-progress': 'En progreso',
        'syncing': 'Sincronizando',
        'pending': 'Pendiente',
        'pending-approval': 'Por aprobar',
        'not-started': 'Por iniciar',
        'finished': 'Finalizado',
        'archived': 'Archivado',
        'disabled': 'Desactivado',
        'paused': 'Pausado',
        'hidden': 'Oculto'
      };
      
      // Inicializar estado del Status Tag
      function initStatusTagPreviewState(componentId) {
        if (!statusTagPreviewState[componentId]) {
          statusTagPreviewState[componentId] = {
            size: 'md',
            status: 'completed',
            label: 'Completado',
            leftIcon: 'grid-2', // Icono izquierdo por defecto segÃºn Figma
            rightIcon: 'chevron-down',
            clickable: false
          };
        }
        return statusTagPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Status Tag
      function generateStatusTagHTML(state, componentId) {
        const { size, status, label, leftIcon, rightIcon, clickable } = state;
        
        // Obtener colores segÃºn el estado (usando tokens UBITS)
        const STATUS_COLORS = {
          'completed': { bg: 'var(--ubits-feedback-success-bg, #e8f8e4)', text: 'var(--ubits-feedback-success-text, #223b16)', border: 'var(--ubits-feedback-success-border, #41c433)' },
          'published': { bg: 'var(--ubits-feedback-success-bg, #e8f8e4)', text: 'var(--ubits-feedback-success-text, #223b16)', border: 'var(--ubits-feedback-success-border, #41c433)' },
          'fulfilled': { bg: 'var(--ubits-feedback-success-bg, #e8f8e4)', text: 'var(--ubits-feedback-success-text, #223b16)', border: 'var(--ubits-feedback-success-border, #41c433)' },
          'created': { bg: 'var(--ubits-feedback-success-bg, #e8f8e4)', text: 'var(--ubits-feedback-success-text, #223b16)', border: 'var(--ubits-feedback-success-border, #41c433)' },
          'active': { bg: 'var(--ubits-feedback-success-bg, #e8f8e4)', text: 'var(--ubits-feedback-success-text, #223b16)', border: 'var(--ubits-feedback-success-border, #41c433)' },
          'not-fulfilled': { bg: 'var(--ubits-feedback-error-bg, #fff0ee)', text: 'var(--ubits-feedback-error-text, #65181e)', border: 'var(--ubits-feedback-error-border, #fd8a82)' },
          'denied': { bg: 'var(--ubits-feedback-error-bg, #fff0ee)', text: 'var(--ubits-feedback-error-text, #65181e)', border: 'var(--ubits-feedback-error-border, #fd8a82)' },
          'draft': { bg: 'var(--ubits-bg-active, rgba(12, 91, 239, 0.15))', text: 'var(--ubits-feedback-info-text, #212f70)', border: 'var(--ubits-accent-brand-static-inverted, #0c5bef)' },
          'in-progress': { bg: 'var(--ubits-bg-active, rgba(12, 91, 239, 0.15))', text: 'var(--ubits-feedback-info-text, #212f70)', border: 'var(--ubits-accent-brand-static-inverted, #0c5bef)' },
          'syncing': { bg: 'var(--ubits-bg-active, rgba(12, 91, 239, 0.15))', text: 'var(--ubits-feedback-info-text, #212f70)', border: 'var(--ubits-accent-brand-static-inverted, #0c5bef)' },
          'pending': { bg: 'var(--ubits-feedback-warning-bg, #fff1e0)', text: 'var(--ubits-feedback-warning-text, #4c2e15)', border: 'var(--ubits-feedback-warning-border, #ec9907)' },
          'pending-approval': { bg: 'var(--ubits-feedback-warning-bg, #fff1e0)', text: 'var(--ubits-feedback-warning-text, #4c2e15)', border: 'var(--ubits-feedback-warning-border, #ec9907)' },
          'not-started': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' },
          'finished': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' },
          'archived': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' },
          'disabled': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' },
          'paused': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' },
          'hidden': { bg: 'var(--ubits-bg-2, #f3f3f4)', text: 'var(--ubits-fg-1-medium, #2b3543)', border: 'var(--ubits-border-1, #a8abb2)' }
        };
        
        const colors = STATUS_COLORS[status] || STATUS_COLORS.pending;
        
        const classes = [
          'ubits-status-tag',
          `ubits-status-tag--${size}`,
          clickable ? 'ubits-status-tag--clickable' : ''
        ].filter(Boolean).join(' ');
        
        // Para estados azules (draft, in-progress, syncing), usar gradiente
        const isInfoStatus = status === 'draft' || status === 'in-progress' || status === 'syncing';
        const bgStyle = isInfoStatus 
          ? `background: linear-gradient(90deg, var(--ubits-bg-active, rgba(12, 91, 239, 0.15)) 0%, var(--ubits-bg-active, rgba(12, 91, 239, 0.15)) 100%), linear-gradient(90deg, var(--ubits-bg-1, #ffffff) 0%, var(--ubits-bg-1, #ffffff) 100%); background-color: ${colors.bg};`
          : `background-color: ${colors.bg};`;
        
        const inlineStyles = `
          ${bgStyle}
          color: ${colors.text};
          border-color: ${colors.border};
        `.trim();
        
        // Icono izquierdo: usar el especificado o grid-2 por defecto (segÃºn Figma)
        const leftIconHTML = leftIcon 
          ? `<span class="ubits-status-tag-left-icon"><i class="far fa-${leftIcon}"></i></span>`
          : '';
        
        const rightIconHTML = rightIcon !== null && rightIcon !== undefined
          ? `<span class="ubits-status-tag-right-icon"><i class="far fa-${rightIcon}"></i></span>`
          : '';
        
        return `
          <span class="${classes}" style="${inlineStyles}" data-status="${status}">
            ${leftIconHTML}
            <span class="ubits-status-tag-label">${label}</span>
            ${rightIconHTML}
          </span>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Status Tag
      window.updateStatusTagPreview = function(componentId) {
        const state = initStatusTagPreviewState(componentId);
        const preview = document.getElementById(`status-tag-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Status Tag no encontrado:', `status-tag-preview-${componentId}`);
          return;
        }
        
        const statusTagHTML = generateStatusTagHTML(state, componentId);
        preview.innerHTML = statusTagHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="status-tag.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/status-tag/src/styles/status-tag.css';
          document.head.appendChild(link);
        }
        
        console.log('âœ… Status Tag preview actualizado:', {
          size: state.size,
          status: state.status,
          label: state.label,
          leftIcon: state.leftIcon,
          rightIcon: state.rightIcon,
          clickable: state.clickable
        });
      };
      
      // FunciÃ³n unificada para controles del Status Tag
      window.setStatusTagControl = function(option, value, componentId) {
        const state = initStatusTagPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
        } else if (option === 'status') {
          state.status = value;
          // Actualizar label automÃ¡ticamente segÃºn el estado
          state.label = statusTagLabels[value] || value;
          // Actualizar input de label
          const labelInput = document.getElementById(`status-tag-label-input-${componentId}`);
          if (labelInput) {
            labelInput.value = state.label;
          }
        } else if (option === 'label') {
          state.label = value;
        } else if (option === 'leftIcon') {
          state.leftIcon = value;
          // Actualizar toggle
          const leftIconToggle = document.getElementById(`status-tag-left-icon-toggle-${componentId}`);
          const leftIconStatus = document.getElementById(`status-tag-left-icon-status-${componentId}`);
          if (leftIconToggle && leftIconStatus) {
            leftIconToggle.checked = value !== null && value !== undefined;
            leftIconStatus.textContent = value !== null && value !== undefined ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'rightIcon') {
          state.rightIcon = value;
          // Actualizar toggle
          const rightIconToggle = document.getElementById(`status-tag-right-icon-toggle-${componentId}`);
          const rightIconStatus = document.getElementById(`status-tag-right-icon-status-${componentId}`);
          if (rightIconToggle && rightIconStatus) {
            rightIconToggle.checked = value !== null && value !== undefined;
            rightIconStatus.textContent = value !== null && value !== undefined ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'clickable') {
          state.clickable = value;
          // Actualizar toggle
          const clickableToggle = document.getElementById(`status-tag-clickable-toggle-${componentId}`);
          const clickableStatus = document.getElementById(`status-tag-clickable-status-${componentId}`);
          if (clickableToggle && clickableStatus) {
            clickableToggle.checked = value;
            clickableStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        updateStatusTagPreview(componentId);
      };
      
      // ========================================
      // CHIP PREVIEW FUNCTIONS
      // ========================================
      
      const chipPreviewState = {};
      
      // Inicializar estado del Chip
      function initChipPreviewState(componentId) {
        if (!chipPreviewState[componentId]) {
          chipPreviewState[componentId] = {
            size: 'md',
            state: 'default',
            label: 'Chip',
            leftIcon: null,
            closable: false,
            clickable: false
          };
        }
        return chipPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Chip
      function generateChipHTML(state, componentId) {
        const { size, state: chipState, label, leftIcon, closable, clickable } = state;
        
        const classes = [
          'ubits-chip',
          `ubits-chip--${size}`,
          chipState !== 'default' ? `ubits-chip--${chipState}` : '',
          clickable ? 'ubits-chip--clickable' : '',
          closable ? 'ubits-chip--closable' : ''
        ].filter(Boolean).join(' ');
        
        // Icono izquierdo
        const leftIconHTML = leftIcon 
          ? `<span class="ubits-chip__left-icon" aria-hidden="true"><i class="far fa-${leftIcon}"></i></span>`
          : '';
        
        // Icono derecho (botÃ³n de cerrar)
        const rightIconHTML = closable
          ? `<button class="ubits-chip__right-icon" type="button" aria-label="Cerrar chip" ${chipState === 'disabled' ? 'disabled' : ''}>
              <i class="far fa-xmark"></i>
            </button>`
          : '';
        
        // Determinar role y aria attributes
        const role = clickable ? 'button' : 'none';
        const tabIndex = clickable && chipState !== 'disabled' ? '0' : '-1';
        const ariaDisabled = chipState === 'disabled' ? 'true' : 'false';
        
        return `
          <span class="${classes}" role="${role}" tabindex="${tabIndex}" aria-disabled="${ariaDisabled}">
            ${leftIconHTML}
            <span class="ubits-chip__label">${label}</span>
            ${rightIconHTML}
          </span>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Chip
      window.updateChipPreview = function(componentId) {
        const state = initChipPreviewState(componentId);
        const preview = document.getElementById(`chip-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Chip no encontrado:', `chip-preview-${componentId}`);
          return;
        }
        
        const chipHTML = generateChipHTML(state, componentId);
        preview.innerHTML = chipHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="chip.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/chip/src/styles/chip.css';
          document.head.appendChild(link);
        }
        
        // Aplicar efecto Focus si el estado es 'focus'
        const chipElement = preview.querySelector('.ubits-chip');
        if (chipElement && state.state === 'focus') {
          // Aplicar estilos inline para mostrar el efecto Focus
          chipElement.style.border = '2px solid var(--ubits-accent-brand-static-inverted, #5297F4)';
          chipElement.style.boxShadow = '0px 0px 0px 4px var(--ubits-button-focus-ring, rgba(82, 151, 244, 0.3))';
          chipElement.style.outline = 'none';
        } else if (chipElement) {
          // Resetear estilos si no es estado focus
          chipElement.style.border = '';
          chipElement.style.boxShadow = '';
          chipElement.style.outline = '';
        }
        
        // Agregar event listener para el botÃ³n de cerrar
        const closeButton = preview.querySelector('.ubits-chip__right-icon');
        if (closeButton) {
          closeButton.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            alert('Chip cerrado');
          });
        }
        
        // Agregar event listener para chip clickeable
        if (state.clickable && state.state !== 'disabled') {
          if (chipElement) {
            chipElement.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              alert('Chip clickeado');
            });
          }
        }
      };
      
      // FunciÃ³n unificada para controles del Chip
      window.setChipControl = function(option, value, componentId) {
        const state = initChipPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
        } else if (option === 'state') {
          state.state = value;
        } else if (option === 'label') {
          state.label = value;
        } else if (option === 'leftIcon') {
          state.leftIcon = value;
          // Actualizar toggle y input
          const leftIconToggle = document.getElementById(`chip-left-icon-toggle-${componentId}`);
          const leftIconStatus = document.getElementById(`chip-left-icon-status-${componentId}`);
          const leftIconInput = document.getElementById(`chip-left-icon-input-${componentId}`);
          if (leftIconToggle && leftIconStatus) {
            leftIconToggle.checked = value !== null && value !== undefined;
            leftIconStatus.textContent = value !== null && value !== undefined ? 'Activado' : 'Desactivado';
          }
          if (leftIconInput) {
            leftIconInput.value = value || '';
          }
        } else if (option === 'closable') {
          state.closable = value;
          // Actualizar toggle
          const closableToggle = document.getElementById(`chip-closable-toggle-${componentId}`);
          const closableStatus = document.getElementById(`chip-closable-status-${componentId}`);
          if (closableToggle && closableStatus) {
            closableToggle.checked = value;
            closableStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'clickable') {
          state.clickable = value;
          // Actualizar toggle
          const clickableToggle = document.getElementById(`chip-clickable-toggle-${componentId}`);
          const clickableStatus = document.getElementById(`chip-clickable-status-${componentId}`);
          if (clickableToggle && clickableStatus) {
            clickableToggle.checked = value;
            clickableStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        updateChipPreview(componentId);
      };
      
      // ========================================
      // RADIO BUTTON PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Radio Button
      const radioButtonPreviewState = {};
      
      // Inicializar estado del Radio Button
      function initRadioButtonPreviewState(componentId) {
        if (!radioButtonPreviewState[componentId]) {
          radioButtonPreviewState[componentId] = {
            size: 'md',
            state: 'default',
            label: 'Label',
            complementaryText: '',
            checked: false,
            name: 'radio-group-' + componentId,
            value: 'option1'
          };
        }
        return radioButtonPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Radio Button
      function generateRadioButtonHTML(state, componentId) {
        const { size, state: radioState, label, complementaryText, checked, name, value } = state;
        
        const isDisabled = radioState === 'disabled';
        
        // Construir clases
        const classes = [
          'ubits-radio-button',
          `ubits-radio-button--${size}`,
          radioState !== 'default' ? `ubits-radio-button--${radioState}` : '',
          checked ? 'ubits-radio-button--checked' : '',
          isDisabled ? 'ubits-radio-button--disabled' : ''
        ].filter(Boolean).join(' ');
        
        // Radio input
        const radioInput = `
          <input
            type="radio"
            id="radio-${name}-${value}-${componentId}"
            name="${name}"
            value="${value}"
            ${checked ? 'checked' : ''}
            ${isDisabled ? 'disabled' : ''}
            class="ubits-radio-button__input"
          />
        `;
        
        // Radio circle (visual)
        const radioCircle = `
          <span class="ubits-radio-button__circle" aria-hidden="true">
            ${checked || (radioState === 'active' && !checked) ? '<span class="ubits-radio-button__dot"></span>' : ''}
          </span>
        `;
        
        // Label text
        const labelHTML = `
          <span class="ubits-radio-button__label">${label}</span>
        `;
        
        // Complementary text
        const complementaryTextHTML = complementaryText
          ? `<span class="ubits-radio-button__complementary-text">${complementaryText}</span>`
          : '';
        
        // Text content wrapper
        const textContentHTML = `
          <div class="ubits-radio-button__text-content">
            ${labelHTML}
            ${complementaryTextHTML}
          </div>
        `;
        
        return `
          <label class="${classes}">
            ${radioInput}
            ${radioCircle}
            ${textContentHTML}
          </label>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Radio Button
      window.updateRadioButtonPreview = function(componentId) {
        const state = initRadioButtonPreviewState(componentId);
        const preview = document.getElementById(`radio-button-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Radio Button no encontrado:', `radio-button-preview-${componentId}`);
          return;
        }
        
        const radioButtonHTML = generateRadioButtonHTML(state, componentId);
        preview.innerHTML = radioButtonHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="radio-button.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/radio-button/src/styles/radio-button.css';
          document.head.appendChild(link);
        }
      };
      
      // FunciÃ³n unificada para controles del Radio Button
      window.setRadioButtonControl = function(option, value, componentId) {
        const state = initRadioButtonPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
        } else if (option === 'state') {
          state.state = value;
        } else if (option === 'label') {
          state.label = value;
        } else if (option === 'complementaryText') {
          state.complementaryText = value;
        } else if (option === 'checked') {
          state.checked = value;
          // Actualizar toggle
          const checkedToggle = document.getElementById(`radio-button-checked-toggle-${componentId}`);
          const checkedStatus = document.getElementById(`radio-button-checked-status-${componentId}`);
          if (checkedToggle && checkedStatus) {
            checkedToggle.checked = value;
            checkedStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        updateRadioButtonPreview(componentId);
      };
      
      // ========================================
      // CHECKBOX PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Checkbox
      const checkboxPreviewState = {};
      
      // Inicializar estado del Checkbox
      function initCheckboxPreviewState(componentId) {
        if (!checkboxPreviewState[componentId]) {
          checkboxPreviewState[componentId] = {
            size: 'md',
            state: 'default',
            label: 'Label',
            complementaryText: '',
            checked: false,
            indeterminate: false,
            name: 'checkbox-group-' + componentId,
            value: 'option1'
          };
        }
        return checkboxPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Checkbox usando renderCheckbox
      function generateCheckboxHTML(state, componentId) {
        const { size, state: checkboxState, label, complementaryText, checked, indeterminate, name, value } = state;
        
        // Usar renderCheckbox directamente para mantener consistencia
        if (typeof window.renderCheckbox === 'function') {
          return window.renderCheckbox({
            label: label,
            complementaryText: complementaryText || undefined,
            value: value,
            name: name,
            checked: checked,
            indeterminate: indeterminate,
            size: size,
            state: checkboxState,
            disabled: checkboxState === 'disabled'
          });
        }
        
        // Fallback si renderCheckbox no estÃ¡ disponible
        const isDisabled = checkboxState === 'disabled';
        const classes = [
          'ubits-checkbox',
          `ubits-checkbox--${size}`,
          checkboxState !== 'default' ? `ubits-checkbox--${checkboxState}` : '',
          checked ? 'ubits-checkbox--checked' : '',
          indeterminate ? 'ubits-checkbox--indeterminate' : '',
          isDisabled ? 'ubits-checkbox--disabled' : ''
        ].filter(Boolean).join(' ');
        
        const checkboxInput = `
          <input
            type="checkbox"
            id="checkbox-${name}-${value}-${componentId}"
            ${name ? `name="${name}"` : ''}
            ${value ? `value="${value}"` : ''}
            ${checked ? 'checked' : ''}
            ${indeterminate ? 'data-indeterminate="true"' : ''}
            ${isDisabled ? 'disabled' : ''}
            class="ubits-checkbox__input"
          />
        `;
        
        const checkboxSquare = `
          <span class="ubits-checkbox__square" aria-hidden="true">
            ${indeterminate ? '<span class="ubits-checkbox__indeterminate"></span>' : ''}
            ${checked && !indeterminate ? '<span class="ubits-checkbox__checkmark"></span>' : ''}
            ${!checked && !indeterminate && checkboxState === 'active' ? '<span class="ubits-checkbox__checkmark"></span>' : ''}
          </span>
        `;
        
        const labelHTML = `<span class="ubits-checkbox__label">${label}</span>`;
        const complementaryTextHTML = complementaryText
          ? `<span class="ubits-checkbox__complementary-text">${complementaryText}</span>`
          : '';
        const textContentHTML = `
          <div class="ubits-checkbox__text-content">
            ${labelHTML}
            ${complementaryTextHTML}
          </div>
        `;
        
        return `
          <label class="${classes}">
            ${checkboxInput}
            ${checkboxSquare}
            ${textContentHTML}
          </label>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Checkbox
      window.updateCheckboxPreview = function(componentId) {
        const state = initCheckboxPreviewState(componentId);
        const preview = document.getElementById(`checkbox-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Checkbox no encontrado:', `checkbox-preview-${componentId}`);
          return;
        }
        
        const checkboxHTML = generateCheckboxHTML(state, componentId);
        preview.innerHTML = checkboxHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="checkbox.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/checkbox/src/styles/checkbox.css';
          document.head.appendChild(link);
        }
      };
      
      // FunciÃ³n unificada para controles del Checkbox
      window.setCheckboxControl = function(option, value, componentId) {
        const state = initCheckboxPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
        } else if (option === 'state') {
          state.state = value;
          // Si el estado es 'indeterminate', activar indeterminate automÃ¡ticamente
          if (value === 'indeterminate') {
            state.indeterminate = true;
            state.checked = false;
            const indeterminateToggle = document.getElementById(`checkbox-indeterminate-toggle-${componentId}`);
            const indeterminateStatus = document.getElementById(`checkbox-indeterminate-status-${componentId}`);
            if (indeterminateToggle && indeterminateStatus) {
              indeterminateToggle.checked = true;
              indeterminateStatus.textContent = 'Activado';
            }
            const checkedToggle = document.getElementById(`checkbox-checked-toggle-${componentId}`);
            const checkedStatus = document.getElementById(`checkbox-checked-status-${componentId}`);
            if (checkedToggle && checkedStatus) {
              checkedToggle.checked = false;
              checkedStatus.textContent = 'Desactivado';
            }
          } else if (value !== 'indeterminate' && state.indeterminate) {
            // Si cambia a otro estado y estaba en indeterminate, desactivar indeterminate
            state.indeterminate = false;
            const indeterminateToggle = document.getElementById(`checkbox-indeterminate-toggle-${componentId}`);
            const indeterminateStatus = document.getElementById(`checkbox-indeterminate-status-${componentId}`);
            if (indeterminateToggle && indeterminateStatus) {
              indeterminateToggle.checked = false;
              indeterminateStatus.textContent = 'Desactivado';
            }
          }
        } else if (option === 'label') {
          state.label = value;
        } else if (option === 'complementaryText') {
          state.complementaryText = value;
        } else if (option === 'checked') {
          state.checked = value;
          // Si se activa checked, desactivar indeterminate
          if (value) {
            state.indeterminate = false;
            const indeterminateToggle = document.getElementById(`checkbox-indeterminate-toggle-${componentId}`);
            const indeterminateStatus = document.getElementById(`checkbox-indeterminate-status-${componentId}`);
            if (indeterminateToggle && indeterminateStatus) {
              indeterminateToggle.checked = false;
              indeterminateStatus.textContent = 'Desactivado';
            }
          }
          // Actualizar toggle
          const checkedToggle = document.getElementById(`checkbox-checked-toggle-${componentId}`);
          const checkedStatus = document.getElementById(`checkbox-checked-status-${componentId}`);
          if (checkedToggle && checkedStatus) {
            checkedToggle.checked = value;
            checkedStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'indeterminate') {
          state.indeterminate = value;
          // Si se activa indeterminate, desactivar checked
          if (value) {
            state.checked = false;
            const checkedToggle = document.getElementById(`checkbox-checked-toggle-${componentId}`);
            const checkedStatus = document.getElementById(`checkbox-checked-status-${componentId}`);
            if (checkedToggle && checkedStatus) {
              checkedToggle.checked = false;
              checkedStatus.textContent = 'Desactivado';
            }
            // Cambiar estado a 'indeterminate' si no estÃ¡ en disabled
            if (state.state !== 'disabled') {
              state.state = 'indeterminate';
              const stateSelect = document.getElementById(`checkbox-state-select-${componentId}`);
              if (stateSelect) {
                stateSelect.value = 'indeterminate';
              }
            }
          } else {
            // Si se desactiva indeterminate y el estado era 'indeterminate', volver a 'default'
            if (state.state === 'indeterminate') {
              state.state = 'default';
              const stateSelect = document.getElementById(`checkbox-state-select-${componentId}`);
              if (stateSelect) {
                stateSelect.value = 'default';
              }
            }
          }
          // Actualizar toggle
          const indeterminateToggle = document.getElementById(`checkbox-indeterminate-toggle-${componentId}`);
          const indeterminateStatus = document.getElementById(`checkbox-indeterminate-status-${componentId}`);
          if (indeterminateToggle && indeterminateStatus) {
            indeterminateToggle.checked = value;
            indeterminateStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        updateCheckboxPreview(componentId);
      };
      
      // ========================================
      // TOGGLE PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Toggle
      const togglePreviewState = {};
      
      // Inicializar estado del Toggle
      function initTogglePreviewState(componentId) {
        if (!togglePreviewState[componentId]) {
          togglePreviewState[componentId] = {
            size: 'md',
            state: 'default',
            label: 'Label',
            complementaryText: '',
            checked: false,
            name: 'toggle-group-' + componentId,
            value: 'option1'
          };
        }
        return togglePreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Toggle
      function generateToggleHTML(state, componentId) {
        const { size, state: toggleState, label, complementaryText, checked, name, value } = state;
        
        const isDisabled = toggleState === 'disabled';
        
        // Construir clases
        const classes = [
          'ubits-toggle',
          `ubits-toggle--${size}`,
          toggleState !== 'default' ? `ubits-toggle--${toggleState}` : '',
          checked ? 'ubits-toggle--checked' : '',
          isDisabled ? 'ubits-toggle--disabled' : ''
        ].filter(Boolean).join(' ');
        
        // Toggle input
        const toggleInput = `
          <input
            type="checkbox"
            id="toggle-${name}-${value}-${componentId}"
            ${name ? `name="${name}"` : ''}
            ${value ? `value="${value}"` : ''}
            ${checked ? 'checked' : ''}
            ${isDisabled ? 'disabled' : ''}
            class="ubits-toggle__input"
            role="switch"
            aria-checked="${checked}"
          />
        `;
        
        // Toggle track (container)
        const toggleTrack = `
          <span class="ubits-toggle__track" aria-hidden="true">
            <span class="ubits-toggle__thumb"></span>
          </span>
        `;
        
        // Text content (si hay label o complementaryText)
        let textContentHTML = '';
        if (label || complementaryText) {
          const labelHTML = label ? `<span class="ubits-toggle__label">${label}</span>` : '';
          const complementaryTextHTML = complementaryText
            ? `<span class="ubits-toggle__complementary-text">${complementaryText}</span>`
            : '';

          textContentHTML = `
            <div class="ubits-toggle__text-content">
              ${labelHTML}
              ${complementaryTextHTML}
            </div>
          `;
        }
        
        // Si hay texto, usar label wrapper, si no, usar div
        const wrapperTag = label || complementaryText ? 'label' : 'div';
        const wrapperClass = label || complementaryText ? classes : `${classes} ubits-toggle--no-label`;

        // Si hay texto, ponerlo primero (a la izquierda), luego el toggle
        return `
          <${wrapperTag} class="${wrapperClass}">
            ${toggleInput}
            ${textContentHTML}
            ${toggleTrack}
          </${wrapperTag}>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Toggle
      window.updateTogglePreview = function(componentId) {
        const state = initTogglePreviewState(componentId);
        const preview = document.getElementById(`toggle-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Toggle no encontrado:', `toggle-preview-${componentId}`);
          return;
        }
        
        const toggleHTML = generateToggleHTML(state, componentId);
        preview.innerHTML = toggleHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="toggle.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/toggle/src/styles/toggle.css';
          document.head.appendChild(link);
        }
      };
      
      // FunciÃ³n unificada para controles del Toggle
      window.setToggleControl = function(option, value, componentId) {
        const state = initTogglePreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
        } else if (option === 'state') {
          state.state = value;
        } else if (option === 'label') {
          state.label = value;
        } else if (option === 'complementaryText') {
          state.complementaryText = value;
        } else if (option === 'checked') {
          state.checked = value;
          // Actualizar toggle
          const checkedToggle = document.getElementById(`toggle-checked-toggle-${componentId}`);
          const checkedStatus = document.getElementById(`toggle-checked-status-${componentId}`);
          if (checkedToggle && checkedStatus) {
            checkedToggle.checked = value;
            checkedStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        updateTogglePreview(componentId);
      };
      
      // ========================================
      // SEARCH BUTTON PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Search Button
      const searchButtonPreviewState = {};
      
      // Inicializar estado del Search Button
      function initSearchButtonPreviewState(componentId) {
        if (!searchButtonPreviewState[componentId]) {
          searchButtonPreviewState[componentId] = {
            active: false,
            size: 'md',
            state: 'default',
            placeholder: '',
            value: '',
            width: 248
          };
        }
        return searchButtonPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Search Button
      function generateSearchButtonHTML(state, componentId) {
        const { active, size, state: searchState, placeholder, value, width } = state;
        
        const isDisabled = searchState === 'disabled';
        
        // Si state es 'active', el buscador estÃ¡ desplegado
        const isSearchActive = active || searchState === 'active';
        
        const iconHTML = '<i class="far fa-magnifying-glass ubits-search-button__icon" aria-hidden="true"></i>';
        const showClearButton = value && value.trim().length > 0;
        const clearButtonHTML = showClearButton ? '<button type="button" class="ubits-search-button__clear" aria-label="Limpiar bÃºsqueda" tabindex="0"><i class="far fa-times ubits-search-button__clear-icon" aria-hidden="true"></i></button>' : '';
        
        // Si estÃ¡ activo (desplegado), mostrar input
        if (isSearchActive) {
          // Construir clases para el wrapper del input
          const inputWrapperClasses = [
            'ubits-search-button',
            'ubits-search-button--active',
            `ubits-search-button--${size}`,
            isDisabled ? 'ubits-search-button--disabled' : ''
          ].filter(Boolean).join(' ');
          
          return `
            <div class="${inputWrapperClasses}" style="width: ${width}px;">
              <div class="ubits-search-button__input-wrapper">
                ${iconHTML}
                <input
                  type="text"
                  class="ubits-search-button__input"
                  placeholder="${placeholder}"
                  value="${value}"
                  ${isDisabled ? 'disabled' : ''}
                  aria-label="Buscar"
                />
                ${clearButtonHTML}
              </div>
            </div>
          `.trim();
        }
        
        // Si no estÃ¡ activo, usar el botÃ³n UBITS estÃ¡ndar (secondary, icon-only)
        // Agregar clases para simular estados hover cuando se seleccionan desde el control
        // Nota: 'active' ahora controla el despliegue, no el estado pressed del botÃ³n
        const buttonClasses = [
          'ubits-button',
          'ubits-button--secondary',
          'ubits-button--icon-only',
          `ubits-button--${size}`,
          searchState === 'hover' ? 'ubits-search-button--force-hover' : ''
        ].filter(Boolean).join(' ');
        
        return `
          <button
            type="button"
            class="${buttonClasses}"
            ${isDisabled ? 'disabled' : ''}
            aria-label="Buscar"
          >
            ${iconHTML}
          </button>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Search Button
      window.updateSearchButtonPreview = function(componentId) {
        const state = initSearchButtonPreviewState(componentId);
        const preview = document.getElementById(`search-button-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Search Button no encontrado:', `search-button-preview-${componentId}`);
          return;
        }
        
        const searchButtonHTML = generateSearchButtonHTML(state, componentId);
        preview.innerHTML = searchButtonHTML;
        
        // Cargar CSS del botÃ³n UBITS si no estÃ¡ cargado (necesario para el modo botÃ³n)
        const existingButtonLink = document.querySelector('link[href*="button.css"]');
        if (!existingButtonLink) {
          const buttonLink = document.createElement('link');
          buttonLink.rel = 'stylesheet';
          buttonLink.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(buttonLink);
        }
        
        // Cargar CSS del Search Button si no estÃ¡ cargado
        const existingLink = document.querySelector('link[href*="search-button.css"]');
        if (!existingLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/search-button/src/styles/search-button.css';
          document.head.appendChild(link);
        }
        
        // Cargar FontAwesome si no estÃ¡ cargado
        const existingFA = document.querySelector('link[href*="fontawesome"]');
        if (!existingFA) {
          const faLink = document.createElement('link');
          faLink.rel = 'stylesheet';
          faLink.href = '../../icons/dist/fontawesome.css';
          document.head.appendChild(faLink);
        }
        
        // Determinar si el buscador estÃ¡ desplegado
        const isSearchActive = state.active || state.state === 'active';
        
        // Agregar interactividad: click en botÃ³n para desplegar input
        if (!isSearchActive) {
          const buttonElement = preview.querySelector('button');
          if (buttonElement) {
            buttonElement.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              // Activar el modo input (usar state='active')
              state.state = 'active';
              state.active = true;
              // Actualizar el toggle en los controles
              const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
              const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
              const stateSelect = document.getElementById(`search-button-state-select-${componentId}`);
              if (activeToggle && activeStatus) {
                activeToggle.checked = true;
                activeStatus.textContent = 'Input';
              }
              if (stateSelect) {
                stateSelect.value = 'active';
              }
              // Re-renderizar
              updateSearchButtonPreview(componentId);
              // Focus en el input despuÃ©s de un pequeÃ±o delay
              setTimeout(() => {
                const inputElement = preview.querySelector('.ubits-search-button__input');
                if (inputElement) {
                  inputElement.focus();
                }
              }, 50);
            });
          }
        } else {
          // Si estÃ¡ activo, agregar listeners para contraer y limpiar
          const inputElement = preview.querySelector('.ubits-search-button__input');
          const clearButton = preview.querySelector('.ubits-search-button__clear');
          
          if (inputElement) {
            // Listener para mostrar/ocultar botÃ³n de limpiar cuando se escribe
            inputElement.addEventListener('input', function(e) {
              state.value = inputElement.value;
              // Re-renderizar para mostrar/ocultar el botÃ³n X
              updateSearchButtonPreview(componentId);
            });
            
            // ESC para contraer
            inputElement.addEventListener('keydown', function(e) {
              if (e.key === 'Escape') {
                e.preventDefault();
                e.stopPropagation();
                // Desactivar el modo input
                state.state = 'default';
                state.active = false;
                // Actualizar el toggle en los controles
                const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
                const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
                const stateSelect = document.getElementById(`search-button-state-select-${componentId}`);
                if (activeToggle && activeStatus) {
                  activeToggle.checked = false;
                  activeStatus.textContent = 'BotÃ³n';
                }
                if (stateSelect) {
                  stateSelect.value = 'default';
                }
                // Re-renderizar
                updateSearchButtonPreview(componentId);
              }
            });
            
            // Blur para contraer cuando se hace click fuera (si el input estÃ¡ vacÃ­o)
            inputElement.addEventListener('blur', function(e) {
              // Solo contraer si el input estÃ¡ vacÃ­o
              if (!inputElement.value.trim()) {
                // Usar setTimeout para permitir que otros clicks se procesen primero
                setTimeout(() => {
                  // Verificar que el elemento aÃºn existe y no tiene focus
                  if (document.activeElement !== inputElement && !inputElement.value.trim()) {
                    state.state = 'default';
                    state.active = false;
                    // Actualizar el toggle en los controles
                    const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
                    const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
                    const stateSelect = document.getElementById(`search-button-state-select-${componentId}`);
                    if (activeToggle && activeStatus) {
                      activeToggle.checked = false;
                      activeStatus.textContent = 'BotÃ³n';
                    }
                    if (stateSelect) {
                      stateSelect.value = 'default';
                    }
                    // Re-renderizar
                    updateSearchButtonPreview(componentId);
                  }
                }, 200);
              }
            });
          }
          
          // BotÃ³n de limpiar (X)
          if (clearButton) {
            clearButton.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              // Limpiar el valor
              state.value = '';
              // Actualizar el input
              const inputElement = preview.querySelector('.ubits-search-button__input');
              if (inputElement) {
                inputElement.value = '';
                inputElement.focus();
              }
              // Re-renderizar para ocultar el botÃ³n X
              updateSearchButtonPreview(componentId);
            });
          }
        }
      };
      
      // FunciÃ³n unificada para controles del Search Button
      window.setSearchButtonControl = function(option, value, componentId) {
        const state = initSearchButtonPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'active') {
          state.active = value;
          // Si se activa, cambiar el estado a 'active'
          if (value) {
            state.state = 'active';
            const stateSelect = document.getElementById(`search-button-state-select-${componentId}`);
            if (stateSelect) {
              stateSelect.value = 'active';
            }
          } else {
            // Si se desactiva y no hay valor, cambiar a 'default'
            if (!state.value || !state.value.trim()) {
              state.state = 'default';
              const stateSelect = document.getElementById(`search-button-state-select-${componentId}`);
              if (stateSelect) {
                stateSelect.value = 'default';
              }
            }
          }
          // Actualizar toggle
          const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
          const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
          if (activeToggle && activeStatus) {
            activeToggle.checked = value;
            activeStatus.textContent = value ? 'Input' : 'BotÃ³n';
          }
        } else if (option === 'size') {
          state.size = value;
        } else if (option === 'state') {
          state.state = value;
          // Si se selecciona 'active', desplegar el buscador
          if (value === 'active') {
            state.active = true;
            // Actualizar el toggle en los controles
            const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
            const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
            if (activeToggle && activeStatus) {
              activeToggle.checked = true;
              activeStatus.textContent = 'Input';
            }
          } else if (value !== 'active' && state.active) {
            // Si se cambia de 'active' a otro estado, colapsar si no hay valor
            if (!state.value || !state.value.trim()) {
              state.active = false;
              // Actualizar el toggle en los controles
              const activeToggle = document.getElementById(`search-button-active-toggle-${componentId}`);
              const activeStatus = document.getElementById(`search-button-active-status-${componentId}`);
              if (activeToggle && activeStatus) {
                activeToggle.checked = false;
                activeStatus.textContent = 'BotÃ³n';
              }
            }
          }
        } else if (option === 'placeholder') {
          state.placeholder = value;
        } else if (option === 'value') {
          state.value = value;
        } else if (option === 'width') {
          state.width = value;
        }
        
        updateSearchButtonPreview(componentId);
      };
      
      // ========================================
      // DATA TABLE PREVIEW FUNCTIONS
      // ========================================
      
      // Inicializar estado del Data Table
      const dataTablePreviewState = {};
      window.dataTableInstances = window.dataTableInstances || {};
      function initDataTablePreviewState(componentId) {
        if (!dataTablePreviewState[componentId]) {
          dataTablePreviewState[componentId] = {
            columnReorderable: true,
            rowReorderable: true,
            showCheckbox: true,
            emailClickable: true,
            rowExpandable: true,
            showVerticalScrollbar: false,
            showHorizontalScrollbar: false,
            showColumnMenu: true,
            showContextMenu: true,
            checkboxSticky: false,
            dragHandleSticky: false,
            expandSticky: false,
            showPagination: false,
            currentPage: 1,
            itemsPerPage: 10,
            paginationVariant: 'default',
            paginationSize: 'md',
            columnsCount: 3,
            // Header states
            headerTitle: 'Tabla de datos',
            headerCounter: true,
            headerCounterMode: 'full', // 'full' o 'total-only'
            headerDisplayedItems: 100, // Cantidad mostrada (X en X/Y)
            headerTotalItems: 100, // Cantidad total (Y en X/Y o solo Y)
            showHeaderTitle: true,
            showHeaderCounter: true,
            showHeaderSearchButton: true,
            showHeaderFilterButton: true,
            showHeaderColumnSelectorButton: true,
            showHeaderSecondaryButtons: true,
            showHeaderPrimaryButton: true,
            headerSecondaryButtons: [
              { icon: 'download', iconStyle: 'regular', onClick: () => console.log('Descargar') },
              { icon: 'share', iconStyle: 'regular', onClick: () => console.log('Compartir') }
            ],
            headerPrimaryButton: { icon: 'plus', iconStyle: 'regular', onClick: () => console.log('Agregar') },
            // Action bar states
            showViewSelected: true,
            showNotifications: true,
            showCopy: true,
            showView: true,
            showEdit: true,
            showDownload: true,
            showDelete: true,
            selectedRows: [],
            viewSelectedActive: false, // Estado para filtrar solo seleccionados
            columns: [
              {
                id: 'checkbox-2',
                title: 'Checkbox',
                visible: true,
                width: 150,
                type: undefined,
              },
              {
                id: 'nombre',
                title: 'Nombre',
                visible: true,
                width: 200,
                type: 'nombre',
              },
              {
                id: 'email',
                title: 'Email',
                visible: true,
                width: 250,
                type: 'correo',
                emailClickable: true,
              },
              {
                id: 'estado',
                title: 'Estado',
                visible: true,
                width: 150,
                type: 'estado',
              },
            ],
            rows: [
              {
                id: 1,
                data: {
                  nombre: 'Juan PÃ©rez',
                  'checkbox-2': false,
                  email: 'juan.perez@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'JP', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
                renderExpandedContent: (rowData) => {
                  return `
                    <div style="padding: 16px;">
                      <h4 style="margin: 0 0 8px 0; font-size: 14px; font-weight: 600;">InformaciÃ³n adicional</h4>
                      <p style="margin: 0; font-size: 13px; color: var(--ubits-body-md-regular-2, #6b7280);">
                        Detalles adicionales para ${rowData.nombre}
                      </p>
                    </div>
                  `;
                },
              },
              {
                id: 2,
                data: {
                  nombre: 'MarÃ­a GarcÃ­a',
                  'checkbox-2': false,
                  email: 'maria.garcia@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'MG', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 3,
                data: {
                  nombre: 'Carlos LÃ³pez',
                  'checkbox-2': false,
                  email: 'carlos.lopez@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'CL', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 4,
                data: {
                  nombre: 'Ana MartÃ­nez',
                  'checkbox-2': false,
                  email: 'ana.martinez@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'AM', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 5,
                data: {
                  nombre: 'Pedro RodrÃ­guez',
                  'checkbox-2': false,
                  email: 'pedro.rodriguez@empresa.com',
                  estado: 'Pendiente',
                  area: 'Ventas',
                  avatar: { initials: 'PR', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 6,
                data: {
                  nombre: 'Valentina Torres',
                  'checkbox-2': false,
                  email: 'valentina.torres@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'VT', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 7,
                data: {
                  nombre: 'Roberto FernÃ¡ndez',
                  'checkbox-2': false,
                  email: 'roberto.fernandez@empresa.com',
                  estado: 'Inactivo',
                  area: 'Marketing',
                  avatar: { initials: 'RF', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 8,
                data: {
                  nombre: 'Carmen Torres',
                  'checkbox-2': false,
                  email: 'carmen.torres@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'CT', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 9,
                data: {
                  nombre: 'Diego Morales',
                  'checkbox-2': false,
                  email: 'diego.morales@empresa.com',
                  estado: 'Pendiente',
                  area: 'Ventas',
                  avatar: { initials: 'DM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 10,
                data: {
                  nombre: 'Isabel Moreno',
                  'checkbox-2': false,
                  email: 'isabel.moreno@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'IM', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 11,
                data: {
                  nombre: 'AndrÃ©s RamÃ­rez',
                  'checkbox-2': false,
                  email: 'andres.ramirez@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'AR', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 12,
                data: {
                  nombre: 'Patricia SÃ¡nchez',
                  'checkbox-2': false,
                  email: 'patricia.sanchez@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'PS', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 13,
                data: {
                  nombre: 'Fernando Castro',
                  'checkbox-2': false,
                  email: 'fernando.castro@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'FC', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 14,
                data: {
                  nombre: 'Gabriela Herrera',
                  'checkbox-2': false,
                  email: 'gabriela.herrera@empresa.com',
                  estado: 'Pendiente',
                  area: 'Ventas',
                  avatar: { initials: 'GH', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 15,
                data: {
                  nombre: 'Ricardo Mendoza',
                  'checkbox-2': false,
                  email: 'ricardo.mendoza@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'RM', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 16,
                data: {
                  nombre: 'Claudia Vargas',
                  'checkbox-2': false,
                  email: 'claudia.vargas@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'CV', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 17,
                data: {
                  nombre: 'Javier Ortiz',
                  'checkbox-2': false,
                  email: 'javier.ortiz@empresa.com',
                  estado: 'Inactivo',
                  area: 'Marketing',
                  avatar: { initials: 'JO', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 18,
                data: {
                  nombre: 'Daniela JimÃ©nez',
                  'checkbox-2': false,
                  email: 'daniela.jimenez@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'DJ', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 19,
                data: {
                  nombre: 'Miguel Ãngel Ruiz',
                  'checkbox-2': false,
                  email: 'miguel.ruiz@empresa.com',
                  estado: 'Pendiente',
                  area: 'Ventas',
                  avatar: { initials: 'MR', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 20,
                data: {
                  nombre: 'Elena Castillo',
                  'checkbox-2': false,
                  email: 'elena.castillo@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'EC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 21,
                data: {
                  nombre: 'Ã“scar GutiÃ©rrez',
                  'checkbox-2': false,
                  email: 'oscar.gutierrez@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'OG', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 22,
                data: {
                  nombre: 'Natalia Rojas',
                  'checkbox-2': false,
                  email: 'natalia.rojas@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'NR', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 23,
                data: {
                  nombre: 'Luis Fernando MejÃ­a',
                  'checkbox-2': false,
                  email: 'luis.mejia@empresa.com',
                  estado: 'Activo',
                  area: 'Ventas',
                  avatar: { initials: 'LM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 24,
                data: {
                  nombre: 'Andrea Salazar',
                  'checkbox-2': false,
                  email: 'andrea.salazar@empresa.com',
                  estado: 'Pendiente',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'AS', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 25,
                data: {
                  nombre: 'Cristian PeÃ±a',
                  'checkbox-2': false,
                  email: 'cristian.pena@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'CP', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 26,
                data: {
                  nombre: 'Monica Restrepo',
                  'checkbox-2': false,
                  email: 'monica.restrepo@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'MR', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 27,
                data: {
                  nombre: 'Esteban Cardona',
                  'checkbox-2': false,
                  email: 'esteban.cardona@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'EC', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 28,
                data: {
                  nombre: 'Paola Agudelo',
                  'checkbox-2': false,
                  email: 'paola.agudelo@empresa.com',
                  estado: 'Activo',
                  area: 'Ventas',
                  avatar: { initials: 'PA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 29,
                data: {
                  nombre: 'Sergio VelÃ¡squez',
                  'checkbox-2': false,
                  email: 'sergio.velasquez@empresa.com',
                  estado: 'Pendiente',
                  area: 'Desarrollo',
                  avatar: { initials: 'SV', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 30,
                data: {
                  nombre: 'Carolina Zapata',
                  'checkbox-2': false,
                  email: 'carolina.zapata@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'CZ', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 31,
                data: {
                  nombre: 'Felipe Ospina',
                  'checkbox-2': false,
                  email: 'felipe.ospina@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'FO', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 32,
                data: {
                  nombre: 'Tatiana Montoya',
                  'checkbox-2': false,
                  email: 'tatiana.montoya@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'TM', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 33,
                data: {
                  nombre: 'Alejandro Betancur',
                  'checkbox-2': false,
                  email: 'alejandro.betancur@empresa.com',
                  estado: 'Activo',
                  area: 'Ventas',
                  avatar: { initials: 'AB', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 34,
                data: {
                  nombre: 'Diana CÃ¡rdenas',
                  'checkbox-2': false,
                  email: 'diana.cardenas@empresa.com',
                  estado: 'Pendiente',
                  area: 'Desarrollo',
                  avatar: { initials: 'DC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 35,
                data: {
                  nombre: 'Jorge IvÃ¡n LondoÃ±o',
                  'checkbox-2': false,
                  email: 'jorge.londono@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'JL', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 36,
                data: {
                  nombre: 'Mariana Uribe',
                  'checkbox-2': false,
                  email: 'mariana.uribe@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'MU', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 37,
                data: {
                  nombre: 'Camilo Arango',
                  'checkbox-2': false,
                  email: 'camilo.arango@empresa.com',
                  estado: 'Inactivo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'CA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 38,
                data: {
                  nombre: 'Liliana Osorio',
                  'checkbox-2': false,
                  email: 'liliana.osorio@empresa.com',
                  estado: 'Activo',
                  area: 'Ventas',
                  avatar: { initials: 'LO', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 39,
                data: {
                  nombre: 'AndrÃ©s Felipe Quintero',
                  'checkbox-2': false,
                  email: 'andres.quintero@empresa.com',
                  estado: 'Pendiente',
                  area: 'Desarrollo',
                  avatar: { initials: 'AQ', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 40,
                data: {
                  nombre: 'Sandra Milena GÃ³mez',
                  'checkbox-2': false,
                  email: 'sandra.gomez@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'SG', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 41,
                data: {
                  nombre: 'HÃ©ctor Fabio MuÃ±oz',
                  'checkbox-2': false,
                  email: 'hector.munoz@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'HM', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 42,
                data: {
                  nombre: 'Yenny Alexandra Parra',
                  'checkbox-2': false,
                  email: 'yenny.parra@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'YP', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 43,
                data: {
                  nombre: 'Jhon Jairo VÃ©lez',
                  'checkbox-2': false,
                  email: 'jhon.velez@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'JV', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 44,
                data: {
                  nombre: 'Adriana Marcela Henao',
                  'checkbox-2': false,
                  email: 'adriana.henao@empresa.com',
                  estado: 'Pendiente',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'AH', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 45,
                data: {
                  nombre: 'Edwin Mauricio Zapata',
                  'checkbox-2': false,
                  email: 'edwin.zapata@empresa.com',
                  estado: 'Activo',
                  area: 'Marketing',
                  avatar: { initials: 'EZ', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 46,
                data: {
                  nombre: 'MÃ³nica Patricia Bedoya',
                  'checkbox-2': false,
                  email: 'monica.bedoya@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'MB', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 47,
                data: {
                  nombre: 'William Alberto Giraldo',
                  'checkbox-2': false,
                  email: 'william.giraldo@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'WG', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 48,
                data: {
                  nombre: 'AngÃ©lica MarÃ­a Cano',
                  'checkbox-2': false,
                  email: 'angelica.cano@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'AC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 49,
                data: {
                  nombre: 'Leonardo Fabio RÃ­os',
                  'checkbox-2': false,
                  email: 'leonardo.rios@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'LR', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 50,
                data: {
                  nombre: 'Claudia Patricia ArbelÃ¡ez',
                  'checkbox-2': false,
                  email: 'claudia.arbelaez@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'CA', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 51,
                data: {
                  nombre: 'Jairo Alonso TobÃ³n',
                  'checkbox-2': false,
                  email: 'jairo.tobon@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'JT', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 52,
                data: {
                  nombre: 'Gloria InÃ©s MejÃ­a',
                  'checkbox-2': false,
                  email: 'gloria.mejia@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'GM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 53,
                data: {
                  nombre: 'Mauricio Esteban Lopera',
                  'checkbox-2': false,
                  email: 'mauricio.lopera@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'ML', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 54,
                data: {
                  nombre: 'Beatriz Elena CastrillÃ³n',
                  'checkbox-2': false,
                  email: 'beatriz.castrillon@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'BC', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 55,
                data: {
                  nombre: 'CÃ©sar Augusto Restrepo',
                  'checkbox-2': false,
                  email: 'cesar.restrepo@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'CR', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 56,
                data: {
                  nombre: 'Dora Luz Aguirre',
                  'checkbox-2': false,
                  email: 'dora.aguirre@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'DA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 57,
                data: {
                  nombre: 'Ã“scar DarÃ­o Valencia',
                  'checkbox-2': false,
                  email: 'oscar.valencia@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'OV', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 58,
                data: {
                  nombre: 'Nubia Esperanza Cardona',
                  'checkbox-2': false,
                  email: 'nubia.cardona@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'NC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 59,
                data: {
                  nombre: 'Alberto Mario Zapata',
                  'checkbox-2': false,
                  email: 'alberto.zapata@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'AZ', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 60,
                data: {
                  nombre: 'Esperanza MarÃ­a Ochoa',
                  'checkbox-2': false,
                  email: 'esperanza.ochoa@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'EO', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 61,
                data: {
                  nombre: 'Jorge Mario Gallego',
                  'checkbox-2': false,
                  email: 'jorge.gallego@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'JG', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 62,
                data: {
                  nombre: 'Blanca Nubia Arango',
                  'checkbox-2': false,
                  email: 'blanca.arango@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'BA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 63,
                data: {
                  nombre: 'Fabio Nelson Uribe',
                  'checkbox-2': false,
                  email: 'fabio.uribe@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'FU', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 64,
                data: {
                  nombre: 'Martha Cecilia LondoÃ±o',
                  'checkbox-2': false,
                  email: 'martha.londono@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'ML', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 65,
                data: {
                  nombre: 'HernÃ¡n DarÃ­o Osorio',
                  'checkbox-2': false,
                  email: 'hernan.osorio@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'HO', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 66,
                data: {
                  nombre: 'Luz Dary Montoya',
                  'checkbox-2': false,
                  email: 'luz.montoya@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'LM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 67,
                data: {
                  nombre: 'Carlos Mario Betancur',
                  'checkbox-2': false,
                  email: 'carlos.betancur@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'CB', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 68,
                data: {
                  nombre: 'Olga LucÃ­a CÃ¡rdenas',
                  'checkbox-2': false,
                  email: 'olga.cardenas@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'OC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 69,
                data: {
                  nombre: 'Jairo HernÃ¡n Quintero',
                  'checkbox-2': false,
                  email: 'jairo.quintero@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'JQ', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 70,
                data: {
                  nombre: 'Amparo GÃ³mez',
                  'checkbox-2': false,
                  email: 'amparo.gomez@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'AG', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 71,
                data: {
                  nombre: 'Gustavo Adolfo MuÃ±oz',
                  'checkbox-2': false,
                  email: 'gustavo.munoz@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'GM', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 72,
                data: {
                  nombre: 'Rosa Elena Parra',
                  'checkbox-2': false,
                  email: 'rosa.parra@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'RP', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 73,
                data: {
                  nombre: 'Alvaro de JesÃºs VÃ©lez',
                  'checkbox-2': false,
                  email: 'alvaro.velez@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'AV', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 74,
                data: {
                  nombre: 'MarÃ­a Eugenia Henao',
                  'checkbox-2': false,
                  email: 'maria.henao@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'MH', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 75,
                data: {
                  nombre: 'Jhonatan Zapata',
                  'checkbox-2': false,
                  email: 'jhonatan.zapata@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'JZ', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 76,
                data: {
                  nombre: 'Yolanda Bedoya',
                  'checkbox-2': false,
                  email: 'yolanda.bedoya@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'YB', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 77,
                data: {
                  nombre: 'Edison Giraldo',
                  'checkbox-2': false,
                  email: 'edison.giraldo@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'EG', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 78,
                data: {
                  nombre: 'Luz Marina Cano',
                  'checkbox-2': false,
                  email: 'luz.cano@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'LC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 79,
                data: {
                  nombre: 'Jhon Fredy RÃ­os',
                  'checkbox-2': false,
                  email: 'jhon.rios@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'JR', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 80,
                data: {
                  nombre: 'Nancy ArbelÃ¡ez',
                  'checkbox-2': false,
                  email: 'nancy.arbelaez@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'NA', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 81,
                data: {
                  nombre: 'Jairo TobÃ³n',
                  'checkbox-2': false,
                  email: 'jairo.tobon2@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'JT', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 82,
                data: {
                  nombre: 'Gloria MejÃ­a',
                  'checkbox-2': false,
                  email: 'gloria.mejia2@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'GM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 83,
                data: {
                  nombre: 'Mauricio Lopera',
                  'checkbox-2': false,
                  email: 'mauricio.lopera2@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'ML', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 84,
                data: {
                  nombre: 'Beatriz CastrillÃ³n',
                  'checkbox-2': false,
                  email: 'beatriz.castrillon2@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'BC', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 85,
                data: {
                  nombre: 'CÃ©sar Restrepo',
                  'checkbox-2': false,
                  email: 'cesar.restrepo2@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'CR', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 86,
                data: {
                  nombre: 'Dora Aguirre',
                  'checkbox-2': false,
                  email: 'dora.aguirre2@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'DA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 87,
                data: {
                  nombre: 'Ã“scar Valencia',
                  'checkbox-2': false,
                  email: 'oscar.valencia2@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'OV', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 88,
                data: {
                  nombre: 'Nubia Cardona',
                  'checkbox-2': false,
                  email: 'nubia.cardona2@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'NC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 89,
                data: {
                  nombre: 'Alberto Zapata',
                  'checkbox-2': false,
                  email: 'alberto.zapata2@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'AZ', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 90,
                data: {
                  nombre: 'Esperanza Ochoa',
                  'checkbox-2': false,
                  email: 'esperanza.ochoa2@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'EO', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 91,
                data: {
                  nombre: 'Jorge Gallego',
                  'checkbox-2': false,
                  email: 'jorge.gallego2@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'JG', badgeColor: 'pink', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 92,
                data: {
                  nombre: 'Blanca Arango',
                  'checkbox-2': false,
                  email: 'blanca.arango2@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'BA', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 93,
                data: {
                  nombre: 'Fabio Uribe',
                  'checkbox-2': false,
                  email: 'fabio.uribe2@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'FU', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 94,
                data: {
                  nombre: 'Martha LondoÃ±o',
                  'checkbox-2': false,
                  email: 'martha.londono2@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'ML', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 95,
                data: {
                  nombre: 'HernÃ¡n Osorio',
                  'checkbox-2': false,
                  email: 'hernan.osorio2@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'HO', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 96,
                data: {
                  nombre: 'Luz Montoya',
                  'checkbox-2': false,
                  email: 'luz.montoya2@empresa.com',
                  estado: 'Activo',
                  area: 'DiseÃ±o',
                  avatar: { initials: 'LM', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 97,
                data: {
                  nombre: 'Carlos Betancur',
                  'checkbox-2': false,
                  email: 'carlos.betancur2@empresa.com',
                  estado: 'Inactivo',
                  area: 'Ventas',
                  avatar: { initials: 'CB', badgeColor: 'blue', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 98,
                data: {
                  nombre: 'Olga CÃ¡rdenas',
                  'checkbox-2': false,
                  email: 'olga.cardenas2@empresa.com',
                  estado: 'Activo',
                  area: 'Desarrollo',
                  avatar: { initials: 'OC', badgeColor: 'green', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 99,
                data: {
                  nombre: 'Jairo Quintero',
                  'checkbox-2': false,
                  email: 'jairo.quintero2@empresa.com',
                  estado: 'Pendiente',
                  area: 'Marketing',
                  avatar: { initials: 'JQ', badgeColor: 'orange', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
              {
                id: 100,
                data: {
                  nombre: 'Amparo GÃ³mez',
                  'checkbox-2': false,
                  email: 'amparo.gomez2@empresa.com',
                  estado: 'Activo',
                  area: 'Recursos Humanos',
                  avatar: { initials: 'AG', badgeColor: 'purple', imageUrl: '../assets/images/Profile-image.jpg' },
                },
                expanded: false,
              },
            ],
          };
        }
        return dataTablePreviewState[componentId];
      }
      
      // FunciÃ³n para establecer controles del Data Table
      window.setDataTableControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ [SET CONTROL] ========== INICIO setDataTableControl ==========');
        console.log('ğŸ›ï¸ [SET CONTROL] ParÃ¡metros recibidos:', { option, value, componentId, valueType: typeof value });
        
        // Verificar que componentId existe
        if (!componentId) {
          console.error('âŒ [SET CONTROL] componentId no proporcionado!');
          return;
        }
        
        const state = initDataTablePreviewState(componentId);
        console.log('ğŸ›ï¸ [SET CONTROL] Estado obtenido:', { 
          hasState: !!state,
          showHeaderSearchButton: state?.showHeaderSearchButton,
          headerDisplayedItems: state?.headerDisplayedItems
        });
        
        if (option === 'columnReorderable') {
          state.columnReorderable = value;
          const statusEl = document.getElementById(`data-table-column-reorderable-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'rowReorderable') {
          state.rowReorderable = value;
          const statusEl = document.getElementById(`data-table-row-reorderable-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showCheckbox') {
          console.log('ğŸ”§ [CONTROL] Cambiando showCheckbox:', value, 'componentId:', componentId);
          state.showCheckbox = value;
          console.log('ğŸ”§ [CONTROL] Estado actualizado. showCheckbox:', state.showCheckbox);
          const statusEl = document.getElementById(`data-table-show-checkbox-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          // Actualizar el preview para reflejar el cambio
          console.log('ğŸ”§ [CONTROL] Llamando a updateDataTablePreview...');
          window.updateDataTablePreview(componentId);
        } else if (option === 'emailClickable') {
          console.log('ğŸ”§ [CONTROL] Cambiando emailClickable:', value, 'componentId:', componentId);
          state.emailClickable = value;
          console.log('ğŸ”§ [CONTROL] Estado actualizado. emailClickable:', state.emailClickable);
          const statusEl = document.getElementById(`data-table-email-clickable-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Clicable' : 'Solo texto';
          // Actualizar el preview para reflejar el cambio
          console.log('ğŸ”§ [CONTROL] Llamando a updateDataTablePreview...');
          window.updateDataTablePreview(componentId);
        } else if (option === 'columnsCount') {
          state.columnsCount = Math.max(1, Math.min(10, parseInt(value) || 3));
          const inputEl = document.getElementById(`data-table-columns-count-${componentId}`);
          if (inputEl) inputEl.value = state.columnsCount;
          
          // Asegurar que tenemos suficientes columnas en el estado (excluyendo checkbox)
          const dataColumns = state.columns.filter(col => col.id !== 'checkbox-2');
          const currentDataColumnsCount = dataColumns.length;
          const columnsCount = state.columnsCount;
          
          // Si necesitamos mÃ¡s columnas, agregarlas al estado
          if (columnsCount > currentDataColumnsCount) {
            const columnNames = ['TelÃ©fono', 'Ciudad', 'PaÃ­s', 'Fecha', 'CategorÃ­a', 'Prioridad', 'Ãrea', 'LÃ­der'];
            for (let i = currentDataColumnsCount; i < columnsCount && i < 10; i++) {
              const columnName = columnNames[i - currentDataColumnsCount] || `Columna ${i + 1}`;
              const newColumn = {
                id: `col${i}`,
                title: columnName,
                visible: true,
                width: 150,
                type: undefined
              };
              // Agregar despuÃ©s de las columnas de datos (pero antes del checkbox si existe)
              const checkboxIndex = state.columns.findIndex(col => col.id === 'checkbox-2');
              if (checkboxIndex >= 0) {
                // Insertar antes del checkbox
                state.columns.splice(checkboxIndex + dataColumns.length, 0, newColumn);
              } else {
                // Agregar al final
                state.columns.push(newColumn);
              }
            }
          } else if (columnsCount < currentDataColumnsCount) {
            // Si necesitamos menos columnas, remover las sobrantes (pero mantener las primeras)
            const checkboxCol = state.columns.find(col => col.id === 'checkbox-2');
            const dataColumnsToKeep = dataColumns.slice(0, columnsCount);
            state.columns = checkboxCol ? [checkboxCol, ...dataColumnsToKeep] : dataColumnsToKeep;
          }
          
          // Regenerar selectores de tipo de columna
          if (typeof window.generateColumnTypeSelectors === 'function') {
            window.generateColumnTypeSelectors(componentId);
          }
          
          // Actualizar el preview
          window.updateDataTablePreview(componentId);
        } else if (option === 'rowExpandable') {
          state.rowExpandable = value;
          const statusEl = document.getElementById(`data-table-row-expandable-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showVerticalScrollbar') {
          state.showVerticalScrollbar = value;
          const statusEl = document.getElementById(`data-table-vertical-scrollbar-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHorizontalScrollbar') {
          state.showHorizontalScrollbar = value;
          const statusEl = document.getElementById(`data-table-horizontal-scrollbar-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showColumnMenu') {
          state.showColumnMenu = value;
          const statusEl = document.getElementById(`data-table-show-column-menu-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showContextMenu') {
          state.showContextMenu = value;
          const statusEl = document.getElementById(`data-table-show-context-menu-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'checkboxSticky') {
          state.checkboxSticky = value;
          const statusEl = document.getElementById(`data-table-checkbox-sticky-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'dragHandleSticky') {
          state.dragHandleSticky = value;
          const statusEl = document.getElementById(`data-table-drag-handle-sticky-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'expandSticky') {
          state.expandSticky = value;
          const statusEl = document.getElementById(`data-table-expand-sticky-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showPagination') {
          console.log('ğŸ“„ [WEB] setDataTableControl - showPagination cambiado a:', value);
          state.showPagination = value;
          console.log('ğŸ“„ [WEB] Estado actualizado. state.showPagination:', state.showPagination);
          const statusEl = document.getElementById(`data-table-show-pagination-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
          console.log('ğŸ“„ [WEB] Llamando a updateDataTablePreview...');
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderTitle') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderTitle:', value, 'componentId:', componentId);
          state.showHeaderTitle = value;
          const statusEl = document.getElementById(`data-table-show-header-title-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderTitle:', state.showHeaderTitle);
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderCounter') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderCounter:', value, 'componentId:', componentId);
          state.showHeaderCounter = value;
          const statusEl = document.getElementById(`data-table-show-header-counter-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderCounter:', state.showHeaderCounter);
          window.updateDataTablePreview(componentId);
        } else if (option === 'headerCounterMode') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando headerCounterMode:', value, 'componentId:', componentId);
          state.headerCounterMode = value;
          // Actualizar visibilidad de los inputs segÃºn el modo
          const displayedContainer = document.getElementById(`data-table-header-displayed-items-container-${componentId}`);
          const totalContainer = document.getElementById(`data-table-header-total-items-container-${componentId}`);
          if (displayedContainer) {
            // En modo 'full' se muestran ambos (X e Y), en modo 'total-only' solo Y
            displayedContainer.style.display = value === 'full' ? 'block' : 'none';
          }
          if (totalContainer) {
            // El input de Y siempre se muestra (en ambos modos)
            totalContainer.style.display = 'block';
          }
          // Actualizar radio buttons
          const radioButtons = document.querySelectorAll(`input[name="data-table-header-counter-mode-${componentId}"]`);
          radioButtons.forEach(radio => {
            if (radio) {
              radio.checked = radio.value === value;
            }
          });
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. headerCounterMode:', state.headerCounterMode);
          window.updateDataTablePreview(componentId);
        } else if (option === 'headerDisplayedItems') {
          console.log('ğŸ”§ [HEADER CONTROL] ========== Cambiando headerDisplayedItems ==========');
          console.log('ğŸ”§ [HEADER CONTROL] Valor recibido:', value, 'Tipo:', typeof value);
          const numValue = typeof value === 'number' ? value : (parseInt(value) || 0);
          const oldValue = state.headerDisplayedItems;
          state.headerDisplayedItems = Math.max(0, numValue);
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado:', { oldValue, newValue: state.headerDisplayedItems });
          
          // Actualizar el input visualmente si existe
          const inputEl = document.getElementById(`data-table-header-displayed-items-${componentId}`);
          if (inputEl) {
            if (inputEl.value !== String(state.headerDisplayedItems)) {
              inputEl.value = state.headerDisplayedItems;
              console.log('ğŸ”§ [HEADER CONTROL] Input actualizado:', inputEl.value);
            }
          } else {
            console.warn('ğŸ”§ [HEADER CONTROL] Input no encontrado');
          }
          
          console.log('ğŸ”§ [HEADER CONTROL] Llamando a updateDataTablePreview...');
          window.updateDataTablePreview(componentId);
          console.log('ğŸ”§ [HEADER CONTROL] ========== FIN headerDisplayedItems ==========');
        } else if (option === 'headerTotalItems') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando headerTotalItems:', value, 'componentId:', componentId);
          const numValue = typeof value === 'number' ? value : (parseInt(value) || 0);
          state.headerTotalItems = Math.max(0, numValue);
          const inputEl = document.getElementById(`data-table-header-total-items-${componentId}`);
          if (inputEl && inputEl.value !== String(state.headerTotalItems)) {
            inputEl.value = state.headerTotalItems;
          }
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. headerTotalItems:', state.headerTotalItems);
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderSearchButton') {
          console.log('ğŸ”§ [HEADER CONTROL] ========== INICIO showHeaderSearchButton ==========');
          console.log('ğŸ”§ [HEADER CONTROL] ParÃ¡metros recibidos:', { option, value, componentId, valueType: typeof value });
          console.log('ğŸ”§ [HEADER CONTROL] Estado anterior:', { showHeaderSearchButton: state.showHeaderSearchButton });
          
          try {
            state.showHeaderSearchButton = Boolean(value);
            console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado en memoria:', { showHeaderSearchButton: state.showHeaderSearchButton });
            
            // Actualizar status text
            const statusEl = document.getElementById(`data-table-show-header-search-button-status-${componentId}`);
            console.log('ğŸ”§ [HEADER CONTROL] Buscando statusEl con ID:', `data-table-show-header-search-button-status-${componentId}`);
            if (statusEl) {
              const oldText = statusEl.textContent;
              statusEl.textContent = state.showHeaderSearchButton ? 'Visible' : 'Oculta';
              console.log('ğŸ”§ [HEADER CONTROL] Status text actualizado:', { oldText, newText: statusEl.textContent });
            } else {
              console.warn('ğŸ”§ [HEADER CONTROL] StatusEl no encontrado');
            }
            
            // Actualizar checkbox
            const checkboxEl = document.getElementById(`data-table-show-header-search-button-${componentId}`);
            console.log('ğŸ”§ [HEADER CONTROL] Buscando checkboxEl con ID:', `data-table-show-header-search-button-${componentId}`);
            if (checkboxEl) {
              console.log('ğŸ”§ [HEADER CONTROL] Checkbox encontrado:', { 
                checked: checkboxEl.checked, 
                shouldBeChecked: state.showHeaderSearchButton,
                needsUpdate: checkboxEl.checked !== state.showHeaderSearchButton
              });
              if (checkboxEl.checked !== state.showHeaderSearchButton) {
                checkboxEl.checked = state.showHeaderSearchButton;
                console.log('ğŸ”§ [HEADER CONTROL] Checkbox actualizado a:', checkboxEl.checked);
              } else {
                console.log('ğŸ”§ [HEADER CONTROL] Checkbox ya estÃ¡ en el estado correcto');
              }
            } else {
              console.warn('ğŸ”§ [HEADER CONTROL] CheckboxEl no encontrado');
            }
            
            console.log('ğŸ”§ [HEADER CONTROL] Llamando a updateDataTablePreview...');
            window.updateDataTablePreview(componentId);
            console.log('ğŸ”§ [HEADER CONTROL] ========== FIN showHeaderSearchButton ==========');
          } catch (error) {
            console.error('âŒ [HEADER CONTROL] Error en showHeaderSearchButton:', error);
            console.error('âŒ [HEADER CONTROL] Stack:', error.stack);
            throw error;
          }
        } else if (option === 'showHeaderFilterButton') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderFilterButton:', value, 'componentId:', componentId);
          state.showHeaderFilterButton = value;
          const statusEl = document.getElementById(`data-table-show-header-filter-button-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderFilterButton:', state.showHeaderFilterButton);
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderColumnSelectorButton') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderColumnSelectorButton:', value, 'componentId:', componentId);
          state.showHeaderColumnSelectorButton = value;
          const statusEl = document.getElementById(`data-table-show-header-column-selector-button-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderColumnSelectorButton:', state.showHeaderColumnSelectorButton);
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderSecondaryButtons') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderSecondaryButtons:', value, 'componentId:', componentId);
          state.showHeaderSecondaryButtons = value;
          const statusEl = document.getElementById(`data-table-show-header-secondary-buttons-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderSecondaryButtons:', state.showHeaderSecondaryButtons);
          window.updateDataTablePreview(componentId);
        } else if (option === 'showHeaderPrimaryButton') {
          console.log('ğŸ”§ [HEADER CONTROL] Cambiando showHeaderPrimaryButton:', value, 'componentId:', componentId);
          state.showHeaderPrimaryButton = value;
          const statusEl = document.getElementById(`data-table-show-header-primary-button-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          console.log('ğŸ”§ [HEADER CONTROL] Estado actualizado. showHeaderPrimaryButton:', state.showHeaderPrimaryButton);
          window.updateDataTablePreview(componentId);
        } else if (option === 'columnSortable') {
          state.columnSortable = value;
          const statusEl = document.getElementById(`data-table-column-sortable-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Habilitado' : 'Deshabilitado';
          // Actualizar el preview para reflejar el cambio
          window.updateDataTablePreview(componentId);
        } else if (option === 'columnType' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, newType]
          const [columnId, newType] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column) {
            // Guardar el tipo anterior antes de actualizar
            const oldType = column.type;
            column.type = newType || undefined;
            // Si cambia a un tipo diferente de 'nombre-avatar' o 'nombre-avatar-texto', eliminar avatarVariant
            if (newType !== 'nombre-avatar' && newType !== 'nombre-avatar-texto') {
              column.avatarVariant = undefined;
            } else if (!column.avatarVariant) {
              // Si cambia a 'nombre-avatar' o 'nombre-avatar-texto' y no tiene avatarVariant, establecer por defecto
              column.avatarVariant = 'initials';
            }
            // Si cambia a un tipo que no es 'nombre', 'nombre-avatar', 'estado', 'fecha', 'checkbox' o 'radio', eliminar editable
            if (newType !== 'nombre' && newType !== 'nombre-avatar' && newType !== 'estado' && newType !== 'fecha' && newType !== 'checkbox' && newType !== 'radio') {
              column.editable = undefined;
            }
            // Igual que en Storybook: no forzar editable = false para 'fecha'
            // Si cambia a tipo 'fecha' y no tiene editable definido, no establecerlo (se establecerÃ¡ false por defecto en buildColumn)
            // Si cambia a un tipo que no es 'radio', eliminar radioLabel
            if (newType !== 'radio') {
              column.radioLabel = undefined;
            } else if (newType === 'radio' && column.radioLabel === undefined) {
              // Si cambia a 'radio' y no tiene radioLabel, establecer por defecto false (sin label)
              column.radioLabel = false;
            }
            // Si cambia a un tipo que no es 'toggle', eliminar toggleLabel
            if (newType !== 'toggle') {
              column.toggleLabel = undefined;
            } else if (newType === 'toggle' && column.toggleLabel === undefined) {
              // Si cambia a 'toggle' y no tiene toggleLabel, establecer por defecto false (sin label)
              column.toggleLabel = false;
            }
            // Si cambia a un tipo que no es 'checkbox', eliminar checkboxLabel
            if (newType !== 'checkbox') {
              column.checkboxLabel = undefined;
            } else if (newType === 'checkbox' && column.checkboxLabel === undefined) {
              // Si cambia a 'checkbox' y no tiene checkboxLabel, establecer por defecto false (sin label)
              column.checkboxLabel = false;
            }
            // Si cambia a un tipo que no es 'correo', eliminar emailClickable
            if (newType !== 'correo') {
              column.emailClickable = undefined;
            } else if (newType === 'correo' && column.emailClickable === undefined) {
              // Si cambia a 'correo' y no tiene emailClickable, usar el del estado global o true por defecto
              column.emailClickable = state.emailClickable !== false;
            }
            // Actualizar el tÃ­tulo del header segÃºn el tipo seleccionado (siempre actualizar)
            const columnTypeLabels = {
              'nombre': 'Nombre',
              'nombre-avatar': 'Nombre',
              'nombre-avatar-texto': 'Nombre',
              'progreso': 'Progreso',
              'estado': 'Estado',
              'radio': 'Radio',
              'toggle': 'Toggle',
              'checkbox': 'Checkbox',
              'correo': 'Correo',
              'acciones': 'Acciones',
              'fecha': 'Fecha',
              'area': 'Ãrea',
              'lider': 'LÃ­der',
              'pais': 'PaÃ­s',
              'ciudad': 'Ciudad'
            };
            // Actualizar tÃ­tulo siempre: si hay newType y estÃ¡ en el mapa, usar ese; si no, mantener el actual o usar un default
            if (newType && columnTypeLabels[newType]) {
              column.title = columnTypeLabels[newType];
            } else if (!newType) {
              // Si se elimina el tipo, mantener el tÃ­tulo actual o usar un default
              // No cambiar el tÃ­tulo si no hay tipo
            }
            
            // Limpiar y actualizar datos de las filas cuando cambia el tipo
            // Tipos que requieren datos especÃ­ficos hardcoded
            const typesWithSpecificData = ['correo', 'fecha', 'area', 'lider', 'pais', 'ciudad'];
            
            // Si cambia a tipo 'correo', generar datos de email para las filas (forzar actualizaciÃ³n siempre)
            if (newType === 'correo') {
              const emails = ['juan.perez@empresa.com', 'maria.garcia@empresa.com', 'carlos.lopez@empresa.com'];
              state.rows.forEach((row, index) => {
                // Forzar actualizaciÃ³n: siempre regenerar los datos cuando cambia a correo
                const nombre = row.data.nombre || '';
                const emailBase = nombre.toLowerCase().replace(/\s+/g, '.').replace(/[Ã¡Ã©Ã­Ã³ÃºÃ±]/g, (m) => {
                  const map = {'Ã¡': 'a', 'Ã©': 'e', 'Ã­': 'i', 'Ã³': 'o', 'Ãº': 'u', 'Ã±': 'n'};
                  return map[m] || m;
                });
                row.data[columnId] = emailBase ? emailBase + '@empresa.com' : (emails[index] || 'usuario' + (index + 1) + '@empresa.com');
              });
            }
            // Si cambia a tipo 'fecha', generar datos de fecha para las filas (forzar actualizaciÃ³n siempre)
            else if (newType === 'fecha') {
              // Generar fechas diferentes para cada fila (dÃ­as diferentes del mes actual)
              const today = new Date();
              state.rows.forEach((row, index) => {
                // Crear una fecha diferente para cada fila (dÃ­as 1, 15, 28 del mes actual)
                const date = new Date(today.getFullYear(), today.getMonth(), (index * 14 + 1) % 28 + 1);
                const formattedDate = date.toLocaleDateString('es-ES', { 
                  year: 'numeric', 
                  month: 'long', 
                  day: 'numeric' 
                });
                row.data[columnId] = formattedDate;
              });
            }
            // Si cambia a tipo 'area', 'lider', 'pais' o 'ciudad', generar datos hardcoded (forzar actualizaciÃ³n siempre)
            else if (newType === 'area' || newType === 'lider' || newType === 'pais' || newType === 'ciudad') {
              const defaultValues = {
                'area': ['Desarrollo', 'DiseÃ±o', 'Marketing'],
                'lider': ['Juan PÃ©rez', 'MarÃ­a GarcÃ­a', 'Carlos LÃ³pez'],
                'pais': ['Colombia', 'MÃ©xico', 'Argentina'],
                'ciudad': ['BogotÃ¡', 'Ciudad de MÃ©xico', 'Buenos Aires']
              };
              
              state.rows.forEach((row, index) => {
                // Forzar actualizaciÃ³n: siempre regenerar los datos cuando cambia el tipo (incluso si ya tenÃ­a datos)
                const values = defaultValues[newType] || [];
                row.data[columnId] = values[index] || values[0] || '';
              });
            }
            // Si cambia a otro tipo o se elimina el tipo, limpiar los datos de esta columna si el tipo anterior requerÃ­a datos especÃ­ficos
            else {
              // Limpiar datos cuando cambia de un tipo que requerÃ­a datos especÃ­ficos a uno que no
              if (oldType && typesWithSpecificData.includes(oldType) && (!newType || !typesWithSpecificData.includes(newType))) {
                // Limpiar datos cuando se cambia de un tipo con datos especÃ­ficos a uno sin datos especÃ­ficos
                state.rows.forEach((row) => {
                  if (row.data[columnId] !== undefined) {
                    delete row.data[columnId];
                  }
                });
              }
            }
            
            // Regenerar selectores para mostrar/ocultar el controlador de variante
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'avatarVariant' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, avatarVariant]
          const [columnId, avatarVariant] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && (column.type === 'nombre-avatar' || column.type === 'nombre-avatar-texto')) {
            column.avatarVariant = avatarVariant || 'initials';
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'editable' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, editable]
          const [columnId, editable] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && (column.type === 'nombre' || column.type === 'nombre-avatar' || column.type === 'estado' || column.type === 'fecha' || column.type === 'checkbox' || column.type === 'radio')) {
            // Igual que en Storybook: permitir editable para todos los tipos editables, incluyendo 'fecha'
            column.editable = editable;
            // Regenerar selectores para actualizar el checkbox
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'radioLabel' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, showLabel]
          const [columnId, showLabel] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && column.type === 'radio') {
            column.radioLabel = showLabel ? true : false;
            // Regenerar selectores para actualizar el checkbox
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'toggleLabel' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, showLabel]
          const [columnId, showLabel] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && column.type === 'toggle') {
            column.toggleLabel = showLabel ? true : false;
            // Regenerar selectores para actualizar el checkbox
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'checkboxLabel' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, showLabel]
          const [columnId, showLabel] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && column.type === 'checkbox') {
            column.checkboxLabel = showLabel ? true : false;
            // Regenerar selectores para actualizar el checkbox
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'emailClickableCol' && Array.isArray(value) && value.length === 2) {
          // value = [columnId, isClickable]
          const [columnId, isClickable] = value;
          const column = state.columns.find(col => col.id === columnId);
          if (column && column.type === 'correo') {
            column.emailClickable = isClickable;
            // Regenerar selectores para actualizar el checkbox
            if (typeof window.generateColumnTypeSelectors === 'function') {
              window.generateColumnTypeSelectors(componentId);
            }
            // Actualizar el preview
            window.updateDataTablePreview(componentId);
          }
        } else if (option === 'showViewSelected') {
          state.showViewSelected = value;
          const statusEl = document.getElementById(`data-table-show-view-selected-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showNotifications') {
          state.showNotifications = value;
          const statusEl = document.getElementById(`data-table-show-notifications-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showCopy') {
          state.showCopy = value;
          const statusEl = document.getElementById(`data-table-show-copy-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showView') {
          state.showView = value;
          const statusEl = document.getElementById(`data-table-show-view-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showEdit') {
          state.showEdit = value;
          const statusEl = document.getElementById(`data-table-show-edit-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showDownload') {
          state.showDownload = value;
          const statusEl = document.getElementById(`data-table-show-download-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        } else if (option === 'showDelete') {
          state.showDelete = value;
          const statusEl = document.getElementById(`data-table-show-delete-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Visible' : 'Oculta';
          window.updateDataTablePreview(componentId);
        }
        
        // Actualizar el preview
        window.updateDataTablePreview(componentId);
      };
      
      // Mapeo de tipos a tÃ­tulos/labels
      const columnTypeLabels = {
        'nombre': 'Nombre',
        'progreso': 'Progreso',
        'estado': 'Estado',
        'radio': 'Radio',
        'toggle': 'Toggle',
        'checkbox': 'Checkbox',
        'correo': 'Correo',
        'acciones': 'Acciones',
        'fecha': 'Fecha',
        'area': 'Ãrea',
        'lider': 'LÃ­der',
        'pais': 'PaÃ­s',
        'ciudad': 'Ciudad'
      };
      
      // FunciÃ³n para generar selectores de tipo de columna
      window.generateColumnTypeSelectors = function(componentId) {
        const state = initDataTablePreviewState(componentId);
        const container = document.getElementById(`data-table-column-types-${componentId}`);
        if (!container) return;
        
        // Obtener columnas visibles (excluyendo checkbox fijo)
        const visibleColumns = state.columns.filter(col => {
          if (col.id === 'checkbox-2') return false;
          return col.visible !== false;
        }).slice(0, state.columnsCount || 3);
        
        const columnTypes = [
          { value: 'nombre', label: 'Nombre' },
          { value: 'nombre-avatar', label: 'Nombre + Avatar' },
          { value: 'nombre-avatar-texto', label: 'Nombre + Avatar + Texto' },
          { value: 'progreso', label: 'Progreso' },
          { value: 'estado', label: 'Estado' },
          { value: 'radio', label: 'Radio' },
          { value: 'toggle', label: 'Toggle' },
          { value: 'checkbox', label: 'Checkbox' },
          { value: 'correo', label: 'Correo' },
          { value: 'acciones', label: 'Acciones' },
          { value: 'fecha', label: 'Fecha' },
          { value: 'area', label: 'Ãrea' },
          { value: 'lider', label: 'LÃ­der' },
          { value: 'pais', label: 'PaÃ­s' },
          { value: 'ciudad', label: 'Ciudad' }
        ];
        
        container.innerHTML = visibleColumns.map((col, index) => {
          const currentType = col.type || 'nombre';
          const currentAvatarVariant = col.avatarVariant || 'initials';
          const currentEditable = col.editable || false;
          const columnNumber = index + 1;
          const isNombreAvatar = currentType === 'nombre-avatar';
          const isNombreAvatarTexto = currentType === 'nombre-avatar-texto';
          const isNombre = currentType === 'nombre';
          const isEstado = currentType === 'estado';
          const isRadio = currentType === 'radio';
          const isToggle = currentType === 'toggle';
          const isCheckbox = currentType === 'checkbox';
          const isCorreo = currentType === 'correo';
          const isFecha = currentType === 'fecha';
          // Igual que en Storybook: incluir 'fecha' en los tipos editables
          const isEditableType = isNombre || isNombreAvatar || isEstado || isFecha || isCheckbox || isRadio;
          const hasAvatarVariant = isNombreAvatar || isNombreAvatarTexto;
          // Determinar el estado del emailClickable: usar el del estado global o el de la columna
          const currentEmailClickable = col.emailClickable !== undefined ? col.emailClickable : (state.emailClickable !== false);
          // Determinar el estado del radioLabel: si es string es true, si es boolean usa ese valor, si es undefined es false
          const currentRadioLabel = col.radioLabel !== undefined ? (typeof col.radioLabel === 'string' ? true : col.radioLabel) : false;
          // Determinar el estado del toggleLabel: si es string es true, si es boolean usa ese valor, si es undefined es false
          const currentToggleLabel = col.toggleLabel !== undefined ? (typeof col.toggleLabel === 'string' ? true : col.toggleLabel) : false;
          // Determinar el estado del checkboxLabel: si es string es true, si es boolean usa ese valor, si es undefined es false
          const currentCheckboxLabel = col.checkboxLabel !== undefined ? (typeof col.checkboxLabel === 'string' ? true : col.checkboxLabel) : false;
          
          return `
            <div style="flex: 0 0 auto; min-width: 200px;">
              <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px;">Columna ${columnNumber}</label>
              <select 
                id="data-table-column-type-${componentId}-${col.id}"
                onchange="setDataTableControl('columnType', ['${col.id}', this.value || undefined], '${componentId}')"
                style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1, #d0d2d5); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; cursor: pointer; margin-bottom: ${hasAvatarVariant || isEditableType || isCorreo ? '12px' : '0'}; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;"
              >
                ${columnTypes.map(type => `
                  <option value="${type.value}" ${currentType === type.value ? 'selected' : ''}>${type.label}</option>
                `).join('')}
              </select>
              ${hasAvatarVariant ? `
                <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-top: 12px; margin-bottom: 8px;">Variante Avatar</label>
                <select 
                  id="data-table-avatar-variant-${componentId}-${col.id}"
                  onchange="setDataTableControl('avatarVariant', ['${col.id}', this.value], '${componentId}')"
                  style="width: 100%; padding: 10px 32px 10px 12px; border: 1px solid var(--ubits-border-1, #d0d2d5); border-radius: 8px; background: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-size: 14px; font-family: var(--font-sans); box-sizing: border-box; cursor: pointer; margin-bottom: ${isEditableType ? '12px' : '0'}; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px;"
                >
                  <option value="photo" ${currentAvatarVariant === 'photo' ? 'selected' : ''}>Foto</option>
                  <option value="initials" ${currentAvatarVariant === 'initials' ? 'selected' : ''}>Iniciales</option>
                  <option value="icon" ${currentAvatarVariant === 'icon' ? 'selected' : ''}>Icono</option>
                </select>
              ` : ''}
              ${isEditableType ? `
                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: ${hasAvatarVariant ? '0' : '12px'};">
                  <input type="checkbox" class="ubits-toggle__input" id="data-table-editable-${componentId}-${col.id}" ${currentEditable ? 'checked' : ''} onchange="setDataTableControl('editable', ['${col.id}', this.checked], '${componentId}')">
                  <span class="ubits-toggle__track">
                    <span class="ubits-toggle__thumb"></span>
                  </span>
                  <span style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium);">Editable</span>
                </label>
              ` : ''}
              ${isRadio ? `
                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 12px;">
                  <input type="checkbox" class="ubits-toggle__input" id="data-table-radio-label-${componentId}-${col.id}" ${currentRadioLabel !== false ? 'checked' : ''} onchange="setDataTableControl('radioLabel', ['${col.id}', this.checked], '${componentId}')">
                  <span class="ubits-toggle__track">
                    <span class="ubits-toggle__thumb"></span>
                  </span>
                  <span style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium);">Mostrar Label</span>
                </label>
              ` : ''}
              ${isToggle ? `
                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 12px;">
                  <input type="checkbox" class="ubits-toggle__input" id="data-table-toggle-label-${componentId}-${col.id}" ${currentToggleLabel !== false ? 'checked' : ''} onchange="setDataTableControl('toggleLabel', ['${col.id}', this.checked], '${componentId}')">
                  <span class="ubits-toggle__track">
                    <span class="ubits-toggle__thumb"></span>
                  </span>
                  <span style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium);">Mostrar Label</span>
                </label>
              ` : ''}
              ${isCheckbox ? `
                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 12px;">
                  <input type="checkbox" class="ubits-toggle__input" id="data-table-checkbox-label-${componentId}-${col.id}" ${currentCheckboxLabel !== false ? 'checked' : ''} onchange="setDataTableControl('checkboxLabel', ['${col.id}', this.checked], '${componentId}')">
                  <span class="ubits-toggle__track">
                    <span class="ubits-toggle__thumb"></span>
                  </span>
                  <span style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium);">Mostrar Label</span>
                </label>
              ` : ''}
              ${isCorreo ? `
                <label class="ubits-toggle ubits-toggle--md" style="display: flex; align-items: center; gap: 12px; cursor: pointer; margin-top: 12px;">
                  <input type="checkbox" class="ubits-toggle__input" id="data-table-email-clickable-col-${componentId}-${col.id}" ${currentEmailClickable ? 'checked' : ''} onchange="setDataTableControl('emailClickableCol', ['${col.id}', this.checked], '${componentId}')">
                  <span class="ubits-toggle__track">
                    <span class="ubits-toggle__thumb"></span>
                  </span>
                  <span style="font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium);">Email Clicable</span>
                </label>
              ` : ''}
            </div>
          `;
        }).join('');
      };
      
      // Almacenar instancias de Data Table
      window.dataTableInstances = window.dataTableInstances || {};
      
      // FunciÃ³n para actualizar el preview del Data Table
      window.updateDataTablePreview = function(componentId) {
        const state = initDataTablePreviewState(componentId);
        const preview = document.getElementById(`data-table-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Data Table no encontrado:', `data-table-preview-${componentId}`);
          return;
        }
        
        // Limpiar completamente el preview antes de crear una nueva tabla
        preview.innerHTML = '';
        
        // Generar selectores de tipo de columna despuÃ©s de que el DOM estÃ© listo
        setTimeout(() => {
          const columnTypesContainer = document.getElementById(`data-table-column-types-${componentId}`);
          if (columnTypesContainer && window.generateColumnTypeSelectors) {
            window.generateColumnTypeSelectors(componentId);
            console.log('âœ… Selectores de tipo de columna generados');
          }
        }, 150);
        
        // Destruir instancia anterior si existe
        if (window.dataTableInstances[componentId]) {
          try {
            window.dataTableInstances[componentId].destroy();
          } catch (e) {
            console.warn('Error destruyendo instancia anterior:', e);
          }
          delete window.dataTableInstances[componentId];
        }
        
        // Cargar CSS necesario (con timestamp para evitar cachÃ©)
        const existingCssLink = document.querySelector('link[href*="data-table.css"]');
        if (existingCssLink) {
          existingCssLink.remove(); // Remover el link existente para forzar recarga
        }
          const link = document.createElement('link');
          link.rel = 'stylesheet';
        link.href = '../../addons/data-table/src/styles/data-table.css?v=' + Date.now();
          document.head.appendChild(link);
        
        if (!document.querySelector('link[href*="checkbox.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/checkbox/src/styles/checkbox.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Progress Bar
        if (!document.querySelector('link[href*="progress.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/progress/src/styles/progress.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Status Tag
        if (!document.querySelector('link[href*="status-tag.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/status-tag/src/styles/status-tag.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Avatar
        if (!document.querySelector('link[href*="avatar.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/avatar/src/styles/avatar.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Toggle
        if (!document.querySelector('link[href*="toggle.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/toggle/src/styles/toggle.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Radio Button
        if (!document.querySelector('link[href*="radio-button.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/radio-button/src/styles/radio-button.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Button
        if (!document.querySelector('link[href*="button.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Cargar script de Button si no estÃ¡ disponible renderButton
        if (typeof window.renderButton === 'undefined') {
          const existingButtonScript = document.querySelector('script[src*="button.umd.js"]');
          if (!existingButtonScript) {
            const buttonScript = document.createElement('script');
            buttonScript.src = '../../addons/button/dist/button.umd.js?v=' + Date.now();
            buttonScript.onload = () => {
              console.log('âœ… Button UMD cargado');
            };
            buttonScript.onerror = () => {
              console.error('âŒ Error cargando button.umd.js');
            };
            document.head.appendChild(buttonScript);
          }
        }
        
        // Cargar CSS de SearchButton
        if (!document.querySelector('link[href*="search-button.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/search-button/src/styles/search-button.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Drawer
        if (!document.querySelector('link[href*="drawer.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/drawer/src/styles/drawer.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Badge
        if (!document.querySelector('link[href*="badge.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/badge/src/styles/badge.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Input
        if (!document.querySelector('link[href*="input.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/input/src/styles/input.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de List
        if (!document.querySelector('link[href*="list.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/list/src/styles/list.css';
          document.head.appendChild(link);
        }
        
        // FunciÃ³n auxiliar para crear la instancia de Data Table
        const createDataTableInstance = () => {
          const instanceId = `instance-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
          console.log(`ğŸ¯ [INSTANCE] ========== INICIO createDataTableInstance [${instanceId}] ==========`);
          
          // CRÃTICO: Obtener el estado MÃS RECIENTE directamente desde dataTablePreviewState
          // Esto asegura que siempre usamos el estado actualizado, incluso si se llama desde onRowSelect
          const currentState = initDataTablePreviewState(componentId);
          console.log(`ğŸ¯ [INSTANCE] Estado obtenido directamente. Filas:`, currentState.rows.length);
          console.log(`ğŸ¯ [INSTANCE] Verificando selecciones en estado actualizado:`);
          currentState.rows.forEach((row, idx) => {
            if (row.data && row.data['checkbox-2'] !== undefined) {
              console.log(`ğŸ¯ [INSTANCE]   Fila ${idx} (id: ${row.id}): checkbox-2 =`, row.data['checkbox-2'], typeof row.data['checkbox-2']);
            }
          });
          
          // Verificar si ya existe un contenedor y limpiarlo
          const existingContainer = document.getElementById(`data-table-container-${componentId}`);
          if (existingContainer) {
            console.log(`ğŸ¯ [INSTANCE] ğŸ§¹ Limpiando contenedor existente`);
            // Destruir instancia anterior si existe
            if (window.dataTableInstances[componentId]) {
              try {
                window.dataTableInstances[componentId].destroy();
              } catch (e) {
                console.warn('Error destruyendo instancia anterior:', e);
              }
              delete window.dataTableInstances[componentId];
            }
            existingContainer.remove();
          }
          
          // Crear la tabla
          const containerId = `data-table-container-${componentId}`;
          const container = document.createElement('div');
          container.id = containerId;
          console.log(`ğŸ¯ [INSTANCE] Creando contenedor:`, containerId);
          preview.appendChild(container);
          console.log(`ğŸ¯ [INSTANCE] Contenedor agregado. Elementos hijos en preview:`, preview.children.length);
          
          try {
            // Construir columnas dinÃ¡micamente segÃºn controles
            // Construir columnas desde el estado (mantener tipos y propiedades)
            // Si showHorizontalScrollbar estÃ¡ activo, asegurar mÃ­nimo 8 columnas para que se vea el scroll
            let columnsCount = currentState.columnsCount || 3;
            if (currentState.showHorizontalScrollbar === true && columnsCount < 8) {
              columnsCount = 8;
            }
            const allColumns = [];
            
            // Separar checkbox de columnas de datos
            const checkboxColumn = currentState.columns.find(col => col.id === 'checkbox-2');
            const dataColumns = currentState.columns.filter(col => col.id !== 'checkbox-2');
            
            // Usar columnas del estado si existen, sino crear por defecto
            if (currentState.columns && currentState.columns.length > 0) {
              // Agregar checkbox primero si existe
              // IMPORTANTE: Preservar la propiedad pinned si existe
              if (checkboxColumn && currentState.showCheckbox !== false) {
                const checkboxCopy = { ...checkboxColumn };
                // Asegurar que pinned se preserve si existe
                if (checkboxColumn.pinned !== undefined) {
                  checkboxCopy.pinned = checkboxColumn.pinned;
                }
                allColumns.push(checkboxCopy);
              }
              
              // Asegurar que tenemos suficientes columnas de datos segÃºn columnsCount
              const dataColumnsToUse = dataColumns.slice(0, columnsCount);
              // Si showHorizontalScrollbar estÃ¡ activo, usar ancho mÃ­nimo de 180px para todas las columnas
              const minColumnWidth = currentState.showHorizontalScrollbar === true ? 180 : undefined;
              dataColumnsToUse.forEach(col => {
                // Copiar todas las propiedades de la columna incluyendo avatarVariant y pinned
                const columnCopy = {
                  id: col.id,
                  title: col.title,
                  type: col.type,
                  width: minColumnWidth ? Math.max(col.width || 150, minColumnWidth) : col.width,
                  visible: col.visible !== false
                };
                // IMPORTANTE: Copiar la propiedad pinned si existe (para preservar columnas fijadas)
                if (col.pinned !== undefined) {
                  columnCopy.pinned = col.pinned;
                }
                // Si tiene avatarVariant, copiarlo tambiÃ©n
                if (col.avatarVariant !== undefined) {
                  columnCopy.avatarVariant = col.avatarVariant;
                }
                // Si tiene editable, copiarlo tambiÃ©n (incluyendo false explÃ­cito)
                // IMPORTANTE: Igual que en Storybook - copiar editable si estÃ¡ definido (incluso si es false)
                // Esto incluye columnas de tipo 'fecha' que pueden ser editables
                if (col.editable !== undefined) {
                  columnCopy.editable = col.editable;
                  console.log(`ğŸ¯ [INSTANCE] Copiando editable para columna ${col.id}:`, col.editable);
                }
                // Si tiene radioLabel, copiarlo tambiÃ©n
                if (col.radioLabel !== undefined) {
                  columnCopy.radioLabel = col.radioLabel;
                }
                // Si tiene toggleLabel, copiarlo tambiÃ©n
                if (col.toggleLabel !== undefined) {
                  columnCopy.toggleLabel = col.toggleLabel;
                }
                // Si tiene checkboxLabel, copiarlo tambiÃ©n
                if (col.checkboxLabel !== undefined) {
                  columnCopy.checkboxLabel = col.checkboxLabel;
                }
                // Si es columna de email, aplicar emailClickable de la columna o del estado
                if (col.type === 'correo' || col.id === 'email') {
                  // Usar el valor de la columna si existe, sino usar el del estado global
                  columnCopy.emailClickable = col.emailClickable !== undefined ? col.emailClickable : (currentState.emailClickable !== false);
                } else if (col.emailClickable !== undefined) {
                  // Si la columna tiene emailClickable definido, usarlo
                  columnCopy.emailClickable = col.emailClickable;
                }
                // Si tiene renderCell, copiarlo tambiÃ©n
                if (col.renderCell) {
                  columnCopy.renderCell = col.renderCell;
                }
                allColumns.push(columnCopy);
              });
              
              // Si necesitamos mÃ¡s columnas de datos, agregar las adicionales
              if (columnsCount > dataColumns.length) {
                const columnNames = ['TelÃ©fono', 'Ciudad', 'PaÃ­s', 'Fecha', 'CategorÃ­a', 'Prioridad', 'Ãrea', 'LÃ­der', 'Departamento', 'Proyecto'];
                // Si showHorizontalScrollbar estÃ¡ activo, usar ancho mÃ­nimo de 180px para que se vea el scroll
                const columnWidth = currentState.showHorizontalScrollbar === true ? 180 : 150;
                for (let i = dataColumns.length; i < columnsCount && i < 12; i++) {
                  const columnName = columnNames[i - dataColumns.length] || `Columna ${i + 1}`;
                  const newColumn = {
                    id: `col${i}`,
                    title: columnName,
                    visible: true,
                    width: columnWidth,
                    type: undefined
                  };
                  allColumns.push(newColumn);
                  // TambiÃ©n agregar al estado para que aparezca en los selectores
                  if (!currentState.columns.find(col => col.id === newColumn.id)) {
                    currentState.columns.push(newColumn);
                  }
                }
                // Regenerar selectores despuÃ©s de agregar nuevas columnas
                if (typeof window.generateColumnTypeSelectors === 'function') {
                  setTimeout(() => window.generateColumnTypeSelectors(componentId), 100);
                }
              }
            } else {
              // Fallback: crear columnas por defecto
              const baseColumns = [
                { id: 'checkbox-2', title: 'Checkbox', visible: currentState.showCheckbox !== false, width: 150, type: undefined },
                { id: 'nombre', title: 'Nombre', visible: true, width: 200, type: 'nombre' },
                { id: 'email', title: 'Email', visible: true, width: 250, type: 'correo', emailClickable: currentState.emailClickable !== false },
                { id: 'estado', title: 'Estado', visible: true, width: 150, type: 'estado' }
              ];
              
              const additionalColumns = [];
              const columnNames = ['TelÃ©fono', 'Ciudad', 'PaÃ­s', 'Fecha', 'CategorÃ­a', 'Prioridad', 'Ãrea', 'LÃ­der', 'Departamento', 'Proyecto'];
              // Si showHorizontalScrollbar estÃ¡ activo, usar ancho mÃ­nimo de 180px para que se vea el scroll
              const columnWidth = currentState.showHorizontalScrollbar === true ? 180 : 150;
              
              for (let i = 3; i < columnsCount && i < 12; i++) {
                const columnName = columnNames[i - 3] || `Columna ${i + 1}`;
                const newColumn = {
                  id: `col${i}`,
                  title: columnName,
                  visible: true,
                  width: columnWidth,
                  type: undefined
                };
                additionalColumns.push(newColumn);
                // TambiÃ©n agregar al estado
                if (!currentState.columns.find(col => col.id === newColumn.id)) {
                  currentState.columns.push(newColumn);
                }
              }
              
              allColumns.push(...baseColumns, ...additionalColumns);
            }
            
            // Filtrar columnas segÃºn opciones
            console.log('ğŸ“Š [FILTER] Antes de filtrar. allColumns:', allColumns.map(c => ({ id: c.id, visible: c.visible })));
            console.log('ğŸ“Š [FILTER] currentState.showCheckbox:', currentState.showCheckbox);
            const columns = allColumns.filter(col => {
              if (col.id === 'checkbox-2') {
                const shouldShow = currentState.showCheckbox !== false;
                console.log('ğŸ“Š [FILTER] Columna checkbox-2 encontrada. Debe mostrarse?', shouldShow);
                return shouldShow;
              }
              return col.visible !== false;
            });
            console.log('ğŸ“Š [FILTER] DespuÃ©s de filtrar. columns:', columns.map(c => ({ id: c.id, visible: c.visible })));
            
            // CRÃTICO: Asegurar que todas las filas tengan row.data inicializado ANTES de crear rowsWithExpand
            // Esto es especialmente importante para la columna checkbox-2, que debe existir desde el inicio
            // Reutilizar checkboxColumn que ya fue declarado arriba
            if (checkboxColumn) {
              currentState.rows.forEach(row => {
                if (!row.data) {
                  row.data = {};
                }
                // Asegurar que checkbox-2 existe en row.data (inicializado como false si no existe)
                if (row.data[checkboxColumn.id] === undefined) {
                  row.data[checkboxColumn.id] = false;
                }
              });
            }
            
            // Preparar filas con renderExpandedContent solo si rowExpandable estÃ¡ activado
            // CRÃTICO: Usar las MISMAS referencias de objetos de currentState.rows para que las actualizaciones
            // del componente Data Table (que actualiza currentOptions.rows) se reflejen automÃ¡ticamente
            // en currentState.rows porque ambos apuntan a los mismos objetos row.data
            let rowsWithExpand = currentState.rows.map(row => {
              // Si rowExpandable estÃ¡ activado, necesitamos agregar renderExpandedContent
              // pero mantener la misma referencia al objeto row.data
              if (currentState.rowExpandable !== false) {
                // Crear un nuevo objeto row pero mantener la misma referencia a row.data
                const rowWithExpand = {
                  ...row,
                  renderExpandedContent: (rowData) => {
                    // Usar tokens CSS para que funcione correctamente en modo dark
                    return `
                      <div style="padding: var(--ubits-spacing-md, 16px);">
                        <h4 style="margin: 0 0 var(--ubits-spacing-sm, 8px) 0; font-size: var(--ubits-font-size-sm, 14px); font-weight: 600; color: var(--ubits-fg-1-high, #1f2937);">
                          InformaciÃ³n adicional
                        </h4>
                        <p style="margin: 0; font-size: var(--ubits-font-size-sm, 13px); color: var(--ubits-fg-1-medium, #6b7280);">
                          Detalles adicionales para ${rowData.nombre || 'usuario'}
                        </p>
                      </div>
                    `;
                  }
                };
                // CRÃTICO: Asegurar que row.data apunta a la misma referencia del objeto data original
                // Esto permite que cuando el componente Data Table actualice currentOptions.rows[row].data[columnId],
                // esa actualizaciÃ³n se refleje automÃ¡ticamente en currentState.rows[row].data[columnId]
                // porque ambos apuntan al mismo objeto data
                rowWithExpand.data = row.data;
                return rowWithExpand;
              }
              // Si no hay rowExpandable, usar la misma referencia directamente (sin copiar)
              // Esto asegura que las actualizaciones del componente Data Table se reflejen en currentState.rows
              return row;
            });
            
            // Aplicar filtro "Ver seleccionados" si estÃ¡ activo
            if (currentState.viewSelectedActive) {
              const checkboxColumn = columns.find(col => col.id === 'checkbox-2');
              if (checkboxColumn) {
                rowsWithExpand = rowsWithExpand.filter(row => {
                  return row.data && row.data[checkboxColumn.id] === true;
                });
              }
            }
            
            const showCheckboxValue = currentState.showCheckbox !== false;
            const showVerticalScrollbarValue = currentState.showVerticalScrollbar === true;
            const showHorizontalScrollbarValue = currentState.showHorizontalScrollbar === true;
            const showColumnMenuValue = currentState.showColumnMenu !== false;
            const showContextMenuValue = currentState.showContextMenu !== false;
            
            // Preparar opciones del header
            const totalRows = rowsWithExpand.length;
            // Asegurar que el tÃ­tulo siempre tenga un valor
            const headerTitleValue = currentState.headerTitle && currentState.headerTitle.trim() !== '' 
              ? currentState.headerTitle 
              : 'Tabla de datos';
            
            // Usar directamente los valores del estado para los controladores
            const headerOptions = {
              title: headerTitleValue,
              counter: currentState.headerCounter !== false ? (currentState.headerCounterMode === 'total-only' ? 'total-only' : true) : false,
              displayedItems: currentState.headerDisplayedItems !== undefined ? currentState.headerDisplayedItems : totalRows,
              totalItems: currentState.headerTotalItems !== undefined ? currentState.headerTotalItems : totalRows,
              showTitle: currentState.showHeaderTitle === true,
              showCounter: currentState.showHeaderCounter === true,
              // BotÃ³n de bÃºsqueda
              searchButton: currentState.showHeaderSearchButton === true ? {
                onSearch: (searchTerm, filteredRows) => {
                  console.log('ğŸ” [SEARCH] onSearch callback llamado:', { 
                    searchTerm, 
                    filteredRowsCount: filteredRows.length,
                    componentId: componentId,
                    headerCounter: currentState.headerCounter
                  });
                  // Actualizar contador si estÃ¡ activo
                  if (currentState.headerCounter !== false) {
                    const oldValue = currentState.headerDisplayedItems;
                    currentState.headerDisplayedItems = filteredRows.length;
                    console.log('ğŸ” [SEARCH] Actualizando headerDisplayedItems:', { 
                      oldValue, 
                      newValue: currentState.headerDisplayedItems,
                      componentId: componentId
                    });
                    
                    // Actualizar el input visualmente
                    const displayedItemsInput = document.getElementById(`data-table-header-displayed-items-${componentId}`);
                    console.log('ğŸ” [SEARCH] Buscando input con ID:', `data-table-header-displayed-items-${componentId}`);
                    if (displayedItemsInput) {
                      const oldInputValue = displayedItemsInput.value;
                      displayedItemsInput.value = currentState.headerDisplayedItems;
                      console.log('ğŸ” [SEARCH] Input actualizado:', { 
                        oldInputValue, 
                        newInputValue: displayedItemsInput.value,
                        stateValue: currentState.headerDisplayedItems
                      });
                    } else {
                      console.warn('ğŸ” [SEARCH] Input no encontrado con ID:', `data-table-header-displayed-items-${componentId}`);
                      console.warn('ğŸ” [SEARCH] Intentando buscar todos los inputs de displayed items:', 
                        document.querySelectorAll('[id*="data-table-header-displayed-items"]').length);
                    }
                  } else {
                    console.log('ğŸ” [SEARCH] Contador desactivado, no actualizando headerDisplayedItems');
                  }
                }
              } : undefined,
              showSearchButton: currentState.showHeaderSearchButton === true,
              // BotÃ³n de filtros
              filterButton: currentState.showHeaderFilterButton === true ? {
                onApplyFilters: (filters) => {
                  console.log('ğŸ” Filtros aplicados:', filters);
                },
                onClearFilters: () => {
                  console.log('ğŸ” Filtros limpiados');
                }
              } : undefined,
              showFilterButton: currentState.showHeaderFilterButton === true,
              // BotÃ³n de selector de columnas
              columnSelectorButton: currentState.showHeaderColumnSelectorButton === true ? {
                onClick: (e) => {
                  console.log('ğŸ“‹ Selector de columnas clickeado');
                }
              } : undefined,
              showColumnSelectorButton: currentState.showHeaderColumnSelectorButton === true,
              // Botones secundarios
              secondaryButtons: currentState.showHeaderSecondaryButtons === true && currentState.headerSecondaryButtons ? currentState.headerSecondaryButtons.map((btn, index) => ({
                icon: btn.icon || 'ellipsis',
                iconStyle: btn.iconStyle || 'regular',
                onClick: (e) => {
                  console.log(`BotÃ³n secundario ${index + 1} clickeado`);
                  if (btn.onClick) btn.onClick(e);
                },
                disabled: btn.disabled || false,
                active: btn.active || false
              })) : [],
              showSecondaryButtons: currentState.showHeaderSecondaryButtons === true,
              // BotÃ³n primario
              primaryButton: currentState.showHeaderPrimaryButton === true && currentState.headerPrimaryButton ? {
                icon: currentState.headerPrimaryButton.icon || 'plus',
                iconStyle: currentState.headerPrimaryButton.iconStyle || 'regular',
                onClick: (e) => {
                  console.log('BotÃ³n primario clickeado');
                  if (currentState.headerPrimaryButton.onClick) currentState.headerPrimaryButton.onClick(e);
                },
                disabled: currentState.headerPrimaryButton.disabled || false
              } : undefined,
              showPrimaryButton: currentState.showHeaderPrimaryButton === true
            };
            
            console.log('ğŸ“‹ [HEADER] headerOptions final - contador:', {
              displayedItems: headerOptions.displayedItems,
              totalItems: headerOptions.totalItems,
              counter: headerOptions.counter,
              showCounter: headerOptions.showCounter
            });
            
            const tableOptions = {
              containerId: containerId,
              columns: columns,
              rows: rowsWithExpand,
              columnReorderable: currentState.columnReorderable !== false,
              rowReorderable: currentState.rowReorderable !== false,
              rowExpandable: currentState.rowExpandable !== false,
              columnSortable: currentState.columnSortable !== false,
              showCheckbox: showCheckboxValue,
              showVerticalScrollbar: showVerticalScrollbarValue,
              showHorizontalScrollbar: showHorizontalScrollbarValue,
              showColumnMenu: showColumnMenuValue,
              showContextMenu: showContextMenuValue,
              checkboxSticky: currentState.checkboxSticky === true,
              dragHandleSticky: currentState.dragHandleSticky === true,
              expandSticky: currentState.expandSticky === true,
              showPagination: currentState.showPagination === true,
              currentPage: currentState.currentPage || 1,
              itemsPerPage: currentState.itemsPerPage || 10,
              paginationVariant: currentState.paginationVariant || 'default',
              paginationSize: currentState.paginationSize || 'md',
              // Lazy load: activo por defecto si no hay paginaciÃ³n
              lazyLoad: currentState.showPagination === true ? false : true,
              lazyLoadItemsPerBatch: 10,
              // Header
              header: headerOptions,
              onPageChange: (page) => {
                const state = initDataTablePreviewState(componentId);
                state.currentPage = page;
                window.updateDataTablePreview(componentId);
              },
              onItemsPerPageChange: (itemsPerPage) => {
                const state = initDataTablePreviewState(componentId);
                state.itemsPerPage = itemsPerPage;
                state.currentPage = 1;
                window.updateDataTablePreview(componentId);
              },
              onLazyLoad: (loadedItems, totalItems) => {
                console.log('ğŸ“¦ [LAZY LOAD] Items cargados:', loadedItems, 'de', totalItems);
              },
              onRowSelect: (rowId, selected) => {
                console.log('ğŸ¯ [ROW SELECT] ========== INICIO ==========');
                console.log('ğŸ¯ [ROW SELECT] Fila:', rowId, 'selected:', selected);
                
                // Obtener el estado actualizado
                const state = initDataTablePreviewState(componentId);
                const checkboxColumn = columns.find(col => col.id === 'checkbox-2');
                
                if (checkboxColumn) {
                  const row = state.rows.find(r => r.id === rowId);
                  if (row) {
                    if (!row.data) row.data = {};
                    row.data[checkboxColumn.id] = selected;
                    console.log('ğŸ¯ [ROW SELECT] Estado actualizado:', rowId, '=', selected);
                  }
                }
                
                // Renderizar barra de acciones inmediatamente (igual que en Storybook)
                const container = document.getElementById(`data-table-container-${componentId}`);
                if (container) {
                  const latestState = initDataTablePreviewState(componentId);
                  renderActionBar(componentId, latestState, container);
                }
                console.log('ğŸ¯ [ROW SELECT] ========== FIN ==========');
              },
              onSelectAll: (selected) => {
                console.log('ğŸ¯ [SELECT ALL] selected:', selected);
                const state = initDataTablePreviewState(componentId);
                const checkboxColumn = columns.find(col => col.id === 'checkbox-2');
                
                if (checkboxColumn) {
                  // Obtener filas visibles desde el DOM
                  const tableElement = document.querySelector(`#data-table-container-${componentId} .ubits-data-table`);
                  const loadedRowIds = new Set();
                  
                  if (tableElement) {
                    const visibleCheckboxes = tableElement.querySelectorAll(`input[type="checkbox"][data-column-id="${checkboxColumn.id}"][data-row-id]`);
                    visibleCheckboxes.forEach((cb) => {
                      const rowIdStr = cb.getAttribute('data-row-id');
                      if (rowIdStr) {
                        const rowId = isNaN(Number(rowIdStr)) ? rowIdStr : Number(rowIdStr);
                        loadedRowIds.add(String(rowId));
                      }
                    });
                  }
                  
                  // Actualizar estado
                  const isLazyLoad = !state.showPagination && (state.lazyLoad !== false);
                  if (isLazyLoad && loadedRowIds.size > 0) {
                    state.rows.forEach(row => {
                      if (!row.data) row.data = {};
                      if (loadedRowIds.has(String(row.id))) {
                        row.data[checkboxColumn.id] = selected;
                      }
                    });
                  } else {
                    state.rows.forEach(row => {
                      if (!row.data) row.data = {};
                      row.data[checkboxColumn.id] = selected;
                    });
                  }
                }
                
                // Renderizar barra de acciones inmediatamente (igual que en Storybook)
                const container = document.getElementById(`data-table-container-${componentId}`);
                if (container) {
                  const latestState = initDataTablePreviewState(componentId);
                  renderActionBar(componentId, latestState, container);
                }
              },
              onRowExpand: (rowId, expanded) => {
                console.log('Fila expandida:', rowId, expanded);
                const state = initDataTablePreviewState(componentId);
                const row = state.rows.find(r => r.id === rowId);
                if (row) {
                  row.expanded = expanded;
                }
              },
              onColumnReorder: (columnIds) => {
                console.log('Columnas reordenadas:', columnIds);
              },
              onRowReorder: (rowIds) => {
                console.log('Filas reordenadas:', rowIds);
              },
              // ConfiguraciÃ³n de Empty State
              emptyState: {
                noData: {
                  title: 'No hay datos',
                  description: 'No se han agregado elementos aÃºn. Comienza agregando tu primer elemento.',
                  icon: 'inbox',
                  showPrimaryButton: false
                },
                noSearchResults: {
                  title: 'No se encontraron resultados',
                  description: 'Intenta con otros tÃ©rminos de bÃºsqueda o ajusta los filtros.',
                  icon: 'search',
                  showPrimaryButton: false
                },
                noFilterResults: {
                  title: 'No hay resultados con los filtros aplicados',
                  description: 'Intenta ajustar los filtros para ver mÃ¡s resultados.',
                  icon: 'filter',
                  actionLabel: 'Limpiar filtros',
                  showPrimaryButton: true,
                  onAction: () => {
                    console.log('Empty state - No filter results: limpiando filtros');
                    // Limpiar filtros - esto se manejarÃ¡ automÃ¡ticamente por el componente
                    alert('Limpiando filtros...');
                  }
                }
              }
            };
            
            const table = window.createDataTable(tableOptions);
            
            // Guardar instancia para poder destruirla despuÃ©s
            window.dataTableInstances[componentId] = table;
            
            // Renderizar barra de acciones despuÃ©s de crear la tabla
            const waitForRenderButton = () => {
              if (typeof window.renderButton !== 'undefined') {
                renderActionBar(componentId, currentState, container);
              } else {
                setTimeout(waitForRenderButton, 50);
              }
            };
            setTimeout(waitForRenderButton, 200);
            
            // Sincronizar checkboxes con el estado actual
            const paginationCheckbox = document.getElementById(`data-table-show-pagination-${componentId}`);
            if (paginationCheckbox) {
              paginationCheckbox.checked = currentState.showPagination === true;
            }
            const paginationStatus = document.getElementById(`data-table-show-pagination-status-${componentId}`);
            if (paginationStatus) {
              paginationStatus.textContent = currentState.showPagination === true ? 'Activado' : 'Desactivado';
            }
            
            // Sincronizar checkboxes del header con el estado actual
            const headerTitleCheckbox = document.getElementById(`data-table-show-header-title-${componentId}`);
            if (headerTitleCheckbox) {
              headerTitleCheckbox.checked = currentState.showHeaderTitle === true;
            }
            const headerTitleStatus = document.getElementById(`data-table-show-header-title-status-${componentId}`);
            if (headerTitleStatus) {
              headerTitleStatus.textContent = currentState.showHeaderTitle === true ? 'Visible' : 'Oculta';
            }
            
            const headerCounterCheckbox = document.getElementById(`data-table-show-header-counter-${componentId}`);
            if (headerCounterCheckbox) {
              headerCounterCheckbox.checked = currentState.showHeaderCounter === true;
            }
            const headerCounterStatus = document.getElementById(`data-table-show-header-counter-status-${componentId}`);
            if (headerCounterStatus) {
              headerCounterStatus.textContent = currentState.showHeaderCounter === true ? 'Visible' : 'Oculta';
            }
            
            // Sincronizar modo del contador y sus inputs
            const counterModeRadios = document.querySelectorAll(`input[name="data-table-header-counter-mode-${componentId}"]`);
            counterModeRadios.forEach(radio => {
              if (radio) {
                radio.checked = radio.value === (currentState.headerCounterMode || 'full');
              }
            });
            
            // Mostrar/ocultar inputs segÃºn el modo
            const displayedContainer = document.getElementById(`data-table-header-displayed-items-container-${componentId}`);
            const totalContainer = document.getElementById(`data-table-header-total-items-container-${componentId}`);
            const currentMode = currentState.headerCounterMode || 'full';
            if (displayedContainer) {
              // En modo 'full' se muestran ambos (X e Y), en modo 'total-only' solo Y
              displayedContainer.style.display = currentMode === 'full' ? 'block' : 'none';
            }
            if (totalContainer) {
              // El input de Y siempre se muestra (en ambos modos)
              totalContainer.style.display = 'block';
            }
            
            // Sincronizar valores de los inputs
            const displayedItemsInput = document.getElementById(`data-table-header-displayed-items-${componentId}`);
            if (displayedItemsInput) {
              displayedItemsInput.value = currentState.headerDisplayedItems !== undefined ? currentState.headerDisplayedItems : totalRows;
            }
            
            const totalItemsInput = document.getElementById(`data-table-header-total-items-${componentId}`);
            if (totalItemsInput) {
              totalItemsInput.value = currentState.headerTotalItems !== undefined ? currentState.headerTotalItems : totalRows;
            }
            
            const headerSearchButtonCheckbox = document.getElementById(`data-table-show-header-search-button-${componentId}`);
            if (headerSearchButtonCheckbox) {
              headerSearchButtonCheckbox.checked = currentState.showHeaderSearchButton === true;
            }
            const headerSearchButtonStatus = document.getElementById(`data-table-show-header-search-button-status-${componentId}`);
            if (headerSearchButtonStatus) {
              headerSearchButtonStatus.textContent = currentState.showHeaderSearchButton === true ? 'Visible' : 'Oculta';
            }
            
            const headerFilterButtonCheckbox = document.getElementById(`data-table-show-header-filter-button-${componentId}`);
            if (headerFilterButtonCheckbox) {
              headerFilterButtonCheckbox.checked = currentState.showHeaderFilterButton === true;
            }
            const headerFilterButtonStatus = document.getElementById(`data-table-show-header-filter-button-status-${componentId}`);
            if (headerFilterButtonStatus) {
              headerFilterButtonStatus.textContent = currentState.showHeaderFilterButton === true ? 'Visible' : 'Oculta';
            }
            
            const headerColumnSelectorCheckbox = document.getElementById(`data-table-show-header-column-selector-button-${componentId}`);
            if (headerColumnSelectorCheckbox) {
              headerColumnSelectorCheckbox.checked = currentState.showHeaderColumnSelectorButton === true;
            }
            const headerColumnSelectorStatus = document.getElementById(`data-table-show-header-column-selector-button-status-${componentId}`);
            if (headerColumnSelectorStatus) {
              headerColumnSelectorStatus.textContent = currentState.showHeaderColumnSelectorButton === true ? 'Visible' : 'Oculta';
            }
            
            // Sincronizar checkbox de menÃº contextual
            const contextMenuCheckbox = document.getElementById(`data-table-show-context-menu-${componentId}`);
            if (contextMenuCheckbox) {
              contextMenuCheckbox.checked = currentState.showContextMenu !== false;
            }
            const contextMenuStatus = document.getElementById(`data-table-show-context-menu-status-${componentId}`);
            if (contextMenuStatus) {
              contextMenuStatus.textContent = currentState.showContextMenu !== false ? 'Visible' : 'Oculta';
            }
            
            const headerSecondaryButtonsCheckbox = document.getElementById(`data-table-show-header-secondary-buttons-${componentId}`);
            if (headerSecondaryButtonsCheckbox) {
              headerSecondaryButtonsCheckbox.checked = currentState.showHeaderSecondaryButtons === true;
            }
            const headerSecondaryButtonsStatus = document.getElementById(`data-table-show-header-secondary-buttons-status-${componentId}`);
            if (headerSecondaryButtonsStatus) {
              headerSecondaryButtonsStatus.textContent = currentState.showHeaderSecondaryButtons === true ? 'Visible' : 'Oculta';
            }
            
            const headerPrimaryButtonCheckbox = document.getElementById(`data-table-show-header-primary-button-${componentId}`);
            if (headerPrimaryButtonCheckbox) {
              headerPrimaryButtonCheckbox.checked = currentState.showHeaderPrimaryButton === true;
            }
            const headerPrimaryButtonStatus = document.getElementById(`data-table-show-header-primary-button-status-${componentId}`);
            if (headerPrimaryButtonStatus) {
              headerPrimaryButtonStatus.textContent = currentState.showHeaderPrimaryButton === true ? 'Visible' : 'Oculta';
            }
            
            // Sincronizar checkboxes de acciones
            const actionCheckboxes = [
              { id: 'showViewSelected', statusId: 'show-view-selected-status' },
              { id: 'showNotifications', statusId: 'show-notifications-status' },
              { id: 'showCopy', statusId: 'show-copy-status' },
              { id: 'showView', statusId: 'show-view-status' },
              { id: 'showEdit', statusId: 'show-edit-status' },
              { id: 'showDownload', statusId: 'show-download-status' },
              { id: 'showDelete', statusId: 'show-delete-status' }
            ];
            
            actionCheckboxes.forEach(({ id, statusId }) => {
              const checkbox = document.getElementById(`data-table-${id}-${componentId}`);
              const status = document.getElementById(`data-table-${statusId}-${componentId}`);
              if (checkbox) {
                checkbox.checked = currentState[id] !== false;
              }
              if (status) {
                status.textContent = currentState[id] !== false ? 'Visible' : 'Oculta';
              }
            });
            
          } catch (error) {
            console.error('âŒ Error creando Data Table:', error);
            preview.innerHTML = `<p style="color: var(--ubits-fg-1-medium); padding: 16px;">Error: ${error.message}</p>`;
          }
        };
        
        // Verificar si el mÃ³dulo ya estÃ¡ cargado
        if (typeof window.createDataTable !== 'undefined') {
          createDataTableInstance();
          return;
        }
        
        // Verificar si ya hay un script cargÃ¡ndose para evitar cargas mÃºltiples
        const existingScript = document.querySelector('script[src*="data-table.umd.js"]');
        if (existingScript && !existingScript.hasAttribute('data-loaded')) {
          console.log(`ğŸ”„ [UPDATE] â³ Script ya se estÃ¡ cargando, esperando...`);
          // Esperar a que el script existente se cargue
          const checkExisting = setInterval(() => {
            if (typeof window.createDataTable !== 'undefined') {
              clearInterval(checkExisting);
              console.log(`ğŸ”„ [UPDATE] âœ… Script existente cargado, creando instancia`);
              createDataTableInstance();
            }
          }, 50);
          return;
        }
        
        // Cargar el mÃ³dulo UMD (con timestamp para evitar cachÃ©)
        console.log(`ğŸ”„ [UPDATE] ğŸ“¦ Cargando mÃ³dulo UMD...`);
        
        // Remover cualquier script anterior para forzar recarga
        const oldScripts = document.querySelectorAll('script[src*="data-table.umd.js"]');
        oldScripts.forEach(oldScript => {
          console.log('ğŸ”„ [UPDATE] ğŸ—‘ï¸ Removiendo script anterior:', oldScript.src);
          oldScript.remove();
        });
        
        const script = document.createElement('script');
        script.src = '../../addons/data-table/dist/data-table.umd.js?v=' + Date.now();
        console.log('ğŸ”„ [UPDATE] ğŸ“¦ Cargando desde:', script.src);
        script.onload = () => {
          script.setAttribute('data-loaded', 'true');
          console.log('âœ… Data Table UMD cargado');
          // Esperar a que el mÃ³dulo estÃ© disponible
          let attempts = 0;
          const maxAttempts = 20;
          const checkModule = setInterval(() => {
            attempts++;
            if (typeof window.createDataTable !== 'undefined') {
              clearInterval(checkModule);
              console.log('âœ… createDataTable disponible');
              createDataTableInstance();
              
              // Agregar listener global para clicks fuera de la tabla para limpiar hover
              const container = document.getElementById(`data-table-container-${componentId}`);
              if (container) {
                // Usar un listener Ãºnico por instancia
                const clickOutsideHandler = (e) => {
                  const target = e.target;
                  const isInsideTable = container.contains(target);
                  console.log('ğŸ–±ï¸ [CLICK OUTSIDE] ========== CLICK DETECTADO ==========');
                  console.log('ğŸ–±ï¸ [CLICK OUTSIDE] Target:', target);
                  console.log('ğŸ–±ï¸ [CLICK OUTSIDE] Â¿Dentro de la tabla?', isInsideTable);
                  
                  if (!isInsideTable) {
                    console.log('ğŸ–±ï¸ [CLICK OUTSIDE] âœ… Click fuera de la tabla detectado');
                    const table = container.querySelector('.ubits-data-table');
                    if (table) {
                      const rows = table.querySelectorAll('.ubits-data-table__row');
                      console.log('ğŸ–±ï¸ [CLICK OUTSIDE] Filas encontradas:', rows.length);
                      
                      rows.forEach((row, index) => {
                        const computedStyle = window.getComputedStyle(row);
                        const bgBefore = computedStyle.backgroundColor;
                        const hasHoverClass = row.classList.contains('ubits-data-table__row--clear-hover');
                        const hasInlineStyle = row.style.backgroundColor;
                        
                        console.log(`ğŸ–±ï¸ [CLICK OUTSIDE] Fila ${index}:`, {
                          bgBefore,
                          hasHoverClass,
                          hasInlineStyle,
                          classes: Array.from(row.classList)
                        });
                        
                        // Limpiar cualquier clase o estilo residual
                        if (hasHoverClass) {
                          row.classList.remove('ubits-data-table__row--clear-hover');
                          console.log(`ğŸ–±ï¸ [CLICK OUTSIDE] âœ… Clase removida de fila ${index}`);
                        }
                        if (hasInlineStyle) {
                          row.style.removeProperty('background-color');
                          const cells = row.querySelectorAll('.ubits-data-table__cell');
                          cells.forEach((cell) => {
                            cell.style.removeProperty('background-color');
                          });
                          console.log(`ğŸ–±ï¸ [CLICK OUTSIDE] âœ… Inline styles removidos de fila ${index}`);
                        }
                        
                        const bgAfter = window.getComputedStyle(row).backgroundColor;
                        console.log(`ğŸ–±ï¸ [CLICK OUTSIDE] Fila ${index} background despuÃ©s:`, bgAfter);
                      });
                    }
                  }
                  console.log('ğŸ–±ï¸ [CLICK OUTSIDE] ========== FIN ==========');
                };
                
                // Agregar listener en fase de captura para que se ejecute antes
                document.addEventListener('click', clickOutsideHandler, true);
                console.log('ğŸ–±ï¸ [CLICK OUTSIDE] âœ… Listener global agregado para limpiar hover');
                
                // Guardar referencia para poder limpiarlo despuÃ©s si es necesario
                container._clickOutsideHandler = clickOutsideHandler;
              }
            } else if (attempts >= maxAttempts) {
              clearInterval(checkModule);
              console.error('âŒ createDataTable no disponible despuÃ©s de', maxAttempts, 'intentos');
              preview.innerHTML = '<p style="color: var(--ubits-fg-1-medium); padding: 16px;">Error: No se pudo cargar el componente Data Table.</p>';
            }
          }, 50);
        };
        script.onerror = () => {
          console.error('âŒ Error cargando data-table.umd.js');
          preview.innerHTML = '<p style="color: var(--ubits-fg-1-medium); padding: 16px;">Error: No se pudo cargar el archivo JavaScript del componente.</p>';
        };
        document.head.appendChild(script);
      };
      
      // FunciÃ³n para renderizar contenido de celdas usando Status Tag de UBITS
      function renderDataTableCell(columnId, rowData) {
        if (columnId === 'select') {
          return '';
        }
        if (columnId === 'name') {
          return rowData.name || '';
        }
        if (columnId === 'avatar') {
          // Columna de avatar eliminada
          return '';
        }
        if (false && columnId === 'avatar-old') {
          // Renderizar Avatar con iniciales y badge (cÃ³digo antiguo)
          const avatarData = rowData.avatar || { initials: rowData.name || 'U', badgeColor: 'gray' };
          if (typeof window.renderAvatar !== 'undefined') {
            try {
              return window.renderAvatar({
                initials: avatarData.initials || rowData.name || 'U',
                size: 'md',
                badgeColor: avatarData.badgeColor || 'gray',
                className: 'ubits-data-table__cell-avatar'
              });
            } catch (e) {
              return `<div class="ubits-avatar ubits-avatar--md">${avatarData.initials || 'U'}</div>`;
            }
          }
          return `<div class="ubits-avatar ubits-avatar--md">${avatarData.initials || 'U'}</div>`;
        }
        if (columnId === 'email') {
          return rowData.email || '';
        }
        if (columnId === 'status') {
          // Usar el componente Status Tag de UBITS
          const statusValue = rowData.status || 'Activo';
          const statusType = statusValue.toLowerCase() === 'activo' ? 'active' : 'not-started';
          // Cargar el mÃ³dulo Status Tag si no estÃ¡ disponible
          if (typeof window.renderStatusTag === 'undefined') {
            // Fallback HTML simple que se actualizarÃ¡ despuÃ©s
            return `<span class="ubits-status-tag" data-status="${statusType}">${statusValue}</span>`;
          }
          // Usar renderStatusTag si estÃ¡ disponible
          try {
            return window.renderStatusTag({
              label: statusValue,
              status: statusType,
              size: 'md'
            });
          } catch (e) {
            return `<span class="ubits-status-tag" data-status="${statusType}">${statusValue}</span>`;
          }
        }
        if (columnId === 'progress') {
          // Renderizar Progress Bar
          const progressValue = rowData.progress || 0;
          if (typeof window.renderProgressBar !== 'undefined') {
            try {
              return window.renderProgressBar({
                size: 'md',
                value: progressValue,
                variant: 'default',
                indicator: `${progressValue}%`
              });
            } catch (e) {
              return `<div class="ubits-progress-bar" style="height: 16px;"><div style="width: ${progressValue}%; background: var(--ubits-accent-brand-static-inverted); height: 100%; border-radius: 1000px;"></div></div>`;
            }
          }
          return `<div class="ubits-progress-bar" style="height: 16px;"><div style="width: ${progressValue}%; background: var(--ubits-accent-brand-static-inverted); height: 100%; border-radius: 1000px;"></div></div>`;
        }
        if (columnId === 'fecha') {
          // Renderizar fecha (formato simple)
          const fecha = rowData.fecha || '';
          return fecha ? new Date(fecha).toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' }) : '';
        }
        if (columnId === 'acciones') {
          // Renderizar botones de acciÃ³n
          const acciones = (rowData.acciones || '').split(',');
          const buttonsHTML = acciones.map(action => {
            const iconMap = {
              'view': 'eye',
              'edit': 'pencil',
              'delete': 'trash',
              'download': 'download'
            };
            const icon = iconMap[action.trim()] || 'ellipsis';
            if (typeof window.renderButton !== 'undefined') {
              try {
                return window.renderButton({
                  variant: 'secondary',
                  size: 'sm',
                  icon: icon,
                  iconOnly: true,
                  attributes: {
                    'aria-label': action.trim(),
                    'data-action': action.trim()
                  }
                });
              } catch (e) {
                return `<button class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" aria-label="${action.trim()}"><i class="far fa-${icon}"></i></button>`;
              }
            }
            return `<button class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" aria-label="${action.trim()}"><i class="far fa-${icon}"></i></button>`;
          }).join('');
          return `<div style="display: flex; gap: 8px; align-items: center;">${buttonsHTML}</div>`;
        }
        return rowData[columnId] || '';
      }
      
      // FunciÃ³n para abrir modal con Data Table - ELIMINADA (versiÃ³n anterior)
      
      // ========================================
      // AVATAR PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Avatar
      const avatarPreviewState = {};
      
      // Inicializar estado del Avatar
      function initAvatarPreviewState(componentId) {
        if (!avatarPreviewState[componentId]) {
          avatarPreviewState[componentId] = {
            variant: 'photo',
            size: 'md',
            imageUrl: '../assets/images/Profile-image.jpg',
            initials: 'JD',
            icon: 'user',
            badgeColor: null,
            badgeContent: null,
            clickable: false
          };
        }
        return avatarPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Avatar
      function generateAvatarHTML(state, componentId) {
        const { variant, size, imageUrl, initials, icon, badgeColor, badgeContent, clickable } = state;
        
        // Usar renderAvatar si estÃ¡ disponible, sino generar HTML manualmente
        if (typeof window.renderAvatar === 'function') {
          const options = {
            size,
            badgeColor: badgeColor || undefined,
            badgeContent: badgeContent || undefined,
            clickable,
            onClick: clickable ? () => { alert('Avatar clickeado!'); } : undefined
          };
          
          if (variant === 'photo') {
            options.imageUrl = imageUrl;
          } else if (variant === 'initials') {
            options.initials = initials;
          } else {
            options.icon = icon;
          }
          
          return window.renderAvatar(options);
        }
        
        // Fallback: generar HTML manualmente
        const avatarSize = { xs: 20, sm: 28, md: 36, lg: 40 }[size] || 36;
        
        let content = '';
        if (variant === 'photo' && imageUrl) {
          content = `<div class="ubits-avatar-image-container"><img src="${imageUrl}" alt="Avatar" class="ubits-avatar-image" /></div>`;
        } else if (variant === 'initials' && initials) {
          const displayInitials = initials.trim().split(/\s+/).map(w => w[0]).join('').toUpperCase().substring(0, 2);
          content = `<span class="ubits-avatar-initials">${displayInitials}</span>`;
        } else {
          const iconSize = avatarSize - ({ xs: 6, sm: 8, md: 10, lg: 10 }[size] || 10) * 2;
          content = `<i class="far fa-${icon}" style="font-size: ${iconSize}px;"></i>`;
        }
        
        // Badge usando el componente badge existente
        // Siempre usa tamaÃ±o md (10px) independientemente del tamaÃ±o del avatar
        let badgeHTML = '';
        if (badgeColor) {
          const badgeVariant = { green: 'success', red: 'error', blue: 'info', orange: 'warning', gray: 'primary' }[badgeColor] || 'success';
          const badgeType = badgeContent && badgeContent.trim() !== '' ? 'number' : 'dot';
          // Usar renderBadge si estÃ¡ disponible
          if (typeof window.renderBadge === 'function') {
            badgeHTML = window.renderBadge({
              type: badgeType,
              size: 'md', // Siempre 10px
              variant: badgeVariant,
              absolute: true,
              position: 'bottom-right',
              className: 'ubits-avatar-badge-wrapper',
              content: badgeContent || null
            });
          } else {
            // Fallback: generar HTML manualmente
            const badgeContentHTML = badgeType === 'number' && badgeContent ? badgeContent : '';
            badgeHTML = `<span class="ubits-badge ubits-badge--md ${badgeType === 'dot' ? 'ubits-badge--dot' : 'ubits-badge--number'} ubits-badge--${badgeVariant} ubits-badge--absolute ubits-badge--absolute-bottom-right ubits-avatar-badge-wrapper">${badgeContentHTML}</span>`;
          }
        }
        
        const classes = [
          'ubits-avatar',
          `ubits-avatar--${size}`,
          `ubits-avatar--${variant}`
        ].filter(Boolean).join(' ');
        
        const roleAttr = clickable ? 'role="button" tabindex="0"' : '';
        
        return `
          <div class="${classes}" style="width: ${avatarSize}px; height: ${avatarSize}px; min-width: ${avatarSize}px; min-height: ${avatarSize}px;" ${roleAttr} data-variant="${variant}">
            ${content}
            ${badgeHTML}
          </div>
        `.trim();
      }
      
      // FunciÃ³n helper para obtener color del badge
      function getBadgeColor(color) {
        const colors = {
          green: 'var(--ubits-accent-green, #1e8d58)',
          red: 'var(--ubits-accent-red, #e63946)',
          blue: 'var(--ubits-accent-brand-static-inverted, #0c5bef)',
          orange: 'var(--ubits-feedback-warning-border, #ec9907)',
          gray: 'var(--ubits-fg-1-medium, #6b7280)'
        };
        return colors[color] || color;
      }
      
      // FunciÃ³n para actualizar el preview del Avatar
      window.updateAvatarPreview = function(componentId) {
        const state = initAvatarPreviewState(componentId);
        const preview = document.getElementById(`avatar-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Avatar no encontrado:', `avatar-preview-${componentId}`);
          return;
        }
        
        const avatarHTML = generateAvatarHTML(state, componentId);
        preview.innerHTML = avatarHTML;
        
        // Cargar CSS si no estÃ¡ cargado
        const existingAvatarLink = document.querySelector('link[href*="avatar.css"]');
        if (!existingAvatarLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/avatar/src/styles/avatar.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del badge si no estÃ¡ cargado
        const existingBadgeLink = document.querySelector('link[href*="badge.css"]');
        if (!existingBadgeLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/badge/src/styles/badge.css';
          document.head.appendChild(link);
        }
        
        // Cargar script si no estÃ¡ cargado
        const existingScript = document.querySelector('script[src*="AvatarProvider"]');
        if (!existingScript && typeof window.renderAvatar === 'undefined') {
          const script = document.createElement('script');
          script.type = 'module';
          script.src = '../../addons/avatar/src/AvatarProvider.ts';
          document.head.appendChild(script);
        }
        
        // Agregar event listener si es clickeable
        if (state.clickable) {
          const avatar = preview.querySelector('.ubits-avatar');
          if (avatar) {
            avatar.addEventListener('click', () => {
              alert('Avatar clickeado!');
            });
          }
        }
        
        console.log('âœ… Avatar preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Avatar
      window.setAvatarControl = function(option, value, componentId) {
        const state = initAvatarPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'variant') {
          state.variant = value;
          // Mostrar/ocultar controles segÃºn la variante
          const imageUrlContainer = document.getElementById(`avatar-image-url-container-${componentId}`);
          const initialsContainer = document.getElementById(`avatar-initials-container-${componentId}`);
          const iconContainer = document.getElementById(`avatar-icon-container-${componentId}`);
          
          if (imageUrlContainer) imageUrlContainer.style.display = value === 'photo' ? 'block' : 'none';
          if (initialsContainer) initialsContainer.style.display = value === 'initials' ? 'block' : 'none';
          if (iconContainer) iconContainer.style.display = value === 'icon' ? 'block' : 'none';
        } else if (option === 'size') {
          state.size = value;
        } else if (option === 'imageUrl') {
          state.imageUrl = value;
        } else if (option === 'initials') {
          state.initials = value;
        } else if (option === 'icon') {
          state.icon = value;
        } else if (option === 'badgeColor') {
          state.badgeColor = value || null;
          // Mostrar/ocultar control de contenido del badge
          const badgeContentContainer = document.getElementById(`avatar-badge-content-container-${componentId}`);
          if (badgeContentContainer) {
            badgeContentContainer.style.display = value ? 'block' : 'none';
          }
          // Limpiar contenido si se desactiva el badge
          if (!value) {
            state.badgeContent = null;
            const badgeContentInput = document.getElementById(`avatar-badge-content-input-${componentId}`);
            if (badgeContentInput) {
              badgeContentInput.value = '';
            }
          }
        } else if (option === 'badgeContent') {
          state.badgeContent = value && value.trim() !== '' ? value : null;
        } else if (option === 'clickable') {
          state.clickable = value;
          // Actualizar toggle
          const clickableToggle = document.getElementById(`avatar-clickable-toggle-${componentId}`);
          const clickableStatus = document.getElementById(`avatar-clickable-status-${componentId}`);
          if (clickableToggle && clickableStatus) {
            clickableToggle.checked = value;
            clickableStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        updateAvatarPreview(componentId);
      };
      
      // ========================================
      // DRAWER NAVIGATION PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Drawer
      const drawerPreviewState = {};
      const drawerInstances = {}; // Guardar instancias de drawer por componentId
      
      // Inicializar estado del Drawer
      function initDrawerPreviewState(componentId) {
        if (!drawerPreviewState[componentId]) {
          drawerPreviewState[componentId] = {
            title: 'Crear dato demogrÃ¡fico',
            complementaryText: '',
            width: 40,
            bodyContent: `
              <div style="padding: 16px;">
                <div style="margin-bottom: 16px;">
                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px;">Pregunta</label>
                  <textarea placeholder="Escribe tu pregunta aquÃ­..." style="width: 100%; min-height: 100px; padding: var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background-color: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-sm-size); line-height: var(--font-body-sm-line); resize: vertical; box-sizing: border-box;"></textarea>
                </div>
                <div class="ubits-alert ubits-alert--info" style="margin-bottom: 16px;">
                  <div class="ubits-alert__icon">
                    <i class="far fa-info-circle"></i>
                  </div>
                  <div class="ubits-alert__content">
                    <div class="ubits-alert__text">Debes tener al menos dos opciones de respuesta</div>
                  </div>
                </div>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <span style="font-size: var(--font-body-sm-size, 13px); color: var(--ubits-fg-1-medium); min-width: 20px;">1</span>
                    <input type="text" placeholder="Label" style="flex: 1; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background-color: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-sm-size); line-height: var(--font-body-sm-line); box-sizing: border-box;">
                    <button style="padding: 8px; border: none; background: transparent; color: var(--ubits-fg-1-medium); cursor: pointer; border-radius: 4px;">
                      <i class="far fa-trash"></i>
                    </button>
                  </div>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <span style="font-size: var(--font-body-sm-size, 13px); color: var(--ubits-fg-1-medium); min-width: 20px;">2</span>
                    <input type="text" placeholder="Label" style="flex: 1; padding: var(--ubits-spacing-sm) var(--ubits-spacing-md); border: 1px solid var(--ubits-border-1); border-radius: var(--ubits-border-radius-md); background-color: var(--ubits-bg-1); color: var(--ubits-fg-1-high); font-family: var(--font-sans); font-size: var(--font-body-sm-size); line-height: var(--font-body-sm-line); box-sizing: border-box;">
                    <button style="padding: 8px; border: none; background: transparent; color: var(--ubits-fg-1-medium); cursor: pointer; border-radius: 4px;">
                      <i class="far fa-trash"></i>
                    </button>
                  </div>
                </div>
                <button style="margin-top: 16px; padding: 10px 12px; border: 1px dashed var(--ubits-border-1); background: transparent; border-radius: 8px; color: var(--ubits-fg-1-medium); font-family: var(--font-sans); font-size: var(--font-body-sm-size, 13px); cursor: pointer; display: flex; align-items: center; gap: 8px; width: 100%;">
                  <i class="far fa-plus"></i>
                  <span>AÃ±adir opciÃ³n de respuesta</span>
                </button>
              </div>
            `,
            tertiaryEnabled: true,
            tertiaryLabel: 'Cancelar',
            secondaryEnabled: true,
            secondaryLabel: 'Guardar',
            primaryEnabled: true,
            primaryLabel: 'Crear',
            isOpen: false
          };
        }
        return drawerPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Drawer manualmente
      function generateDrawerHTML(state, componentId) {
        const drawerWidth = { 100: '100%', 80: '80%', 60: '60%', 50: '50%', 40: '40%', 30: '30%' }[state.width] || '40%';
        const drawerWidthClass = `ubits-drawer--width-${state.width}`;
        
        const headerHTML = `
          <div class="ubits-drawer__header">
            <div class="ubits-drawer__header-text">
              <div class="ubits-drawer__header-title">
                <p class="ubits-heading-h2">${state.title}</p>
              </div>
              ${state.complementaryText ? `
              <div class="ubits-drawer__header-complementary">
                <p class="ubits-body-sm-regular">${state.complementaryText}</p>
              </div>
              ` : ''}
            </div>
            ${typeof window.renderButton !== 'undefined' ? window.renderButton({
              variant: 'secondary',
              size: 'md',
              icon: 'fa-times',
              iconOnly: true,
              className: 'ubits-drawer__close'
            }) : '<button class="ubits-drawer__close ubits-button ubits-button--secondary ubits-button--md ubits-button--icon-only" aria-label="Cerrar drawer" type="button"><i class="far fa-times"></i></button>'}
          </div>
        `;
        
        const bodyHTML = `
          <div class="ubits-drawer__body">
            <div class="ubits-drawer__body-content">
              ${state.bodyContent}
            </div>
            <div class="ubits-drawer__scrollbar">
              <div class="ubits-drawer__scrollbar-bar"></div>
            </div>
          </div>
        `;
        
        const footerHTML = (state.tertiaryEnabled || state.secondaryEnabled || state.primaryEnabled) ? `
          <div class="ubits-drawer__footer">
            <div class="ubits-drawer__footer-actions">
              ${state.tertiaryEnabled ? `
              <div class="ubits-drawer__footer-left">
                <button class="ubits-button ubits-button--tertiary ubits-button--md ubits-drawer__footer-button" type="button">
                  <span>${state.tertiaryLabel}</span>
                </button>
              </div>
              ` : ''}
              <div class="ubits-drawer__footer-right">
                ${state.secondaryEnabled ? `
                <button class="ubits-button ubits-button--secondary ubits-button--md ubits-drawer__footer-button" type="button">
                  <span>${state.secondaryLabel}</span>
                </button>
                ` : ''}
                ${state.primaryEnabled ? `
                <button class="ubits-button ubits-button--primary ubits-button--md ubits-drawer__footer-button" type="button">
                  <span>${state.primaryLabel}</span>
                </button>
                ` : ''}
              </div>
            </div>
          </div>
        ` : '';
        
        return `
          <div class="ubits-drawer-overlay">
            <div class="ubits-drawer ${drawerWidthClass}">
              ${headerHTML}
              ${bodyHTML}
              ${footerHTML}
            </div>
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Drawer
      window.updateDrawerPreview = function(componentId) {
        const state = initDrawerPreviewState(componentId);
        const container = document.getElementById(`drawer-preview-container-${componentId}`);
        
        if (!container) {
          console.error('âŒ Preview container de Drawer no encontrado:', `drawer-preview-container-${componentId}`);
          return;
        }
        
        // Limpiar drawer anterior si existe
        if (drawerInstances[componentId] && drawerInstances[componentId].element) {
          drawerInstances[componentId].element.remove();
          drawerInstances[componentId] = null;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const existingDrawerLink = document.querySelector('link[href*="drawer.css"]');
        if (!existingDrawerLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/drawer/src/styles/drawer.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del button si no estÃ¡ cargado (para los botones del footer)
        const existingButtonLink = document.querySelector('link[href*="button.css"]');
        if (!existingButtonLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del alert si no estÃ¡ cargado (para la notificaciÃ³n inline)
        const existingAlertLink = document.querySelector('link[href*="alert.css"]');
        if (!existingAlertLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/alert/src/styles/alert.css';
          document.head.appendChild(link);
        }
        
        // Generar HTML del drawer manualmente
        const drawerHTML = generateDrawerHTML(state, componentId);
        
        // Crear wrapper temporal para parsear el HTML
        const wrapper = document.createElement('div');
        wrapper.innerHTML = drawerHTML;
        const drawerOverlay = wrapper.firstElementChild;
        
        if (!drawerOverlay) {
          console.error('âŒ No se pudo crear el drawer');
          return;
        }
        
        // AÃ±adir el overlay al body, no al contenedor del preview
        document.body.appendChild(drawerOverlay);
        
        const drawer = drawerOverlay.querySelector('.ubits-drawer');
        const closeButton = drawerOverlay.querySelector('.ubits-drawer__close');
        
        if (!drawer) {
          console.error('âŒ No se pudo encontrar el drawer');
          return;
        }
        
        // Funciones de control
        const openDrawer = () => {
          drawerOverlay.classList.add('ubits-drawer-overlay--open');
          document.body.style.overflow = 'hidden';
          state.isOpen = true;
          const toggleButton = document.getElementById(`drawer-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Cerrar Drawer';
          }
        };
        
        const closeDrawer = () => {
          drawerOverlay.classList.remove('ubits-drawer-overlay--open');
          document.body.style.overflow = '';
          state.isOpen = false;
          const toggleButton = document.getElementById(`drawer-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Abrir Drawer';
          }
        };
        
        // Event listeners
        if (closeButton) {
          closeButton.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            closeDrawer();
          });
        }
        
        if (drawerOverlay) {
          drawerOverlay.addEventListener('click', (e) => {
            if (e.target === drawerOverlay) {
              closeDrawer();
            }
          });
        }
        
        // Cerrar con ESC
        const handleEsc = (e) => {
          if (e.key === 'Escape' && drawerOverlay.classList.contains('ubits-drawer-overlay--open')) {
            closeDrawer();
          }
        };
        document.addEventListener('keydown', handleEsc);
        
        // Guardar referencia al handler para poder removerlo despuÃ©s
        drawerOverlay.__escHandler = handleEsc;
        
        // Agregar event listeners a los botones del footer
        if (state.tertiaryEnabled) {
          const tertiaryButton = drawerOverlay.querySelector('.ubits-drawer__footer-left .ubits-drawer__footer-button');
          if (tertiaryButton) {
            tertiaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Tertiary clickeado');
            });
          }
        }
        
        if (state.secondaryEnabled) {
          const secondaryButton = drawerOverlay.querySelector('.ubits-drawer__footer-right .ubits-button--secondary');
          if (secondaryButton) {
            secondaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Secondary clickeado');
            });
          }
        }
        
        if (state.primaryEnabled) {
          const primaryButton = drawerOverlay.querySelector('.ubits-drawer__footer-right .ubits-button--primary');
          if (primaryButton) {
            primaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Primary clickeado');
            });
          }
        }
        
        // Guardar instancia
        drawerInstances[componentId] = {
          element: drawerOverlay,
          open: openDrawer,
          close: closeDrawer,
          updateContent: (content) => {
            const bodyContentElement = drawerOverlay.querySelector('.ubits-drawer__body-content');
            if (bodyContentElement) {
              const contentHTML = typeof content === 'function' ? content() : content;
              bodyContentElement.innerHTML = contentHTML;
            }
          }
        };
        
        // Abrir si estÃ¡ configurado para abrirse inicialmente
        if (state.isOpen) {
          openDrawer();
        }
        
        // Actualizar estado del botÃ³n toggle
        const toggleButton = document.getElementById(`drawer-toggle-button-text-${componentId}`);
        if (toggleButton) {
          toggleButton.textContent = state.isOpen ? 'Cerrar Drawer' : 'Abrir Drawer';
        }
      };
      
      // FunciÃ³n unificada para controles del Drawer
      window.setDrawerControl = function(option, value, componentId) {
        const state = initDrawerPreviewState(componentId);
        
        if (option === 'title') {
          state.title = value;
        } else if (option === 'complementaryText') {
          state.complementaryText = value;
        } else if (option === 'width') {
          state.width = value;
        } else if (option === 'tertiaryLabel') {
          state.tertiaryLabel = value;
        } else if (option === 'tertiaryEnabled') {
          state.tertiaryEnabled = value;
        } else if (option === 'secondaryLabel') {
          state.secondaryLabel = value;
        } else if (option === 'secondaryEnabled') {
          state.secondaryEnabled = value;
        } else if (option === 'primaryLabel') {
          state.primaryLabel = value;
        } else if (option === 'primaryEnabled') {
          state.primaryEnabled = value;
        }
        
        // Actualizar drawer si existe, o recrearlo si cambiÃ³ algo importante
        const drawerInstance = drawerInstances[componentId];
        const wasOpen = drawerInstance && state.isOpen;
        
        // Recrear drawer con nuevas opciones
        window.updateDrawerPreview(componentId);
        
        // Si estaba abierto, abrirlo de nuevo
        if (wasOpen) {
          setTimeout(() => {
            const newInstance = drawerInstances[componentId];
            if (newInstance) {
              newInstance.open();
            }
          }, 50);
        }
      };
      
      // FunciÃ³n para toggle del drawer
      window.toggleDrawer = function(componentId) {
        const state = initDrawerPreviewState(componentId);
        const drawerInstance = drawerInstances[componentId];
        
        if (drawerInstance && drawerInstance.open && drawerInstance.close) {
          if (state.isOpen) {
            drawerInstance.close();
            state.isOpen = false;
          } else {
            drawerInstance.open();
            state.isOpen = true;
          }
          
          const toggleButton = document.getElementById(`drawer-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = state.isOpen ? 'Cerrar Drawer' : 'Abrir Drawer';
          }
        } else {
          // Si no existe, crear y abrir
          state.isOpen = true;
          window.updateDrawerPreview(componentId);
          setTimeout(() => {
            const instance = drawerInstances[componentId];
            if (instance && instance.open) {
              instance.open();
            }
          }, 100);
        }
      };
      
      // ========================================
      // MODAL PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Modal
      const modalPreviewState = {};
      const modalInstances = {}; // Guardar instancias de modal por componentId
      
      // Inicializar estado del Modal
      function initModalPreviewState(componentId) {
        if (!modalPreviewState[componentId]) {
          modalPreviewState[componentId] = {
            title: 'TÃ­tulo del modal',
            size: 'md',
            fullScreen: false,
            bodyContent: `
              <div style="padding: 16px;">
                <p style="margin: 0; font-size: var(--font-body-md-size, 16px); color: var(--ubits-fg-1-high); line-height: var(--font-body-md-line-height, 24px);">
                  Este es el contenido del modal. Puedes agregar cualquier contenido HTML aquÃ­, como formularios, texto, imÃ¡genes, etc.
                </p>
              </div>
            `,
            tertiaryEnabled: true,
            tertiaryLabel: 'Cancelar',
            secondaryEnabled: true,
            secondaryLabel: 'Guardar',
            primaryEnabled: true,
            primaryLabel: 'Aplicar',
            isOpen: false
          };
        }
        return modalPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Modal manualmente
      function generateModalHTML(state, componentId) {
        const modalSizes = { sm: '320px', md: '480px', lg: '640px', xl: '800px', full: '1280px' };
        const modalWidth = modalSizes[state.size] || modalSizes.md;
        const modalSizeClass = `ubits-modal--size-${state.size}`;
        const fullScreenClass = state.fullScreen ? 'ubits-modal--full-screen' : '';
        
        const headerHTML = `
          <div class="ubits-modal__header">
            <div class="ubits-modal__header-text">
              <div class="ubits-modal__header-title">
                <p class="ubits-heading-h2">${state.title}</p>
              </div>
            </div>
            <button class="ubits-modal__close" aria-label="Cerrar modal" type="button">
              <i class="far fa-times"></i>
            </button>
          </div>
        `;
        
        const bodyHTML = `
          <div class="ubits-modal__body">
            <div class="ubits-modal__body-content">
              ${state.bodyContent}
            </div>
            <div class="ubits-modal__scrollbar">
              <div class="ubits-modal__scrollbar-bar"></div>
            </div>
          </div>
        `;
        
        const footerHTML = (state.tertiaryEnabled || state.secondaryEnabled || state.primaryEnabled) ? `
          <div class="ubits-modal__footer">
            <div class="ubits-modal__footer-actions">
              ${state.tertiaryEnabled ? `
              <div class="ubits-modal__footer-left">
                <button class="ubits-button ubits-button--tertiary ubits-button--md ubits-modal__footer-button" type="button">
                  <span>${state.tertiaryLabel}</span>
                </button>
              </div>
              ` : ''}
              <div class="ubits-modal__footer-right">
                ${state.secondaryEnabled ? `
                <button class="ubits-button ubits-button--secondary ubits-button--md ubits-modal__footer-button" type="button">
                  <span>${state.secondaryLabel}</span>
                </button>
                ` : ''}
                ${state.primaryEnabled ? `
                <button class="ubits-button ubits-button--primary ubits-button--md ubits-modal__footer-button" type="button">
                  <span>${state.primaryLabel}</span>
                </button>
                ` : ''}
              </div>
            </div>
          </div>
        ` : '';
        
        return `
          <div class="ubits-modal-overlay">
            <div class="ubits-modal ${modalSizeClass} ${fullScreenClass}" style="max-width: ${modalWidth};">
              ${headerHTML}
              ${bodyHTML}
              ${footerHTML}
            </div>
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Modal
      window.updateModalPreview = function(componentId) {
        const state = initModalPreviewState(componentId);
        const container = document.getElementById(`modal-preview-container-${componentId}`);
        
        if (!container) {
          console.error('âŒ Preview container de Modal no encontrado:', `modal-preview-container-${componentId}`);
          return;
        }
        
        // Limpiar modal anterior si existe
        if (modalInstances[componentId] && modalInstances[componentId].element) {
          modalInstances[componentId].element.remove();
          modalInstances[componentId] = null;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const existingModalLink = document.querySelector('link[href*="modal.css"]');
        if (!existingModalLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/modal/src/styles/modal.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del button si no estÃ¡ cargado (para los botones del footer)
        const existingButtonLink = document.querySelector('link[href*="button.css"]');
        if (!existingButtonLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Generar HTML del modal manualmente
        const modalHTML = generateModalHTML(state, componentId);
        
        // Crear wrapper temporal para parsear el HTML
        const wrapper = document.createElement('div');
        wrapper.innerHTML = modalHTML;
        const modalOverlay = wrapper.firstElementChild;
        
        if (!modalOverlay) {
          console.error('âŒ No se pudo crear el modal');
          return;
        }
        
        // AÃ±adir el overlay al body, no al contenedor del preview
        document.body.appendChild(modalOverlay);
        
        const modal = modalOverlay.querySelector('.ubits-modal');
        const closeButton = modalOverlay.querySelector('.ubits-modal__close');
        
        if (!modal) {
          console.error('âŒ No se pudo encontrar el modal');
          return;
        }
        
        // Funciones de control
        const openModal = () => {
          modalOverlay.classList.add('ubits-modal-overlay--open');
          document.body.style.overflow = 'hidden';
          state.isOpen = true;
          const toggleButton = document.getElementById(`modal-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Cerrar Modal';
          }
        };
        
        const closeModal = () => {
          modalOverlay.classList.remove('ubits-modal-overlay--open');
          document.body.style.overflow = '';
          state.isOpen = false;
          const toggleButton = document.getElementById(`modal-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Abrir Modal';
          }
        };
        
        // Event listeners
        if (closeButton) {
          closeButton.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            closeModal();
          });
        }
        
        if (modalOverlay) {
          modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
              closeModal();
            }
          });
        }
        
        // Cerrar con ESC
        const handleEsc = (e) => {
          if (e.key === 'Escape' && modalOverlay.classList.contains('ubits-modal-overlay--open')) {
            closeModal();
          }
        };
        document.addEventListener('keydown', handleEsc);
        
        // Guardar referencia al handler para poder removerlo despuÃ©s
        modalOverlay.__escHandler = handleEsc;
        
        // Agregar event listeners a los botones del footer
        if (state.tertiaryEnabled) {
          const tertiaryButton = modalOverlay.querySelector('.ubits-modal__footer-left .ubits-modal__footer-button');
          if (tertiaryButton) {
            tertiaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Tertiary clickeado');
            });
          }
        }
        
        if (state.secondaryEnabled) {
          const secondaryButton = modalOverlay.querySelector('.ubits-modal__footer-right .ubits-button--secondary');
          if (secondaryButton) {
            secondaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Secondary clickeado');
            });
          }
        }
        
        if (state.primaryEnabled) {
          const primaryButton = modalOverlay.querySelector('.ubits-modal__footer-right .ubits-button--primary');
          if (primaryButton) {
            primaryButton.addEventListener('click', () => {
              console.log('BotÃ³n Primary clickeado');
            });
          }
        }
        
        // Guardar instancia
        modalInstances[componentId] = {
          element: modalOverlay,
          open: openModal,
          close: closeModal,
          updateContent: (content) => {
            const bodyContentElement = modalOverlay.querySelector('.ubits-modal__body-content');
            if (bodyContentElement) {
              const contentHTML = typeof content === 'function' ? content() : content;
              bodyContentElement.innerHTML = contentHTML;
            }
          }
        };
        
        // Abrir si estÃ¡ configurado para abrirse inicialmente
        if (state.isOpen) {
          openModal();
        }
        
        // Actualizar estado del botÃ³n toggle
        const toggleButton = document.getElementById(`modal-toggle-button-text-${componentId}`);
        if (toggleButton) {
          toggleButton.textContent = state.isOpen ? 'Cerrar Modal' : 'Abrir Modal';
        }
      };
      
      // FunciÃ³n unificada para controles del Modal
      window.setModalControl = function(option, value, componentId) {
        const state = initModalPreviewState(componentId);
        
        if (option === 'title') {
          state.title = value;
        } else if (option === 'size') {
          state.size = value;
        } else if (option === 'fullScreen') {
          state.fullScreen = value;
        } else if (option === 'tertiaryLabel') {
          state.tertiaryLabel = value;
        } else if (option === 'tertiaryEnabled') {
          state.tertiaryEnabled = value;
        } else if (option === 'secondaryLabel') {
          state.secondaryLabel = value;
        } else if (option === 'secondaryEnabled') {
          state.secondaryEnabled = value;
        } else if (option === 'primaryLabel') {
          state.primaryLabel = value;
        } else if (option === 'primaryEnabled') {
          state.primaryEnabled = value;
        }
        
        // Actualizar modal si existe, o recrearlo si cambiÃ³ algo importante
        const modalInstance = modalInstances[componentId];
        const wasOpen = modalInstance && state.isOpen;
        
        // Recrear modal con nuevas opciones
        window.updateModalPreview(componentId);
        
        // Si estaba abierto, abrirlo de nuevo
        if (wasOpen) {
          setTimeout(() => {
            const newInstance = modalInstances[componentId];
            if (newInstance) {
              newInstance.open();
            }
          }, 50);
        }
      };
      
      // FunciÃ³n para toggle del modal
      window.toggleModal = function(componentId) {
        const state = initModalPreviewState(componentId);
        const modalInstance = modalInstances[componentId];
        
        if (modalInstance && modalInstance.open && modalInstance.close) {
          if (state.isOpen) {
            modalInstance.close();
            state.isOpen = false;
          } else {
            modalInstance.open();
            state.isOpen = true;
          }
          
          const toggleButton = document.getElementById(`modal-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = state.isOpen ? 'Cerrar Modal' : 'Abrir Modal';
          }
        } else {
          // Si no existe, crear y abrir
          state.isOpen = true;
          window.updateModalPreview(componentId);
          setTimeout(() => {
            const instance = modalInstances[componentId];
            if (instance && instance.open) {
              instance.open();
            }
          }, 100);
        }
      };
      
      // ========================================
      // POPOVER PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Popover
      const popoverPreviewState = {};
      const popoverInstances = {}; // Guardar instancias de popover por componentId
      
      // Inicializar estado del Popover
      function initPopoverPreviewState(componentId) {
        if (!popoverPreviewState[componentId]) {
          popoverPreviewState[componentId] = {
            title: 'Title',
            width: 'md',
            tailPosition: 'top',
            bodyContent: `
              <p style="margin: 0; font-size: var(--font-body-sm-size, 13px); color: var(--ubits-fg-1-high-static-inverted, #edeeef); line-height: var(--ubits-line-height-md, 19.5px);">
                Tooltips are used to describe or identify an element. In most scenarios, tooltips help the user understand the meaning, function or alt-text of an element.
              </p>
            `,
            tertiaryEnabled: true,
            tertiaryLabel: 'Tertiary',
            secondaryEnabled: true,
            secondaryLabel: 'Secondary',
            primaryEnabled: true,
            primaryLabel: 'Primary',
            isOpen: false
          };
        }
        return popoverPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Popover manualmente
      function generatePopoverHTML(state, componentId) {
        const popoverWidths = { sm: '240px', md: '360px', lg: '400px', xl: '480px' };
        const popoverWidth = popoverWidths[state.width] || popoverWidths.md;
        const popoverWidthClass = `ubits-popover--width-${state.width}`;
        const tailPositionClass = `ubits-popover--tail-${state.tailPosition}`;
        
        const tailHTML = `
          <div class="ubits-popover__tail" style="${state.tailPosition === 'top' || state.tailPosition === 'bottom' ? `left: ${state.tailOffset ? `calc(50% + ${state.tailOffset}px)` : '50%'};` : `top: ${state.tailOffset ? `calc(50% + ${state.tailOffset}px)` : '50%'};`}">
            <div class="ubits-popover__tail-inner"></div>
          </div>
        `;
        
        const headerHTML = state.title ? `
          <div class="ubits-popover__header">
            <div class="ubits-popover__header-title">
              <p class="ubits-body-md-semibold">${state.title}</p>
            </div>
          </div>
        ` : '';
        
        const bodyHTML = `
          <div class="ubits-popover__body">
            <div class="ubits-popover__body-content">
              ${state.bodyContent}
            </div>
            <div class="ubits-popover__scrollbar">
              <div class="ubits-popover__scrollbar-bar"></div>
            </div>
          </div>
        `;
        
        const footerHTML = (state.tertiaryEnabled || state.secondaryEnabled || state.primaryEnabled) ? `
          <div class="ubits-popover__footer">
            <div class="ubits-popover__footer-actions${!state.tertiaryEnabled ? ' ubits-popover__footer-actions--no-tertiary' : ''}">
              ${state.tertiaryEnabled ? `
              <div class="ubits-popover__footer-left">
                <button class="ubits-button ubits-button--tertiary ubits-button--md ubits-popover__footer-button" type="button">
                  <span>${state.tertiaryLabel}</span>
                </button>
              </div>
              ` : ''}
              <div class="ubits-popover__footer-right">
                ${state.secondaryEnabled ? `
                <button class="ubits-button ubits-button--secondary ubits-button--md ubits-popover__footer-button" type="button">
                  <span>${state.secondaryLabel}</span>
                </button>
                ` : ''}
                ${state.primaryEnabled ? `
                <button class="ubits-button ubits-button--primary ubits-button--md ubits-popover__footer-button" type="button">
                  <span>${state.primaryLabel}</span>
                </button>
                ` : ''}
              </div>
            </div>
          </div>
        ` : '';
        
        return `
          <div class="ubits-popover ${popoverWidthClass} ${tailPositionClass}" style="width: ${popoverWidth}; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
            ${tailHTML}
            <div class="ubits-popover__content">
              ${headerHTML}
              ${bodyHTML}
              ${footerHTML}
            </div>
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Popover
      window.updatePopoverPreview = function(componentId) {
        const state = initPopoverPreviewState(componentId);
        const container = document.getElementById(`popover-preview-container-${componentId}`);
        
        if (!container) {
          console.error('âŒ Preview container de Popover no encontrado:', `popover-preview-container-${componentId}`);
          return;
        }
        
        // Limpiar popover anterior si existe
        if (popoverInstances[componentId] && popoverInstances[componentId].element) {
          popoverInstances[componentId].element.remove();
          popoverInstances[componentId] = null;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const existingPopoverLink = document.querySelector('link[href*="popover.css"]');
        if (!existingPopoverLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/popover/src/styles/popover.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del button si no estÃ¡ cargado (para los botones del footer)
        const existingButtonLink = document.querySelector('link[href*="button.css"]');
        if (!existingButtonLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Generar HTML del popover manualmente
        const popoverHTML = generatePopoverHTML(state, componentId);
        
        // Crear wrapper temporal para parsear el HTML
        const wrapper = document.createElement('div');
        wrapper.innerHTML = popoverHTML;
        const popover = wrapper.firstElementChild;
        
        if (!popover) {
          console.error('âŒ No se pudo crear el popover');
          return;
        }
        
        // AÃ±adir el popover al contenedor del preview
        container.appendChild(popover);
        
        console.log('âœ… Popover agregado al DOM:', popover);
        console.log('âœ… Clases del popover:', popover.className);
        console.log('âœ… Estilos del popover:', popover.style.cssText);
        
        // Funciones de control
        const openPopover = () => {
          if (!popover || !popover.classList) {
            console.error('âŒ Popover element no vÃ¡lido');
            return;
          }
          console.log('ğŸ”µ Abriendo popover, agregando clase ubits-popover--open');
          popover.classList.add('ubits-popover--open');
          state.isOpen = true;
          const toggleButton = document.getElementById(`popover-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Cerrar Popover';
          }
          console.log('âœ… Popover abierto, clases:', popover.className);
          console.log('âœ… Estilos despuÃ©s de abrir:', window.getComputedStyle(popover).opacity, window.getComputedStyle(popover).visibility);
        };
        
        const closePopover = () => {
          if (!popover || !popover.classList) {
            console.error('âŒ Popover element no vÃ¡lido');
            return;
          }
          console.log('ğŸ”µ Cerrando popover, removiendo clase ubits-popover--open');
          popover.classList.remove('ubits-popover--open');
          state.isOpen = false;
          const toggleButton = document.getElementById(`popover-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Abrir Popover';
          }
        };
        
        // Guardar instancia
        popoverInstances[componentId] = {
          element: popover,
          open: openPopover,
          close: closePopover
        };
        
        console.log('âœ… Popover creado y guardado en instancia:', componentId);
      };
      
      // FunciÃ³n para toggle del Popover
      window.togglePopoverComponent = function(componentId) {
        console.log('ğŸ”µ togglePopoverComponent llamado con componentId:', componentId);
        const state = initPopoverPreviewState(componentId);
        let instance = popoverInstances[componentId];
        
        console.log('ğŸ”µ Estado actual:', { isOpen: state.isOpen, instanceExists: !!instance });
        
        if (!instance || !instance.element || !instance.element.parentElement) {
          console.log('ğŸ”µ No existe instancia, creando...');
          // Si no existe o fue removido, crear primero
          window.updatePopoverPreview(componentId);
          // Esperar a que se cree y luego abrir
          setTimeout(() => {
            instance = popoverInstances[componentId];
            console.log('ğŸ”µ Instancia despuÃ©s de crear:', instance);
            if (instance && instance.open) {
              console.log('ğŸ”µ Abriendo popover...');
              instance.open();
            } else {
              console.error('âŒ No se pudo crear o abrir el popover');
            }
          }, 100);
          return;
        }
        
        console.log('ğŸ”µ Toggleando estado:', state.isOpen ? 'cerrar' : 'abrir');
        if (state.isOpen) {
          instance.close();
        } else {
          instance.open();
        }
      };
      
      // FunciÃ³n unificada para controles del Popover
      window.setPopoverControl = function(option, value, componentId) {
        const state = initPopoverPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'title') {
          state.title = value;
        } else if (option === 'width') {
          state.width = value;
        } else if (option === 'tailPosition') {
          state.tailPosition = value;
        } else if (option === 'tertiaryLabel') {
          state.tertiaryLabel = value;
        } else if (option === 'tertiaryEnabled') {
          state.tertiaryEnabled = value;
        } else if (option === 'secondaryLabel') {
          state.secondaryLabel = value;
        } else if (option === 'secondaryEnabled') {
          state.secondaryEnabled = value;
        } else if (option === 'primaryLabel') {
          state.primaryLabel = value;
        } else if (option === 'primaryEnabled') {
          state.primaryEnabled = value;
        }
        
        // Actualizar preview
        window.updatePopoverPreview(componentId);
        
        // Si estaba abierto, mantenerlo abierto
        if (state.isOpen && popoverInstances[componentId]) {
          setTimeout(() => {
            const instance = popoverInstances[componentId];
            if (instance && instance.open) {
              instance.open();
            }
          }, 50);
        }
      };
      
      // ========================================
      // TOOLTIP PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Tooltip
      const tooltipPreviewState = {};
      const tooltipInstances = {};
      
      // Inicializar estado del Tooltip
      function initTooltipPreviewState(componentId) {
        if (!tooltipPreviewState[componentId]) {
          tooltipPreviewState[componentId] = {
            title: 'TÃ­tulo del tooltip',
            showTitle: true,
            description: 'DescripciÃ³n del tooltip que proporciona informaciÃ³n adicional al usuario.',
            showDescription: true,
            width: 'md',
            tailPosition: 'top',
            tailOffset: 0,
            primaryButtonLabel: 'Aceptar',
            showPrimaryButton: false,
            primaryButtonIcon: 'check',
            showPrimaryButtonIcon: false,
            secondaryButtonLabel: 'Cancelar',
            showSecondaryButton: false,
            secondaryButtonIcon: 'times',
            showSecondaryButtonIcon: false,
            tertiaryButtonLabel: 'MÃ¡s info',
            showTertiaryButton: false,
            tertiaryButtonIcon: 'info-circle',
            showTertiaryButtonIcon: false,
            isOpen: false
          };
        }
        return tooltipPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Tooltip manualmente
      function generateTooltipHTML(state, componentId) {
        // Mapear tamaÃ±o del tooltip al tamaÃ±o de los botones
        const buttonSizeMap = {
          sm: 'xs',
          md: 'sm',
          lg: 'md'
        };
        const buttonSize = buttonSizeMap[state.width] || 'sm';
        
        // Calcular cantidad de botones visibles
        const buttonCount = (state.showPrimaryButton ? 1 : 0) + 
                           (state.showSecondaryButton ? 1 : 0) + 
                           (state.showTertiaryButton ? 1 : 0);
        
        // Calcular min-width y max-width segÃºn tamaÃ±o y cantidad de botones
        const baseMinWidths = { sm: 120, md: 160, lg: 200 };
        const baseMaxWidths = { sm: 240, md: 320, lg: 400 };
        let minWidth = baseMinWidths[state.width] || baseMinWidths.md;
        let maxWidth = baseMaxWidths[state.width] || baseMaxWidths.md;
        
        // Si hay botones, aumentar el max-width para que no se corte
        if (buttonCount === 3) {
          maxWidth = Math.max(maxWidth, 420);
        } else if (buttonCount === 2) {
          maxWidth = Math.max(maxWidth, 360);
        }
        
        // Usar min-width y max-width en lugar de width fijo para que se adapte al contenido
        const tooltipWidthStyle = `min-width: ${minWidth}px; max-width: ${maxWidth}px; width: auto;`;
        const tailPositionClass = `ubits-tooltip--tail-${state.tailPosition}`;
        
        // Tail HTML - usar transform para el offset en lugar de left/top para que se adapte al contenedor
        let tailStyle = '';
        if (state.tailOffset) {
          if (state.tailPosition === 'top' || state.tailPosition === 'bottom') {
            tailStyle = `transform: translateX(calc(-50% + ${state.tailOffset}px));`;
          } else {
            tailStyle = `transform: translateY(calc(-50% + ${state.tailOffset}px));`;
          }
        }
        const tailHTML = `
          <div class="ubits-tooltip__tail"${tailStyle ? ` style="${tailStyle}"` : ''}>
            <div class="ubits-tooltip__tail-inner"></div>
          </div>
        `;
        
        const headerHTML = (state.showTitle && state.title) ? `
          <div class="ubits-tooltip__header">
            <div class="ubits-tooltip__header-title">
              <p class="ubits-body-md-semibold">${state.title}</p>
            </div>
          </div>
        ` : '';
        
        const bodyHTML = (state.showDescription && state.description) ? `
          <div class="ubits-tooltip__body">
            <div class="ubits-tooltip__body-content">
              <p class="ubits-body-md">${state.description}</p>
            </div>
          </div>
        ` : '';
        
        // Footer HTML
        let footerHTML = '';
        const hasButtons = state.showPrimaryButton || state.showSecondaryButton || state.showTertiaryButton;
        
        if (hasButtons) {
          // BotÃ³n primario
          let primaryButtonContent = state.primaryButtonLabel || '';
          if (state.showPrimaryButtonIcon && state.primaryButtonIcon) {
            primaryButtonContent = `<i class="far fa-${state.primaryButtonIcon}"></i> ${primaryButtonContent}`;
          }
          const primaryButton = (state.showPrimaryButton && state.primaryButtonLabel) 
            ? `<button class="ubits-button ubits-button--primary ubits-button--${buttonSize} ubits-tooltip__footer-button" data-action="primary" type="button">${primaryButtonContent}</button>`
            : '';

          // BotÃ³n secundario
          let secondaryButtonContent = state.secondaryButtonLabel || '';
          if (state.showSecondaryButtonIcon && state.secondaryButtonIcon) {
            secondaryButtonContent = `<i class="far fa-${state.secondaryButtonIcon}"></i> ${secondaryButtonContent}`;
          }
          const secondaryButton = (state.showSecondaryButton && state.secondaryButtonLabel)
            ? `<button class="ubits-button ubits-button--secondary ubits-button--${buttonSize} ubits-tooltip__footer-button" data-action="secondary" type="button">${secondaryButtonContent}</button>`
            : '';

          // BotÃ³n terciario
          let tertiaryButtonContent = state.tertiaryButtonLabel || '';
          if (state.showTertiaryButtonIcon && state.tertiaryButtonIcon) {
            tertiaryButtonContent = `<i class="far fa-${state.tertiaryButtonIcon}"></i> ${tertiaryButtonContent}`;
          }
          const tertiaryButton = (state.showTertiaryButton && state.tertiaryButtonLabel)
            ? `<button class="ubits-button ubits-button--tertiary ubits-button--${buttonSize} ubits-tooltip__footer-button" data-action="tertiary" type="button">${tertiaryButtonContent}</button>`
            : '';

          footerHTML = `
            <div class="ubits-tooltip__footer">
              <div class="ubits-tooltip__footer-actions${!state.showTertiaryButton ? ' ubits-tooltip__footer-actions--no-tertiary' : ''}">
                ${tertiaryButton ? `
                <div class="ubits-tooltip__footer-left">
                  ${tertiaryButton}
                </div>
                ` : ''}
                <div class="ubits-tooltip__footer-right">
                  ${secondaryButton}
                  ${primaryButton}
                </div>
              </div>
            </div>
          `;
        }
        
        // El tooltip se posiciona con transform para centrarlo
        // Usar min-width y max-width para que se adapte al contenido
        // El tail se posicionarÃ¡ relativo al tooltip usando left: 50% y transform: translateX(-50%)
        const tooltipHTML = `
          <div class="ubits-tooltip ${tailPositionClass}" style="${tooltipWidthStyle} position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;">
            ${tailHTML}
            <div class="ubits-tooltip__content">
              ${headerHTML}
              ${bodyHTML}
              ${footerHTML}
            </div>
          </div>
        `.trim();
        
        console.log('ğŸ“ [generateTooltipHTML] HTML generado:', {
          tooltipWidthStyle: tooltipWidthStyle,
          minWidth: minWidth,
          maxWidth: maxWidth,
          tailPositionClass: tailPositionClass,
          tailHTML: tailHTML,
          fullHTML: tooltipHTML.substring(0, 1000),
          state: {
            tailPosition: state.tailPosition,
            tailOffset: state.tailOffset,
            width: state.width
          }
        });
        
        return tooltipHTML;
      }
      
      // FunciÃ³n para actualizar el preview del Tooltip
      window.updateTooltipPreview = function(componentId) {
        const state = initTooltipPreviewState(componentId);
        const container = document.getElementById(`tooltip-preview-container-${componentId}`);
        
        if (!container) {
          console.error('âŒ Preview container de Tooltip no encontrado:', `tooltip-preview-container-${componentId}`);
          return;
        }
        
        // Limpiar tooltip anterior si existe
        if (tooltipInstances[componentId] && tooltipInstances[componentId].element) {
          tooltipInstances[componentId].element.remove();
          tooltipInstances[componentId] = null;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const existingTooltipLink = document.querySelector('link[href*="tooltip.css"]');
        if (!existingTooltipLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/tooltip/src/styles/tooltip.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS del button si no estÃ¡ cargado (para los botones del footer)
        const existingButtonLink = document.querySelector('link[href*="button.css"]');
        if (!existingButtonLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Generar HTML del tooltip manualmente
        console.log('ğŸš€ [updateTooltipPreview] Generando HTML del tooltip...');
        console.log('ğŸ“Š [updateTooltipPreview] Estado completo:', JSON.stringify(state, null, 2));
        
        const tooltipHTML = generateTooltipHTML(state, componentId);
        
        console.log('âœ… [updateTooltipPreview] HTML generado, parseando...');
        
        // Crear wrapper temporal para parsear el HTML
        const wrapper = document.createElement('div');
        wrapper.innerHTML = tooltipHTML;
        const tooltip = wrapper.firstElementChild;
        
        if (!tooltip) {
          console.error('âŒ [updateTooltipPreview] No se pudo crear el tooltip');
          console.error('âŒ [updateTooltipPreview] HTML generado:', tooltipHTML);
          console.error('âŒ [updateTooltipPreview] Wrapper HTML:', wrapper.innerHTML);
          return;
        }
        
        console.log('âœ… [updateTooltipPreview] Tooltip creado:', {
          tooltip: tooltip,
          tooltipClasses: tooltip.className,
          tooltipStyles: tooltip.style.cssText,
          tooltipHTML: tooltip.outerHTML.substring(0, 500),
          hasTail: !!tooltip.querySelector('.ubits-tooltip__tail')
        });
        
        // AÃ±adir el tooltip al contenedor del preview
        container.appendChild(tooltip);
        
        console.log('âœ… [updateTooltipPreview] Tooltip aÃ±adido al contenedor');
        
        // FunciÃ³n para centrar el tail del tooltip principal
        const centerTooltipTail = () => {
          console.log('ğŸ”§ [Tooltip Main] ========== INICIANDO CENTRADO DE TAIL ==========');
          
          // Logs de estructura completa
          console.log('ğŸ“‹ [Tooltip Main] Estructura del tooltip:', {
            tooltipElement: tooltip,
            tooltipId: tooltip.id,
            tooltipClasses: tooltip.className,
            tooltipStyles: tooltip.style.cssText,
            tooltipHTML: tooltip.outerHTML.substring(0, 500),
            tooltipRect: tooltip.getBoundingClientRect(),
            tooltipComputed: {
              position: window.getComputedStyle(tooltip).position,
              width: window.getComputedStyle(tooltip).width,
              height: window.getComputedStyle(tooltip).height,
              left: window.getComputedStyle(tooltip).left,
              top: window.getComputedStyle(tooltip).top,
              transform: window.getComputedStyle(tooltip).transform
            }
          });
          
          const tailElement = tooltip.querySelector('.ubits-tooltip__tail');
          
          if (!tailElement) {
            console.error('âŒ [Tooltip Main] Tail element NO encontrado en tooltip!');
            console.error('âŒ [Tooltip Main] Tooltip HTML completo:', tooltip.outerHTML);
            console.error('âŒ [Tooltip Main] QuerySelector result:', tooltip.querySelectorAll('*'));
            return;
          }
          
          console.log('âœ… [Tooltip Main] Tail element encontrado:', {
            tailElement: tailElement,
            tailClasses: tailElement.className,
            tailStyles: tailElement.style.cssText,
            tailHTML: tailElement.outerHTML,
            tailRect: tailElement.getBoundingClientRect(),
            tailComputed: {
              position: window.getComputedStyle(tailElement).position,
              left: window.getComputedStyle(tailElement).left,
              right: window.getComputedStyle(tailElement).right,
              top: window.getComputedStyle(tailElement).top,
              bottom: window.getComputedStyle(tailElement).bottom,
              transform: window.getComputedStyle(tailElement).transform,
              transformOrigin: window.getComputedStyle(tailElement).transformOrigin,
              width: window.getComputedStyle(tailElement).width,
              height: window.getComputedStyle(tailElement).height,
              marginLeft: window.getComputedStyle(tailElement).marginLeft,
              marginRight: window.getComputedStyle(tailElement).marginRight
            }
          });
          
          // Verificar clases del tooltip
          const hasTailTop = tooltip.classList.contains('ubits-tooltip--tail-top');
          const hasTailBottom = tooltip.classList.contains('ubits-tooltip--tail-bottom');
          const hasTailLeft = tooltip.classList.contains('ubits-tooltip--tail-left');
          const hasTailRight = tooltip.classList.contains('ubits-tooltip--tail-right');
          
          console.log('ğŸ·ï¸ [Tooltip Main] Clases del tooltip relacionadas con tail:', {
            hasTailTop: hasTailTop,
            hasTailBottom: hasTailBottom,
            hasTailLeft: hasTailLeft,
            hasTailRight: hasTailRight,
            tailPosition: state.tailPosition,
            allClasses: tooltip.className.split(' ')
          });
          
          // Remover cualquier estilo inline que pueda interferir (excepto el offset si existe)
          const currentStyle = tailElement.style.cssText;
          const hasOffset = state.tailOffset && state.tailOffset !== 0;
          
          console.log('ğŸ¯ [Tooltip Main] Estado antes de centrar:', {
            currentStyle: currentStyle,
            hasOffset: hasOffset,
            tailOffset: state.tailOffset,
            tailPosition: state.tailPosition
          });
          
          // Si no hay offset, remover todos los estilos inline y dejar que CSS maneje el centrado
          if (!hasOffset) {
            console.log('ğŸ§¹ [Tooltip Main] Removiendo estilos inline (sin offset)...');
            tailElement.style.removeProperty('left');
            tailElement.style.removeProperty('right');
            tailElement.style.removeProperty('top');
            tailElement.style.removeProperty('bottom');
            tailElement.style.removeProperty('transform');
            tailElement.style.removeProperty('margin-left');
            tailElement.style.removeProperty('margin-right');
            
            console.log('âœ… [Tooltip Main] Estilos inline removidos. Estilos despuÃ©s:', {
              inlineStyles: tailElement.style.cssText,
              computedLeft: window.getComputedStyle(tailElement).left,
              computedTransform: window.getComputedStyle(tailElement).transform
            });
          } else {
            console.log('ğŸ¯ [Tooltip Main] Aplicando estilos con offset...');
            // Si hay offset, mantener solo el transform con el offset
            if (state.tailPosition === 'top' || state.tailPosition === 'bottom') {
              tailElement.style.left = '50%';
              tailElement.style.right = 'auto';
              tailElement.style.transform = `translateX(calc(-50% + ${state.tailOffset}px))`;
              if (state.tailPosition === 'bottom') {
                tailElement.style.transform += ' rotate(180deg)';
              }
            } else {
              tailElement.style.top = '50%';
              tailElement.style.bottom = 'auto';
              tailElement.style.transform = `translateY(calc(-50% + ${state.tailOffset}px))`;
            }
            
            console.log('âœ… [Tooltip Main] Estilos con offset aplicados:', {
              inlineStyles: tailElement.style.cssText,
              computedLeft: window.getComputedStyle(tailElement).left,
              computedTransform: window.getComputedStyle(tailElement).transform
            });
          }
          
          // Forzar reflow
          void tailElement.offsetHeight;
          
          // Verificar que el tail estÃ© centrado
          setTimeout(() => {
            const tailRect = tailElement.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            const tailRelativeLeft = tailRect.left - tooltipRect.left;
            const tooltipCenterRelative = tooltipRect.width / 2;
            const tailCenterRelative = tailRelativeLeft + (tailRect.width / 2);
            const difference = Math.abs(tailCenterRelative - tooltipCenterRelative);
            
            console.log('ğŸ”º [Tooltip Main] ========== VERIFICACIÃ“N FINAL DEL TAIL ==========');
            
            // Logs individuales para ver valores reales
            console.log('ğŸ“ [Tooltip Main] Tail Rect:', 
              'left:', tailRect.left.toFixed(2),
              'top:', tailRect.top.toFixed(2),
              'width:', tailRect.width.toFixed(2),
              'height:', tailRect.height.toFixed(2)
            );
            console.log('ğŸ“ [Tooltip Main] Tooltip Rect:', 
              'left:', tooltipRect.left.toFixed(2),
              'top:', tooltipRect.top.toFixed(2),
              'width:', tooltipRect.width.toFixed(2),
              'height:', tooltipRect.height.toFixed(2)
            );
            console.log('ğŸ“ [Tooltip Main] CÃ¡lculos:', 
              'tailRelativeLeft:', tailRelativeLeft.toFixed(2),
              'tooltipCenterRelative:', tooltipCenterRelative.toFixed(2),
              'tailCenterRelative:', tailCenterRelative.toFixed(2),
              'difference:', difference.toFixed(2),
              'isCentered:', difference < 2
            );
            
            const tailComputedLeft = window.getComputedStyle(tailElement).left;
            const tailComputedTransform = window.getComputedStyle(tailElement).transform;
            const tailComputedPosition = window.getComputedStyle(tailElement).position;
            
            console.log('ğŸ¨ [Tooltip Main] Tail Computed Styles:', 
              'left:', tailComputedLeft,
              'transform:', tailComputedTransform,
              'position:', tailComputedPosition
            );
            
            const tooltipComputedWidth = window.getComputedStyle(tooltip).width;
            const tooltipComputedLeft = window.getComputedStyle(tooltip).left;
            const tooltipComputedTransform = window.getComputedStyle(tooltip).transform;
            
            console.log('ğŸ¨ [Tooltip Main] Tooltip Computed Styles:', 
              'width:', tooltipComputedWidth,
              'left:', tooltipComputedLeft,
              'transform:', tooltipComputedTransform
            );
            
            console.log('ğŸ”º [Tooltip Main] Estado del tail despuÃ©s de centrar:', {
              tailRect: {
                left: tailRect.left,
                top: tailRect.top,
                width: tailRect.width,
                height: tailRect.height,
                right: tailRect.right,
                bottom: tailRect.bottom
              },
              tooltipRect: {
                left: tooltipRect.left,
                top: tooltipRect.top,
                width: tooltipRect.width,
                height: tooltipRect.height,
                right: tooltipRect.right,
                bottom: tooltipRect.bottom
              },
              tailRelativeLeft: tailRelativeLeft,
              tooltipCenterRelative: tooltipCenterRelative,
              tailCenterRelative: tailCenterRelative,
              difference: difference,
              isCentered: difference < 2,
              tailComputed: {
                left: tailComputedLeft,
                right: window.getComputedStyle(tailElement).right,
                top: window.getComputedStyle(tailElement).top,
                bottom: window.getComputedStyle(tailElement).bottom,
                transform: tailComputedTransform,
                position: tailComputedPosition,
                width: window.getComputedStyle(tailElement).width,
                height: window.getComputedStyle(tailElement).height
              },
              tooltipComputed: {
                position: window.getComputedStyle(tooltip).position,
                width: tooltipComputedWidth,
                left: tooltipComputedLeft,
                transform: tooltipComputedTransform
              }
            });
            
            if (difference >= 2) {
              console.warn('âš ï¸ [Tooltip Main] Tail NO estÃ¡ centrado, diferencia:', difference, 'px');
              console.warn('âš ï¸ [Tooltip Main] Intentando correcciÃ³n...');
              
              // Intentar corregir forzando los estilos
              if (state.tailPosition === 'top' || state.tailPosition === 'bottom') {
                tailElement.style.setProperty('left', '50%', 'important');
                tailElement.style.setProperty('right', 'auto', 'important');
                if (!hasOffset) {
                  tailElement.style.removeProperty('transform');
                }
              }
              
              setTimeout(() => {
                const tailRectAfter = tailElement.getBoundingClientRect();
                const tooltipRectAfter = tooltip.getBoundingClientRect();
                const tailRelativeLeftAfter = tailRectAfter.left - tooltipRectAfter.left;
                const tailCenterRelativeAfter = tailRelativeLeftAfter + (tailRectAfter.width / 2);
                const tooltipCenterRelativeAfter = tooltipRectAfter.width / 2;
                const differenceAfter = Math.abs(tailCenterRelativeAfter - tooltipCenterRelativeAfter);
                
                console.log('ğŸ”§ [Tooltip Main] DespuÃ©s de correcciÃ³n:', {
                  differenceAfter: differenceAfter,
                  isCentered: differenceAfter < 2,
                  tailComputedAfter: {
                    left: window.getComputedStyle(tailElement).left,
                    transform: window.getComputedStyle(tailElement).transform
                  }
                });
              }, 10);
            } else {
              console.log('âœ… [Tooltip Main] Tail estÃ¡ correctamente centrado');
            }
            
            console.log('ğŸ”º [Tooltip Main] ========== FIN VERIFICACIÃ“N ==========');
          }, 10);
        };
        
        // Observar cambios en el tamaÃ±o del tooltip para recalcular el tail
        if (typeof ResizeObserver !== 'undefined') {
          try {
            const resizeObserver = new ResizeObserver(() => {
              console.log('ğŸ“ [Tooltip Main ResizeObserver] Tooltip cambiÃ³ de tamaÃ±o, recalculando tail...');
              centerTooltipTail();
            });
            resizeObserver.observe(tooltip);
            
            // Guardar referencia para poder desconectarlo despuÃ©s
            tooltip._tailResizeObserver = resizeObserver;
            
            // Centrar el tail inicialmente
            setTimeout(() => {
              centerTooltipTail();
            }, 50);
          } catch (error) {
            console.warn('âš ï¸ [Tooltip Main] Error al crear ResizeObserver:', error);
            // Centrar el tail de todas formas
            setTimeout(() => {
              centerTooltipTail();
            }, 50);
          }
        } else {
          // Si ResizeObserver no estÃ¡ disponible, centrar despuÃ©s de un delay
          setTimeout(() => {
            centerTooltipTail();
          }, 100);
        }
        
        // Funciones de control
        const openTooltip = () => {
          if (!tooltip || !tooltip.classList) {
            console.error('âŒ Tooltip element no vÃ¡lido');
            return;
          }
          tooltip.classList.add('ubits-tooltip--open');
          state.isOpen = true;
          const toggleButton = document.getElementById(`tooltip-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Cerrar Tooltip';
          }
        };
        
        const closeTooltip = () => {
          if (!tooltip || !tooltip.classList) {
            console.error('âŒ Tooltip element no vÃ¡lido');
            return;
          }
          tooltip.classList.remove('ubits-tooltip--open');
          state.isOpen = false;
          const toggleButton = document.getElementById(`tooltip-toggle-button-text-${componentId}`);
          if (toggleButton) {
            toggleButton.textContent = 'Abrir Tooltip';
          }
        };
        
        // Guardar instancia
        tooltipInstances[componentId] = {
          element: tooltip,
          open: openTooltip,
          close: closeTooltip
        };
      };
      
      // FunciÃ³n para toggle del Tooltip
      window.toggleTooltipComponent = function(componentId) {
        const state = initTooltipPreviewState(componentId);
        let instance = tooltipInstances[componentId];
        
        if (!instance || !instance.element || !instance.element.parentElement) {
          // Si no existe o fue removido, crear primero
          window.updateTooltipPreview(componentId);
          // Esperar a que se cree y luego abrir
          setTimeout(() => {
            instance = tooltipInstances[componentId];
            if (instance && instance.open) {
              instance.open();
            }
          }, 100);
          return;
        }
        
        if (state.isOpen) {
          instance.close();
        } else {
          instance.open();
        }
      };
      
      // FunciÃ³n unificada para controles del Tooltip
      window.setTooltipControl = function(option, value, componentId) {
        const state = initTooltipPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'title') {
          state.title = value;
        } else if (option === 'showTitle') {
          state.showTitle = value;
        } else if (option === 'description') {
          state.description = value;
        } else if (option === 'showDescription') {
          state.showDescription = value;
        } else if (option === 'width') {
          state.width = value;
        } else if (option === 'tailPosition') {
          state.tailPosition = value;
        } else if (option === 'primaryButtonLabel') {
          state.primaryButtonLabel = value;
        } else if (option === 'showPrimaryButton') {
          state.showPrimaryButton = value;
        } else if (option === 'primaryButtonIcon') {
          state.primaryButtonIcon = value;
        } else if (option === 'showPrimaryButtonIcon') {
          state.showPrimaryButtonIcon = value;
        } else if (option === 'secondaryButtonLabel') {
          state.secondaryButtonLabel = value;
        } else if (option === 'showSecondaryButton') {
          state.showSecondaryButton = value;
        } else if (option === 'secondaryButtonIcon') {
          state.secondaryButtonIcon = value;
        } else if (option === 'showSecondaryButtonIcon') {
          state.showSecondaryButtonIcon = value;
        } else if (option === 'tertiaryButtonLabel') {
          state.tertiaryButtonLabel = value;
        } else if (option === 'showTertiaryButton') {
          state.showTertiaryButton = value;
        } else if (option === 'tertiaryButtonIcon') {
          state.tertiaryButtonIcon = value;
        } else if (option === 'showTertiaryButtonIcon') {
          state.showTertiaryButtonIcon = value;
        }
        
        // Actualizar preview
        window.updateTooltipPreview(componentId);
        
        // Si estaba abierto, mantenerlo abierto
        if (state.isOpen && tooltipInstances[componentId]) {
          setTimeout(() => {
            const instance = tooltipInstances[componentId];
            if (instance && instance.open) {
              instance.open();
            }
          }, 50);
        }
      };
      
      // ========================================
      // SCROLLBAR PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Scrollbar
      const scrollbarPreviewState = {};
      const scrollbarInstances = {};
      
      // Inicializar estado del Scrollbar
      function initScrollbarPreviewState(componentId) {
        if (!scrollbarPreviewState[componentId]) {
          scrollbarPreviewState[componentId] = {
            orientation: 'vertical'
          };
        }
        return scrollbarPreviewState[componentId];
      }
      
      // FunciÃ³n global para crear scrollbar directamente (sin mÃ³dulo externo)
      // Esta funciÃ³n debe estar disponible globalmente para el calendario
      window.createScrollbarLocal = function(targetElement, scrollbarContainer, orientation) {
          // Crear elemento del scrollbar
          const scrollbarElement = document.createElement('div');
          scrollbarElement.className = `ubits-scrollbar ubits-scrollbar--${orientation} ubits-scrollbar--default`;
          
          const barElement = document.createElement('div');
          barElement.className = 'ubits-scrollbar__bar';
          scrollbarElement.appendChild(barElement);
          
          scrollbarContainer.appendChild(scrollbarElement);
          
          // FunciÃ³n para actualizar el scrollbar
          const updateScrollbar = () => {
            if (!targetElement || !barElement || !scrollbarElement) return;
            
            const isVertical = orientation === 'vertical';
            const scroll = isVertical ? targetElement.scrollTop : targetElement.scrollLeft;
            const clientSize = isVertical ? targetElement.clientHeight : targetElement.clientWidth;
            const scrollSize = isVertical ? targetElement.scrollHeight : targetElement.scrollWidth;
            
            if (scrollSize <= clientSize) {
              // No hay scroll necesario
              barElement.style.opacity = '0';
              barElement.style.pointerEvents = 'none';
              return;
            }
            
            // Calcular posiciÃ³n y tamaÃ±o del thumb
            const scrollbarSize = isVertical ? scrollbarElement.clientHeight : scrollbarElement.clientWidth;
            const thumbSize = Math.max((clientSize / scrollSize) * scrollbarSize, 20); // MÃ­nimo 20px
            const maxThumbPosition = scrollbarSize - thumbSize;
            const thumbPosition = (scroll / (scrollSize - clientSize)) * maxThumbPosition;
            
            if (isVertical) {
              barElement.style.height = `${thumbSize}px`;
              barElement.style.transform = `translateY(${thumbPosition}px)`;
            } else {
              barElement.style.width = `${thumbSize}px`;
              barElement.style.transform = `translateX(${thumbPosition}px)`;
            }
            
            // El scrollbar se mostrarÃ¡ en hover gracias al CSS
            // No establecemos opacity aquÃ­, dejamos que el CSS lo maneje
          };
          
          // FunciÃ³n para hacer scroll al hacer clic en el scrollbar
          const handleScrollbarClick = (e) => {
            if (!targetElement || !barElement) return;
            
            // Prevenir que el clic en la barra misma active el scroll
            if (e.target === barElement) {
              return;
            }
            
            e.preventDefault();
            e.stopPropagation();
            
            const isVertical = orientation === 'vertical';
            const rect = scrollbarElement.getBoundingClientRect();
            const clickPosition = isVertical 
              ? e.clientY - rect.top 
              : e.clientX - rect.left;
            
            const scrollbarSize = isVertical ? scrollbarElement.clientHeight : scrollbarElement.clientWidth;
            const percentage = clickPosition / scrollbarSize;
            
            const clientSize = isVertical ? targetElement.clientHeight : targetElement.clientWidth;
            const scrollSize = isVertical ? targetElement.scrollHeight : targetElement.scrollWidth;
            const maxScroll = scrollSize - clientSize;
            
            if (isVertical) {
              targetElement.scrollTop = percentage * maxScroll;
            } else {
              targetElement.scrollLeft = percentage * maxScroll;
            }
          };
          
          // FunciÃ³n para arrastrar el scrollbar
          let isDragging = false;
          let startPosition = 0;
          let startScroll = 0;
          
          const handleMouseDown = (e) => {
            if (!targetElement || !barElement) return;
            if (e.target !== barElement) return;
            
            e.preventDefault();
            e.stopPropagation();
            
            isDragging = true;
            const isVertical = orientation === 'vertical';
            startPosition = isVertical ? e.clientY : e.clientX;
            startScroll = isVertical ? targetElement.scrollTop : targetElement.scrollLeft;
            
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
          };
          
          const handleMouseMove = (e) => {
            if (!isDragging || !targetElement || !barElement) return;
            
            const isVertical = orientation === 'vertical';
            const currentPosition = isVertical ? e.clientY : e.clientX;
            const delta = currentPosition - startPosition;
            
            const scrollbarSize = isVertical ? scrollbarElement.clientHeight : scrollbarElement.clientWidth;
            const clientSize = isVertical ? targetElement.clientHeight : targetElement.clientWidth;
            const scrollSize = isVertical ? targetElement.scrollHeight : targetElement.scrollWidth;
            const maxScroll = scrollSize - clientSize;
            
            const scrollRatio = maxScroll / scrollbarSize;
            const newScroll = startScroll + (delta * scrollRatio);
            
            if (isVertical) {
              targetElement.scrollTop = Math.max(0, Math.min(maxScroll, newScroll));
            } else {
              targetElement.scrollLeft = Math.max(0, Math.min(maxScroll, newScroll));
            }
          };
          
          const handleMouseUp = () => {
            isDragging = false;
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', handleMouseUp);
          };
          
          // Event listeners
          targetElement.addEventListener('scroll', updateScrollbar);
          targetElement.addEventListener('resize', updateScrollbar);
          
          // Observar cambios en el contenido
          const resizeObserver = new ResizeObserver(() => {
            updateScrollbar();
          });
          resizeObserver.observe(targetElement);
          
          // Eventos del scrollbar
          scrollbarElement.addEventListener('click', handleScrollbarClick);
          barElement.addEventListener('mousedown', handleMouseDown);
          
          // Guardar funciones para poder limpiarlas despuÃ©s
          scrollbarElement.__handleMouseUp = handleMouseUp;
          scrollbarElement.__handleMouseMove = handleMouseMove;
          
          // Actualizar inicialmente
          setTimeout(() => {
            updateScrollbar();
          }, 100);
          
          // Retornar objeto con mÃ©todos
          return {
            element: scrollbarElement,
            update: updateScrollbar,
            destroy: () => {
              targetElement.removeEventListener('scroll', updateScrollbar);
              targetElement.removeEventListener('resize', updateScrollbar);
              resizeObserver.disconnect();
              scrollbarElement.removeEventListener('click', handleScrollbarClick);
              barElement.removeEventListener('mousedown', handleMouseDown);
              
              // Limpiar listeners de drag si existen
              if (scrollbarElement.__handleMouseUp) {
                document.removeEventListener('mousemove', scrollbarElement.__handleMouseMove);
                document.removeEventListener('mouseup', scrollbarElement.__handleMouseUp);
              }
              
              scrollbarElement.remove();
            }
          };
      };
      
      // FunciÃ³n para actualizar el preview del Scrollbar
      window.updateScrollbarPreview = function(componentId) {
        const state = initScrollbarPreviewState(componentId);
        
        // Limpiar instancias anteriores
        if (scrollbarInstances[componentId]) {
          if (scrollbarInstances[componentId].vertical) {
            scrollbarInstances[componentId].vertical.destroy();
          }
          if (scrollbarInstances[componentId].horizontal) {
            scrollbarInstances[componentId].horizontal.destroy();
          }
        }
        scrollbarInstances[componentId] = {};
        
        // Ocultar todos los contenedores
        const verticalWrapper = document.getElementById(`scrollbar-wrapper-vertical-${componentId}`);
        const horizontalWrapper = document.getElementById(`scrollbar-wrapper-horizontal-${componentId}`);
        const verticalContainer = document.getElementById(`scrollbar-scrollable-vertical-${componentId}`);
        const horizontalContainer = document.getElementById(`scrollbar-scrollable-horizontal-${componentId}`);
        const verticalScrollbar = document.getElementById(`scrollbar-vertical-${componentId}`);
        const horizontalScrollbar = document.getElementById(`scrollbar-horizontal-${componentId}`);
        
        if (!verticalContainer || !horizontalContainer || !verticalScrollbar || !horizontalScrollbar || !verticalWrapper || !horizontalWrapper) {
          return;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const cssLinkId = 'scrollbar-css';
        if (!document.getElementById(cssLinkId)) {
          const link = document.createElement('link');
          link.id = cssLinkId;
          link.rel = 'stylesheet';
          link.href = '../../addons/scroll/src/styles/scroll.css';
          document.head.appendChild(link);
        }
        
        if (state.orientation === 'vertical') {
          // Mostrar contenedor vertical y ocultar horizontal
          verticalWrapper.style.display = 'flex';
          horizontalWrapper.style.display = 'none';
          
          // Limpiar scrollbar anterior si existe
          verticalScrollbar.innerHTML = '';
          
          // Configurar el contenedor para que sea scrollable
          verticalContainer.setAttribute('data-scrollable', 'true');
          
          // Ocultar scrollbar nativo
          verticalContainer.style.setProperty('-ms-overflow-style', 'none');
          verticalContainer.style.setProperty('scrollbar-width', 'none');
          const styleId = `scrollbar-style-vertical-${componentId}`;
          if (!document.getElementById(styleId)) {
            const style = document.createElement('style');
            style.id = styleId;
            style.textContent = `#scrollbar-scrollable-vertical-${componentId}::-webkit-scrollbar { display: none; }`;
            document.head.appendChild(style);
          }
          
          // Crear scrollbar vertical
          setTimeout(() => {
            try {
              const instance = window.createScrollbarLocal(
                verticalContainer,
                verticalScrollbar,
                'vertical'
              );
              scrollbarInstances[componentId].vertical = instance;
            } catch (error) {
              console.error('Error al crear scrollbar vertical:', error);
            }
          }, 100);
        } else {
          // Mostrar contenedor horizontal y ocultar vertical
          verticalWrapper.style.display = 'none';
          horizontalWrapper.style.display = 'flex';
          
          // Limpiar scrollbar anterior si existe
          horizontalScrollbar.innerHTML = '';
          
          // Configurar el contenedor para que sea scrollable
          horizontalContainer.setAttribute('data-scrollable', 'true');
          
          // Ocultar scrollbar nativo
          horizontalContainer.style.setProperty('-ms-overflow-style', 'none');
          horizontalContainer.style.setProperty('scrollbar-width', 'none');
          const styleId = `scrollbar-style-horizontal-${componentId}`;
          if (!document.getElementById(styleId)) {
            const style = document.createElement('style');
            style.id = styleId;
            style.textContent = `#scrollbar-scrollable-horizontal-${componentId}::-webkit-scrollbar { display: none; }`;
            document.head.appendChild(style);
          }
          
          // Crear scrollbar horizontal
          setTimeout(() => {
            try {
              const instance = window.createScrollbarLocal(
                horizontalContainer,
                horizontalScrollbar,
                'horizontal'
              );
              scrollbarInstances[componentId].horizontal = instance;
            } catch (error) {
              console.error('Error al crear scrollbar horizontal:', error);
            }
          }, 100);
        }
      };
      
      // FunciÃ³n para actualizar controles del Scrollbar
      window.setScrollbarControl = function(option, value, componentId) {
        const state = initScrollbarPreviewState(componentId);
        
        if (option === 'orientation') {
          state.orientation = value;
          
          // Actualizar botones activos
          const buttons = document.querySelectorAll(`[data-component="${componentId}"][data-option="orientation"]`);
          buttons.forEach(btn => {
            if (btn.getAttribute('data-value') === value) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        }
        
        // Actualizar preview
        window.updateScrollbarPreview(componentId);
      };
      
      // ========================================
      // CALENDAR PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Calendar
      const calendarPreviewState = {};
      const calendarInstances = {};
      
      // Constantes del Calendar (disponibles globalmente)
      const CALENDAR_MONTH_NAMES = [
        'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
        'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
      ];
      const CALENDAR_DAY_NAMES = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];
      
      // Inicializar estado del Calendar
      function initCalendarPreviewState(componentId) {
        if (!calendarPreviewState[componentId]) {
          calendarPreviewState[componentId] = {
            mode: 'single',
            selectedDate: null,
            endDate: null,
            minDate: null,
            maxDate: null,
            currentDate: new Date(),
            isSelectingRange: false
          };
        }
        return calendarPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del Calendar
      function generateCalendarHTML(state) {
        const MONTH_NAMES = CALENDAR_MONTH_NAMES;
        const DAY_NAMES = CALENDAR_DAY_NAMES;
        
        const formatDate = (date) => {
          const day = String(date.getDate()).padStart(2, '0');
          const month = String(date.getMonth() + 1).padStart(2, '0');
          const year = date.getFullYear();
          return `${day}/${month}/${year}`;
        };
        
        const compareDates = (date1, date2) => {
          const d1 = new Date(date1.getFullYear(), date1.getMonth(), date1.getDate());
          const d2 = new Date(date2.getFullYear(), date2.getMonth(), date2.getDate());
          return d1.getTime() - d2.getTime();
        };
        
        const isSameDay = (date1, date2) => {
          return compareDates(date1, date2) === 0;
        };
        
        const isDateInRange = (date, startDate, endDate) => {
          const dateTime = compareDates(date, startDate);
          const endTime = compareDates(endDate, date);
          return dateTime >= 0 && endTime >= 0;
        };
        
        const currentDate = state.currentDate || new Date();
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDay = firstDay.getDay();
        
        const today = new Date();
        const todayString = today.toDateString();
        
        const mode = state.mode || 'single';
        const classes = `ubits-calendar ubits-calendar--${mode}`;
        
        // Header - usando componentes UBITS correctamente
        const selectedMonthName = MONTH_NAMES[month];
        const headerHTML = `
          <div class="ubits-calendar__header">
            <button type="button" class="ubits-button ubits-button--tertiary ubits-button--sm ubits-button--icon-only ubits-calendar__nav-button ubits-calendar__nav-button--prev" aria-label="Mes anterior">
              <i class="far fa-chevron-left"></i>
            </button>
            <div class="ubits-calendar__month-year">
              <div class="ubits-input-container" style="position: relative; flex: 1; min-width: 100px;">
                <input type="text" class="ubits-input ubits-input--sm ubits-calendar__month-input" value="${selectedMonthName}" readonly style="cursor: pointer;">
                <i class="far fa-chevron-down ubits-input-icon-right" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>
                <div class="ubits-calendar__month-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; z-index: 1000; margin-top: 4px;"></div>
              </div>
              <div class="ubits-input-container" style="position: relative; flex: 1; min-width: 80px; margin-left: 8px;">
                <input type="text" class="ubits-input ubits-input--sm ubits-calendar__year-input" value="${year}" readonly style="cursor: pointer;">
                <i class="far fa-chevron-down ubits-input-icon-right" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>
                <div class="ubits-calendar__year-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; z-index: 1000; margin-top: 4px;"></div>
              </div>
            </div>
            <button type="button" class="ubits-button ubits-button--tertiary ubits-button--sm ubits-button--icon-only ubits-calendar__nav-button ubits-calendar__nav-button--next" aria-label="Mes siguiente">
              <i class="far fa-chevron-right"></i>
            </button>
          </div>
        `;
        
        // Weekdays
        const weekdaysHTML = `
          <div class="ubits-calendar__weekdays">
            ${DAY_NAMES.map(day => `<div class="ubits-calendar__weekday">${day}</div>`).join('')}
          </div>
        `;
        
        // Days
        let daysHTML = '<div class="ubits-calendar__days">';
        
        // Empty days at start
        for (let i = 0; i < startingDay; i++) {
          daysHTML += '<div class="ubits-calendar__day ubits-calendar__day--empty"></div>';
        }
        
        // Days of month
        for (let day = 1; day <= daysInMonth; day++) {
          const date = new Date(year, month, day);
          const dateString = date.toDateString();
          const isToday = dateString === todayString;
          
          let dayClasses = ['ubits-calendar__day'];
          
          // Check if selected (single mode)
          if (mode === 'single' && state.selectedDate && isSameDay(date, state.selectedDate)) {
            dayClasses.push('ubits-calendar__day--selected');
          }
          
          // Check if in range (range mode)
          if (mode === 'range' && state.selectedDate) {
            if (state.endDate) {
              // Rango completo
              if (isSameDay(date, state.selectedDate)) {
                dayClasses.push('ubits-calendar__day--range-start');
              } else if (isSameDay(date, state.endDate)) {
                dayClasses.push('ubits-calendar__day--range-end');
              } else if (isDateInRange(date, state.selectedDate, state.endDate)) {
                dayClasses.push('ubits-calendar__day--in-range');
              }
            } else {
              // Solo fecha inicial seleccionada (mientras se selecciona el rango)
              if (isSameDay(date, state.selectedDate)) {
                dayClasses.push('ubits-calendar__day--range-start');
              }
            }
          }
          
          // Check if today
          if (isToday) {
            dayClasses.push('ubits-calendar__day--today');
          }
          
          // Check if disabled
          let isDisabled = false;
          if (state.minDate && compareDates(date, state.minDate) < 0) {
            isDisabled = true;
            dayClasses.push('ubits-calendar__day--disabled');
          }
          if (state.maxDate && compareDates(date, state.maxDate) > 0) {
            isDisabled = true;
            dayClasses.push('ubits-calendar__day--disabled');
          }
          
          const disabledAttr = isDisabled ? ' disabled' : '';
          const dataDate = formatDate(date);
          
          daysHTML += `<button type="button" class="${dayClasses.join(' ')}" data-date="${dataDate}"${disabledAttr}>${day}</button>`;
        }
        
        daysHTML += '</div>';
        
        return `
          <div class="${classes}">
            ${headerHTML}
            ${weekdaysHTML}
            ${daysHTML}
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Calendar
      window.updateCalendarPreview = function(componentId) {
        const state = initCalendarPreviewState(componentId);
        const container = document.getElementById(`calendar-preview-container-${componentId}`);
        
        if (!container) {
          console.error('âŒ Preview container de Calendar no encontrado:', `calendar-preview-container-${componentId}`);
          return;
        }
        
        // Limpiar calendario anterior si existe
        if (calendarInstances[componentId] && calendarInstances[componentId].element) {
          calendarInstances[componentId].element.remove();
          calendarInstances[componentId] = null;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const existingCalendarLink = document.querySelector('link[href*="calendar.css"]');
        if (!existingCalendarLink) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/calendar/src/styles/calendar.css';
          document.head.appendChild(link);
        }
        
        // Inicializar currentDate si no existe
        if (!state.currentDate) {
          state.currentDate = new Date();
        }
        
        // Generar HTML del calendario
        const calendarHTML = generateCalendarHTML(state);
        
        // Crear wrapper temporal para parsear el HTML
        const wrapper = document.createElement('div');
        wrapper.innerHTML = calendarHTML;
        const calendar = wrapper.firstElementChild;
        
        if (!calendar) {
          console.error('âŒ No se pudo crear el calendario');
          return;
        }
        
        // Configurar event listeners
        const setupEventListeners = () => {
          const prevBtn = calendar.querySelector('.ubits-calendar__nav-button--prev');
          const nextBtn = calendar.querySelector('.ubits-calendar__nav-button--next');
          const monthInput = calendar.querySelector('.ubits-calendar__month-input');
          const yearInput = calendar.querySelector('.ubits-calendar__year-input');
          const monthDropdown = calendar.querySelector('.ubits-calendar__month-dropdown');
          const yearDropdown = calendar.querySelector('.ubits-calendar__year-dropdown');
          
          console.log('ğŸ” [Calendar] setupEventListeners - Elementos encontrados:', {
            prevBtn: !!prevBtn,
            nextBtn: !!nextBtn,
            monthInput: !!monthInput,
            yearInput: !!yearInput,
            monthDropdown: !!monthDropdown,
            yearDropdown: !!yearDropdown,
            monthInputElement: monthInput,
            yearInputElement: yearInput,
            monthDropdownElement: monthDropdown,
            yearDropdownElement: yearDropdown
          });
          
          // Logs detallados para diagnosticar espaciado
          setTimeout(() => {
            const header = calendar.querySelector('.ubits-calendar__header');
            const prevBtnEl = calendar.querySelector('.ubits-calendar__nav-button--prev');
            const nextBtnEl = calendar.querySelector('.ubits-calendar__nav-button--next');
            const monthYearContainer = calendar.querySelector('.ubits-calendar__month-year');
            
            if (header && prevBtnEl && nextBtnEl && monthYearContainer) {
              console.log('ğŸ” [Calendar Header - Web Preview] ========== DIAGNÃ“STICO ESPACIADO ==========');
              
              // Estilos computados del header
              const headerStyles = window.getComputedStyle(header);
              console.log('ğŸ“ Header - Estilos computados:');
              console.log('  display:', headerStyles.display);
              console.log('  flexDirection:', headerStyles.flexDirection);
              console.log('  justifyContent:', headerStyles.justifyContent);
              console.log('  alignItems:', headerStyles.alignItems);
              console.log('  gap:', headerStyles.gap);
              console.log('  padding:', headerStyles.padding);
              console.log('  paddingLeft:', headerStyles.paddingLeft);
              console.log('  paddingRight:', headerStyles.paddingRight);
              console.log('  paddingTop:', headerStyles.paddingTop);
              console.log('  paddingBottom:', headerStyles.paddingBottom);
              console.log('  width:', headerStyles.width);
              console.log('  margin:', headerStyles.margin);
              console.log('  marginLeft:', headerStyles.marginLeft);
              console.log('  marginRight:', headerStyles.marginRight);
              
              // Bounding rects
              const headerRect = header.getBoundingClientRect();
              const prevBtnRect = prevBtnEl.getBoundingClientRect();
              const nextBtnRect = nextBtnEl.getBoundingClientRect();
              const monthYearRect = monthYearContainer.getBoundingClientRect();
              
              console.log('ğŸ“ Header - Dimensiones:');
              console.log('  width:', headerRect.width, 'px');
              console.log('  height:', headerRect.height, 'px');
              console.log('  left:', headerRect.left, 'px');
              console.log('  right:', headerRect.right, 'px');
              
              console.log('ğŸ“ BotÃ³n Prev - Dimensiones:');
              console.log('  width:', prevBtnRect.width, 'px');
              console.log('  height:', prevBtnRect.height, 'px');
              console.log('  left:', prevBtnRect.left, 'px');
              console.log('  right:', prevBtnRect.right, 'px');
              
              console.log('ğŸ“ Contenedor Mes/AÃ±o - Dimensiones:');
              console.log('  width:', monthYearRect.width, 'px');
              console.log('  height:', monthYearRect.height, 'px');
              console.log('  left:', monthYearRect.left, 'px');
              console.log('  right:', monthYearRect.right, 'px');
              
              console.log('ğŸ“ BotÃ³n Next - Dimensiones:');
              console.log('  width:', nextBtnRect.width, 'px');
              console.log('  height:', nextBtnRect.height, 'px');
              console.log('  left:', nextBtnRect.left, 'px');
              console.log('  right:', nextBtnRect.right, 'px');
              
              // Distancias calculadas
              const distancePrevToInput = monthYearRect.left - prevBtnRect.right;
              const distanceInputToNext = nextBtnRect.left - monthYearRect.right;
              
              console.log('ğŸ“ Distancias:');
              console.log('  BotÃ³n Prev â†’ Inputs:', distancePrevToInput.toFixed(2), 'px');
              console.log('  Inputs â†’ BotÃ³n Next:', distanceInputToNext.toFixed(2), 'px');
              
              // Estilos computados de los botones
              const prevBtnStyles = window.getComputedStyle(prevBtnEl);
              const nextBtnStyles = window.getComputedStyle(nextBtnEl);
              console.log('ğŸ”˜ BotÃ³n Prev - Estilos:');
              console.log('  margin:', prevBtnStyles.margin);
              console.log('  marginLeft:', prevBtnStyles.marginLeft);
              console.log('  marginRight:', prevBtnStyles.marginRight);
              console.log('  width:', prevBtnStyles.width);
              console.log('  flexShrink:', prevBtnStyles.flexShrink);
              console.log('  flexGrow:', prevBtnStyles.flexGrow);
              console.log('ğŸ”˜ BotÃ³n Next - Estilos:');
              console.log('  margin:', nextBtnStyles.margin);
              console.log('  marginLeft:', nextBtnStyles.marginLeft);
              console.log('  marginRight:', nextBtnStyles.marginRight);
              console.log('  width:', nextBtnStyles.width);
              console.log('  flexShrink:', nextBtnStyles.flexShrink);
              console.log('  flexGrow:', nextBtnStyles.flexGrow);
              
              // Estilos del contenedor mes/aÃ±o
              const monthYearStyles = window.getComputedStyle(monthYearContainer);
              console.log('ğŸ“¦ Contenedor Mes/AÃ±o - Estilos:');
              console.log('  margin:', monthYearStyles.margin);
              console.log('  marginLeft:', monthYearStyles.marginLeft);
              console.log('  marginRight:', monthYearStyles.marginRight);
              console.log('  width:', monthYearStyles.width);
              console.log('  flex:', monthYearStyles.flex);
              console.log('  flexShrink:', monthYearStyles.flexShrink);
              console.log('  flexGrow:', monthYearStyles.flexGrow);
              
              console.log('ğŸ” [Calendar Header - Web Preview] ========== FIN DIAGNÃ“STICO ==========');
            } else {
              console.error('âŒ [Calendar Header - Web Preview] Elementos no encontrados:', {
                header: !!header,
                prevBtn: !!prevBtnEl,
                nextBtn: !!nextBtnEl,
                monthYearContainer: !!monthYearContainer
              });
            }
          }, 100);
          
          prevBtn?.addEventListener('click', () => {
            state.currentDate.setMonth(state.currentDate.getMonth() - 1);
            window.updateCalendarPreview(componentId);
          });
          
          nextBtn?.addEventListener('click', () => {
            state.currentDate.setMonth(state.currentDate.getMonth() + 1);
            window.updateCalendarPreview(componentId);
          });
          
          // Cargar CSS de List y Scrollbar si no estÃ¡n cargados
          const existingListLink = document.querySelector('link[href*="list.css"]');
          if (!existingListLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/list/src/styles/list.css';
            document.head.appendChild(link);
            console.log('ğŸ“¦ [Calendar] CSS de List cargado');
          }
          
          const existingScrollLink = document.querySelector('link[href*="scroll.css"]');
          if (!existingScrollLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/scroll/src/styles/scroll.css';
            document.head.appendChild(link);
            console.log('ğŸ“¦ [Calendar] CSS de Scrollbar cargado');
          }
          
          // Crear dropdown de meses usando List UBITS
          if (monthInput && monthDropdown) {
            const currentMonth = state.currentDate.getMonth();
            console.log('ğŸ“… [Calendar] Configurando dropdown de mes, mes actual:', currentMonth);
            
            const monthItems = CALENDAR_MONTH_NAMES.map((name, index) => ({
              label: name,
              value: String(index),
              selected: index === currentMonth,
              state: index === currentMonth ? 'active' : 'default'
            }));
            
            monthInput.addEventListener('click', (e) => {
              e.stopPropagation();
              console.log('ğŸ“… [Calendar] CLICK en input de MES');
              console.log('ğŸ“… [Calendar] monthDropdown existe?', !!monthDropdown);
              console.log('ğŸ“… [Calendar] monthDropdown.style.display:', monthDropdown.style.display);
              
              const isVisible = monthDropdown.style.display === 'block';
              console.log('ğŸ“… [Calendar] isVisible:', isVisible);
              
              if (!isVisible) {
                // Cerrar dropdown de aÃ±o si estÃ¡ abierto
                if (yearDropdown) {
                  yearDropdown.style.display = 'none';
                }
                
                console.log('ğŸ“… [Calendar] Generando HTML del dropdown de mes...');
                // IDs Ãºnicos para el dropdown de mes
                const monthListId = `calendar-month-list-${componentId}`;
                const monthScrollbarId = `calendar-month-scrollbar-${componentId}`;
                
                // Renderizar List UBITS con contenedor para scrollbar
                const listHTML = `
                  <div style="position: relative; max-height: 200px;">
                    <div id="${monthListId}" class="ubits-list" role="list" style="max-height: 200px; background: var(--ubits-bg-1); border: 1px solid var(--ubits-border-1); border-radius: 6px; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)); overflow-y: auto; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none;">
                      <style>
                        #${monthListId}::-webkit-scrollbar { display: none; }
                      </style>
                      ${monthItems.map((item, idx) => `
                        <div class="ubits-list-item ubits-list-item--sm ${item.state === 'active' ? 'ubits-list-item--active' : ''}" 
                             role="listitem" 
                             data-value="${item.value}" 
                             data-index="${idx}"
                             tabindex="0"
                             style="cursor: pointer;">
                          ${item.label}
                        </div>
                      `).join('')}
                    </div>
                    <div id="${monthScrollbarId}" style="position: absolute; top: 0; right: 0; width: 8px; height: 100%; pointer-events: none;"></div>
                  </div>
                `;
                console.log('ğŸ“… [Calendar] HTML generado, longitud:', listHTML.length);
                monthDropdown.innerHTML = listHTML;
                monthDropdown.style.display = 'block';
                console.log('ğŸ“… [Calendar] âœ… Dropdown de MES ABIERTO');
                
                // Crear scrollbar UBITS despuÃ©s de renderizar
                requestAnimationFrame(() => {
                  try {
                    const listElement = document.getElementById(monthListId);
                    const scrollbarContainer = document.getElementById(monthScrollbarId);
                    
                    console.log('ğŸ“… [Calendar] ========== DIAGNÃ“STICO SCROLLBAR MES ==========');
                    console.log('ğŸ“… [Calendar] Elementos encontrados:', {
                      listElement: !!listElement,
                      scrollbarContainer: !!scrollbarContainer,
                      listElementId: listElement?.id,
                      scrollbarContainerId: scrollbarContainer?.id
                    });
                    
                    if (listElement) {
                      console.log('ğŸ“… [Calendar] Dimensiones de la lista:', {
                        scrollHeight: listElement.scrollHeight,
                        clientHeight: listElement.clientHeight,
                        offsetHeight: listElement.offsetHeight,
                        needsScroll: listElement.scrollHeight > listElement.clientHeight,
                        difference: listElement.scrollHeight - listElement.clientHeight
                      });
                    }
                    
                    if (scrollbarContainer) {
                      console.log('ğŸ“… [Calendar] Estado del contenedor del scrollbar:', {
                        offsetHeight: scrollbarContainer.offsetHeight,
                        offsetWidth: scrollbarContainer.offsetWidth,
                        styleHeight: scrollbarContainer.style.height,
                        styleWidth: scrollbarContainer.style.width,
                        innerHTML: scrollbarContainer.innerHTML.substring(0, 200),
                        children: scrollbarContainer.children.length
                      });
                    }
                    
                    if (listElement && scrollbarContainer) {
                      // Asegurar que el contenedor tenga la misma altura que la lista
                      const listHeight = listElement.clientHeight;
                      scrollbarContainer.style.height = `${listHeight}px`;
                      scrollbarContainer.style.maxHeight = '200px'; // Limitar altura mÃ¡xima
                      scrollbarContainer.style.overflow = 'hidden'; // Evitar que el scrollbar se salga
                      scrollbarContainer.style.pointerEvents = 'auto'; // Permitir interacciÃ³n con el scrollbar
                      console.log('ğŸ“… [Calendar] Altura del contenedor ajustada a:', listHeight);
                      
                      if (listElement.scrollHeight > listElement.clientHeight) {
                        console.log('ğŸ“… [Calendar] âœ… Se necesita scrollbar, creando...');
                        // Usar funciÃ³n local createScrollbarLocal
                        if (typeof window.createScrollbarLocal === 'function') {
                          console.log('ğŸ“… [Calendar] createScrollbarLocal estÃ¡ disponible');
                          monthDropdown._scrollbarInstance = window.createScrollbarLocal(listElement, scrollbarContainer, 'vertical');
                          console.log('ğŸ“… [Calendar] Scrollbar creado, instancia:', monthDropdown._scrollbarInstance);
                          
                          // Verificar que el scrollbar se creÃ³
                          setTimeout(() => {
                            const scrollbarElement = scrollbarContainer.querySelector('.ubits-scrollbar');
                            const barElement = scrollbarContainer.querySelector('.ubits-scrollbar__bar');
                            console.log('ğŸ“… [Calendar] VerificaciÃ³n del scrollbar creado:', {
                              scrollbarElement: !!scrollbarElement,
                              barElement: !!barElement,
                              scrollbarClasses: scrollbarElement?.className,
                              barClasses: barElement?.className,
                              scrollbarStyle: scrollbarElement?.style.cssText,
                              barStyle: barElement?.style.cssText,
                              scrollbarComputed: scrollbarElement ? {
                                display: window.getComputedStyle(scrollbarElement).display,
                                opacity: window.getComputedStyle(scrollbarElement).opacity,
                                width: window.getComputedStyle(scrollbarElement).width,
                                height: window.getComputedStyle(scrollbarElement).height
                              } : null,
                              barComputed: barElement ? {
                                display: window.getComputedStyle(barElement).display,
                                opacity: window.getComputedStyle(barElement).opacity,
                                width: window.getComputedStyle(barElement).width,
                                height: window.getComputedStyle(barElement).height,
                                transform: window.getComputedStyle(barElement).transform
                              } : null
                            });
                            
                            // Verificar CSS cargado
                            const scrollbarStyles = window.getComputedStyle(barElement || document.body);
                            console.log('ğŸ“… [Calendar] CSS del scrollbar verificado');
                          }, 100);
                        } else {
                          console.error('âŒ [Calendar] createScrollbarLocal NO estÃ¡ disponible');
                        }
                      } else {
                        console.log('ğŸ“… [Calendar] âš ï¸ No se necesita scrollbar para mes (contenido cabe)');
                      }
                    } else {
                      console.error('âŒ [Calendar] Faltan elementos:', {
                        listElement: !!listElement,
                        scrollbarContainer: !!scrollbarContainer
                      });
                    }
                    console.log('ğŸ“… [Calendar] ========== FIN DIAGNÃ“STICO ==========');
                  } catch (err) {
                    console.error('âŒ [Calendar] Error creando scrollbar:', err);
                    console.error('âŒ [Calendar] Stack:', err.stack);
                  }
                });
                
                // Event listeners para items de mes
                const listItems = monthDropdown.querySelectorAll('.ubits-list-item');
                console.log('ğŸ“… [Calendar] Items encontrados en dropdown:', listItems.length);
                listItems.forEach((itemEl, idx) => {
                  itemEl.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const monthIndex = parseInt(itemEl.getAttribute('data-value') || '0');
                    console.log('ğŸ“… [Calendar] Mes seleccionado:', monthIndex, CALENDAR_MONTH_NAMES[monthIndex]);
                    // Limpiar scrollbar antes de cerrar
                    if (monthDropdown._scrollbarInstance) {
                      try {
                        if (monthDropdown._scrollbarInstance.destroy) {
                          monthDropdown._scrollbarInstance.destroy();
                        }
                        // TambiÃ©n limpiar el elemento del scrollbar del DOM
                        const scrollbarEl = monthDropdown.querySelector('.ubits-scrollbar');
                        if (scrollbarEl && scrollbarEl.parentElement) {
                          scrollbarEl.parentElement.removeChild(scrollbarEl);
                        }
                      } catch (e) {
                        console.warn('ğŸ“… [Calendar] Error limpiando scrollbar:', e);
                      }
                      delete monthDropdown._scrollbarInstance;
                    }
                    state.currentDate.setMonth(monthIndex);
                    monthDropdown.style.display = 'none';
                    window.updateCalendarPreview(componentId);
                  });
                });
              } else {
                monthDropdown.style.display = 'none';
                console.log('ğŸ“… [Calendar] Dropdown de MES CERRADO');
              }
            });
            
            console.log('ğŸ“… [Calendar] Event listener de mes agregado');
          } else {
            console.error('âŒ [Calendar] monthInput o monthDropdown NO encontrados:', {
              monthInput: !!monthInput,
              monthDropdown: !!monthDropdown
            });
          }
          
          // Crear dropdown de aÃ±os usando List UBITS
          if (yearInput && yearDropdown) {
            const currentYear = state.currentDate.getFullYear();
            const yearItems = Array.from({ length: 100 }, (_, i) => {
              const yearOption = currentYear - 50 + i;
              return {
                label: String(yearOption),
                value: String(yearOption),
                selected: yearOption === currentYear,
                state: yearOption === currentYear ? 'active' : 'default'
              };
            });
            
            yearInput.addEventListener('click', (e) => {
              e.stopPropagation();
              console.log('ğŸ“… [Calendar] CLICK en input de AÃ‘O');
              console.log('ğŸ“… [Calendar] yearDropdown existe?', !!yearDropdown);
              console.log('ğŸ“… [Calendar] yearDropdown.style.display:', yearDropdown.style.display);
              
              const isVisible = yearDropdown.style.display === 'block';
              console.log('ğŸ“… [Calendar] isVisible:', isVisible);
              
              if (!isVisible) {
                // Cerrar dropdown de mes si estÃ¡ abierto
                if (monthDropdown) {
                  monthDropdown.style.display = 'none';
                }
                
                console.log('ğŸ“… [Calendar] Generando HTML del dropdown de aÃ±o...');
                // IDs Ãºnicos para el dropdown de aÃ±o
                const yearListId = `calendar-year-list-${componentId}`;
                const yearScrollbarId = `calendar-year-scrollbar-${componentId}`;
                
                // Renderizar List UBITS con contenedor para scrollbar
                const listHTML = `
                  <div style="position: relative; max-height: 200px;">
                    <div id="${yearListId}" class="ubits-list" role="list" style="max-height: 200px; background: var(--ubits-bg-1); border: 1px solid var(--ubits-border-1); border-radius: 6px; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)); overflow-y: auto; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none;">
                      <style>
                        #${yearListId}::-webkit-scrollbar { display: none; }
                      </style>
                      ${yearItems.map((item, idx) => `
                        <div class="ubits-list-item ubits-list-item--sm ${item.state === 'active' ? 'ubits-list-item--active' : ''}" 
                             role="listitem" 
                             data-value="${item.value}" 
                             data-index="${idx}"
                             tabindex="0"
                             style="cursor: pointer;">
                          ${item.label}
                        </div>
                      `).join('')}
                    </div>
                    <div id="${yearScrollbarId}" style="position: absolute; top: 0; right: 0; width: 8px; height: 100%; pointer-events: none;"></div>
                  </div>
                `;
                console.log('ğŸ“… [Calendar] HTML generado, longitud:', listHTML.length);
                yearDropdown.innerHTML = listHTML;
                yearDropdown.style.display = 'block';
                console.log('ğŸ“… [Calendar] âœ… Dropdown de AÃ‘O ABIERTO');
                
                // Crear scrollbar UBITS despuÃ©s de renderizar
                requestAnimationFrame(() => {
                  try {
                    const listElement = document.getElementById(yearListId);
                    const scrollbarContainer = document.getElementById(yearScrollbarId);
                    
                    console.log('ğŸ“… [Calendar] ========== DIAGNÃ“STICO SCROLLBAR AÃ‘O ==========');
                    console.log('ğŸ“… [Calendar] Elementos encontrados:', {
                      listElement: !!listElement,
                      scrollbarContainer: !!scrollbarContainer,
                      listElementId: listElement?.id,
                      scrollbarContainerId: scrollbarContainer?.id
                    });
                    
                    if (listElement) {
                      console.log('ğŸ“… [Calendar] Dimensiones de la lista:', {
                        scrollHeight: listElement.scrollHeight,
                        clientHeight: listElement.clientHeight,
                        offsetHeight: listElement.offsetHeight,
                        needsScroll: listElement.scrollHeight > listElement.clientHeight,
                        difference: listElement.scrollHeight - listElement.clientHeight
                      });
                    }
                    
                    if (scrollbarContainer) {
                      console.log('ğŸ“… [Calendar] Estado del contenedor del scrollbar:', {
                        offsetHeight: scrollbarContainer.offsetHeight,
                        offsetWidth: scrollbarContainer.offsetWidth,
                        styleHeight: scrollbarContainer.style.height,
                        styleWidth: scrollbarContainer.style.width,
                        innerHTML: scrollbarContainer.innerHTML.substring(0, 200),
                        children: scrollbarContainer.children.length
                      });
                    }
                    
                    if (listElement && scrollbarContainer) {
                      // Asegurar que el contenedor tenga la misma altura que la lista
                      const listHeight = listElement.clientHeight;
                      scrollbarContainer.style.height = `${listHeight}px`;
                      scrollbarContainer.style.maxHeight = '200px'; // Limitar altura mÃ¡xima
                      scrollbarContainer.style.overflow = 'hidden'; // Evitar que el scrollbar se salga
                      scrollbarContainer.style.pointerEvents = 'auto'; // Permitir interacciÃ³n con el scrollbar
                      console.log('ğŸ“… [Calendar] Altura del contenedor ajustada a:', listHeight);
                      
                      if (listElement.scrollHeight > listElement.clientHeight) {
                        console.log('ğŸ“… [Calendar] âœ… Se necesita scrollbar, creando...');
                        // Usar funciÃ³n local createScrollbarLocal
                        if (typeof window.createScrollbarLocal === 'function') {
                          console.log('ğŸ“… [Calendar] createScrollbarLocal estÃ¡ disponible');
                          yearDropdown._scrollbarInstance = window.createScrollbarLocal(listElement, scrollbarContainer, 'vertical');
                          console.log('ğŸ“… [Calendar] Scrollbar creado, instancia:', yearDropdown._scrollbarInstance);
                          
                          // Verificar que el scrollbar se creÃ³
                          setTimeout(() => {
                            const scrollbarElement = scrollbarContainer.querySelector('.ubits-scrollbar');
                            const barElement = scrollbarContainer.querySelector('.ubits-scrollbar__bar');
                            console.log('ğŸ“… [Calendar] VerificaciÃ³n del scrollbar creado:', {
                              scrollbarElement: !!scrollbarElement,
                              barElement: !!barElement,
                              scrollbarClasses: scrollbarElement?.className,
                              barClasses: barElement?.className,
                              scrollbarStyle: scrollbarElement?.style.cssText,
                              barStyle: barElement?.style.cssText,
                              scrollbarComputed: scrollbarElement ? {
                                display: window.getComputedStyle(scrollbarElement).display,
                                opacity: window.getComputedStyle(scrollbarElement).opacity,
                                width: window.getComputedStyle(scrollbarElement).width,
                                height: window.getComputedStyle(scrollbarElement).height
                              } : null,
                              barComputed: barElement ? {
                                display: window.getComputedStyle(barElement).display,
                                opacity: window.getComputedStyle(barElement).opacity,
                                width: window.getComputedStyle(barElement).width,
                                height: window.getComputedStyle(barElement).height,
                                transform: window.getComputedStyle(barElement).transform
                              } : null
                            });
                          }, 100);
                        } else {
                          console.error('âŒ [Calendar] createScrollbarLocal NO estÃ¡ disponible');
                        }
                      } else {
                        console.log('ğŸ“… [Calendar] âš ï¸ No se necesita scrollbar para aÃ±o (contenido cabe)');
                      }
                    } else {
                      console.error('âŒ [Calendar] Faltan elementos:', {
                        listElement: !!listElement,
                        scrollbarContainer: !!scrollbarContainer
                      });
                    }
                    console.log('ğŸ“… [Calendar] ========== FIN DIAGNÃ“STICO ==========');
                  } catch (err) {
                    console.error('âŒ [Calendar] Error creando scrollbar:', err);
                    console.error('âŒ [Calendar] Stack:', err.stack);
                  }
                });
                
                // Event listeners para items de aÃ±o
                const listItems = yearDropdown.querySelectorAll('.ubits-list-item');
                console.log('ğŸ“… [Calendar] Items encontrados en dropdown:', listItems.length);
                listItems.forEach((itemEl, idx) => {
                  itemEl.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const yearValue = parseInt(itemEl.getAttribute('data-value') || String(currentYear));
                    console.log('ğŸ“… [Calendar] AÃ±o seleccionado:', yearValue);
                    // Limpiar scrollbar antes de cerrar
                    if (yearDropdown._scrollbarInstance) {
                      try {
                        if (yearDropdown._scrollbarInstance.destroy) {
                          yearDropdown._scrollbarInstance.destroy();
                        }
                        // TambiÃ©n limpiar el elemento del scrollbar del DOM
                        const scrollbarEl = yearDropdown.querySelector('.ubits-scrollbar');
                        if (scrollbarEl && scrollbarEl.parentElement) {
                          scrollbarEl.parentElement.removeChild(scrollbarEl);
                        }
                      } catch (e) {
                        console.warn('ğŸ“… [Calendar] Error limpiando scrollbar:', e);
                      }
                      delete yearDropdown._scrollbarInstance;
                    }
                    state.currentDate.setFullYear(yearValue);
                    yearDropdown.style.display = 'none';
                    window.updateCalendarPreview(componentId);
                  });
                });
              } else {
                yearDropdown.style.display = 'none';
                console.log('ğŸ“… [Calendar] Dropdown de AÃ‘O CERRADO');
              }
            });
            
            console.log('ğŸ“… [Calendar] Event listener de aÃ±o agregado');
          } else {
            console.error('âŒ [Calendar] yearInput o yearDropdown NO encontrados:', {
              yearInput: !!yearInput,
              yearDropdown: !!yearDropdown
            });
          }
          
          // Cerrar dropdowns al hacer click fuera
          document.addEventListener('click', (e) => {
            const target = e.target;
            if (monthDropdown && monthInput && !monthInput.contains(target) && !monthDropdown.contains(target)) {
              monthDropdown.style.display = 'none';
            }
            if (yearDropdown && yearInput && !yearInput.contains(target) && !yearDropdown.contains(target)) {
              yearDropdown.style.display = 'none';
            }
          });
          
          // Day selection
          const dayButtons = calendar.querySelectorAll('.ubits-calendar__day:not(.ubits-calendar__day--empty):not(.ubits-calendar__day--disabled)');
          
          dayButtons.forEach(dayBtn => {
            dayBtn.addEventListener('click', () => {
              const dateStr = dayBtn.dataset.date || '';
              const [day, month, year] = dateStr.split('/');
              const clickedDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
              
              if (state.mode === 'single') {
                state.selectedDate = clickedDate;
                state.endDate = null;
                state.isSelectingRange = false;
                window.updateCalendarPreview(componentId);
                console.log('ğŸ“… Fecha seleccionada:', clickedDate);
              } else if (state.mode === 'range') {
                const compareDates = (d1, d2) => {
                  const date1 = new Date(d1.getFullYear(), d1.getMonth(), d1.getDate());
                  const date2 = new Date(d2.getFullYear(), d2.getMonth(), d2.getDate());
                  return date1.getTime() - date2.getTime();
                };
                
                if (!state.selectedDate || (state.selectedDate && state.endDate)) {
                  // Iniciar nuevo rango (no hay fecha inicial o ya hay un rango completo)
                  state.selectedDate = clickedDate;
                  state.endDate = null;
                  state.isSelectingRange = true;
                  window.updateCalendarPreview(componentId);
                  console.log('ğŸ“… Iniciando rango:', clickedDate);
                } else if (state.selectedDate && !state.endDate) {
                  // Completar rango (ya hay fecha inicial, falta la final)
                  if (compareDates(clickedDate, state.selectedDate) < 0) {
                    // La fecha clickeada es anterior a la inicial, intercambiar
                    state.endDate = state.selectedDate;
                    state.selectedDate = clickedDate;
                  } else {
                    // La fecha clickeada es posterior a la inicial, establecer como final
                    state.endDate = clickedDate;
                  }
                  state.isSelectingRange = false;
                  window.updateCalendarPreview(componentId);
                  console.log('ğŸ“… Rango seleccionado:', state.selectedDate, 'a', state.endDate);
                }
              }
            });
          });
        };
        
        // AÃ±adir el calendario al contenedor
        container.innerHTML = '';
        container.appendChild(calendar);
        
        // Configurar event listeners
        setupEventListeners();
        
        // Guardar instancia
        calendarInstances[componentId] = {
          element: calendar,
          destroy: () => {
            if (calendar.parentElement) {
              calendar.parentElement.removeChild(calendar);
            }
          }
        };
      };
      
      // FunciÃ³n unificada para controles del Calendar
      window.setCalendarControl = function(option, value, componentId) {
        const state = initCalendarPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'mode') {
          state.mode = value;
          // Limpiar selecciones al cambiar de modo
          state.selectedDate = null;
          state.endDate = null;
          
          // Actualizar botones activos
          document.querySelectorAll(`[data-component="${componentId}"][data-option="mode"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        }
        
        // Actualizar preview
        window.updateCalendarPreview(componentId);
      };
      
      // ========================================
      // PROGRESS BAR PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Progress Bar
      const progressBarPreviewState = {};
      
      // Instancias del Progress Bar
      const progressBarInstances = {};
      
      // Inicializar estado del preview del Progress Bar
      window.initProgressBarPreviewState = function(componentId) {
        if (!progressBarPreviewState[componentId]) {
          progressBarPreviewState[componentId] = {
            size: 'md',
            variant: 'default',
            value: 75,
            indicator: true,
            numSegments: 4,
            segments: [
              { value: 30, color: 'info' },
              { value: 25, color: 'yellow' },
              { value: 20, color: 'green' },
              { value: 25, color: 'error' }
            ]
          };
        }
        return progressBarPreviewState[componentId];
      };
      
      // FunciÃ³n para renderizar Progress Bar localmente
      function renderProgressBarLocal(options) {
        const {
          size = 'md',
          value = 0,
          variant = 'default',
          segments = [],
          indicator = false
        } = options;
        
        const sizeConfig = {
          xs: { height: 4, fontSize: 'var(--font-body-xs-size, 11px)' },
          sm: { height: 8, fontSize: 'var(--font-body-sm-size, 13px)' },
          md: { height: 16, fontSize: 'var(--font-body-md-size, 16px)' },
          lg: { height: 20, fontSize: 'var(--font-body-lg-size, 18px)' }
        }[size] || { height: 16, fontSize: 'var(--font-body-md-size, 16px)' };
        
        const classes = [
          'ubits-progress-bar',
          `ubits-progress-bar--${size}`,
          variant === 'multi-color' ? 'ubits-progress-bar--multi-color' : ''
        ].filter(Boolean).join(' ');
        
        let indicatorHtml = '';
        if (indicator !== undefined && indicator !== false) {
          const indicatorText = typeof indicator === 'string' ? indicator : `${Math.round(value)}%`;
          indicatorHtml = `<span class="ubits-progress-bar__indicator">${indicatorText}</span>`;
        }
        
        const colorTokens = {
          yellow: 'var(--ubits-fg-yellow-subtle-inverted, #ffd555)',
          green: 'var(--ubits-feedback-accent-success, #56ce51)',
          gray: 'var(--ubits-bg-4, #dbdde0)',
          info: 'var(--ubits-feedback-accent-info-static-inverted, #4a74ee)',
          error: 'var(--ubits-button-badge, #cf0e34)'
        };
        
        let progressIndicatorHtml = '';
        
        if (variant === 'multi-color' && segments.length > 0) {
          // Calcular el total de los segmentos definidos
          const totalDefined = segments.reduce((sum, seg) => sum + seg.value, 0);
          // Calcular el resto (lo que falta para llegar a 100%)
          const remainder = Math.max(0, 100 - totalDefined);
          
          // Crear array con todos los segmentos (incluyendo el resto gris si es necesario)
          const allSegments = [...segments];
          if (remainder > 0) {
            allSegments.push({ value: remainder, color: 'gray' });
          }
          
          // Generar segmentos HTML
          const segmentsHtml = allSegments.map((segment, index) => {
            const width = segment.value; // Ya estÃ¡ en porcentaje (0-100)
            const color = colorTokens[segment.color] || colorTokens.gray;
            const isFirst = index === 0;
            const isLast = index === allSegments.length - 1;
            const borderRadius = `border-radius: ${isFirst ? '1000px 0 0 1000px' : isLast ? '0 1000px 1000px 0' : '0'};`;
            
            return `<div 
              class="ubits-progress-bar__segment" 
              style="width: ${width}%; background-color: ${color}; ${borderRadius}"
              data-color="${segment.color}"
            ></div>`;
          }).join('');
          
          progressIndicatorHtml = `<div class="ubits-progress-bar__indicator-wrapper">${segmentsHtml}</div>`;
        } else {
          const clampedValue = Math.max(0, Math.min(100, value));
          progressIndicatorHtml = `<div 
            class="ubits-progress-bar__indicator-wrapper" 
            style="width: ${clampedValue}%;"
          ></div>`;
        }
        
        return `
          <div class="${classes}" style="height: ${sizeConfig.height}px;">
            <div class="ubits-progress-bar__container">
              ${progressIndicatorHtml}
            </div>
            ${indicatorHtml}
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del Progress Bar
      window.updateProgressBarPreview = function(componentId) {
        const state = initProgressBarPreviewState(componentId);
        
        // Limpiar instancia anterior
        if (progressBarInstances[componentId]) {
          progressBarInstances[componentId].destroy();
        }
        
        const previewContainer = document.getElementById(`progress-bar-preview-${componentId}`);
        if (!previewContainer) {
          return;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const cssLinkId = 'progress-bar-css';
        if (!document.getElementById(cssLinkId)) {
          const link = document.createElement('link');
          link.id = cssLinkId;
          link.rel = 'stylesheet';
          link.href = '../../addons/progress/src/styles/progress.css';
          document.head.appendChild(link);
        }
        
        // Preparar opciones
        let options = {
          size: state.size,
          variant: state.variant,
          value: state.value,
          indicator: state.indicator
        };
        
        // Si es multi-color, usar solo los segmentos activos segÃºn numSegments
        if (state.variant === 'multi-color') {
          const numSegments = state.numSegments || 4;
          // Asegurar que hay suficientes segmentos
          if (!state.segments || state.segments.length < numSegments) {
            const defaultSegments = [
              { value: 30, color: 'info' },
              { value: 25, color: 'yellow' },
              { value: 20, color: 'green' },
              { value: 25, color: 'error' },
              { value: 0, color: 'gray' }
            ];
            state.segments = defaultSegments.slice(0, numSegments);
          }
          // Usar solo los segmentos activos
          options.segments = state.segments.slice(0, numSegments);
          options.value = undefined;
        }
        
        // Renderizar Progress Bar
        const html = renderProgressBarLocal(options);
        previewContainer.innerHTML = html;
        
        // Guardar instancia (simulada para compatibilidad)
        progressBarInstances[componentId] = {
          destroy: () => {
            previewContainer.innerHTML = '';
          }
        };
        
        // Actualizar visibilidad del control de valor
        const valueControl = document.getElementById(`progress-value-control-${componentId}`);
        if (valueControl) {
          valueControl.style.display = state.variant === 'default' ? 'block' : 'none';
        }
        
        // Actualizar visibilidad de controles multi-color
        const multicolorControls = document.getElementById(`progress-multicolor-controls-${componentId}`);
        if (multicolorControls) {
          multicolorControls.style.display = state.variant === 'multi-color' ? 'block' : 'none';
        }
        
        // Actualizar visibilidad y valores de controles de segmentos si es multi-color
        if (state.variant === 'multi-color') {
          const numSegments = state.numSegments || 4;
          
          // Mostrar/ocultar wrappers de segmentos segÃºn numSegments
          for (let i = 1; i <= 5; i++) {
            const wrapper = document.getElementById(`progress-segment-${i}-wrapper-${componentId}`);
            if (wrapper) {
              wrapper.style.display = i <= numSegments ? 'flex' : 'none';
            }
          }
          
          // Actualizar valores de controles de segmentos activos
          if (state.segments) {
            state.segments.forEach((segment, index) => {
              const segmentNum = index + 1;
              if (segmentNum > numSegments) return;
              
              const colorSelect = document.getElementById(`progress-segment-${segmentNum}-color-${componentId}`);
              const valueInput = document.getElementById(`progress-segment-${segmentNum}-value-${componentId}`);
              const valueDisplay = document.getElementById(`progress-segment-${segmentNum}-display-${componentId}`);
              
              if (colorSelect) colorSelect.value = segment.color;
              if (valueInput) {
                valueInput.value = segment.value;
              }
              if (valueDisplay) {
                valueDisplay.textContent = `${segment.value}%`;
              }
            });
          }
          
          // Actualizar selector de nÃºmero de segmentos
          const segmentsCountSelect = document.getElementById(`progress-segments-count-${componentId}`);
          if (segmentsCountSelect) {
            segmentsCountSelect.value = numSegments;
          }
        }
        
        // Actualizar valor del slider
        const valueInput = document.getElementById(`progress-value-input-${componentId}`);
        const valueDisplay = document.getElementById(`progress-value-display-${componentId}`);
        if (valueInput && valueDisplay) {
          valueInput.value = state.value;
          valueDisplay.textContent = `${state.value}%`;
        }
        
        // Actualizar estado del toggle de indicador
        const indicatorToggle = document.getElementById(`progress-indicator-toggle-${componentId}`);
        const indicatorStatus = document.getElementById(`progress-indicator-status-${componentId}`);
        if (indicatorToggle && indicatorStatus) {
          indicatorToggle.checked = state.indicator;
          indicatorStatus.textContent = state.indicator ? 'Activado' : 'Desactivado';
        }
      };
      
      // FunciÃ³n para actualizar controles del Progress Bar
      window.setProgressBarControl = function(option, value, componentId) {
        const state = initProgressBarPreviewState(componentId);
        
        if (option === 'size') {
          state.size = value;
          
          // Actualizar botones activos
          const buttons = document.querySelectorAll(`[data-component="${componentId}"][data-option="size"]`);
          buttons.forEach(btn => {
            if (btn.getAttribute('data-value') === value) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        } else if (option === 'variant') {
          state.variant = value;
          
          // Actualizar botones activos
          const buttons = document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`);
          buttons.forEach(btn => {
            if (btn.getAttribute('data-value') === value) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        } else if (option === 'value') {
          state.value = value;
          
          // Actualizar display
          const valueDisplay = document.getElementById(`progress-value-display-${componentId}`);
          if (valueDisplay) {
            valueDisplay.textContent = `${value}%`;
          }
        } else if (option === 'indicator') {
          state.indicator = value;
          
          // Actualizar estado del toggle
          const indicatorStatus = document.getElementById(`progress-indicator-status-${componentId}`);
          if (indicatorStatus) {
            indicatorStatus.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        updateProgressBarPreview(componentId);
      };
      
      // FunciÃ³n para actualizar controles de segmentos multi-color
      window.setProgressBarSegmentControl = function(segmentNum, option, value, componentId) {
        const state = initProgressBarPreviewState(componentId);
        
        // Asegurar que el array tenga suficientes segmentos (hasta 5)
        if (!state.segments || state.segments.length < 5) {
          const defaultSegments = [
            { value: 30, color: 'info' },
            { value: 25, color: 'yellow' },
            { value: 20, color: 'green' },
            { value: 25, color: 'error' },
            { value: 0, color: 'gray' }
          ];
          if (!state.segments) {
            state.segments = defaultSegments.slice(0, state.numSegments || 4);
          } else {
            // Asegurar que hay 5 segmentos disponibles
            while (state.segments.length < 5) {
              state.segments.push({ value: 0, color: 'gray' });
            }
          }
        }
        
        const segmentIndex = segmentNum - 1;
        if (segmentIndex >= 0 && segmentIndex < state.segments.length && segmentIndex < 5) {
          if (option === 'color') {
            state.segments[segmentIndex].color = value;
          } else if (option === 'value') {
            state.segments[segmentIndex].value = value;
            
            // Actualizar display
            const valueDisplay = document.getElementById(`progress-segment-${segmentNum}-display-${componentId}`);
            if (valueDisplay) {
              valueDisplay.textContent = `${value}%`;
            }
          }
        }
        
        updateProgressBarPreview(componentId);
      };
      
      // FunciÃ³n para cambiar el nÃºmero de segmentos activos
      window.setProgressBarSegmentCount = function(count, componentId) {
        const state = initProgressBarPreviewState(componentId);
        
        // Validar que el count estÃ© entre 1 y 5
        count = Math.max(1, Math.min(5, parseInt(count)));
        state.numSegments = count;
        
        // Asegurar que hay suficientes segmentos en el array
        if (!state.segments || state.segments.length < count) {
          const defaultSegments = [
            { value: 30, color: 'info' },
            { value: 25, color: 'yellow' },
            { value: 20, color: 'green' },
            { value: 25, color: 'error' },
            { value: 0, color: 'gray' }
          ];
          if (!state.segments) {
            state.segments = [];
          }
          // Agregar segmentos faltantes con valores por defecto
          while (state.segments.length < count) {
            const defaultIndex = state.segments.length;
            state.segments.push(defaultSegments[defaultIndex] || { value: 0, color: 'gray' });
          }
        }
        
        updateProgressBarPreview(componentId);
      };
      
      // ========================================
      // SLIDER PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Slider
      const sliderPreviewState = {};
      
      // Instancias del Slider
      const sliderInstances = {};
      
      // Inicializar estado del preview del Slider
      function initSliderPreviewState(componentId) {
        if (!sliderPreviewState[componentId]) {
          sliderPreviewState[componentId] = {
            mode: 'single',
            orientation: 'horizontal',
            size: 'md',
            state: 'default',
            min: 0,
            max: 100,
            step: 1,
            value: 50,
            values: [25, 75],
            label: 'Rango de precio',
            helperText: '',
            showInputs: false,
            showMarks: false,
            showRangeGuide: false,
            showLabel: true,
            showHelper: false
          };
        }
        return sliderPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del Slider
      window.updateSliderPreview = function(componentId) {
        try {
          const state = initSliderPreviewState(componentId);
          const container = document.getElementById(`slider-preview-container-${componentId}`);
          
          if (!container) {
            return;
          }
          
          // Limpiar instancia anterior si existe
          if (sliderInstances[componentId]) {
            try {
              if (sliderInstances[componentId].destroy) {
                sliderInstances[componentId].destroy();
              }
            } catch (e) {
              // Silently handle destroy errors
            }
            sliderInstances[componentId] = null;
          }
          
          // Cargar CSS si no estÃ¡ cargado
          const existingSliderLink = document.querySelector('link[href*="slider.css"]');
          if (!existingSliderLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/slider/src/styles/slider.css';
            document.head.appendChild(link);
          }
          
          // Cargar CSS de Input si no estÃ¡ cargado (para los inputs del slider)
          const existingInputLink = document.querySelector('link[href*="input.css"]');
          if (!existingInputLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/input/src/styles/input.css';
            document.head.appendChild(link);
          }
          
          // Preparar opciones para el slider
          const sliderOptions = {
            containerId: `slider-preview-${componentId}`,
            label: state.label || '',
            helperText: state.showHelper ? (state.helperText || '') : '',
            size: state.size,
            state: state.state,
            orientation: state.orientation,
            mode: state.mode,
            min: state.min,
            max: state.max,
            step: state.step,
            showInputs: state.showInputs,
            showLabel: state.showLabel,
            showHelper: state.showHelper,
            showMarks: state.showMarks,
            marks: state.showMarks ? [state.min, (state.min + state.max) / 2, state.max] : [],
            showRangeGuide: state.showRangeGuide
          };
          
          // Agregar valores segÃºn el modo
          if (state.mode === 'range') {
            sliderOptions.values = state.values;
          } else {
            sliderOptions.value = state.value;
          }
          
          // Limpiar contenedor
          container.innerHTML = '';
          
          // Ajustar altura del contenedor segÃºn orientaciÃ³n
          const parentContainer = container.parentElement;
          if (state.orientation === 'vertical') {
            container.style.minHeight = '300px';
            container.style.height = '300px';
            container.style.display = 'flex';
            container.style.alignItems = 'center';
            container.style.justifyContent = 'center';
            // Ajustar tambiÃ©n el contenedor padre
            if (parentContainer) {
              parentContainer.style.minHeight = '400px';
              parentContainer.style.alignItems = 'center';
            }
          } else {
            container.style.minHeight = '200px';
            container.style.height = 'auto';
            container.style.display = 'block';
            // Restaurar contenedor padre a valores por defecto
            if (parentContainer) {
              parentContainer.style.minHeight = '200px';
              parentContainer.style.alignItems = 'center';
            }
          }
          
          // Crear contenedor para el slider
          const sliderContainer = document.createElement('div');
          sliderContainer.id = `slider-preview-${componentId}`;
          if (state.orientation === 'vertical') {
            sliderContainer.style.width = '100%';
            sliderContainer.style.height = '100%';
            sliderContainer.style.minHeight = '250px';
            sliderContainer.style.display = 'flex';
            sliderContainer.style.alignItems = 'center';
            sliderContainer.style.justifyContent = 'center';
          }
          container.appendChild(sliderContainer);
          
          // Cargar el mÃ³dulo del Slider usando UMD (como Badge)
          const loadSliderModule = () => {
            // Verificar si createSlider ya estÃ¡ disponible
            if (typeof window.createSlider !== 'undefined') {
              createSliderInstance();
              return;
            }
            
            // Verificar si el script UMD ya estÃ¡ cargando
            const existingScript = document.querySelector('script[src*="slider.umd.js"]');
            if (existingScript) {
              // Esperar a que el script se cargue
              const checkLoaded = setInterval(() => {
                if (typeof window.createSlider !== 'undefined') {
                  clearInterval(checkLoaded);
                  createSliderInstance();
                }
              }, 100);
              // Timeout despuÃ©s de 5 segundos
              setTimeout(() => {
                clearInterval(checkLoaded);
                if (typeof window.createSlider === 'undefined') {
                  showError('Timeout esperando que el script se cargue');
                }
              }, 5000);
              return;
            }
            
            // Cargar el script UMD
            const script = document.createElement('script');
            script.src = '../../addons/slider/dist/slider.umd.js?v=' + Date.now();
            script.onload = () => {
              // El mÃ³dulo UMD expone createSlider directamente
              // Intentar mÃºltiples formas de acceso
              let createSliderFn = null;
              
              // 1. Verificar si ya estÃ¡ en window.createSlider
              if (typeof window.createSlider === 'function') {
                createSliderFn = window.createSlider;
              }
              // 2. Verificar window.UbitsSlider.createSlider
              else if (window.UbitsSlider && typeof window.UbitsSlider.createSlider === 'function') {
                createSliderFn = window.UbitsSlider.createSlider;
                window.createSlider = createSliderFn;
              }
              // 3. Verificar window.UBITS.Slider.create
              else if (window.UBITS && window.UBITS.Slider && typeof window.UBITS.Slider.create === 'function') {
                createSliderFn = window.UBITS.Slider.create;
                window.createSlider = createSliderFn;
              }
              // 4. Intentar inicializar el addon si existe
              else if (window.UbitsSlider && window.UbitsSlider.SliderAddon) {
                const addon = new window.UbitsSlider.SliderAddon();
                addon.initialize({}).then(() => {
                  if (typeof window.createSlider === 'function') {
                    createSliderInstance();
                  } else {
                    showError('createSlider no disponible despuÃ©s de inicializar el addon');
                  }
                }).catch(err => {
                  showError('Error inicializando SliderAddon: ' + err.message);
                });
                return;
              }
              
              if (createSliderFn) {
                window.createSlider = createSliderFn;
                createSliderInstance();
              } else {
                showError('createSlider no estÃ¡ disponible despuÃ©s de cargar el script. Verifica la consola para mÃ¡s detalles.');
              }
            };
            script.onerror = () => {
              showError('Error cargando el archivo JavaScript del componente');
            };
            document.head.appendChild(script);
          };
          
          // FunciÃ³n para crear la instancia del slider
          const createSliderInstance = () => {
            try {
              if (typeof window.createSlider === 'undefined') {
                showError('createSlider no estÃ¡ disponible');
                return;
              }
              
              const sliderInstance = window.createSlider(sliderOptions);
              
              if (sliderInstance && sliderInstance.element) {
                sliderInstances[componentId] = sliderInstance;
                
                // Agregar el slider al contenedor
                if (sliderInstance.element && sliderContainer) {
                  sliderContainer.appendChild(sliderInstance.element);
                } else if (sliderInstance.element) {
                  container.appendChild(sliderInstance.element);
                }
              } else {
                showError(`No se pudo crear la instancia del Slider. Instancia: ${sliderInstance ? 'existe pero sin element' : 'null'}`);
              }
            } catch (error) {
              showError(error.message || 'Error desconocido al crear el slider');
            }
          };
          
          // FunciÃ³n para mostrar errores
          const showError = (message) => {
            container.innerHTML = `
              <div style="padding: 20px; background: var(--ubits-bg-2); border-radius: 8px; color: var(--ubits-fg-1-high);">
                <p>Error cargando el componente Slider.</p>
                <p style="font-size: 12px; color: var(--ubits-fg-1-medium); margin-top: 8px;">${message}</p>
                <p style="font-size: 11px; color: var(--ubits-fg-1-low); margin-top: 4px;">Revisa la consola para mÃ¡s detalles</p>
              </div>
            `;
          };
          
          // Cargar el mÃ³dulo
          setTimeout(loadSliderModule, 100);
        } catch (error) {
          // Silently handle errors
        }
      };
      
      // FunciÃ³n para actualizar controles del Slider
      window.setSliderControl = function(option, value, componentId) {
        try {
          const state = initSliderPreviewState(componentId);
          
          if (option === 'mode') {
            state.mode = value;
            // Actualizar botones activos
            document.querySelectorAll(`[data-component="${componentId}"][data-option="mode"]`).forEach(btn => {
              btn.classList.toggle('active', btn.getAttribute('data-value') === value);
            });
          } else if (option === 'orientation') {
            state.orientation = value;
            // Actualizar botones activos
            document.querySelectorAll(`[data-component="${componentId}"][data-option="orientation"]`).forEach(btn => {
              btn.classList.toggle('active', btn.getAttribute('data-value') === value);
            });
          } else if (option === 'size') {
            state.size = value;
          } else if (option === 'state') {
            state.state = value;
            // Actualizar botones activos
            document.querySelectorAll(`[data-component="${componentId}"][data-option="state"]`).forEach(btn => {
              btn.classList.toggle('active', btn.getAttribute('data-value') === value);
            });
          } else if (option === 'min') {
            state.min = value;
            // Asegurar que value/values estÃ©n dentro del rango
            if (state.mode === 'range') {
              state.values[0] = Math.max(state.min, state.values[0]);
              state.values[1] = Math.max(state.min, state.values[1]);
            } else {
              state.value = Math.max(state.min, state.value);
            }
          } else if (option === 'max') {
            state.max = value;
            // Asegurar que value/values estÃ©n dentro del rango
            if (state.mode === 'range') {
              state.values[0] = Math.min(state.max, state.values[0]);
              state.values[1] = Math.min(state.max, state.values[1]);
            } else {
              state.value = Math.min(state.max, state.value);
            }
          } else if (option === 'step') {
            state.step = value;
          } else if (option === 'label') {
            state.label = value;
          } else if (option === 'helperText') {
            state.helperText = value;
          } else if (option === 'showInputs') {
            state.showInputs = value;
            const statusEl = document.getElementById(`slider-show-inputs-status-${componentId}`);
            if (statusEl) {
              statusEl.textContent = value ? 'Activado' : 'Desactivado';
            }
          } else if (option === 'showMarks') {
            state.showMarks = value;
            const statusEl = document.getElementById(`slider-show-marks-status-${componentId}`);
            if (statusEl) {
              statusEl.textContent = value ? 'Activado' : 'Desactivado';
            }
          } else if (option === 'showRangeGuide') {
            state.showRangeGuide = value;
            const statusEl = document.getElementById(`slider-show-range-guide-status-${componentId}`);
            if (statusEl) {
              statusEl.textContent = value ? 'Activado' : 'Desactivado';
            }
          } else if (option === 'showLabel') {
            state.showLabel = value;
            const statusEl = document.getElementById(`slider-show-label-status-${componentId}`);
            if (statusEl) {
              statusEl.textContent = value ? 'Activado' : 'Desactivado';
            }
          } else if (option === 'showHelper') {
            state.showHelper = value;
            const statusEl = document.getElementById(`slider-show-helper-status-${componentId}`);
            if (statusEl) {
              statusEl.textContent = value ? 'Activado' : 'Desactivado';
            }
          }
          
          // Actualizar preview
          if (typeof window.updateSliderPreview === 'function') {
            try {
              window.updateSliderPreview(componentId);
            } catch (e) {
              // Silently handle errors
            }
          }
        } catch (error) {
          // Silently handle errors
        }
      };
      
      // ========================================
      // FILE UPLOAD PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del File Upload
      const fileUploadPreviewState = {};
      
      // Instancias del File Upload
      const fileUploadInstances = {};
      
      // Inicializar estado del File Upload
      function initFileUploadPreviewState(componentId) {
        if (!fileUploadPreviewState[componentId]) {
          fileUploadPreviewState[componentId] = {
              view: 'dropzone', // 'dropzone' o 'files-list'
            state: 'default',
              files: [],
              maxFiles: 6,
              maxSize: 5 * 1024 * 1024, // 5 MB en bytes
              showFileSize: true,
              showProgress: true,
              showIcon: false,
              dropText: 'Arrastra tus archivos aquÃ­',
              selectButtonText: 'Seleccionar archivos',
            // Legacy support
            fileName: '',
            fileExtension: '',
            fileSize: 2 * 1024 * 1024,
            showActions: true,
            uploadText: 'Haz clic para subir archivo',
            fileStatus: 'pending'
          };
        }
        return fileUploadPreviewState[componentId];
      }
      
      // FunciÃ³n para renderizar File Upload localmente (usa el nuevo diseÃ±o)
      function renderFileUploadLocal(options) {
        const {
          view = 'dropzone',
          state = 'default',
          files = [],
          maxFiles = 6,
          maxSize = 5 * 1024 * 1024,
          showFileSize = true,
          showProgress = true,
          showIcon = false,
          dropText = 'Arrastra tus archivos aquÃ­',
          selectButtonText = 'Seleccionar archivos',
          // Legacy support
          fileName = '',
          fileExtension = '',
          fileSize = 0,
          showActions = true,
          uploadText = 'Haz clic para subir archivo',
          fileStatus = 'pending'
        } = options;
        
        // Formatear tamaÃ±o del archivo
        function formatFileSize(bytes) {
          if (bytes === 0) return '0 B';
          const k = 1024;
          const sizes = ['B', 'KB', 'MB', 'GB'];
          const i = Math.floor(Math.log(bytes) / Math.log(k));
          return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        // Vista de lista de archivos
        if (view === 'files-list' && files && files.length > 0) {
          const isSingleMode = maxFiles === 1;
          // En modo single, solo mostrar el primer archivo
          const filesToShow = isSingleMode ? files.slice(0, 1) : files;
          const filesListHtml = filesToShow.map((file, index) => {
            const fileId = file.id || `file-${index}`;
            const fileProgress = file.progress !== undefined ? file.progress : 0;
            const showFileProgress = showProgress && file.status === 'uploading' && fileProgress > 0;

            return `
              <div class="ubits-file-upload__file-item" data-file-id="${fileId}">
                <div class="ubits-file-upload__file-icon">
                  <i class="far fa-file"></i>
            </div>
                <div class="ubits-file-upload__file-info">
                  <div class="ubits-file-upload__file-name">${file.name}</div>
                  ${showFileSize ? `<div class="ubits-file-upload__file-size">${formatFileSize(file.size)}</div>` : ''}
                  ${showFileProgress ? `
                    <div class="ubits-file-upload__progress-container">
                      <div class="ubits-progress-bar ubits-progress-bar--xs" style="height: 4px;">
                        <div class="ubits-progress-bar__container">
                          <div class="ubits-progress-bar__indicator-wrapper" style="width: ${fileProgress}%;"></div>
            </div>
                        <span class="ubits-progress-bar__indicator">${fileProgress}%</span>
            </div>
            </div>
                  ` : ''}
            </div>
                <button class="ubits-file-upload__file-remove" data-file-id="${fileId}" aria-label="Eliminar archivo">
                  <i class="far fa-times"></i>
                </button>
            </div>
          `;
          }).join('');

          // En modo single, no mostrar tÃ­tulo con contador ni botones Add/Remove all
          const headerHtml = isSingleMode ? '' : `
            <div class="ubits-file-upload__header">
              <h3 class="ubits-file-upload__title">Files (${filesToShow.length})</h3>
              <div class="ubits-file-upload__header-actions">
                <button class="ubits-button ubits-button--secondary ubits-button--sm ubits-file-upload__add-button" aria-label="Agregar archivos">
                  <i class="far fa-arrow-up-from-bracket"></i> Agregar archivos
                </button>
                <button class="ubits-button ubits-button--secondary ubits-button--sm ubits-file-upload__remove-all-button" aria-label="Eliminar todos">
                  <i class="far fa-trash"></i> Eliminar todos
                </button>
              </div>
            </div>
          `;

          return `
            <div class="ubits-file-upload ubits-file-upload--files-list ${isSingleMode ? 'ubits-file-upload--single-mode' : ''}">
              ${headerHtml}
              <div class="ubits-file-upload__files-list">
                ${filesListHtml}
              </div>
            </div>
          `.trim();
        }
        
        // Vista de drop zone (default)
        const classes = [
          'ubits-file-upload',
          `ubits-file-upload--${state}`
        ].filter(Boolean).join(' ');

        // Determinar estilos del borde segÃºn el estado
        let borderColor = 'var(--ubits-border-1, #d0d2d5)';
        let backgroundColor = 'var(--ubits-bg-1, #ffffff)';

        if (state === 'dragging') {
          borderColor = 'var(--ubits-accent-brand-static-inverted, #0c5bef)';
        } else if (state === 'error') {
          borderColor = 'var(--ubits-feedback-accent-error, #e9343c)';
        } else if (state === 'disabled') {
          backgroundColor = 'var(--ubits-bg-disabled, #edeeef)';
          borderColor = 'var(--ubits-border-disabled, #e1e2e5)';
        }

        // Generar texto de restricciones
        const constraintsText = `MÃ¡x. ${maxFiles} archivos Â· Hasta ${formatFileSize(maxSize)}`;
        
        // Icono circular con icono de archivo (opcional)
        const iconHtml = showIcon ? `
          <div class="ubits-file-upload__drop-icon">
            <i class="far fa-file"></i>
          </div>
        ` : '';

        return `
          <div class="${classes}" 
               style="background-color: ${backgroundColor}; border-color: ${borderColor};"
               tabindex="${state === 'disabled' ? '-1' : '0'}"
               role="button"
               aria-disabled="${state === 'disabled' ? 'true' : 'false'}">
            <div class="ubits-file-upload__drop-zone">
              ${iconHtml}
              <div class="ubits-file-upload__drop-content">
                <div class="ubits-file-upload__drop-text">${dropText}</div>
                <div class="ubits-file-upload__constraints">${constraintsText}</div>
              </div>
              <button class="ubits-button ubits-button--secondary ubits-button--sm ubits-file-upload__select-button" type="button">
                <i class="far fa-arrow-up-from-bracket"></i> ${selectButtonText}
              </button>
            </div>
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del File Upload
      window.updateFileUploadPreview = function(componentId) {
        const state = initFileUploadPreviewState(componentId);
        
        // Leer valores de los inputs si existen
        const maxFilesInput = document.getElementById(`file-upload-maxfiles-input-${componentId}`);
        const maxSizeInput = document.getElementById(`file-upload-maxsize-input-${componentId}`);
        const dropTextInput = document.getElementById(`file-upload-droptext-input-${componentId}`);
        const selectTextInput = document.getElementById(`file-upload-selecttext-input-${componentId}`);
        const showProgressToggle = document.getElementById(`file-upload-showprogress-toggle-${componentId}`);
        const showIconToggle = document.getElementById(`file-upload-showicon-toggle-${componentId}`);
        
        if (maxFilesInput) state.maxFiles = parseInt(maxFilesInput.value) || 6;
        if (maxSizeInput) state.maxSize = parseFloat(maxSizeInput.value) * 1024 * 1024 || 5 * 1024 * 1024;
        if (dropTextInput) state.dropText = dropTextInput.value || 'Arrastra tus archivos aquÃ­';
        if (selectTextInput) state.selectButtonText = selectTextInput.value || 'Seleccionar archivos';
        if (showProgressToggle) state.showProgress = showProgressToggle.checked;
        if (showIconToggle) state.showIcon = showIconToggle.checked;
        
        // Limpiar instancia anterior
        if (fileUploadInstances[componentId]) {
          fileUploadInstances[componentId].destroy();
        }
        
        const previewContainer = document.getElementById(`file-upload-preview-${componentId}`);
        if (!previewContainer) {
          return;
        }
        
        // Cargar CSS si no estÃ¡ cargado
        const cssLinkId = 'file-upload-css';
        if (!document.getElementById(cssLinkId)) {
          const link = document.createElement('link');
          link.id = cssLinkId;
          link.rel = 'stylesheet';
          link.href = '../../addons/file-upload/src/styles/file-upload.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Button si no estÃ¡ cargado (para los botones)
        const buttonCssLinkId = 'button-css';
        if (!document.getElementById(buttonCssLinkId)) {
          const buttonLink = document.createElement('link');
          buttonLink.id = buttonCssLinkId;
          buttonLink.rel = 'stylesheet';
          buttonLink.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(buttonLink);
        }
        
        // Cargar CSS de Progress si no estÃ¡ cargado (para la barra de progreso)
        const progressCssLinkId = 'progress-bar-css';
        if (!document.getElementById(progressCssLinkId)) {
          const progressLink = document.createElement('link');
          progressLink.id = progressCssLinkId;
          progressLink.rel = 'stylesheet';
          progressLink.href = '../../addons/progress/src/styles/progress.css';
          document.head.appendChild(progressLink);
        }
        
        // Limitar archivos si maxFiles es 1
        let filesToRender = state.files || [];
        if (state.maxFiles === 1 && filesToRender.length > 1) {
          filesToRender = filesToRender.slice(0, 1);
        }
        
        // Renderizar File Upload
        const html = renderFileUploadLocal({
          view: state.view,
          state: state.state,
          files: filesToRender,
          maxFiles: state.maxFiles,
          maxSize: state.maxSize,
          showFileSize: state.showFileSize,
          showProgress: state.showProgress,
          showIcon: state.showIcon,
          dropText: state.dropText,
          selectButtonText: state.selectButtonText
        });
        
        previewContainer.innerHTML = html;
        
        // Guardar instancia (simulada para compatibilidad)
        fileUploadInstances[componentId] = {
          destroy: () => {
            previewContainer.innerHTML = '';
          }
        };
        
        // Actualizar estados de los controles de vista
        const viewButtons = document.querySelectorAll(`[data-component="${componentId}"][data-option="view"]`);
        viewButtons.forEach(btn => {
          if (btn.getAttribute('data-value') === state.view) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });
        
        // Actualizar estados de los controles de estado (solo para dropzone)
        const stateButtons = document.querySelectorAll(`[data-component="${componentId}"][data-option="state"]`);
        stateButtons.forEach(btn => {
          if (btn.getAttribute('data-value') === state.state) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });
        
        // Mostrar/ocultar controles segÃºn la vista
        const stateControl = document.getElementById(`file-upload-state-control-${componentId}`);
        const dropTextControl = document.getElementById(`file-upload-droptext-control-${componentId}`);
        const selectTextControl = document.getElementById(`file-upload-selecttext-control-${componentId}`);
        const iconControl = document.getElementById(`file-upload-icon-control-${componentId}`);
        const progressControl = document.getElementById(`file-upload-progress-control-${componentId}`);
        const filesActions = document.getElementById(`file-upload-files-actions-${componentId}`);
        
        if (state.view === 'dropzone') {
          if (stateControl) stateControl.style.display = 'block';
          if (dropTextControl) dropTextControl.style.display = 'block';
          if (selectTextControl) selectTextControl.style.display = 'block';
          if (iconControl) iconControl.style.display = 'block';
          if (progressControl) progressControl.style.display = 'none';
          if (filesActions) filesActions.style.display = 'none';
        } else {
          if (stateControl) stateControl.style.display = 'none';
          if (dropTextControl) dropTextControl.style.display = 'none';
          if (selectTextControl) selectTextControl.style.display = 'none';
          if (iconControl) iconControl.style.display = 'none';
          if (progressControl) progressControl.style.display = 'block';
          if (filesActions) filesActions.style.display = 'block';
        }
        
        // Actualizar estados de los switches
        const showProgressStatus = document.getElementById(`file-upload-showprogress-status-${componentId}`);
        if (showProgressStatus) {
          showProgressStatus.textContent = state.showProgress ? 'Activado' : 'Desactivado';
        }
        
        const showIconStatus = document.getElementById(`file-upload-showicon-status-${componentId}`);
        if (showIconStatus) {
          showIconStatus.textContent = state.showIcon ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar estado visual del toggle de icono
        const showIconToggleElement = document.getElementById(`file-upload-showicon-toggle-${componentId}`);
        if (showIconToggleElement) {
          showIconToggleElement.checked = state.showIcon;
          const toggleLabel = showIconToggleElement.closest('.ubits-toggle');
          if (toggleLabel) {
            if (state.showIcon) {
              toggleLabel.classList.add('ubits-toggle--checked');
            } else {
              toggleLabel.classList.remove('ubits-toggle--checked');
            }
          }
        }
      };
      
      // FunciÃ³n para actualizar controles del File Upload
      window.setFileUploadControl = function(option, value, componentId) {
        const state = initFileUploadPreviewState(componentId);
        
        if (option === 'view') {
          state.view = value;
        } else if (option === 'state') {
          state.state = value;
        } else if (option === 'maxFiles') {
          state.maxFiles = value;
        } else if (option === 'maxSize') {
          state.maxSize = value;
        } else if (option === 'dropText') {
          state.dropText = value;
        } else if (option === 'selectButtonText') {
          state.selectButtonText = value;
        } else if (option === 'showProgress') {
          state.showProgress = value;
        } else if (option === 'showIcon') {
          state.showIcon = value;
        } else if (option === 'showFileSize') {
          state.showFileSize = value;
        } else if (option === 'showActions') {
          state.showActions = value;
        }
        
        updateFileUploadPreview(componentId);
      };
      
      // FunciÃ³n para agregar archivos de ejemplo
      window.addExampleFiles = function(componentId) {
        const state = initFileUploadPreviewState(componentId);
        
        // Si maxFiles es 1, solo agregar un archivo
        if (state.maxFiles === 1) {
          state.files = [
            { name: 'index.html', size: 1392640, id: 'file-1', status: 'uploading', progress: 70 }
          ];
        } else {
          const exampleFiles = [
            { name: 'index.html', size: 1392640, id: 'file-1', status: 'uploading', progress: 70 },
            { name: 'respuestas_emocionales_nom035.csv', size: 5847, id: 'file-2', status: 'completed' }
          ];
          state.files = exampleFiles;
        }
        
        state.view = 'files-list';
        updateFileUploadPreview(componentId);
      };
      
      // FunciÃ³n para limpiar archivos
      window.clearFiles = function(componentId) {
        const state = initFileUploadPreviewState(componentId);
        state.files = [];
        state.view = 'dropzone';
        updateFileUploadPreview(componentId);
      };
      
      // ========================================
      // ALERT PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Alert
      const alertPreviewState = {};
      
      // Mapeo de iconos por tipo
      const alertIconMap = {
        success: 'fa-check-circle',
        info: 'fa-info-circle',
        warning: 'fa-exclamation-triangle',
        error: 'fa-times-circle'
      };
      
      // Mensajes por defecto por tipo
      const alertMessages = {
        success: 'Los cambios se han guardado correctamente.',
        info: 'Esta es una notificaciÃ³n informativa del sistema.',
        warning: 'Por favor, revisa los datos antes de continuar.',
        error: 'Ha ocurrido un error al procesar la solicitud.'
      };
      
      // Inicializar estado del Alert
      function initAlertPreviewState(componentId) {
        if (!alertPreviewState[componentId]) {
          alertPreviewState[componentId] = {
            type: 'success',
            message: alertMessages.success,
            closable: true
          };
        }
        return alertPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML del alert
      function generateAlertHTML(state, componentId) {
        const { type, message, closable } = state;
        
        const iconClass = alertIconMap[type] || alertIconMap.success;
        const classes = [
          'ubits-alert',
          `ubits-alert--${type}`,
          !closable && 'ubits-alert--no-close'
        ].filter(Boolean).join(' ');
        
        return `
          <div class="${classes}" role="alert" aria-live="polite">
            <div class="ubits-alert__icon">
              <i class="far ${iconClass}"></i>
            </div>
            <div class="ubits-alert__content">
              <div class="ubits-alert__text">${message}</div>
            </div>
            ${closable ? `
              <button class="ubits-alert__close" aria-label="Cerrar alerta" onclick="this.closest('.ubits-alert').classList.add('ubits-alert--closing'); setTimeout(() => this.closest('.ubits-alert')?.remove(), 300);">
                <i class="far fa-times"></i>
              </button>
            ` : ''}
          </div>
        `.trim();
      }
      
      // FunciÃ³n para actualizar el preview del alert
      window.updateAlertPreview = function(componentId) {
        const state = initAlertPreviewState(componentId);
        const preview = document.getElementById(`alert-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Alert no encontrado:', `alert-preview-${componentId}`);
          return;
        }
        
        const alertHTML = generateAlertHTML(state, componentId);
        preview.innerHTML = alertHTML;
        
        console.log('âœ… Alert preview actualizado:', {
          type: state.type,
          message: state.message,
          closable: state.closable
        });
      };
      
      // FunciÃ³n unificada para controles del Alert
      window.setAlertControl = function(option, value, componentId) {
        const state = initAlertPreviewState(componentId);
        
        if (option === 'type') {
          state.type = value;
          // Actualizar mensaje segÃºn tipo
          state.message = alertMessages[value] || state.message;
          // Actualizar botones activos de tipo
          document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          // Actualizar input de mensaje
          const messageInput = document.getElementById(`alert-message-input-${componentId}`);
          if (messageInput) messageInput.value = state.message;
        } else if (option === 'message') {
          state.message = value || alertMessages[state.type];
          const input = document.getElementById(`alert-message-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'closable') {
          state.closable = value;
          const toggle = document.getElementById(`alert-closable-toggle-${componentId}`);
          if (toggle) toggle.checked = value;
        }
        
        // Actualizar preview
        updateAlertPreview(componentId);
      };
      
      // Inicializar preview de Alert cuando se carga el componente
      function initializeAlertPreview(componentId) {
        setTimeout(() => {
          const preview = document.getElementById(`alert-preview-${componentId}`);
          if (preview && preview.innerHTML.trim() === '') {
            updateAlertPreview(componentId);
          }
        }, 100);
        
        // Observer para cuando el preview se vuelve visible
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              updateAlertPreview(componentId);
              observer.unobserve(entry.target);
            }
          });
        }, { threshold: 0.1 });
        
        setTimeout(() => {
          const preview = document.getElementById(`alert-preview-${componentId}`);
          if (preview) observer.observe(preview);
        }, 200);
      }
      
      // ========================================
      // TOAST PREVIEW FUNCTIONS
      // ========================================
      
      // Mensajes por defecto por tipo (con texto largo de ejemplo)
      const toastTitles = {
        success: 'OperaciÃ³n completada',
        info: 'InformaciÃ³n',
        warning: 'Advertencia',
        error: 'Error'
      };

      const toastMessages = {
        success: 'Los cambios se han guardado correctamente. Este ejemplo de texto es mÃ¡s largo para demostrar cÃ³mo funciona el espaciado y el botÃ³n de acciÃ³n debajo del texto.',
        info: 'Esta es una notificaciÃ³n informativa del sistema. Este mensaje contiene varias lÃ­neas de texto para mostrar cÃ³mo el botÃ³n de acciÃ³n se posiciona correctamente en la parte inferior derecha del contenido.',
        warning: 'Por favor, revisa los datos antes de continuar. Este mensaje de advertencia es mÃ¡s extenso para demostrar la disposiciÃ³n del componente con mÃºltiples lÃ­neas de texto y el botÃ³n de acciÃ³n debajo.',
        error: 'Ha ocurrido un error al procesar la solicitud. Este mensaje de error contiene texto adicional para mostrar cÃ³mo el botÃ³n de acciÃ³n se alinea correctamente cuando hay contenido largo en el toast.'
      };
      
      // Estado del preview del Toast
      const toastPreviewState = {};
      
      // Inicializar estado del Toast
      function initToastPreviewState(componentId) {
        if (!toastPreviewState[componentId]) {
          toastPreviewState[componentId] = {
            action: false // BotÃ³n de acciÃ³n desactivado por defecto
          };
        }
        return toastPreviewState[componentId];
      }
      
      // FunciÃ³n para manejar controles del Toast
      window.setToastControl = function(option, value, componentId) {
        const state = initToastPreviewState(componentId);
        
        if (option === 'action') {
          state.action = value;
          const toggle = document.getElementById(`toast-action-toggle-${componentId}`);
          const statusSpan = document.getElementById(`toast-action-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
      };
      
      // Asegurar que el container existe (declarar primero)
      function ensureToastContainer() {
        let container = document.getElementById('ubits-toast-container');
        if (!container) {
          container = document.createElement('div');
          container.id = 'ubits-toast-container';
          // Aplicar estilos inline como respaldo
          container.style.cssText = `
            position: fixed !important;
            top: 16px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            gap: 12px !important;
            width: 100% !important;
            max-width: 560px !important;
            min-width: 320px !important;
            padding: 0 16px !important;
            box-sizing: border-box !important;
            z-index: 10000 !important;
            pointer-events: none !important;
          `;
          document.body.appendChild(container);
          console.log('âœ… Container de toast creado:', container);
        } else {
          console.log('âœ… Container de toast ya existe:', container);
        }
        return container;
      }
      
      // FunciÃ³n simple para renderizar toast (para preview en autoframe)
      function renderToastSimple(type, message, options = {}) {
        const container = ensureToastContainer();
        const noClose = options.noClose || false;
        const action = options.action; // Puede ser un objeto {label, onClick} o false/undefined
        const title = options.title || ''; // TÃ­tulo opcional
        
        console.log('ğŸ”” Mostrando toast:', { type, title, message, container: container.id, action });
        
        const iconMap = {
          success: 'fa-check-circle',
          info: 'fa-info-circle',
          warning: 'fa-exclamation-triangle',
          error: 'fa-times-circle'
        };
        
        const iconClass = iconMap[type] || iconMap.info;
        const role = (type === 'warning' || type === 'error') ? 'alert' : 'status';
        const ariaLive = (type === 'warning' || type === 'error') ? 'assertive' : 'polite';
        
        // Colores por variante usando tokens UBITS (con fallback si los tokens no cargan)
        const variantColors = {
          success: { 
            bg: 'var(--ubits-feedback-bg-success-subtle, #e8f8e4)', 
            color: 'var(--ubits-feedback-fg-success-subtle, #223b16)', 
            border: 'var(--ubits-feedback-border-success-static, #41c433)' 
          },
          info: { 
            bg: 'var(--ubits-feedback-bg-info-subtle, #f3f2ff)', 
            color: 'var(--ubits-feedback-fg-info-subtle, #20335f)', 
            border: 'var(--ubits-feedback-border-info-static, #97a5fd)' 
          },
          warning: { 
            bg: 'var(--ubits-feedback-bg-warning-subtle, #fff1e0)', 
            color: 'var(--ubits-feedback-fg-warning-subtle, #4c2e15)', 
            border: 'var(--ubits-feedback-border-warning-static, #ec9907)' 
          },
          error: { 
            bg: 'var(--ubits-feedback-bg-error-subtle, #fff0ee)', 
            color: 'var(--ubits-feedback-fg-error-subtle, #65181e)', 
            border: 'var(--ubits-feedback-border-error-static, #fd8a82)' 
          }
        };
        
        const colors = variantColors[type] || variantColors.info;
        
        const toast = document.createElement('div');
        toast.className = `ubits-toast ubits-toast--${type}`;
        toast.setAttribute('role', role);
        toast.setAttribute('aria-live', ariaLive);
        
        // Asegurar que el toast sea visible con estilos inline como respaldo
        toast.style.cssText = `
          display: flex !important;
          gap: 8px !important;
          align-items: flex-start !important;
          padding: 16px !important;
          border-radius: 10px !important;
          position: relative !important;
          width: 100% !important;
          max-width: 560px !important;
          min-width: 320px !important;
          z-index: 10001 !important;
          pointer-events: auto !important;
          opacity: 1 !important;
          transform: translateY(0) !important;
          background-color: ${colors.bg} !important;
          color: ${colors.color} !important;
          border: 1px solid ${colors.border} !important;
          box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)) !important;
        `;
        
        // Header con icono, tÃ­tulo y botÃ³n cerrar alineados
        const headerHTML = `
          <div class="ubits-toast__header" style="display: flex; align-items: center; width: 100%; gap: 8px;">
            <div class="ubits-toast__icon" style="flex-shrink: 0; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 18px; line-height: 1;">
              <i class="far ${iconClass}"></i>
            </div>
            <div class="ubits-toast__title" style="font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); font-weight: var(--weight-bold); color: inherit; flex: 1; min-width: 0;">${title || ''}</div>
            ${!noClose ? `
              <button class="ubits-button ubits-button--tertiary ubits-button--sm ubits-toast__close" aria-label="Cerrar notificaciÃ³n" style="padding: 0 10px; color: ${colors.border};" onclick="this.closest('.ubits-toast').classList.add('ubits-toast--exit'); setTimeout(() => this.closest('.ubits-toast')?.remove(), 180);">
                <i class="far fa-times"></i>
              </button>
            ` : ''}
          </div>
        `;
        
        // BotÃ³n de acciÃ³n opcional
        const hasAction = action && typeof action === 'object' && action.label;
        const actionButtonHTML = hasAction ? `
          <div class="ubits-toast__actions" style="display: flex; justify-content: flex-end; align-items: center; width: 100%; margin-top: 4px;">
            <button class="ubits-toast__action ubits-toast__action--${type}" type="button" data-toast-action style="display: inline-flex; align-items: center; justify-content: center; height: 32px; min-height: 32px; padding: 10px 14px; border: none; border-radius: 6px; font-family: var(--font-sans); font-size: var(--font-body-sm-size); font-weight: var(--weight-semibold); line-height: var(--font-body-sm-line); cursor: pointer; color: white; background-color: ${colors.border}; box-shadow: var(--ubits-effects-elevation-1, 0px 1px 2px 0px rgba(0, 0, 0, 0.12));">
              <span>${action.label}</span>
            </button>
          </div>
        ` : '';
        
        toast.innerHTML = `
          <div class="ubits-toast__content" style="display: flex; flex-direction: column; gap: 2px; align-items: flex-start; min-width: 0; flex: 1;">
            ${headerHTML}
            <div class="ubits-toast__body" style="font-size: var(--font-body-md-size); line-height: var(--font-body-md-line); font-weight: var(--weight-regular); color: inherit; width: 100%; word-wrap: break-word;">${message}</div>
            ${actionButtonHTML}
          </div>
        `;
        
        // Agregar event listener al botÃ³n de acciÃ³n si existe
        if (hasAction && action.onClick) {
          const actionBtn = toast.querySelector('[data-toast-action]');
          if (actionBtn) {
            actionBtn.addEventListener('click', (e) => {
              e.stopPropagation();
              action.onClick();
            });
          }
        }
        
        container.appendChild(toast);
        
        console.log('âœ… Toast agregado al DOM:', {
          container: container.id,
          toast: toast.className,
          containerChildren: container.children.length
        });
        
        // AnimaciÃ³n de entrada
        requestAnimationFrame(() => {
          toast.classList.add('ubits-toast--enter');
          console.log('âœ… AnimaciÃ³n de entrada aplicada');
        });
        
        // Auto-cierre
        const duration = options.duration || (type === 'success' || type === 'info' ? 3500 : type === 'warning' ? 5000 : 6500);
        if (duration > 0) {
          setTimeout(() => {
            toast.classList.add('ubits-toast--exit');
            setTimeout(() => toast.remove(), 180);
          }, duration);
        }
        
        // Limitar apilado (mÃ¡ximo 3)
        const toasts = container.querySelectorAll('.ubits-toast');
        if (toasts.length > 3) {
          const oldest = toasts[0];
          oldest.classList.add('ubits-toast--exit');
          setTimeout(() => oldest.remove(), 180);
        }
        
        return toast;
      }
      
      // Exponer showToast globalmente
      // Maneja tanto showToast(message) como showToast(type, message, options)
      window.showToast = function(typeOrMessage, messageOrOptions, options = {}) {
        // Tipos vÃ¡lidos de toast
        const validTypes = ['success', 'info', 'warning', 'error'];
        
        // Si solo hay un parÃ¡metro, es la forma antigua: showToast(message)
        if (arguments.length === 1) {
          const message = typeOrMessage;
          return renderToastSimple('success', message, { title: 'Copiado' });
        }
        
        // Si el primer parÃ¡metro es un tipo vÃ¡lido, es la forma nueva: showToast(type, message, options)
        if (validTypes.includes(typeOrMessage)) {
          const type = typeOrMessage;
          const message = messageOrOptions || '';
          return renderToastSimple(type, message, options || {});
        }
        
        // Si el primer parÃ¡metro no es un tipo vÃ¡lido pero hay dos parÃ¡metros,
        // asumimos que es showToast(message, options) - forma intermedia
        const message = typeOrMessage;
        const messageOptions = messageOrOptions || {};
        return renderToastSimple('success', message, { title: 'Copiado', ...messageOptions });
      };
      
      // FunciÃ³n para mostrar toast preview
      window.showToastPreview = function(type, componentId) {
        console.log('ğŸ¯ showToastPreview llamado:', { type, componentId });
        
        const state = initToastPreviewState(componentId);
        const messageInput = document.getElementById(`toast-message-input-${componentId}`);
        const message = messageInput ? messageInput.value || toastMessages[type] : toastMessages[type];
        const title = toastTitles[type] || '';
        
        console.log('ğŸ“ TÃ­tulo y mensaje obtenidos:', { title, message });
        
        // Actualizar botones activos
        document.querySelectorAll(`[data-component="${componentId}"][data-option="type"]`).forEach(btn => {
          btn.classList.toggle('active', btn.getAttribute('data-value') === type);
        });
        
        // Verificar que showToast existe
        if (typeof window.showToast !== 'function') {
          console.error('âŒ window.showToast no estÃ¡ disponible');
          alert('Error: La funciÃ³n showToast no estÃ¡ disponible. Por favor, recarga la pÃ¡gina.');
          return;
        }
        
        console.log('âœ… Llamando a showToast...');
        
        // Mostrar toast con botÃ³n de acciÃ³n si estÃ¡ activado
        try {
          const toastOptions = {
            title: title,
            duration: type === 'success' || type === 'info' ? 3500 : type === 'warning' ? 5000 : 6500,
            pauseOnHover: true
          };
          
          // Agregar botÃ³n de acciÃ³n si estÃ¡ activado
          if (state.action) {
            toastOptions.action = {
              label: 'Action',
              onClick: () => {
                alert(`AcciÃ³n ejecutada: ${type}`);
              }
            };
          }
          
          const toast = window.showToast(type, message, toastOptions);
          
          if (!toast) {
            console.error('âŒ showToast no devolviÃ³ un elemento toast');
          } else {
            console.log('âœ… Toast creado:', toast);
          }
        } catch (error) {
          console.error('âŒ Error al mostrar toast:', error);
          alert('Error al mostrar toast: ' + error.message);
        }
      };
      
      // FunciÃ³n para establecer mensaje del toast
      window.setToastMessage = function(message, componentId) {
        // El mensaje se usarÃ¡ la prÃ³xima vez que se muestre un toast
        console.log('ğŸ“ Mensaje de toast actualizado:', message);
      };
      
      // Inicializar container cuando se carga la pÃ¡gina
      ensureToastContainer();
      
      // ========================================
      // INPUT PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Input
      const inputPreviewState = {};
      
      // Inicializar estado por componente
      function initInputPreviewState(componentId) {
        if (!inputPreviewState[componentId]) {
          inputPreviewState[componentId] = {
            label: 'Label',
            showLabel: true,
            mandatory: false,
            mandatoryType: 'opcional',
            helperText: 'Helper text',
            showHelper: true,
            showCounter: true,
            maxLength: 50,
            leftIcon: 'user',
            rightIcon: 'check',
            size: 'md',
            state: 'default',
            type: 'text',
            placeholder: 'Placeholder text',
            showRichTextToolbar: false
          };
        }
        return inputPreviewState[componentId];
      }
      
      // FunciÃ³n para renderizar Input (versiÃ³n simplificada para autoframe)
      function renderInputSimple(state, componentId) {
        const {
          label,
          showLabel,
          mandatory,
          mandatoryType,
          helperText,
          showHelper,
          showCounter,
          maxLength,
          leftIcon,
          rightIcon,
          size,
          state: inputState,
          type,
          placeholder,
          showRichTextToolbar
        } = state;
        
        // Calcular padding segÃºn iconos y tamaÃ±o
        const hasLeftIcon = leftIcon && leftIcon.trim() !== '';
        const hasRightIcon = rightIcon && rightIcon.trim() !== '';
        
        // Padding base sin iconos
        const paddingBaseMap = {
          xs: { left: '8px', right: '8px' },
          sm: { left: '10px', right: '10px' },
          md: { left: '12px', right: '12px' },
          lg: { left: '16px', right: '16px' }
        };
        
        // Padding con iconos (icono 12px desde el borde + 8px espacio + 12px icono = 32px+)
        const paddingWithIconMap = {
          xs: { left: '32px', right: '36px' },
          sm: { left: '36px', right: '40px' },
          md: { left: '40px', right: '44px' },
          lg: { left: '44px', right: '48px' }
        };
        
        let paddingLeft = hasLeftIcon ? paddingWithIconMap[size].left : paddingBaseMap[size].left;
        let paddingRight = hasRightIcon ? paddingWithIconMap[size].right : paddingBaseMap[size].right;
        
        // Clases CSS
        const inputClasses = ['ubits-input', `ubits-input--${size}`];
        if (inputState !== 'default') {
          inputClasses.push(`ubits-input--${inputState}`);
        }
        
        // Altura segÃºn tamaÃ±o
        const heightMap = { xs: '28px', sm: '32px', md: '40px', lg: '48px' };
        const fontSizeMap = { xs: 'var(--font-body-xs-size)', sm: 'var(--font-body-sm-size)', md: 'var(--font-body-md-size)', lg: 'var(--font-body-lg-size)' };
        
        let inputHTML = '';
        
        // Label
        if (showLabel && label) {
          const mandatoryText = mandatory ? ` <span class="ubits-input-mandatory">(${mandatoryType})</span>` : '';
          inputHTML += `<label class="ubits-input-label">${label}${mandatoryText}</label>`;
        }
        
        // Input wrapper
        inputHTML += `<div style="position: relative; display: inline-block; width: 100%;">`;
        
        // Icono izquierdo (solo para tipos que permiten icono personalizado)
        // Search, autocomplete, email, tel, url tienen su propio icono automÃ¡tico
        if (hasLeftIcon && type !== 'search' && type !== 'autocomplete' && type !== 'email' && type !== 'tel' && type !== 'url') {
          const leftIconClass = leftIcon.startsWith('fa-') ? `far ${leftIcon}` : `far fa-${leftIcon}`;
          // Ajustar posiciÃ³n del icono segÃºn el tamaÃ±o
          const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="${leftIconClass}" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1; width: 14px; text-align: center;"></i>`;
        }
        
        // Input segÃºn tipo
        const disabledAttr = inputState === 'disabled' ? ' disabled' : '';
        const maxLengthAttr = showCounter ? ` maxlength="${maxLength}"` : '';
        
        if (type === 'textarea') {
          // TEXTAREA - campo multilÃ­nea con redimensionamiento y barra de herramientas opcional
          if (showRichTextToolbar) {
            // Contenedor que envuelve la barra y el textarea
            inputHTML += `<div class="ubits-input-rich-text-wrapper">`;
            
            // Barra de herramientas de texto enriquecido dentro del contenedor
            inputHTML += `
              <div class="ubits-input-rich-text-toolbar" data-container-id="${componentId}">
                <button type="button" class="ubits-rich-text-btn" data-command="bold" title="Negrita">
                  <i class="fas fa-bold"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="italic" title="Cursiva">
                  <i class="fas fa-italic"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="underline" title="Subrayado">
                  <i class="fas fa-underline"></i>
                </button>
                <div class="ubits-rich-text-separator"></div>
                <button type="button" class="ubits-rich-text-btn" data-command="justifyLeft" title="Alinear izquierda">
                  <i class="fas fa-align-left"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="justifyCenter" title="Alinear centro">
                  <i class="fas fa-align-center"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="justifyRight" title="Alinear derecha">
                  <i class="fas fa-align-right"></i>
                </button>
                <div class="ubits-rich-text-separator"></div>
                <button type="button" class="ubits-rich-text-btn" data-command="insertUnorderedList" title="Lista con viÃ±etas">
                  <i class="fas fa-list-ul"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="insertOrderedList" title="Lista numerada">
                  <i class="fas fa-list-ol"></i>
                </button>
                <div class="ubits-rich-text-separator"></div>
                <button type="button" class="ubits-rich-text-btn" data-command="insertImage" title="Insertar imagen">
                  <i class="fas fa-image"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="insertTable" title="Insertar tabla">
                  <i class="fas fa-table"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="createLink" title="Insertar enlace">
                  <i class="fas fa-link"></i>
                </button>
                <button type="button" class="ubits-rich-text-btn" data-command="code" title="CÃ³digo">
                  <i class="fas fa-code"></i>
                </button>
                <div class="ubits-rich-text-separator"></div>
                <button type="button" class="ubits-rich-text-btn" data-command="removeFormat" title="Limpiar formato">
                  <i class="fas fa-remove-format"></i>
                </button>
              </div>
            `;
            
            let textareaStyle = `width: 100%; min-height: 80px; resize: vertical; `;
            const computedStyle = window.getComputedStyle(document.body);
            const paddingTop = '12px';
            const paddingBottom = '12px';
            textareaStyle += `padding: ${paddingTop} ${paddingRight} ${paddingBottom} ${paddingLeft} !important; `;
            textareaStyle += `font-family: var(--font-sans); font-size: ${fontSizeMap[size]}; `;
            if (inputState === 'disabled') {
              textareaStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
            }
            inputHTML += `<textarea class="${inputClasses.join(' ')}" style="${textareaStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}></textarea>`;
            inputHTML += `</div>`;
          } else {
            // Textarea normal sin barra de herramientas
            let textareaStyle = `width: 100%; min-height: 80px; resize: vertical; font-family: var(--font-sans); font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${paddingRight} !important;`;
            if (inputState === 'disabled') {
              textareaStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
            }
            inputHTML += `<textarea class="${inputClasses.join(' ')}" style="${textareaStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}></textarea>`;
          }
        } else if (type === 'select') {
          // Select siempre tiene icono chevron a la derecha
          const selectPaddingRight = paddingWithIconMap[size].right;
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="select" style="width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${selectPaddingRight} !important; cursor: pointer;" value="" readonly placeholder="${placeholder}">`;
          // Forzar rightIcon a chevron
          const iconRightPos = size === 'xs' ? '14px' : size === 'sm' ? '16px' : size === 'md' ? '18px' : '20px';
          inputHTML += `<i class="far fa-chevron-down" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
        } else if (type === 'password') {
          const passwordPaddingRight = hasRightIcon ? paddingRight : paddingWithIconMap[size].right;
          let passwordStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${passwordPaddingRight} !important;`;
          if (inputState === 'disabled') {
            passwordStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="password" class="${inputClasses.join(' ')}" data-input-type="password" style="${passwordStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de ojo automÃ¡tico (siempre presente en password)
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-eye ubits-password-toggle" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1;"></i>`;
        } else if (type === 'search') {
          const searchPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          const searchPaddingRight = hasRightIcon ? paddingRight : paddingWithIconMap[size].right;
          let searchStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${searchPaddingLeft} !important; padding-right: ${searchPaddingRight} !important;`;
          if (inputState === 'disabled') {
            searchStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="search" style="${searchStyle}" placeholder="${placeholder}" autocomplete="off"${disabledAttr}${maxLengthAttr}>`;
          // Iconos automÃ¡ticos para search
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-search" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-times ubits-search-clear" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1; display: none;"></i>`;
        } else if (type === 'calendar') {
          // Calendar siempre tiene icono de calendario a la derecha
          const calendarPaddingRight = paddingWithIconMap[size].right;
          let calendarStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${calendarPaddingRight} !important; cursor: pointer;`;
          if (inputState === 'disabled') {
            calendarStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="calendar" style="${calendarStyle}" placeholder="${placeholder}" value="" readonly${disabledAttr}>`;
          // Icono de calendario automÃ¡tico
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-calendar" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
        } else if (type === 'email') {
          // Email: siempre tiene icono de email a la izquierda
          const emailPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let emailStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${emailPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            emailStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="email" class="${inputClasses.join(' ')}" data-input-type="email" style="${emailStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de email automÃ¡tico si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-envelope" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'tel') {
          // Tel: siempre tiene icono de telÃ©fono a la izquierda
          const telPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let telStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${telPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            telStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="tel" class="${inputClasses.join(' ')}" data-input-type="tel" style="${telStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de telÃ©fono automÃ¡tico si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-phone" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'url') {
          // URL: siempre tiene icono de link a la izquierda
          const urlPaddingLeft = hasLeftIcon ? paddingLeft : paddingWithIconMap[size].left;
          let urlStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${urlPaddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            urlStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="url" class="${inputClasses.join(' ')}" data-input-type="url" style="${urlStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
          // Icono de link automÃ¡tico si no hay icono personalizado
          if (!hasLeftIcon) {
            const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
            inputHTML += `<i class="far fa-link" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          }
        } else if (type === 'autocomplete') {
          // Autocomplete: siempre tiene icono de bÃºsqueda a la izquierda y clear a la derecha
          const autocompletePaddingLeft = paddingWithIconMap[size].left;
          const autocompletePaddingRight = paddingWithIconMap[size].right;
          let autocompleteStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${autocompletePaddingLeft} !important; padding-right: ${autocompletePaddingRight} !important;`;
          if (inputState === 'disabled') {
            autocompleteStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="text" class="${inputClasses.join(' ')}" data-input-type="autocomplete" style="${autocompleteStyle}" placeholder="${placeholder}" autocomplete="off"${disabledAttr}${maxLengthAttr}>`;
          // Icono de bÃºsqueda automÃ¡tico a la izquierda
          const iconLeftPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-search" style="position: absolute; left: ${iconLeftPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1;"></i>`;
          // Icono X para borrar a la derecha
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="far fa-times ubits-input-clear" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: auto; cursor: pointer; z-index: 1; display: none;"></i>`;
        } else {
          // Input normal (text, number)
          let inputStyle = `width: 100%; height: ${heightMap[size]} !important; min-height: ${heightMap[size]} !important; font-size: ${fontSizeMap[size]}; padding-left: ${paddingLeft} !important; padding-right: ${paddingRight} !important;`;
          if (inputState === 'disabled') {
            inputStyle += ` background: var(--ubits-bg-3) !important; color: var(--ubits-fg-1-low) !important; border-color: var(--ubits-border-2) !important;`;
          }
          inputHTML += `<input type="${type}" class="${inputClasses.join(' ')}" data-input-type="${type}" style="${inputStyle}" placeholder="${placeholder}"${disabledAttr}${maxLengthAttr}>`;
        }
        
        // Icono derecho (si no se agregÃ³ automÃ¡ticamente)
        // No agregar icono derecho personalizado si el tipo ya tiene su icono automÃ¡tico
        if (hasRightIcon && !(type === 'password' || type === 'search' || type === 'autocomplete' || type === 'select' || type === 'calendar')) {
          const rightIconClass = rightIcon.startsWith('fa-') ? `far ${rightIcon}` : `far fa-${rightIcon}`;
          const iconRightPos = size === 'xs' ? '10px' : size === 'sm' ? '11px' : size === 'md' ? '12px' : '13px';
          inputHTML += `<i class="${rightIconClass}" style="position: absolute; right: ${iconRightPos}; top: 50%; transform: translateY(-50%); color: var(--ubits-fg-1-medium); pointer-events: none; z-index: 1; width: 14px; text-align: center;"></i>`;
        }
        
        // Icono izquierdo personalizado (no se agrega si el tipo tiene icono automÃ¡tico)
        if (hasLeftIcon && !(type === 'search' || type === 'autocomplete')) {
          // Ya se agregÃ³ arriba, no hacer nada
        }
        
        inputHTML += '</div>';
        
        // Helper text y counter
        if (showHelper || showCounter) {
          inputHTML += '<div class="ubits-input-helper">';
          if (showHelper && helperText) {
            inputHTML += `<span>${helperText}</span>`;
          }
          if (showCounter) {
            inputHTML += `<span class="ubits-input-counter">0/${maxLength}</span>`;
          }
          inputHTML += '</div>';
        }
        
        return inputHTML;
      }
      
      // FunciÃ³n para actualizar el preview del Input
      window.updateInputPreview = function(componentId) {
        const state = initInputPreviewState(componentId);
        const preview = document.getElementById(`input-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview no encontrado:', `input-preview-${componentId}`);
          return;
        }
        
        const inputHTML = renderInputSimple(state, componentId);
        preview.innerHTML = inputHTML;
        
        // Obtener elementos del DOM
        const wrapper = preview.querySelector('div[style*="position: relative"]');
        const inputElement = preview.querySelector('.ubits-input');
        const counterElement = preview.querySelector('.ubits-input-counter');
        
        if (!inputElement || !wrapper) {
          console.error('âŒ No se pudo encontrar input o wrapper');
          return;
        }
        
        // Asegurar que el wrapper tenga position relative para los dropdowns
        if (wrapper && getComputedStyle(wrapper).position !== 'relative') {
          wrapper.style.position = 'relative';
        }
        
        // Inicializar funcionalidades especÃ­ficas segÃºn el tipo
        const inputType = inputElement.getAttribute('data-input-type') || state.type;
        
        // Password toggle
        if (inputType === 'password' && inputElement instanceof HTMLInputElement) {
          const toggleIcon = preview.querySelector('.ubits-password-toggle');
          if (toggleIcon) {
            let isPasswordVisible = false;
            toggleIcon.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              isPasswordVisible = !isPasswordVisible;
              inputElement.type = isPasswordVisible ? 'text' : 'password';
              toggleIcon.className = isPasswordVisible ? 'far fa-eye-slash ubits-password-toggle' : 'far fa-eye ubits-password-toggle';
              toggleIcon.setAttribute('style', toggleIcon.getAttribute('style') || '');
            });
          }
        }
        
        // Search clear
        if (inputType === 'search' && inputElement instanceof HTMLInputElement) {
          const clearIcon = preview.querySelector('.ubits-search-clear');
          if (clearIcon) {
            const toggleClearIcon = () => {
              clearIcon.style.display = inputElement.value.length > 0 ? 'block' : 'none';
            };
            inputElement.addEventListener('input', toggleClearIcon);
            clearIcon.addEventListener('click', (e) => {
              e.preventDefault();
              inputElement.value = '';
              inputElement.focus();
              toggleClearIcon();
            });
            toggleClearIcon();
          }
        }
        
        // Autocomplete dropdown - usando componente List
        if (inputType === 'autocomplete' && inputElement instanceof HTMLInputElement) {
          const clearIcon = preview.querySelector('.ubits-input-clear');
          if (clearIcon) {
            const toggleClearIcon = () => {
              clearIcon.style.display = inputElement.value.length > 0 ? 'block' : 'none';
            };
            inputElement.addEventListener('input', toggleClearIcon);
            clearIcon.addEventListener('click', (e) => {
              e.preventDefault();
              inputElement.value = '';
              inputElement.focus();
              toggleClearIcon();
              const listContainer = preview.querySelector('.ubits-autocomplete-list-container');
              if (listContainer) listContainer.style.display = 'none';
            });
            toggleClearIcon();
          }
          
          // Crear contenedor para el List
          const listContainer = document.createElement('div');
          listContainer.className = 'ubits-autocomplete-list-container';
          listContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
          `;
          wrapper.appendChild(listContainer);
          
          // Opciones de ejemplo para autocomplete (lista mÃ¡s realista)
          const autocompleteOptions = [
            { value: 'apple', text: 'Manzana' },
            { value: 'banana', text: 'Banana' },
            { value: 'orange', text: 'Naranja' },
            { value: 'grape', text: 'Uva' },
            { value: 'strawberry', text: 'Fresa' },
            { value: 'watermelon', text: 'SandÃ­a' },
            { value: 'pineapple', text: 'PiÃ±a' },
            { value: 'mango', text: 'Mango' },
            { value: 'kiwi', text: 'Kiwi' },
            { value: 'peach', text: 'Durazno' },
            { value: 'cherry', text: 'Cereza' },
            { value: 'blueberry', text: 'ArÃ¡ndano' },
            { value: 'papaya', text: 'Papaya' },
            { value: 'coconut', text: 'Coco' },
            { value: 'avocado', text: 'Aguacate' }
          ];
          
          // Obtener el tamaÃ±o del List basado en el tamaÃ±o del Input
          const listSize = state.size === 'xs' ? 'xs' : state.size === 'sm' ? 'sm' : state.size === 'md' ? 'md' : 'lg';
          
          // FunciÃ³n para actualizar el dropdown
          const updateDropdown = (showAll = false) => {
            const searchText = inputElement.value.toLowerCase();
            
            let filtered;
            if (showAll || searchText.length < 1) {
              // Mostrar todas las opciones cuando se activa el input o no hay texto
              filtered = autocompleteOptions.slice(0, 8);
            } else {
              // Filtrar segÃºn el texto ingresado
              filtered = autocompleteOptions
                .filter(opt => opt.text.toLowerCase().includes(searchText))
                .slice(0, 8);
            }
            
            if (filtered.length === 0) {
              listContainer.style.display = 'none';
              return;
            }
            
            // Convertir opciones a items de List
            const listItems = filtered.map(option => ({
              label: option.text,
              state: 'default',
              value: option.value,
              selected: false
            }));
            
            // Generar HTML del List manualmente
            const listId = `ubits-autocomplete-list-${wrapper.id || 'default'}`;
            listContainer.id = listId;
            listContainer.innerHTML = '';
            
            let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
            listItems.forEach((item) => {
              let label = item.label;
              // Resaltar texto buscado
              if (searchText.length > 0) {
                const regex = new RegExp(`(${searchText})`, 'gi');
                label = item.label.replace(regex, '<strong>$1</strong>');
              }
              listHTML += `
                <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                  ${label}
                </div>
              `;
            });
            listHTML += '</div>';
            
            listContainer.innerHTML = listHTML;
            
            // Agregar event listeners a los items
            const listItemsElements = listContainer.querySelectorAll('.ubits-list-item');
            listItemsElements.forEach((itemEl, idx) => {
              const item = listItems[idx];
              if (item) {
                itemEl.addEventListener('click', () => {
                  inputElement.value = item.label;
                  listContainer.style.display = 'none';
                  if (clearIcon) clearIcon.style.display = 'block';
                });
              }
            });
            
            listContainer.style.display = 'block';
          };
          
          // Mostrar dropdown al activar el input (focus)
          inputElement.addEventListener('focus', () => {
            updateDropdown(true);
          });
          
          // Actualizar dropdown mientras se escribe
          inputElement.addEventListener('input', () => {
            updateDropdown(false);
          });
          
          // Ocultar dropdown al desactivar el input (blur)
          inputElement.addEventListener('blur', () => {
            setTimeout(() => listContainer.style.display = 'none', 150);
          });
        }
        
        // Calendar picker - usando componente Calendar UBITS (sin imports dinÃ¡micos)
        if (inputType === 'calendar' && inputElement instanceof HTMLInputElement) {
          console.log('ğŸ“… [Input Preview] Inicializando calendar picker...');
          
          // PREVENIR CALENDARIO NATIVO: Asegurar que el input nunca tenga type="date"
          // y tenga todos los atributos necesarios para prevenir el calendario nativo
          inputElement.type = 'text';
          inputElement.setAttribute('readonly', 'readonly');
          inputElement.setAttribute('autocomplete', 'off');
          // Asegurar que no tenga atributos que puedan causar el calendario nativo
          inputElement.removeAttribute('data-type');
          
          console.log('ğŸ“… [Input Preview] Input configurado para prevenir calendario nativo:', {
            type: inputElement.type,
            readonly: inputElement.hasAttribute('readonly'),
            autocomplete: inputElement.getAttribute('autocomplete'),
            originalType: inputElement.getAttribute('type')
          });
          
          // Crear contenedor para el calendario con z-index muy alto para estar sobre cualquier calendario nativo
          let calendarContainer = wrapper.querySelector('.ubits-calendar-picker-container');
          if (!calendarContainer) {
            calendarContainer = document.createElement('div');
            calendarContainer.className = 'ubits-calendar-picker-container';
            calendarContainer.style.cssText = 'position: absolute; top: 100%; left: 0; right: 0; z-index: 99999 !important; margin-top: 4px; display: none;';
            wrapper.appendChild(calendarContainer);
          }
          
          // Estado del calendario para el input
          const calendarState = {
            mode: 'single',
            selectedDate: null,
            endDate: null,
            minDate: null,
            maxDate: null,
            currentDate: new Date(),
            isSelectingRange: false
          };
          
          const formatDate = (date) => {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
          };
          
          const parseDate = (dateStr) => {
            if (!dateStr) return null;
            const [day, month, year] = dateStr.split('/');
            if (!day || !month || !year) return null;
            return new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
          };
          
          // FunciÃ³n para renderizar el calendario usando generateCalendarHTML
          const renderCalendar = () => {
            // Cargar CSS si no estÃ¡ cargado
            const existingCalendarLink = document.querySelector('link[href*="calendar.css"]');
            if (!existingCalendarLink) {
              const link = document.createElement('link');
              link.rel = 'stylesheet';
              link.href = '../../addons/calendar/src/styles/calendar.css';
              document.head.appendChild(link);
            }
            
            // Cargar CSS de scroll si no estÃ¡ cargado (para el scrollbar de las listas)
            const existingScrollLink = document.querySelector('link[href*="scroll.css"]');
            if (!existingScrollLink) {
              console.log('ğŸ“… [Input Preview] Cargando CSS del scrollbar...');
              const link = document.createElement('link');
              link.rel = 'stylesheet';
              link.href = '../../addons/scroll/src/styles/scroll.css';
              document.head.appendChild(link);
              console.log('âœ… [Input Preview] CSS del scrollbar cargado');
            }
            
            // Generar HTML del calendario usando la funciÃ³n existente
            const calendarHTML = generateCalendarHTML(calendarState);
            
            // Crear wrapper temporal para parsear el HTML
            const tempWrapper = document.createElement('div');
            tempWrapper.innerHTML = calendarHTML;
            const calendar = tempWrapper.firstElementChild;
            
            if (!calendar) {
              console.error('âŒ [Input Preview] No se pudo crear el calendario');
              return null;
            }
            
            // Configurar event listeners bÃ¡sicos (similar a setupEventListeners en updateCalendarPreview)
            const prevBtn = calendar.querySelector('.ubits-calendar__nav-button--prev');
            const nextBtn = calendar.querySelector('.ubits-calendar__nav-button--next');
            const monthInput = calendar.querySelector('.ubits-calendar__month-input');
            const yearInput = calendar.querySelector('.ubits-calendar__year-input');
            const monthDropdown = calendar.querySelector('.ubits-calendar__month-dropdown');
            const yearDropdown = calendar.querySelector('.ubits-calendar__year-dropdown');
            const dayButtons = calendar.querySelectorAll('.ubits-calendar__day[data-date]');
            
            prevBtn?.addEventListener('click', (e) => {
              e.stopPropagation();
              calendarState.currentDate.setMonth(calendarState.currentDate.getMonth() - 1);
              calendarContainer.innerHTML = '';
              const newCalendar = renderCalendar();
              if (newCalendar) {
                calendarContainer.appendChild(newCalendar);
              }
            });
            
            nextBtn?.addEventListener('click', (e) => {
              e.stopPropagation();
              calendarState.currentDate.setMonth(calendarState.currentDate.getMonth() + 1);
              calendarContainer.innerHTML = '';
              const newCalendar = renderCalendar();
              if (newCalendar) {
                calendarContainer.appendChild(newCalendar);
              }
            });
            
            // Event listeners para dropdowns de mes y aÃ±o
            if (monthInput && monthDropdown) {
              const currentMonth = calendarState.currentDate.getMonth();
              const monthItems = CALENDAR_MONTH_NAMES.map((name, index) => ({
                label: name,
                value: String(index),
                selected: index === currentMonth,
                state: index === currentMonth ? 'active' : 'default'
              }));
              
              monthInput.addEventListener('click', (e) => {
                e.stopPropagation();
                const isVisible = monthDropdown.style.display === 'block';
                
                if (!isVisible) {
                  if (yearDropdown) {
                    yearDropdown.style.display = 'none';
                    // Limpiar scrollbar del dropdown de aÃ±o si existe
                    if (yearDropdown._scrollbarInstance) {
                      try {
                        if (yearDropdown._scrollbarInstance.destroy) {
                          yearDropdown._scrollbarInstance.destroy();
                        }
                        const scrollbarEl = yearDropdown.querySelector('.ubits-scrollbar');
                        if (scrollbarEl && scrollbarEl.parentElement) {
                          scrollbarEl.parentElement.removeChild(scrollbarEl);
                        }
                      } catch (err) {
                        console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de aÃ±o:', err);
                      }
                      delete yearDropdown._scrollbarInstance;
                    }
                  }
                  
                  // IDs Ãºnicos para el dropdown de mes
                  const monthListId = `input-calendar-month-list-${Date.now()}`;
                  const monthScrollbarId = `input-calendar-month-scrollbar-${Date.now()}`;
                  
                  // Renderizar List UBITS con contenedor para scrollbar (igual que en updateCalendarPreview)
                  const listHTML = `
                    <div style="position: relative; max-height: 200px;">
                      <div id="${monthListId}" class="ubits-list" role="list" style="max-height: 200px; background: var(--ubits-bg-1); border: 1px solid var(--ubits-border-1); border-radius: 6px; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)); overflow-y: auto; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none;">
                        <style>
                          #${monthListId}::-webkit-scrollbar { display: none; }
                        </style>
                        ${monthItems.map((item, idx) => `
                          <div class="ubits-list-item ubits-list-item--sm ${item.state === 'active' ? 'ubits-list-item--active' : ''}" 
                               role="listitem" 
                               data-value="${item.value}" 
                               data-index="${idx}"
                               tabindex="0"
                               style="cursor: pointer;">
                            ${item.label}
                          </div>
                        `).join('')}
                      </div>
                      <div id="${monthScrollbarId}" style="position: absolute; top: 0; right: 0; width: 8px; height: 100%; pointer-events: none;"></div>
                    </div>
                  `;
                  monthDropdown.innerHTML = listHTML;
                  monthDropdown.style.display = 'block';
                  
                  // Crear scrollbar UBITS despuÃ©s de renderizar
                  requestAnimationFrame(() => {
                    try {
                      const listElement = document.getElementById(monthListId);
                      const scrollbarContainer = document.getElementById(monthScrollbarId);
                      
                      console.log('ğŸ“… [Input Preview] ========== DIAGNÃ“STICO SCROLLBAR MES ==========');
                      console.log('ğŸ“… [Input Preview] Elementos encontrados:', {
                        listElement: !!listElement,
                        scrollbarContainer: !!scrollbarContainer,
                        listElementId: listElement?.id,
                        scrollbarContainerId: scrollbarContainer?.id
                      });
                      
                      if (listElement) {
                        console.log('ğŸ“… [Input Preview] Dimensiones de la lista:', {
                          scrollHeight: listElement.scrollHeight,
                          clientHeight: listElement.clientHeight,
                          offsetHeight: listElement.offsetHeight,
                          needsScroll: listElement.scrollHeight > listElement.clientHeight,
                          difference: listElement.scrollHeight - listElement.clientHeight
                        });
                      }
                      
                      if (listElement && scrollbarContainer) {
                        // Asegurar que el contenedor tenga la misma altura que la lista
                        const listHeight = listElement.clientHeight;
                        scrollbarContainer.style.height = `${listHeight}px`;
                        scrollbarContainer.style.maxHeight = '200px'; // Limitar altura mÃ¡xima
                        scrollbarContainer.style.overflow = 'hidden'; // Evitar que el scrollbar se salga
                        scrollbarContainer.style.pointerEvents = 'auto';
                        console.log('ğŸ“… [Input Preview] Altura del contenedor ajustada a:', listHeight);
                        
                        if (listElement.scrollHeight > listElement.clientHeight) {
                          console.log('ğŸ“… [Input Preview] âœ… Se necesita scrollbar, creando...');
                          // Usar funciÃ³n local createScrollbarLocal
                          if (typeof window.createScrollbarLocal === 'function') {
                            console.log('ğŸ“… [Input Preview] createScrollbarLocal estÃ¡ disponible');
                            monthDropdown._scrollbarInstance = window.createScrollbarLocal(listElement, scrollbarContainer, 'vertical');
                            console.log('ğŸ“… [Input Preview] Scrollbar creado, instancia:', monthDropdown._scrollbarInstance);
                            
                            // Verificar que el scrollbar se creÃ³
                            setTimeout(() => {
                              const scrollbarElement = scrollbarContainer.querySelector('.ubits-scrollbar');
                              const barElement = scrollbarContainer.querySelector('.ubits-scrollbar__bar');
                              console.log('ğŸ“… [Input Preview] VerificaciÃ³n del scrollbar creado:', {
                                scrollbarElement: !!scrollbarElement,
                                barElement: !!barElement,
                                scrollbarClasses: scrollbarElement?.className,
                                barClasses: barElement?.className,
                                scrollbarStyle: scrollbarElement?.style.cssText,
                                barStyle: barElement?.style.cssText,
                                scrollbarComputed: scrollbarElement ? {
                                  display: window.getComputedStyle(scrollbarElement).display,
                                  opacity: window.getComputedStyle(scrollbarElement).opacity,
                                  width: window.getComputedStyle(scrollbarElement).width,
                                  height: window.getComputedStyle(scrollbarElement).height
                                } : null,
                                barComputed: barElement ? {
                                  display: window.getComputedStyle(barElement).display,
                                  opacity: window.getComputedStyle(barElement).opacity,
                                  width: window.getComputedStyle(barElement).width,
                                  height: window.getComputedStyle(barElement).height,
                                  transform: window.getComputedStyle(barElement).transform
                                } : null
                              });
                            }, 100);
                          } else {
                            console.error('âŒ [Input Preview] createScrollbarLocal NO estÃ¡ disponible');
                          }
                        } else {
                          console.log('ğŸ“… [Input Preview] âš ï¸ No se necesita scrollbar para mes (contenido cabe)');
                        }
                      } else {
                        console.error('âŒ [Input Preview] Faltan elementos:', {
                          listElement: !!listElement,
                          scrollbarContainer: !!scrollbarContainer
                        });
                      }
                      console.log('ğŸ“… [Input Preview] ========== FIN DIAGNÃ“STICO ==========');
                    } catch (err) {
                      console.error('âŒ [Input Preview] Error creando scrollbar para mes:', err);
                      console.error('âŒ [Input Preview] Stack:', err.stack);
                    }
                  });
                  
                  // Event listeners para items de mes
                  monthDropdown.querySelectorAll('.ubits-list-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                      e.stopPropagation();
                      const monthIndex = parseInt(item.getAttribute('data-value'));
                      calendarState.currentDate.setMonth(monthIndex);
                      
                      // Limpiar scrollbar antes de cerrar
                      if (monthDropdown._scrollbarInstance) {
                        try {
                          if (monthDropdown._scrollbarInstance.destroy) {
                            monthDropdown._scrollbarInstance.destroy();
                          }
                          const scrollbarEl = monthDropdown.querySelector('.ubits-scrollbar');
                          if (scrollbarEl && scrollbarEl.parentElement) {
                            scrollbarEl.parentElement.removeChild(scrollbarEl);
                          }
                        } catch (err) {
                          console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de mes:', err);
                        }
                        delete monthDropdown._scrollbarInstance;
                      }
                      
                      monthDropdown.style.display = 'none';
                      calendarContainer.innerHTML = '';
                      const newCalendar = renderCalendar();
                      if (newCalendar) {
                        calendarContainer.appendChild(newCalendar);
                      }
                    });
                  });
                } else {
                  monthDropdown.style.display = 'none';
                  // Limpiar scrollbar al cerrar
                  if (monthDropdown._scrollbarInstance) {
                    try {
                      if (monthDropdown._scrollbarInstance.destroy) {
                        monthDropdown._scrollbarInstance.destroy();
                      }
                      const scrollbarEl = monthDropdown.querySelector('.ubits-scrollbar');
                      if (scrollbarEl && scrollbarEl.parentElement) {
                        scrollbarEl.parentElement.removeChild(scrollbarEl);
                      }
                    } catch (err) {
                      console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de mes:', err);
                    }
                    delete monthDropdown._scrollbarInstance;
                  }
                }
              });
            }
            
            if (yearInput && yearDropdown) {
              const currentYear = calendarState.currentDate.getFullYear();
              const startYear = currentYear - 10;
              const endYear = currentYear + 10;
              const yearItems = [];
              for (let y = startYear; y <= endYear; y++) {
                yearItems.push({
                  label: String(y),
                  value: String(y),
                  selected: y === currentYear,
                  state: y === currentYear ? 'active' : 'default'
                });
              }
              
              yearInput.addEventListener('click', (e) => {
                e.stopPropagation();
                const isVisible = yearDropdown.style.display === 'block';
                
                if (!isVisible) {
                  if (monthDropdown) {
                    monthDropdown.style.display = 'none';
                    // Limpiar scrollbar del dropdown de mes si existe
                    if (monthDropdown._scrollbarInstance) {
                      try {
                        if (monthDropdown._scrollbarInstance.destroy) {
                          monthDropdown._scrollbarInstance.destroy();
                        }
                        const scrollbarEl = monthDropdown.querySelector('.ubits-scrollbar');
                        if (scrollbarEl && scrollbarEl.parentElement) {
                          scrollbarEl.parentElement.removeChild(scrollbarEl);
                        }
                      } catch (err) {
                        console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de mes:', err);
                      }
                      delete monthDropdown._scrollbarInstance;
                    }
                  }
                  
                  // IDs Ãºnicos para el dropdown de aÃ±o
                  const yearListId = `input-calendar-year-list-${Date.now()}`;
                  const yearScrollbarId = `input-calendar-year-scrollbar-${Date.now()}`;
                  
                  // Renderizar List UBITS con contenedor para scrollbar (igual que en updateCalendarPreview)
                  const listHTML = `
                    <div style="position: relative; max-height: 200px;">
                      <div id="${yearListId}" class="ubits-list" role="list" style="max-height: 200px; background: var(--ubits-bg-1); border: 1px solid var(--ubits-border-1); border-radius: 6px; box-shadow: var(--ubits-effects-elevation-3, 0px 4px 8px 0px rgba(0, 0, 0, 0.12)); overflow-y: auto; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none;">
                        <style>
                          #${yearListId}::-webkit-scrollbar { display: none; }
                        </style>
                        ${yearItems.map((item, idx) => `
                          <div class="ubits-list-item ubits-list-item--sm ${item.state === 'active' ? 'ubits-list-item--active' : ''}" 
                               role="listitem" 
                               data-value="${item.value}" 
                               data-index="${idx}"
                               tabindex="0"
                               style="cursor: pointer;">
                            ${item.label}
                          </div>
                        `).join('')}
                      </div>
                      <div id="${yearScrollbarId}" style="position: absolute; top: 0; right: 0; width: 8px; height: 100%; pointer-events: none;"></div>
                    </div>
                  `;
                  yearDropdown.innerHTML = listHTML;
                  yearDropdown.style.display = 'block';
                  
                  // Crear scrollbar UBITS despuÃ©s de renderizar
                  requestAnimationFrame(() => {
                    try {
                      const listElement = document.getElementById(yearListId);
                      const scrollbarContainer = document.getElementById(yearScrollbarId);
                      
                      console.log('ğŸ“… [Input Preview] ========== DIAGNÃ“STICO SCROLLBAR AÃ‘O ==========');
                      console.log('ğŸ“… [Input Preview] Elementos encontrados:', {
                        listElement: !!listElement,
                        scrollbarContainer: !!scrollbarContainer,
                        listElementId: listElement?.id,
                        scrollbarContainerId: scrollbarContainer?.id
                      });
                      
                      if (listElement) {
                        console.log('ğŸ“… [Input Preview] Dimensiones de la lista:', {
                          scrollHeight: listElement.scrollHeight,
                          clientHeight: listElement.clientHeight,
                          offsetHeight: listElement.offsetHeight,
                          needsScroll: listElement.scrollHeight > listElement.clientHeight,
                          difference: listElement.scrollHeight - listElement.clientHeight
                        });
                      }
                      
                      if (listElement && scrollbarContainer) {
                        // Asegurar que el contenedor tenga la misma altura que la lista
                        const listHeight = listElement.clientHeight;
                        scrollbarContainer.style.height = `${listHeight}px`;
                        scrollbarContainer.style.maxHeight = '200px'; // Limitar altura mÃ¡xima
                        scrollbarContainer.style.overflow = 'hidden'; // Evitar que el scrollbar se salga
                        scrollbarContainer.style.pointerEvents = 'auto';
                        console.log('ğŸ“… [Input Preview] Altura del contenedor ajustada a:', listHeight);
                        
                        if (listElement.scrollHeight > listElement.clientHeight) {
                          console.log('ğŸ“… [Input Preview] âœ… Se necesita scrollbar, creando...');
                          // Usar funciÃ³n local createScrollbarLocal
                          if (typeof window.createScrollbarLocal === 'function') {
                            console.log('ğŸ“… [Input Preview] createScrollbarLocal estÃ¡ disponible');
                            yearDropdown._scrollbarInstance = window.createScrollbarLocal(listElement, scrollbarContainer, 'vertical');
                            console.log('ğŸ“… [Input Preview] Scrollbar creado, instancia:', yearDropdown._scrollbarInstance);
                            
                            // Verificar que el scrollbar se creÃ³
                            setTimeout(() => {
                              const scrollbarElement = scrollbarContainer.querySelector('.ubits-scrollbar');
                              const barElement = scrollbarContainer.querySelector('.ubits-scrollbar__bar');
                              console.log('ğŸ“… [Input Preview] VerificaciÃ³n del scrollbar creado:', {
                                scrollbarElement: !!scrollbarElement,
                                barElement: !!barElement,
                                scrollbarClasses: scrollbarElement?.className,
                                barClasses: barElement?.className,
                                scrollbarStyle: scrollbarElement?.style.cssText,
                                barStyle: barElement?.style.cssText,
                                scrollbarComputed: scrollbarElement ? {
                                  display: window.getComputedStyle(scrollbarElement).display,
                                  opacity: window.getComputedStyle(scrollbarElement).opacity,
                                  width: window.getComputedStyle(scrollbarElement).width,
                                  height: window.getComputedStyle(scrollbarElement).height
                                } : null,
                                barComputed: barElement ? {
                                  display: window.getComputedStyle(barElement).display,
                                  opacity: window.getComputedStyle(barElement).opacity,
                                  width: window.getComputedStyle(barElement).width,
                                  height: window.getComputedStyle(barElement).height,
                                  transform: window.getComputedStyle(barElement).transform
                                } : null
                              });
                            }, 100);
                          } else {
                            console.error('âŒ [Input Preview] createScrollbarLocal NO estÃ¡ disponible');
                          }
                        } else {
                          console.log('ğŸ“… [Input Preview] âš ï¸ No se necesita scrollbar para aÃ±o (contenido cabe)');
                        }
                      } else {
                        console.error('âŒ [Input Preview] Faltan elementos:', {
                          listElement: !!listElement,
                          scrollbarContainer: !!scrollbarContainer
                        });
                      }
                      console.log('ğŸ“… [Input Preview] ========== FIN DIAGNÃ“STICO ==========');
                    } catch (err) {
                      console.error('âŒ [Input Preview] Error creando scrollbar para aÃ±o:', err);
                      console.error('âŒ [Input Preview] Stack:', err.stack);
                    }
                  });
                  
                  // Event listeners para items de aÃ±o
                  yearDropdown.querySelectorAll('.ubits-list-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                      e.stopPropagation();
                      const year = parseInt(item.getAttribute('data-value'));
                      calendarState.currentDate.setFullYear(year);
                      
                      // Limpiar scrollbar antes de cerrar
                      if (yearDropdown._scrollbarInstance) {
                        try {
                          if (yearDropdown._scrollbarInstance.destroy) {
                            yearDropdown._scrollbarInstance.destroy();
                          }
                          const scrollbarEl = yearDropdown.querySelector('.ubits-scrollbar');
                          if (scrollbarEl && scrollbarEl.parentElement) {
                            scrollbarEl.parentElement.removeChild(scrollbarEl);
                          }
                        } catch (err) {
                          console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de aÃ±o:', err);
                        }
                        delete yearDropdown._scrollbarInstance;
                      }
                      
                      yearDropdown.style.display = 'none';
                      calendarContainer.innerHTML = '';
                      const newCalendar = renderCalendar();
                      if (newCalendar) {
                        calendarContainer.appendChild(newCalendar);
                      }
                    });
                  });
                } else {
                  yearDropdown.style.display = 'none';
                  // Limpiar scrollbar al cerrar
                  if (yearDropdown._scrollbarInstance) {
                    try {
                      if (yearDropdown._scrollbarInstance.destroy) {
                        yearDropdown._scrollbarInstance.destroy();
                      }
                      const scrollbarEl = yearDropdown.querySelector('.ubits-scrollbar');
                      if (scrollbarEl && scrollbarEl.parentElement) {
                        scrollbarEl.parentElement.removeChild(scrollbarEl);
                      }
                    } catch (err) {
                      console.warn('ğŸ“… [Input Preview] Error limpiando scrollbar de aÃ±o:', err);
                    }
                    delete yearDropdown._scrollbarInstance;
                  }
                }
              });
            }
            
            // Event listeners para selecciÃ³n de fecha
            dayButtons.forEach(dayBtn => {
              dayBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const dateStr = dayBtn.getAttribute('data-date');
                if (dateStr) {
                  const selectedDate = parseDate(dateStr);
                  if (selectedDate) {
                    calendarState.selectedDate = selectedDate;
                    inputElement.value = formatDate(selectedDate);
                    calendarContainer.style.display = 'none';
                    console.log('ğŸ“… [Input Preview] Fecha seleccionada:', selectedDate);
                  }
                }
              });
            });
            
            return calendar;
          };
          
          let isShowingCalendar = false;
          
          const showCalendar = () => {
            // Prevenir mÃºltiples llamadas simultÃ¡neas
            if (isShowingCalendar) {
              console.log('ğŸ“… [Input Preview] showCalendar ya en ejecuciÃ³n, ignorando...');
              return;
            }
            
            console.log('ğŸ“… [Input Preview] Mostrando calendario UBITS...');
            console.log('ğŸ“… [Input Preview] Estado del input:', {
              type: inputElement.type,
              readonly: inputElement.hasAttribute('readonly'),
              value: inputElement.value
            });
            
            // Marcar que estamos abriendo el calendario
            isOpening = true;
            isShowingCalendar = true;
            
            // Si el calendario ya estÃ¡ visible, ocultarlo
            if (calendarContainer && calendarContainer.style.display !== 'none') {
              console.log('ğŸ“… [Input Preview] Ocultando calendario...');
              calendarContainer.style.display = 'none';
              isOpening = false;
              isShowingCalendar = false;
              return;
            }
            
            // Asegurar nuevamente que el input no tenga type="date"
            if (inputElement.type === 'date' || inputElement.getAttribute('type') === 'date') {
              console.warn('âš ï¸ [Input Preview] Input tiene type="date" en showCalendar, corrigiendo...');
              inputElement.type = 'text';
              inputElement.setAttribute('readonly', 'readonly');
            }
            
            // Obtener fecha inicial del input si existe
            const currentValue = inputElement.value;
            if (currentValue) {
              const parsedDate = parseDate(currentValue);
              if (parsedDate) {
                calendarState.selectedDate = parsedDate;
                calendarState.currentDate = new Date(parsedDate);
              }
            }
            
            // Renderizar el calendario inmediatamente
            calendarContainer.innerHTML = '';
            const calendar = renderCalendar();
            if (calendar) {
              calendarContainer.appendChild(calendar);
              // Mostrar inmediatamente con display block y asegurar z-index
              calendarContainer.style.display = 'block';
              calendarContainer.style.zIndex = '99999';
              console.log('âœ… [Input Preview] Calendario UBITS mostrado correctamente');
              console.log('ğŸ“… [Input Preview] Estado del contenedor:', {
                display: calendarContainer.style.display,
                zIndex: calendarContainer.style.zIndex,
                hasCalendar: calendarContainer.querySelector('.ubits-calendar') !== null
              });
              
              // Resetear flag despuÃ©s de un pequeÃ±o delay
              setTimeout(() => {
                isShowingCalendar = false;
              }, 100);
              
              // Configurar el listener de click fuera despuÃ©s de mostrar el calendario
              // Usar un delay mÃ¡s largo para asegurar que el click que abriÃ³ el calendario no lo cierre
              setTimeout(() => {
                setupClickOutside();
              }, 500);
            } else {
              console.error('âŒ [Input Preview] Error al renderizar el calendario');
              isShowingCalendar = false;
              isOpening = false;
            }
          };
          
          // Event listeners para mostrar/ocultar el calendario
          // Usar capture phase para interceptar antes de que el navegador muestre el calendario nativo
          let lastClickTime = 0;
          
          inputElement.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            
            // Prevenir doble click (debounce)
            const now = Date.now();
            if (now - lastClickTime < 300) {
              console.log('ğŸ“… [Input Preview] Click ignorado (muy rÃ¡pido despuÃ©s del anterior)');
              return false;
            }
            lastClickTime = now;
            
            console.log('ğŸ“… [Input Preview] Click interceptado, mostrando calendario UBITS');
            // Llamar directamente sin setTimeout para evitar que otros listeners interfieran
            showCalendar();
            return false;
          }, true);
          
          inputElement.addEventListener('focus', (e) => {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            console.log('ğŸ“… [Input Preview] Focus interceptado, mostrando calendario UBITS');
            // Solo mostrar si no hay un click reciente (para evitar doble apertura)
            const now = Date.now();
            if (now - lastClickTime > 100) {
              showCalendar();
            }
            return false;
          }, true);
          
          // Prevenir cualquier otro evento que pueda mostrar el calendario nativo
          inputElement.addEventListener('mousedown', (e) => {
            if (e.target === inputElement) {
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              // No llamar showCalendar aquÃ­ para evitar doble apertura con click
              return false;
            }
          }, true);
          
          // TambiÃ©n escuchar clicks en el icono del calendario
          const calendarIcon = wrapper.querySelector('.ubits-input-icon-right, i[class*="fa-calendar"]');
          if (calendarIcon) {
            calendarIcon.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              showCalendar();
            });
          }
          
          // Cerrar calendario al hacer clic fuera (usar setTimeout para evitar que se cierre inmediatamente)
          let clickOutsideHandler = null;
          let isOpening = false;
          let openingTimeout = null;
          let clickOutsideSetupTimeout = null;
          
          const setupClickOutside = () => {
            // Remover handler anterior si existe
            if (clickOutsideHandler) {
              document.removeEventListener('click', clickOutsideHandler);
            }
            
            // Limpiar timeout anterior si existe
            if (clickOutsideSetupTimeout) {
              clearTimeout(clickOutsideSetupTimeout);
            }
            
            // Agregar nuevo handler despuÃ©s de un delay largo para evitar que se cierre inmediatamente
            clickOutsideSetupTimeout = setTimeout(() => {
              isOpening = false;
              clickOutsideHandler = (e) => {
                // No cerrar si estamos abriendo el calendario o mostrÃ¡ndolo
                if (isOpening || isShowingCalendar) {
                  console.log('ğŸ“… [Input Preview] Ignorando click fuera (calendario abriÃ©ndose/mostrÃ¡ndose)');
                  return;
                }
                
                // No cerrar si el click es en el input, icono o contenedor del calendario
                const target = e.target;
                const isInWrapper = wrapper.contains(target);
                const isInCalendar = calendarContainer && calendarContainer.contains(target);
                const isInput = target === inputElement;
                const isIcon = target === calendarIcon || (calendarIcon && calendarIcon.contains(target));
                
                // Verificar tambiÃ©n si el click es en los dropdowns de mes/aÃ±o
                const monthDropdown = calendarContainer?.querySelector('.ubits-calendar__month-dropdown');
                const yearDropdown = calendarContainer?.querySelector('.ubits-calendar__year-dropdown');
                const isInMonthDropdown = monthDropdown && monthDropdown.contains(target);
                const isInYearDropdown = yearDropdown && yearDropdown.contains(target);
                
                if (calendarContainer && calendarContainer.style.display !== 'none') {
                  if (!isInWrapper && !isInCalendar && !isInput && !isIcon && !isInMonthDropdown && !isInYearDropdown) {
                    console.log('ğŸ“… [Input Preview] Click fuera detectado, cerrando calendario');
                    calendarContainer.style.display = 'none';
                    // Cerrar tambiÃ©n los dropdowns si estÃ¡n abiertos
                    if (monthDropdown) monthDropdown.style.display = 'none';
                    if (yearDropdown) yearDropdown.style.display = 'none';
                    // Remover el handler para evitar mÃºltiples cierres
                    if (clickOutsideHandler) {
                      document.removeEventListener('click', clickOutsideHandler);
                      clickOutsideHandler = null;
                    }
                  } else {
                    console.log('ğŸ“… [Input Preview] Click dentro del calendario, no cerrando');
                  }
                }
              };
              // NO usar capture phase para evitar interferir con la apertura
              document.addEventListener('click', clickOutsideHandler);
              console.log('ğŸ“… [Input Preview] Listener de click fuera configurado');
            }, 500);
          };
          
          // Cerrar calendario al presionar ESC
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && calendarContainer) {
              calendarContainer.style.display = 'none';
            }
          });
          
          console.log('âœ… [Input Preview] Calendar picker inicializado');
        }
        
        // Select dropdown - usando componente List
        if (inputType === 'select' && inputElement instanceof HTMLInputElement) {
          // Crear contenedor para el List
          const listContainer = document.createElement('div');
          listContainer.className = 'ubits-select-list-container';
          listContainer.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            margin-top: 4px;
            display: none;
          `;
          wrapper.appendChild(listContainer);
          
          // Opciones de ejemplo para select
          const selectOptions = Array.from({length: 20}, (_, i) => ({
            value: `opt-${i + 1}`,
            text: `OpciÃ³n ${i + 1}`
          }));
          
          // Obtener el tamaÃ±o del List basado en el tamaÃ±o del Input
          const listSize = state.size === 'xs' ? 'xs' : state.size === 'sm' ? 'sm' : state.size === 'md' ? 'md' : 'lg';
          
          const itemsPerPage = 50; // MÃ¡s items ya que List tiene scroll
          let currentPage = 0;
          let allLoadedItems = [];
          let isLoading = false;
          
          const loadOptions = (page = 0) => {
            if (isLoading) return;
            isLoading = true;
            
            setTimeout(() => {
              const startIndex = page * itemsPerPage;
              const endIndex = Math.min(startIndex + itemsPerPage, selectOptions.length);
              const pageOptions = selectOptions.slice(startIndex, endIndex);
              
              // Convertir opciones a items de List
              const newItems = pageOptions.map(option => ({
                label: option.text,
                state: 'default',
                value: option.value,
                selected: false
              }));
              
              // Si es la primera pÃ¡gina, reemplazar todos los items
              if (page === 0) {
                allLoadedItems = newItems;
              } else {
                // Agregar items nuevos
                allLoadedItems = allLoadedItems.concat(newItems);
              }
              
              // Crear la lista usando renderListSimple del componente List
              const listId = `ubits-select-list-${wrapper.id || 'default'}`;
              listContainer.id = listId;
              listContainer.innerHTML = '';
              
              // Generar HTML del List manualmente (sin usar createList para evitar dependencias)
              let listHTML = `<div class="ubits-list" role="list" style="max-height: 200px;">`;
              allLoadedItems.forEach((item) => {
                listHTML += `
                  <div class="ubits-list-item ubits-list-item--${listSize}" role="listitem" tabindex="0" data-value="${item.value}">
                    ${item.label}
                  </div>
                `;
              });
              listHTML += '</div>';
              
              listContainer.innerHTML = listHTML;
              
              // Agregar event listeners a los items
              const listItems = listContainer.querySelectorAll('.ubits-list-item');
              listItems.forEach((itemEl, idx) => {
                const item = allLoadedItems[idx];
                if (item) {
                  itemEl.addEventListener('click', () => {
                    inputElement.value = item.label;
                    listContainer.style.display = 'none';
                  });
                }
              });
              
              // Scroll infinito: cargar mÃ¡s items cuando se acerque al final
              if (endIndex < selectOptions.length) {
                const listElement = listContainer.querySelector('.ubits-list');
                if (listElement) {
                  const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting && !isLoading && endIndex < selectOptions.length) {
                      currentPage++;
                      loadOptions(currentPage);
                    }
                  }, { root: listElement, rootMargin: '50px' });
                  
                  // Observar el Ãºltimo item
                  const lastItem = listContainer.querySelector('.ubits-list-item:last-child');
                  if (lastItem) {
                    observer.observe(lastItem);
                  }
                }
              }
              
              isLoading = false;
            }, 150);
          };
          
          inputElement.addEventListener('click', () => {
            const isVisible = listContainer.style.display === 'block';
            if (!isVisible) {
              currentPage = 0;
              allLoadedItems = [];
              loadOptions(0);
              listContainer.style.display = 'block';
            } else {
              listContainer.style.display = 'none';
            }
          });
          
          document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target)) {
              listContainer.style.display = 'none';
            }
          });
        }
        
        // Calendar picker
        if (inputType === 'calendar' && inputElement instanceof HTMLInputElement) {
          const calendar = document.createElement('div');
          calendar.className = 'ubits-calendar-picker';
          wrapper.appendChild(calendar);
          
          let currentDate = new Date();
          let selectedDate = null;
          
          const formatDate = (date) => {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
          };
          
          const renderCalendar = () => {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            const dayNames = ['Dom', 'Lun', 'Mar', 'MiÃ©', 'Jue', 'Vie', 'SÃ¡b'];
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            let calendarHTML = `
              <div class="ubits-calendar-header">
                <button class="ubits-calendar-prev" type="button"><i class="far fa-chevron-left"></i></button>
                <div class="ubits-calendar-selectors">
                  <select class="ubits-calendar-month-select">
                    ${monthNames.map((name, index) => `<option value="${index}" ${index === month ? 'selected' : ''}>${name}</option>`).join('')}
                  </select>
                  <select class="ubits-calendar-year-select">
                    ${Array.from({length: 100}, (_, i) => {
                      const yearOption = currentDate.getFullYear() - 50 + i;
                      return `<option value="${yearOption}" ${yearOption === year ? 'selected' : ''}>${yearOption}</option>`;
                    }).join('')}
                  </select>
                </div>
                <button class="ubits-calendar-next" type="button"><i class="far fa-chevron-right"></i></button>
              </div>
              <div class="ubits-calendar-weekdays">
                ${dayNames.map(day => `<div class="ubits-calendar-weekday">${day}</div>`).join('')}
              </div>
              <div class="ubits-calendar-days">
            `;
            
            for (let i = 0; i < startingDay; i++) {
              calendarHTML += '<div class="ubits-calendar-day ubits-calendar-day--empty"></div>';
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
              const date = new Date(year, month, day);
              const isToday = date.toDateString() === new Date().toDateString();
              const isSelected = selectedDate && date.toDateString() === selectedDate.toDateString();
              
              let dayClass = 'ubits-calendar-day';
              if (isToday) dayClass += ' ubits-calendar-day--today';
              if (isSelected) dayClass += ' ubits-calendar-day--selected';
              
              calendarHTML += `<div class="${dayClass}" data-date="${formatDate(date)}">${day}</div>`;
            }
            
            calendarHTML += '</div>';
            calendar.innerHTML = calendarHTML;
            
            // Event listeners
            const prevBtn = calendar.querySelector('.ubits-calendar-prev');
            const nextBtn = calendar.querySelector('.ubits-calendar-next');
            const monthSelect = calendar.querySelector('.ubits-calendar-month-select');
            const yearSelect = calendar.querySelector('.ubits-calendar-year-select');
            
            if (prevBtn) {
              prevBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
              });
            }
            
            if (nextBtn) {
              nextBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
              });
            }
            
            if (monthSelect) {
              monthSelect.addEventListener('change', (e) => {
                const target = e.target || e.currentTarget;
                currentDate.setMonth(parseInt(target.value || '0'));
                renderCalendar();
              });
            }
            
            if (yearSelect) {
              yearSelect.addEventListener('change', (e) => {
                const target = e.target || e.currentTarget;
                currentDate.setFullYear(parseInt(target.value || '0'));
                renderCalendar();
              });
            }
            
            calendar.querySelectorAll('.ubits-calendar-day:not(.ubits-calendar-day--empty)').forEach(dayEl => {
              dayEl.addEventListener('click', () => {
                const dateStr = dayEl.dataset.date || '';
                const [day, month, year] = dateStr.split('/');
                selectedDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
                inputElement.value = dateStr;
                calendar.style.display = 'none';
              });
            });
          };
          
          inputElement.addEventListener('click', () => {
            if (calendar.style.display === 'none' || !calendar.style.display) {
              calendar.style.display = 'block';
              renderCalendar();
            } else {
              calendar.style.display = 'none';
            }
          });
          
          document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target)) {
              calendar.style.display = 'none';
            }
          });
        }
        
        // ValidaciÃ³n para telÃ©fono (solo nÃºmeros)
        if (inputType === 'tel' && inputElement instanceof HTMLInputElement) {
          inputElement.addEventListener('input', (e) => {
            // Eliminar cualquier carÃ¡cter que no sea nÃºmero
            const target = e.target || e.currentTarget;
            const value = target.value.replace(/[^0-9]/g, '');
            if (target.value !== value) {
              target.value = value;
            }
          });
          
          // Prevenir pegado de texto no numÃ©rico
          inputElement.addEventListener('paste', (e) => {
            e.preventDefault();
            const paste = (e.clipboardData || window.clipboardData).getData('text');
            const numericPaste = paste.replace(/[^0-9]/g, '');
            inputElement.value = numericPaste;
          });
        }
        
        // Agregar event listener para actualizar contador si existe
        if (inputElement && counterElement && state.showCounter) {
          const updateCounter = () => {
            const length = inputElement.value.length;
            counterElement.textContent = `${length}/${state.maxLength}`;
            if (length >= state.maxLength) {
              counterElement.classList.add('ubits-input-counter--limit');
            } else {
              counterElement.classList.remove('ubits-input-counter--limit');
            }
          };
          inputElement.addEventListener('input', updateCounter);
          updateCounter();
        }
        
        // Mostrar/ocultar contenedor de Rich Text Toolbar segÃºn el tipo
        const richtextContainer = document.getElementById(`input-richtext-toolbar-container-${componentId}`);
        if (richtextContainer) {
          if (inputType === 'textarea') {
            richtextContainer.style.display = 'flex';
          } else {
            richtextContainer.style.display = 'none';
          }
        }
        
        // Rich Text Toolbar (solo para textarea)
        if (inputType === 'textarea' && state.showRichTextToolbar && inputElement instanceof HTMLTextAreaElement) {
          // Cargar CSS de la barra de texto enriquecido
          const existingRichTextCSS = document.querySelector('link[href*="input.css"]');
          if (!existingRichTextCSS) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/input/src/styles/input.css';
            document.head.appendChild(link);
          }
          
          // Cargar CSS del modal si no estÃ¡ cargado
          const existingModalCSS = document.querySelector('link[href*="modal.css"]');
          if (!existingModalCSS) {
            const modalLink = document.createElement('link');
            modalLink.rel = 'stylesheet';
            modalLink.href = '../../addons/modal/src/styles/modal.css';
            document.head.appendChild(modalLink);
          }
          
          // Buscar el contenedor del textarea
          const container = preview.querySelector('.ubits-input-rich-text-wrapper');
          if (container) {
            setupRichTextToolbarForPreview(container, inputElement, componentId);
          }
        }
        
        console.log('âœ… Preview de Input actualizado:', state);
      };
      
      // ========================================
      // RICH TEXT TOOLBAR FUNCTIONS
      // ========================================
      
      // FunciÃ³n para inicializar la barra de texto enriquecido en el preview
      function setupRichTextToolbarForPreview(container, textareaElement, componentId) {
        const toolbar = container.querySelector('.ubits-input-rich-text-toolbar');
        if (!toolbar) return;
        
        const richTextWrapper = textareaElement.closest('.ubits-input-rich-text-wrapper');
        if (!richTextWrapper) return;
        
        const placeholder = textareaElement.placeholder || '';
        
        // Crear div contentEditable que reemplazarÃ¡ al textarea
        const editableDiv = document.createElement('div');
        editableDiv.className = textareaElement.className;
        
        // Copiar estilos del textarea
        const computedStyle = window.getComputedStyle(textareaElement);
        editableDiv.style.cssText = textareaElement.style.cssText;
        editableDiv.style.position = 'relative';
        editableDiv.style.padding = computedStyle.padding || '12px 12px';
        editableDiv.style.margin = '0';
        editableDiv.style.outline = 'none';
        editableDiv.style.overflow = 'auto';
        editableDiv.style.minHeight = computedStyle.minHeight || '80px';
        editableDiv.style.resize = 'vertical';
        editableDiv.contentEditable = 'true';
        editableDiv.setAttribute('data-placeholder', placeholder);
        
        // Establecer contenido inicial
        if (textareaElement.value && textareaElement.value.trim()) {
          editableDiv.innerHTML = textareaElement.value;
        } else {
          editableDiv.classList.add('ubits-rich-text-placeholder');
        }
        
        // Reemplazar textarea con div editable
        textareaElement.style.display = 'none';
        textareaElement.setAttribute('data-rich-text-editor', 'true');
        richTextWrapper.insertBefore(editableDiv, textareaElement);
        
        // FunciÃ³n para sincronizar contenido
        const syncContent = (event) => {
          const textContent = editableDiv.innerText || '';
          textareaElement.value = textContent;
          
          // Manejar placeholder
          if (!textContent.trim()) {
            editableDiv.classList.add('ubits-rich-text-placeholder');
          } else {
            editableDiv.classList.remove('ubits-rich-text-placeholder');
          }
        };
        
        // Sincronizar contenido
        editableDiv.addEventListener('input', syncContent);
        editableDiv.addEventListener('blur', syncContent);
        
        // Manejar placeholder al enfocar
        editableDiv.addEventListener('focus', () => {
          if (editableDiv.classList.contains('ubits-rich-text-placeholder')) {
            editableDiv.textContent = '';
            editableDiv.classList.remove('ubits-rich-text-placeholder');
          }
        });
        
        // Botones de la barra de herramientas
        const toolbarButtons = toolbar.querySelectorAll('.ubits-rich-text-btn');
        toolbarButtons.forEach(button => {
          button.addEventListener('click', (e) => {
            e.preventDefault();
            editableDiv.focus();
            
            const command = button.getAttribute('data-command');
            if (!command) return;
            
            // Comandos especiales que requieren modales
            if (command === 'insertImage') {
              showInsertImageModalForPreview(editableDiv, syncContent);
            } else if (command === 'insertTable') {
              showInsertTableModalForPreview(editableDiv, syncContent);
            } else if (command === 'createLink') {
              showCreateLinkModalForPreview(editableDiv, syncContent);
            } else if (command === 'code') {
              const selection = window.getSelection();
              if (selection && selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const code = document.createElement('code');
                code.style.background = 'var(--ubits-bg-2)';
                code.style.padding = 'var(--ubits-spacing-xs, 2px) var(--ubits-spacing-sm, 4px)';
                code.style.borderRadius = 'var(--ubits-border-radius-sm, 4px)';
                code.style.fontFamily = 'var(--font-mono, monospace)';
                try {
                  range.surroundContents(code);
                } catch (e) {
                  code.textContent = range.toString();
                  range.deleteContents();
                  range.insertNode(code);
                }
              }
            } else {
              // Comandos estÃ¡ndar de document.execCommand
              document.execCommand(command, false, undefined);
            }
            
            // Sincronizar contenido
            syncContent();
          });
        });
      }
      
      // FunciÃ³n para mostrar modal de insertar imagen
      function showInsertImageModalForPreview(editableDiv, syncContent) {
        // Cargar script del modal si no estÃ¡ cargado
        if (!window.createModal) {
          const script = document.createElement('script');
          script.src = '../../addons/modal/dist/modal.umd.js';
          script.onload = () => {
            showInsertImageModalForPreview(editableDiv, syncContent);
          };
          document.head.appendChild(script);
          return;
        }
        
        const modalId = `ubits-rich-text-image-modal-${Date.now()}`;
        const inputId = `${modalId}-input`;
        
        const modalOptions = {
          title: 'Insertar imagen',
          size: 'md',
          bodyContent: `
            <div style="padding: var(--ubits-spacing-md, 8px) 0;">
              <label class="ubits-input-label" style="margin-bottom: var(--ubits-spacing-sm, 8px);">
                URL de la imagen:
              </label>
              <div style="display: flex; gap: var(--ubits-spacing-sm, 8px); align-items: flex-start;">
                <input 
                  type="text" 
                  id="${inputId}"
                  class="ubits-input ubits-input--md"
                  placeholder="https://ejemplo.com/imagen.jpg"
                  style="flex: 1;"
                />
                <button 
                  type="button"
                  id="${modalId}-insert-btn"
                  class="ubits-button ubits-button--primary ubits-button--md"
                >
                  <span>Insertar imagen</span>
                </button>
              </div>
            </div>
          `,
          footerButtons: {
            secondary: {
              label: 'Cancelar',
              onClick: () => {}
            }
          },
          onClose: () => {
            const modal = document.getElementById(modalId)?.closest('.ubits-modal-overlay');
            if (modal) {
              setTimeout(() => modal.remove(), 300);
            }
          },
          closeOnOverlayClick: true,
          open: true
        };
        
        const modal = window.createModal(modalOptions);
        const modalElement = modal.element;
        modalElement.id = modalId;
        
        const insertBtn = document.getElementById(`${modalId}-insert-btn`);
        const urlInput = document.getElementById(inputId);
        
        if (insertBtn && urlInput) {
          const handleInsert = () => {
            const url = urlInput.value.trim();
            if (url) {
              const img = document.createElement('img');
              img.src = url;
              img.style.maxWidth = '100%';
              img.style.height = 'auto';
              img.style.display = 'block';
              img.style.margin = 'var(--ubits-spacing-sm, 8px) 0';
              const selection = window.getSelection();
              if (selection && selection.rangeCount > 0) {
                selection.getRangeAt(0).insertNode(img);
              } else {
                editableDiv.appendChild(img);
              }
              syncContent();
              modal.close();
            }
          };
          
          insertBtn.addEventListener('click', handleInsert);
          urlInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
              e.preventDefault();
              handleInsert();
            }
          });
          
          const cancelBtn = modalElement.querySelector('.ubits-button--secondary');
          if (cancelBtn) {
            cancelBtn.addEventListener('click', () => modal.close());
          }
        }
      }
      
      // FunciÃ³n para mostrar modal de insertar tabla
      function showInsertTableModalForPreview(editableDiv, syncContent) {
        // Cargar script del modal si no estÃ¡ cargado
        if (!window.createModal) {
          const script = document.createElement('script');
          script.src = '../../addons/modal/dist/modal.umd.js';
          script.onload = () => {
            showInsertTableModalForPreview(editableDiv, syncContent);
          };
          document.head.appendChild(script);
          return;
        }
        
        const modalId = `ubits-rich-text-table-modal-${Date.now()}`;
        const rowsInputId = `${modalId}-rows`;
        const colsInputId = `${modalId}-cols`;
        
        const modalOptions = {
          title: 'Insertar tabla',
          size: 'sm',
          bodyContent: `
            <div style="padding: var(--ubits-spacing-md, 8px) 0;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--ubits-spacing-lg, 16px);">
                <div>
                  <label class="ubits-input-label" style="margin-bottom: var(--ubits-spacing-sm, 8px);">
                    Filas:
                  </label>
                  <input 
                    type="number" 
                    id="${rowsInputId}"
                    class="ubits-input ubits-input--md"
                    value="2"
                    min="1"
                    max="20"
                    style="width: 100%;"
                  />
                </div>
                <div>
                  <label class="ubits-input-label" style="margin-bottom: var(--ubits-spacing-sm, 8px);">
                    Columnas:
                  </label>
                  <input 
                    type="number" 
                    id="${colsInputId}"
                    class="ubits-input ubits-input--md"
                    value="2"
                    min="1"
                    max="20"
                    style="width: 100%;"
                  />
                </div>
              </div>
            </div>
          `,
          footerButtons: {
            secondary: {
              label: 'Cancelar',
              onClick: () => {}
            },
            primary: {
              label: 'Insertar',
              onClick: () => {}
            }
          },
          onClose: () => {
            const modal = document.getElementById(modalId)?.closest('.ubits-modal-overlay');
            if (modal) {
              setTimeout(() => modal.remove(), 300);
            }
          },
          closeOnOverlayClick: true,
          open: true
        };
        
        const modal = window.createModal(modalOptions);
        const modalElement = modal.element;
        modalElement.id = modalId;
        
        const insertBtn = modalElement.querySelector('.ubits-button--primary');
        const rowsInput = document.getElementById(rowsInputId);
        const colsInput = document.getElementById(colsInputId);
        
        if (insertBtn && rowsInput && colsInput) {
          insertBtn.addEventListener('click', () => {
            const rows = parseInt(rowsInput.value) || 2;
            const cols = parseInt(colsInput.value) || 2;
            
            if (rows > 0 && cols > 0) {
              const table = document.createElement('table');
              table.style.borderCollapse = 'collapse';
              table.style.width = '100%';
              table.style.margin = 'var(--ubits-spacing-sm, 8px) 0';
              table.style.border = '1px solid var(--ubits-border-1)';
              
              for (let i = 0; i < rows; i++) {
                const tr = document.createElement('tr');
                for (let j = 0; j < cols; j++) {
                  const td = document.createElement('td');
                  td.style.border = '1px solid var(--ubits-border-1)';
                  td.style.padding = 'var(--ubits-spacing-sm, 8px)';
                  td.style.minWidth = '50px';
                  td.textContent = ' ';
                  tr.appendChild(td);
                }
                table.appendChild(tr);
              }
              
              const selection = window.getSelection();
              if (selection && selection.rangeCount > 0) {
                selection.getRangeAt(0).insertNode(table);
              } else {
                editableDiv.appendChild(table);
              }
              
              syncContent();
              modal.close();
            }
          });
        }
        
        const cancelBtn = modalElement.querySelector('.ubits-button--secondary');
        if (cancelBtn) {
          cancelBtn.addEventListener('click', () => modal.close());
        }
      }
      
      // FunciÃ³n para mostrar modal de crear enlace
      function showCreateLinkModalForPreview(editableDiv, syncContent) {
        // Cargar script del modal si no estÃ¡ cargado
        if (!window.createModal) {
          const script = document.createElement('script');
          script.src = '../../addons/modal/dist/modal.umd.js';
          script.onload = () => {
            showCreateLinkModalForPreview(editableDiv, syncContent);
          };
          document.head.appendChild(script);
          return;
        }
        
        const modalId = `ubits-rich-text-link-modal-${Date.now()}`;
        const inputId = `${modalId}-input`;
        
        const modalOptions = {
          title: 'Insertar enlace',
          size: 'md',
          bodyContent: `
            <div style="padding: var(--ubits-spacing-md, 8px) 0;">
              <label class="ubits-input-label" style="margin-bottom: var(--ubits-spacing-sm, 8px);">
                URL del enlace:
              </label>
              <input 
                type="text" 
                id="${inputId}"
                class="ubits-input ubits-input--md"
                placeholder="https://ejemplo.com"
                style="width: 100%; box-sizing: border-box;"
              />
            </div>
          `,
          footerButtons: {
            secondary: {
              label: 'Cancelar',
              onClick: () => {}
            },
            primary: {
              label: 'Insertar',
              onClick: () => {}
            }
          },
          onClose: () => {
            const modal = document.getElementById(modalId)?.closest('.ubits-modal-overlay');
            if (modal) {
              setTimeout(() => modal.remove(), 300);
            }
          },
          closeOnOverlayClick: true,
          open: true
        };
        
        const modal = window.createModal(modalOptions);
        const modalElement = modal.element;
        modalElement.id = modalId;
        
        const insertBtn = modalElement.querySelector('.ubits-button--primary');
        const urlInput = document.getElementById(inputId);
        
        if (insertBtn && urlInput) {
          insertBtn.addEventListener('click', () => {
            const url = urlInput.value.trim();
            if (url) {
              document.execCommand('createLink', false, url);
              syncContent();
              modal.close();
            }
          });
        }
        
        const cancelBtn = modalElement.querySelector('.ubits-button--secondary');
        if (cancelBtn) {
          cancelBtn.addEventListener('click', () => modal.close());
        }
        
        if (urlInput) {
          urlInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
              e.preventDefault();
              if (insertBtn) {
                insertBtn.click();
              }
            }
          });
        }
      }
      
      // ========================================
      // LIST PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const listPreviewState = {};
      
      function initListPreviewState(componentId) {
        if (!listPreviewState[componentId]) {
          listPreviewState[componentId] = {
            size: 'md',
            item1State: 'default',
            item2State: 'active',
            item3State: 'disabled',
            item4State: 'default',
            maxHeight: '400px',
            showScrollbar: false
          };
        }
        return listPreviewState[componentId];
      }
      
      // FunciÃ³n para renderizar List (versiÃ³n simplificada para autoframe)
      function renderListSimple(state, componentId) {
        const { size, item1State, item2State, item3State, item4State, maxHeight, showScrollbar } = state;
        
        // Crear mÃ¡s items para que tenga scroll (10 items)
        const items = [
          { label: 'Item 1', state: item1State },
          { label: 'Item 2', state: item2State },
          { label: 'Item 3', state: item3State },
          { label: 'Item 4', state: item4State },
          { label: 'Item 5', state: 'default' },
          { label: 'Item 6', state: 'default' },
          { label: 'Item 7', state: 'default' },
          { label: 'Item 8', state: 'default' },
          { label: 'Item 9', state: 'default' },
          { label: 'Item 10', state: 'default' }
        ];
        
        const listContainerId = `list-container-${componentId}-${Date.now()}`;
        const listId = `list-${componentId}-${Date.now()}`;
        const scrollbarContainerId = `list-scrollbar-${componentId}-${Date.now()}`;
        
        // Si showScrollbar estÃ¡ activado, usar estructura con scrollbar UBITS
        if (showScrollbar) {
          let listHTML = `
            <div id="${listContainerId}" style="position: relative; width: 100%;">
              <div id="${listId}" class="ubits-list" role="list" style="max-height: ${maxHeight}; overflow-y: auto; overflow-x: hidden; -ms-overflow-style: none; scrollbar-width: none; padding-right: 8px;">
          `;
          
          items.forEach((item, index) => {
            const itemState = item.state || 'default';
            const itemClasses = [
              'ubits-list-item',
              `ubits-list-item--${size}`,
              itemState !== 'default' ? `ubits-list-item--${itemState}` : ''
            ].filter(Boolean).join(' ');
            
            const itemAttrs = [];
            if (itemState === 'active') {
              itemAttrs.push('aria-selected="true"');
            }
            if (itemState === 'disabled') {
              itemAttrs.push('aria-disabled="true"');
            } else {
              itemAttrs.push('tabindex="0"');
            }
            
            listHTML += `
              <div class="${itemClasses}" role="listitem" ${itemAttrs.join(' ')}>
                ${item.label}
              </div>
            `;
          });
          
          listHTML += `
              </div>
              <div id="${scrollbarContainerId}" style="position: absolute; top: 0; right: 0; width: 8px; height: 100%; pointer-events: none;"></div>
            </div>
            <style>
              #${listId}::-webkit-scrollbar { display: none; }
            </style>
          `;
          
          // Crear scrollbar UBITS despuÃ©s de que el DOM estÃ© listo
          setTimeout(() => {
            const listElement = document.getElementById(listId);
            const scrollbarContainer = document.getElementById(scrollbarContainerId);
            
            if (listElement && scrollbarContainer && typeof window.createScrollbarLocal === 'function') {
              if (listElement.scrollHeight > listElement.clientHeight) {
                const scrollbarInstance = window.createScrollbarLocal(listElement, scrollbarContainer, 'vertical');
                if (scrollbarInstance) {
                  scrollbarContainer.style.pointerEvents = 'auto';
                  // Guardar referencia
                  listElement._scrollbarInstance = scrollbarInstance;
                  
                  // Forzar que el scrollbar sea visible
                  setTimeout(() => {
                    const scrollbarElement = scrollbarContainer.querySelector('.ubits-scrollbar');
                    const barElement = scrollbarContainer.querySelector('.ubits-scrollbar__bar');
                    if (scrollbarElement && barElement) {
                      scrollbarElement.style.display = 'flex';
                      barElement.style.opacity = '0.6';
                      barElement.style.pointerEvents = 'auto';
                    }
                  }, 50);
                }
              }
            }
          }, 100);
          
          return listHTML;
        } else {
          // Sin scrollbar UBITS, ocultar scrollbar nativo tambiÃ©n
          let listHTML = `<div class="ubits-list" role="list" style="max-height: ${maxHeight}; overflow-y: auto; -ms-overflow-style: none; scrollbar-width: none;">`;
          
          items.forEach((item, index) => {
            const itemState = item.state || 'default';
            const itemClasses = [
              'ubits-list-item',
              `ubits-list-item--${size}`,
              itemState !== 'default' ? `ubits-list-item--${itemState}` : ''
            ].filter(Boolean).join(' ');
            
            const itemAttrs = [];
            if (itemState === 'active') {
              itemAttrs.push('aria-selected="true"');
            }
            if (itemState === 'disabled') {
              itemAttrs.push('aria-disabled="true"');
            } else {
              itemAttrs.push('tabindex="0"');
            }
            
            listHTML += `
              <div class="${itemClasses}" role="listitem" ${itemAttrs.join(' ')}>
                ${item.label}
              </div>
            `;
          });
          
          listHTML += '</div>';
          listHTML += `<style>
            .ubits-list::-webkit-scrollbar { display: none; }
          </style>`;
          return listHTML;
        }
      }
      
      // FunciÃ³n para actualizar el preview del List
      window.updateListPreview = function(componentId) {
        const state = initListPreviewState(componentId);
        const preview = document.getElementById(`list-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview no encontrado:', `list-preview-${componentId}`);
          return;
        }
        
        // Destruir scrollbar anterior si existe
        const previousList = preview.querySelector('.ubits-list');
        if (previousList && previousList._scrollbarInstance) {
          try {
            if (typeof previousList._scrollbarInstance.destroy === 'function') {
              previousList._scrollbarInstance.destroy();
            }
          } catch (e) {
            console.warn('âš ï¸ Error al destruir scrollbar anterior:', e);
          }
        }
        
        const listHTML = renderListSimple(state, componentId);
        preview.innerHTML = listHTML;
        
        // Cargar CSS del scrollbar siempre (para que estÃ© disponible cuando se active)
        const scrollbarCSSId = 'ubits-scrollbar-css';
        if (!document.getElementById(scrollbarCSSId)) {
          const link = document.createElement('link');
          link.id = scrollbarCSSId;
          link.rel = 'stylesheet';
          link.href = '../../addons/scroll/src/styles/scroll.css';
          document.head.appendChild(link);
        }
        
        console.log('âœ… Preview de List actualizado:', state);
      };
      
      // FunciÃ³n para manejar controles del List
      window.setListControl = function(option, value, componentId) {
        const state = initListPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`list-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item1State') {
          state.item1State = value;
          const select = document.getElementById(`list-item1-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item2State') {
          state.item2State = value;
          const select = document.getElementById(`list-item2-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item3State') {
          state.item3State = value;
          const select = document.getElementById(`list-item3-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'item4State') {
          state.item4State = value;
          const select = document.getElementById(`list-item4-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'maxHeight') {
          state.maxHeight = value;
          const input = document.getElementById(`list-maxheight-input-${componentId}`);
          if (input) input.value = value;
        } else if (option === 'showScrollbar') {
          state.showScrollbar = value;
          const toggle = document.getElementById(`list-scrollbar-toggle-${componentId}`);
          const statusSpan = document.getElementById(`list-scrollbar-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        window.updateListPreview(componentId);
      };
      
      // FunciÃ³n para manejar controles del Input
      window.setInputControl = function(option, value, componentId) {
        const state = initInputPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'label') {
          state.label = value;
          const input = document.getElementById(`input-label-input-${componentId}`);
          if (input) input.value = value;
        } else if (option === 'showLabel') {
          state.showLabel = value;
          const toggle = document.getElementById(`input-label-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-label-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'mandatory') {
          state.mandatory = value;
          const toggle = document.getElementById(`input-mandatory-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-mandatory-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'mandatoryType') {
          state.mandatoryType = value;
          const select = document.getElementById(`input-mandatory-type-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'helperText') {
          state.helperText = value;
          const input = document.getElementById(`input-helper-input-${componentId}`);
          if (input) input.value = value;
        } else if (option === 'showHelper') {
          state.showHelper = value;
          const toggle = document.getElementById(`input-helper-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-helper-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showCounter') {
          state.showCounter = value;
          const toggle = document.getElementById(`input-counter-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-counter-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'maxLength') {
          state.maxLength = parseInt(value) || 50;
          const input = document.getElementById(`input-maxlength-input-${componentId}`);
          if (input) input.value = state.maxLength;
        } else if (option === 'leftIcon') {
          state.leftIcon = value;
          const input = document.getElementById(`input-lefticon-input-${componentId}`);
          const toggle = document.getElementById(`input-lefticon-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'user';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'rightIcon') {
          state.rightIcon = value;
          const input = document.getElementById(`input-righticon-input-${componentId}`);
          const toggle = document.getElementById(`input-righticon-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-righticon-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'check';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'size') {
          state.size = value;
          const select = document.getElementById(`input-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'state') {
          state.state = value;
          const select = document.getElementById(`input-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'type') {
          state.type = value;
          const select = document.getElementById(`input-type-select-${componentId}`);
          if (select) {
            select.value = value;
            console.log('âœ… Tipo cambiado a:', value);
          }
          
          // Ajustar controles segÃºn el tipo
          const leftIconToggle = document.getElementById(`input-lefticon-toggle-${componentId}`);
          const rightIconToggle = document.getElementById(`input-righticon-toggle-${componentId}`);
          const leftIconInput = document.getElementById(`input-lefticon-input-${componentId}`);
          const rightIconInput = document.getElementById(`input-righticon-input-${componentId}`);
          
          // Tipos que tienen iconos automÃ¡ticos fijos
          if (value === 'password') {
            // Password: siempre tiene icono de ojo a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'search') {
            // Search: siempre tiene icono de bÃºsqueda a la izquierda y clear a la derecha
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
          } else if (value === 'autocomplete') {
            // Autocomplete: siempre tiene icono de bÃºsqueda a la izquierda y clear a la derecha
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
          } else if (value === 'select') {
            // Select: siempre tiene chevron a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'calendar') {
            // Calendar: siempre tiene icono de calendario a la derecha, no se puede cambiar
            if (rightIconToggle) {
              rightIconToggle.checked = false;
              rightIconToggle.disabled = true;
              const rightStatusSpan = document.getElementById(`input-righticon-status-${componentId}`);
              if (rightStatusSpan) rightStatusSpan.textContent = 'Desactivado';
            }
            if (rightIconInput) rightIconInput.value = '';
            state.rightIcon = ''; // Limpiar estado
            if (leftIconToggle) leftIconToggle.disabled = false;
          } else if (value === 'email' || value === 'tel' || value === 'url') {
            // Email, Tel, URL: siempre tienen icono a la izquierda, no se puede cambiar
            if (leftIconToggle) {
              leftIconToggle.checked = false;
              leftIconToggle.disabled = true;
              const leftStatusSpan = document.getElementById(`input-lefticon-status-${componentId}`);
              if (leftStatusSpan) leftStatusSpan.textContent = 'Desactivado';
            }
            if (leftIconInput) leftIconInput.value = '';
            state.leftIcon = ''; // Limpiar estado
            if (rightIconToggle) rightIconToggle.disabled = false;
          } else {
            // Otros tipos: permitir cambiar iconos libremente
            if (leftIconToggle) leftIconToggle.disabled = false;
            if (rightIconToggle) rightIconToggle.disabled = false;
          }
          
          // Mostrar/ocultar contenedor de Rich Text Toolbar segÃºn el tipo
          const richtextContainer = document.getElementById(`input-richtext-toolbar-container-${componentId}`);
          if (richtextContainer) {
            if (value === 'textarea') {
              richtextContainer.style.display = 'flex';
            } else {
              richtextContainer.style.display = 'none';
              // Si no es textarea, desactivar la barra de texto enriquecido
              state.showRichTextToolbar = false;
              const richtextToggle = document.getElementById(`input-richtext-toggle-${componentId}`);
              const richtextStatus = document.getElementById(`input-richtext-status-${componentId}`);
              if (richtextToggle) richtextToggle.checked = false;
              if (richtextStatus) richtextStatus.textContent = 'Desactivado';
            }
          }
          
          // Actualizar preview inmediatamente cuando cambia el tipo
          updateInputPreview(componentId);
          return; // Return early ya que updateInputPreview se llama aquÃ­
        } else if (option === 'placeholder') {
          state.placeholder = value;
          const input = document.getElementById(`input-placeholder-input-${componentId}`);
          const toggle = document.getElementById(`input-placeholder-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-placeholder-status-${componentId}`);
          if (toggle) {
            toggle.checked = value !== '';
            if (input) input.value = value || 'Placeholder text';
          }
          if (statusSpan) {
            statusSpan.textContent = value !== '' ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showRichTextToolbar') {
          state.showRichTextToolbar = value;
          const toggle = document.getElementById(`input-richtext-toggle-${componentId}`);
          const statusSpan = document.getElementById(`input-richtext-status-${componentId}`);
          if (toggle) toggle.checked = value;
          if (statusSpan) {
            statusSpan.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        updateInputPreview(componentId);
      };
      
      // Estilos para switches y botones de control
      const style = document.createElement('style');
      style.textContent = `
        .preview-control-btn.active {
          background: var(--ubits-accent-brand-static-inverted) !important;
          color: var(--ubits-fg-bold, #ffffff) !important;
          border-color: var(--ubits-accent-brand-static-inverted) !important;
        }
        .preview-control-btn.active span {
          color: var(--ubits-fg-bold, #ffffff) !important;
        }
        /* Estilos antiguos de .switch eliminados - ahora usamos ubits-toggle */
      `;
      document.head.appendChild(style);
      
      // Inicializar preview del Button cuando se renderice o cuando se active la secciÃ³n
      function initializeButtonPreview() {
        console.log('ğŸš€ initializeButtonPreview llamado');
        const buttonPreview = document.getElementById('button-preview-button');
        
        if (buttonPreview) {
          const hasContent = buttonPreview.innerHTML.trim() !== '' && buttonPreview.querySelector('.ubits-button');
          console.log('ğŸ“‹ Preview estado:', { exists: true, hasContent });
          
          if (!hasContent) {
            console.log('ğŸ”„ Inicializando preview de Button...');
            if (typeof window.updateButtonPreview === 'function') {
              window.updateButtonPreview('button');
            } else {
              console.error('âŒ window.updateButtonPreview no estÃ¡ disponible');
            }
          } else {
            console.log('âœ… Preview ya tiene contenido');
          }
        } else {
          console.warn('âš ï¸ button-preview-button no encontrado');
        }
      }
      
      // Intentar inicializar mÃºltiples veces para asegurar que funcione
      setTimeout(initializeButtonPreview, 100);
      setTimeout(initializeButtonPreview, 500);
      setTimeout(initializeButtonPreview, 1000);
      
      // TambiÃ©n verificar cuando se rendericen los componentes
      const checkButtonInterval = setInterval(() => {
        const buttonPreview = document.getElementById('button-preview-button');
        const componentButton = document.getElementById('component-button');
        
        if (componentButton && buttonPreview && buttonPreview.innerHTML.trim() === '') {
          console.log('ğŸ”„ Detectado componente Button sin preview, inicializando...');
          initializeButtonPreview();
          clearInterval(checkButtonInterval);
        }
      }, 500);
      
      // Limpiar despuÃ©s de 10 segundos
      setTimeout(() => {
        clearInterval(checkButtonInterval);
        console.log('â±ï¸ Interval de verificaciÃ³n de Button finalizado');
      }, 10000);
      
      // Observador de intersecciÃ³n para detectar cuando Button es visible
      const buttonObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const buttonPreview = document.getElementById('button-preview-button');
            if (buttonPreview && buttonPreview.innerHTML.trim() === '') {
              console.log('ğŸ‘ï¸ Componente Button visible en viewport, inicializando preview...');
              setTimeout(() => {
                initializeButtonPreview();
              }, 200);
            }
          }
        });
      }, { threshold: 0.1 });
      
      // Observar el componente Button cuando se renderice
      setTimeout(() => {
        const buttonComponent = document.getElementById('component-button');
        if (buttonComponent) {
          buttonObserver.observe(buttonComponent);
          console.log('ğŸ‘ï¸ Observador de visibilidad activado para Button');
        }
      }, 1000);
      
      // TambiÃ©n inicializar cuando se hace scroll
      let scrollTimeout;
      const scrollHandler = () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
          const buttonPreview = document.getElementById('button-preview-button');
          const buttonComponent = document.getElementById('component-button');
          
          if (buttonComponent && buttonPreview && buttonPreview.innerHTML.trim() === '') {
            const rect = buttonComponent.getBoundingClientRect();
            if (rect.top < window.innerHeight && rect.bottom > 0) {
              console.log('ğŸ‘ï¸ Componente Button visible en scroll, inicializando preview...');
              initializeButtonPreview();
            }
          }
        }, 100);
      };
      window.addEventListener('scroll', scrollHandler, { passive: true });
      
      // ========================================
      // SIDEBAR PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const sidebarPreviewState = {};
      
      // Configuraciones de botones para cada variante
      const defaultBodyButtons = [
        { section: 'admin', icon: 'fa-laptop', tooltip: 'Administrador', state: 'default' },
        { section: 'aprendizaje', icon: 'fa-graduation-cap', tooltip: 'Aprendizaje', state: 'default' },
        { section: 'diagnÃ³stico', icon: 'fa-chart-mixed', tooltip: 'DiagnÃ³stico', state: 'default' },
        { section: 'desempeÃ±o', icon: 'fa-bars-progress', tooltip: 'DesempeÃ±o', state: 'default' },
        { section: 'encuestas', icon: 'fa-clipboard', tooltip: 'Encuestas', state: 'default' },
        { section: 'reclutamiento', icon: 'fa-users', tooltip: 'Reclutamiento', state: 'default' },
        { section: 'tareas', icon: 'fa-layer-group', tooltip: 'Tareas', state: 'default' },
        { section: 'ubits-ai', icon: 'fa-sparkles', tooltip: 'UBITS AI', state: 'default' }
      ];
      
      const adminBodyButtons = [
        { section: 'inicio', icon: 'fa-house', tooltip: 'Inicio', state: 'default' },
        { section: 'empresa', icon: 'fa-building', tooltip: 'Empresa', state: 'default' },
        { section: 'aprendizaje', icon: 'fa-graduation-cap', tooltip: 'Aprendizaje', state: 'default' },
        { section: 'diagnÃ³stico', icon: 'fa-chart-mixed', tooltip: 'DiagnÃ³stico', state: 'default' },
        { section: 'desempeÃ±o', icon: 'fa-bars-progress', tooltip: 'DesempeÃ±o', state: 'default' },
        { section: 'encuestas', icon: 'fa-clipboard', tooltip: 'Encuestas', state: 'default' }
      ];
      
      const adminFooterButtons = [
        { section: 'api', icon: 'fa-code', tooltip: 'API', id: 'api-button', state: 'default' },
        { section: 'centro-de-ayuda', icon: 'fa-circle-question', tooltip: 'Centro de ayuda', id: 'help-center-button', state: 'default' }
      ];
      
      const defaultProfileMenuItems = [
        { icon: 'fa-user', label: 'Ver mi perfil', divider: false },
        { divider: true },
        { icon: 'fa-laptop', label: 'Modo Administrador', divider: false },
        { divider: true },
        { icon: 'fa-key', label: 'Cambio de contraseÃ±a', divider: false },
        { icon: 'fa-sign-out', label: 'Cerrar sesiÃ³n', divider: false }
      ];
      
      const adminProfileMenuItems = [
        { icon: 'fa-user', label: 'Ver mi perfil', divider: false },
        { divider: true },
        { icon: 'fa-user-gear', label: 'Modo colaborador', divider: false },
        { divider: true },
        { icon: 'fa-key', label: 'Cambio de contraseÃ±a', divider: false },
        { icon: 'fa-sign-out', label: 'Cerrar sesiÃ³n', divider: false }
      ];
      
      function initSidebarPreviewState(componentId) {
        if (!sidebarPreviewState[componentId]) {
          sidebarPreviewState[componentId] = {
            variant: 'colaborador',
            activeButton: ''
          };
        }
        return sidebarPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del Sidebar
      window.updateSidebarPreview = function(componentId) {
        const state = initSidebarPreviewState(componentId);
        const preview = document.getElementById(`sidebar-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Sidebar no encontrado:', `sidebar-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”„ Actualizando preview de Sidebar:', state);
        
        // Asegurar que el contenedor tenga fondo
        if (preview.parentElement) {
          preview.parentElement.style.background = 'var(--ubits-bg-2)';
        }
        
        // Limpiar preview anterior
        preview.innerHTML = '';
        
        // Obtener botones segÃºn la variante
        let bodyButtons = state.variant === 'admin' ? JSON.parse(JSON.stringify(adminBodyButtons)) : JSON.parse(JSON.stringify(defaultBodyButtons));
        let footerButtons = state.variant === 'admin' ? JSON.parse(JSON.stringify(adminFooterButtons)) : [];
        const profileMenuItems = state.variant === 'admin' ? adminProfileMenuItems : defaultProfileMenuItems;
        
        // Marcar botÃ³n activo
        if (state.activeButton) {
          bodyButtons.forEach(btn => {
            if (btn.section === state.activeButton) {
              btn.state = 'active';
            } else {
              btn.state = 'default';
            }
          });
        }
        
        // Renderizar directamente HTML estÃ¡tico (siempre usar este mÃ©todo en autoframe)
        renderSidebarStatic(preview, state, bodyButtons, footerButtons, profileMenuItems);
        
        console.log('âœ… Preview de Sidebar actualizado:', state);
      };
      
      // FunciÃ³n para renderizar Sidebar estÃ¡tico (fallback)
      function renderSidebarStatic(container, state, bodyButtons, footerButtons, profileMenuItems) {
        const variant = state.variant || 'colaborador';
        
        console.log('ğŸ¨ Renderizando Sidebar estÃ¡tico:', {
          variant,
          bodyButtonsCount: bodyButtons.length,
          footerButtonsCount: footerButtons.length,
          activeButton: state.activeButton
        });
        
        // Helper para renderizar iconos
        function renderIcon(iconName) {
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="far ${name}" style="font-size: 16px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; line-height: 1; margin: 0; padding: 0; box-sizing: border-box;"></i>`;
        }
        
        let sidebarHTML = `
          <aside class="ubits-sidebar" style="position: relative !important; width: 96px !important; height: 650px !important; top: 0 !important; left: 0 !important; margin: 0 !important;">
            <div class="ubits-sidebar-main">
              <div class="ubits-sidebar-header">
                <div class="ubits-sidebar-logo">
                  <img src="../assets/images/Ubits-logo.svg" alt="UBITS Logo" style="width: 24px; height: 25px;" />
                </div>
              </div>
              <div class="ubits-sidebar-body">
                ${bodyButtons.map(btn => `
                  <button 
                    class="ubits-sidebar-nav-button ${btn.state === 'active' ? 'active' : ''}" 
                    data-section="${btn.section}" 
                    data-tooltip="${btn.tooltip}">
                    ${renderIcon(btn.icon)}
                  </button>
                `).join('')}
              </div>
            </div>
            <div class="ubits-sidebar-footer">
              ${footerButtons.map(btn => `
                <button 
                  class="ubits-sidebar-nav-button" 
                  ${btn.id ? `id="ubits-${btn.id}"` : ''}
                  data-section="${btn.section}" 
                  data-tooltip="${btn.tooltip}">
                  ${renderIcon(btn.icon)}
                </button>
              `).join('')}
              <button class="ubits-sidebar-nav-button" id="ubits-darkmode-toggle" data-tooltip="Modo oscuro" data-theme="light">
                ${renderIcon('fa-moon')}
              </button>
              <div class="ubits-sidebar-user-avatar-container">
                <div class="ubits-sidebar-user-avatar">
                  <img src="../assets/images/Profile-image.jpg" alt="Usuario" class="ubits-sidebar-avatar-image" />
                </div>
              </div>
            </div>
          </aside>
          <div class="ubits-sidebar-profile-menu" id="ubits-sidebar-profile-menu" style="display: none !important;">
            ${profileMenuItems.map(item => {
              if (item.divider) {
                return '<div class="ubits-sidebar-profile-menu-divider"></div>';
              }
              return `
                <div class="ubits-sidebar-profile-menu-item">
                  ${renderIcon(item.icon).replace('width: 24px; height: 24px', 'width: 16px; height: 16px').replace('font-size: 16px', 'font-size: 14px')}
                  <span>${item.label}</span>
                </div>
              `;
            }).join('')}
          </div>
        `;
        
        // Insertar HTML directamente en el contenedor
        container.innerHTML = sidebarHTML;
        
        const sidebarElement = container.querySelector('.ubits-sidebar');
        const menuElement = container.querySelector('.ubits-sidebar-profile-menu');
        
        // Mantener el menÃº dentro del contenedor del preview pero posicionado absolutamente
        // El contenedor ya tiene position: relative, asÃ­ que el menÃº se posicionarÃ¡ relativo a Ã©l
        
        // Inicializar tooltips bÃ¡sicos
        if (sidebarElement) {
          console.log('âœ… Sidebar renderizado, inicializando tooltips...');
          initSidebarTooltipsBasic(sidebarElement);
          
          // Inicializar menÃº de perfil (usar el contenedor del preview)
          initSidebarProfileMenuBasic(container, sidebarElement);
          
          // Inicializar dark mode toggle con cambio de icono
          initDarkModeToggleBasic(sidebarElement);
        } else {
          console.error('âŒ No se encontrÃ³ el elemento .ubits-sidebar despuÃ©s de renderizar');
        }
      }
      
      // FunciÃ³n bÃ¡sica para inicializar menÃº de perfil
      function initSidebarProfileMenuBasic(container, sidebarElement) {
        const avatarElement = sidebarElement.querySelector('.ubits-sidebar-user-avatar');
        const menuElement = container.querySelector('.ubits-sidebar-profile-menu');
        
        if (!avatarElement || !menuElement) {
          console.error('âŒ Avatar o menÃº no encontrado:', { avatarElement, menuElement });
          return;
        }
        
        // Calcular posiciÃ³n del menÃº relativa al avatar (pegado al sidebar)
        const updateMenuPosition = () => {
          const sidebarRect = sidebarElement.getBoundingClientRect();
          const containerRect = container.getBoundingClientRect();
          
          // Posicionar el menÃº justo al lado del sidebar (96px + 0px, completamente pegado)
          const menuLeft = sidebarRect.left - containerRect.left + 96;
          // Alinear con el avatar en la parte inferior
          const menuBottom = 27;
          
          menuElement.style.left = `${menuLeft}px`;
          menuElement.style.bottom = `${menuBottom}px`;
        };
        
        // Configurar estilos del menÃº para posicionamiento absoluto relativo al contenedor
        menuElement.style.position = 'absolute';
        updateMenuPosition(); // Calcular posiciÃ³n inicial
        menuElement.style.zIndex = '2000';
        menuElement.style.display = 'none';
        
        let showTimeout = null;
        let hideTimeout = null;
        
        const showMenu = () => {
          if (hideTimeout) {
            clearTimeout(hideTimeout);
            hideTimeout = null;
          }
          if (showTimeout) clearTimeout(showTimeout);
          updateMenuPosition(); // Actualizar posiciÃ³n antes de mostrar
          showTimeout = window.setTimeout(() => {
            menuElement.classList.add('show');
            menuElement.style.display = 'block';
          }, 100);
        };
        
        const hideMenu = () => {
          if (showTimeout) {
            clearTimeout(showTimeout);
            showTimeout = null;
          }
          hideTimeout = window.setTimeout(() => {
            menuElement.classList.remove('show');
            menuElement.style.display = 'none';
          }, 200);
        };
        
        avatarElement.addEventListener('mouseenter', showMenu);
        avatarElement.addEventListener('mouseleave', hideMenu);
        menuElement.addEventListener('mouseenter', showMenu);
        menuElement.addEventListener('mouseleave', hideMenu);
        
        console.log('âœ… MenÃº de perfil inicializado correctamente');
      }
      
      // FunciÃ³n bÃ¡sica para inicializar dark mode toggle con cambio de icono (solo en preview)
      function initDarkModeToggleBasic(sidebarElement) {
        const darkModeButton = sidebarElement.querySelector('#ubits-darkmode-toggle');
        if (!darkModeButton) return;
        
        // Encontrar el contenedor del preview (el padre del sidebar)
        const previewContainer = sidebarElement.closest('[id^="sidebar-preview-"]');
        if (!previewContainer) {
          console.warn('âš ï¸ No se encontrÃ³ el contenedor del preview');
          return;
        }
        
        // FunciÃ³n para actualizar el icono segÃºn el tema con animaciÃ³n
        const updateIcon = (theme) => {
          const iconElement = darkModeButton.querySelector('i');
          if (iconElement) {
            // Agregar clase de animaciÃ³n
            iconElement.classList.add('ubits-icon-transition');
            
            // Remover clases de iconos anteriores
            iconElement.classList.remove('fa-moon', 'fa-sun', 'fa-sun-bright', 'fa-solid', 'fa-regular', 'far');
            
            // Agregar la clase del icono correspondiente
            if (theme === 'dark') {
              iconElement.classList.add('fa-solid', 'fa-sun-bright');
            } else {
              iconElement.classList.add('far', 'fa-moon');
            }
            
            // Remover clase de animaciÃ³n despuÃ©s de la transiciÃ³n
            setTimeout(() => {
              iconElement.classList.remove('ubits-icon-transition');
            }, 500);
          }
        };
        
        darkModeButton.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          const currentTheme = darkModeButton.getAttribute('data-theme') || 'light';
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          
          // Actualizar atributo del botÃ³n
          darkModeButton.setAttribute('data-theme', newTheme);
          
          // Actualizar el icono
          updateIcon(newTheme);
          
          // Actualizar atributo SOLO en el contenedor del preview, no en todo el documento
          previewContainer.setAttribute('data-theme', newTheme);
          
          console.log('ğŸŒ“ Tema cambiado a:', newTheme, '(solo en preview)');
        });
        
        console.log('âœ… Dark mode toggle inicializado correctamente (solo afecta preview)');
      }
      
      // FunciÃ³n bÃ¡sica para inicializar tooltips
      function initSidebarTooltipsBasic(sidebarElement) {
        if (!sidebarElement) return;
        
        const tooltip = document.getElementById('ubits-sidebar-tooltip') || (() => {
          const tt = document.createElement('div');
          tt.className = 'ubits-sidebar-tooltip';
          tt.id = 'ubits-sidebar-tooltip';
          document.body.appendChild(tt);
          return tt;
        })();
        
        const buttons = sidebarElement.querySelectorAll('[data-tooltip]');
        buttons.forEach(button => {
          button.addEventListener('mouseenter', (e) => {
            const rect = e.target.getBoundingClientRect();
            tooltip.textContent = e.target.getAttribute('data-tooltip');
            tooltip.classList.add('show');
            tooltip.style.left = `${rect.right + 12}px`;
            tooltip.style.top = `${rect.top + (rect.height / 2) - (tooltip.offsetHeight / 2)}px`;
          });
          
          button.addEventListener('mouseleave', () => {
            tooltip.classList.remove('show');
          });
        });
      }
      
      // FunciÃ³n unificada para controles del Sidebar
      window.setSidebarControl = function(option, value, componentId) {
        const state = initSidebarPreviewState(componentId);
        
        if (option === 'variant') {
          state.variant = value;
          state.activeButton = ''; // Resetear botÃ³n activo al cambiar variante
          
          // Actualizar botones activos de variante
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
          
          // Mostrar/ocultar selects de botÃ³n activo segÃºn variante
          const colaboradorSelect = document.getElementById(`sidebar-active-colaborador-${componentId}`);
          const adminSelect = document.getElementById(`sidebar-active-admin-${componentId}`);
          if (colaboradorSelect) colaboradorSelect.style.display = value === 'colaborador' ? 'flex' : 'none';
          if (adminSelect) adminSelect.style.display = value === 'admin' ? 'flex' : 'none';
        } else if (option === 'activeButton') {
          state.activeButton = value || '';
          
          // Actualizar selects
          const variant = state.variant;
          const selectColaborador = document.getElementById(`sidebar-active-button-colaborador-${componentId}`);
          const selectAdmin = document.getElementById(`sidebar-active-button-admin-${componentId}`);
          if (selectColaborador && variant === 'colaborador') selectColaborador.value = value || '';
          if (selectAdmin && variant === 'admin') selectAdmin.value = value || '';
        }
        
        // Actualizar preview
        updateSidebarPreview(componentId);
      };
      
      // Helper global para createSidebar (wrapper para usar en el preview)
      window.createSidebarHelper = function(options) {
        // Intentar importar dinÃ¡micamente si es posible
        if (typeof window.UBITS !== 'undefined' && window.UBITS.Sidebar && window.UBITS.Sidebar.createSidebar) {
          return window.UBITS.Sidebar.createSidebar(options);
        }
        // Si no estÃ¡ disponible, usar el fallback estÃ¡tico
        return null;
      };
      
      // ========================================
      // BADGE PREVIEW INITIALIZATION
      // ========================================
      
      function initializeBadgePreview() {
        console.log('ğŸš€ initializeBadgePreview llamado');
        const badgePreview = document.getElementById('badge-preview-badge');
        
        if (badgePreview) {
          const hasContent = badgePreview.innerHTML.trim() !== '' && badgePreview.querySelector('.ubits-badge');
          console.log('ğŸ“‹ Badge Preview estado:', { exists: true, hasContent });
          
          if (!hasContent && typeof window.updateBadgePreview === 'function') {
            console.log('âœ… Inicializando preview de Badge...');
            window.updateBadgePreview('badge');
          }
        } else {
          console.log('âš ï¸ badge-preview-badge no encontrado aÃºn');
        }
      }
      
      // Inicializar Badge preview cuando el componente estÃ© visible
      setTimeout(initializeBadgePreview, 100);
      setTimeout(initializeBadgePreview, 500);
      
      // Verificar cuando se rendericen los componentes
      const checkBadgeInterval = setInterval(() => {
        const badgePreview = document.getElementById('badge-preview-badge');
        const componentBadge = document.getElementById('component-badge');
        
        if (badgePreview && componentBadge && componentBadge.offsetHeight > 0) {
          initializeBadgePreview();
          clearInterval(checkBadgeInterval);
        }
      }, 500);
      
      // Limpiar despuÃ©s de 10 segundos
      setTimeout(() => clearInterval(checkBadgeInterval), 10000);
      
      // Usar IntersectionObserver para Badge
      if (typeof IntersectionObserver !== 'undefined') {
        const badgeObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              setTimeout(() => {
                initializeBadgePreview();
              }, 200);
            }
          });
        }, { threshold: 0.1 });
        
        const badgeComponent = document.getElementById('component-badge');
        if (badgeComponent) {
          badgeObserver.observe(badgeComponent);
          console.log('ğŸ‘ï¸ Observador de visibilidad activado para Badge');
        }
      }
      
      // ========================================
      // LIST PREVIEW INITIALIZATION
      // ========================================
      
      function initializeListPreview() {
        console.log('ğŸš€ initializeListPreview llamado');
        const listPreview = document.getElementById('list-preview-list');
        
        if (listPreview) {
          const hasContent = listPreview.innerHTML.trim() !== '' && listPreview.querySelector('.ubits-list');
          console.log('ğŸ“‹ List Preview estado:', { exists: true, hasContent });
          
          if (!hasContent && typeof window.updateListPreview === 'function') {
            console.log('âœ… Inicializando preview de List...');
            window.updateListPreview('list');
          }
        } else {
          console.log('âš ï¸ list-preview-list no encontrado aÃºn');
        }
      }
      
      // Inicializar List preview cuando el componente estÃ© visible
      setTimeout(initializeListPreview, 100);
      setTimeout(initializeListPreview, 500);
      
      // Verificar cuando se rendericen los componentes
      const checkListInterval = setInterval(() => {
        const listPreview = document.getElementById('list-preview-list');
        const componentList = document.getElementById('component-list');
        
        if (listPreview && componentList && componentList.offsetHeight > 0) {
          initializeListPreview();
          clearInterval(checkListInterval);
        }
      }, 500);
      
      // Limpiar despuÃ©s de 10 segundos
      setTimeout(() => clearInterval(checkListInterval), 10000);
      
      // Usar IntersectionObserver para List
      if (typeof IntersectionObserver !== 'undefined') {
        const listObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              setTimeout(() => {
                initializeListPreview();
              }, 200);
            }
          });
        }, { threshold: 0.1 });
        
        const listComponent = document.getElementById('component-list');
        if (listComponent) {
          listObserver.observe(listComponent);
          console.log('ğŸ‘ï¸ Observador de visibilidad activado para List');
        }
      }
      
      // ========================================
      // SUBNAV PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const subNavPreviewState = {};
      
      // Configuraciones de tabs por variante
      const subNavVariantsConfig = {
        template: [
          { id: 'section1', label: 'SecciÃ³n 1', icon: 'fa-home' },
          { id: 'section2', label: 'SecciÃ³n 2', icon: 'fa-book' },
          { id: 'section3', label: 'SecciÃ³n 3', icon: 'fa-chart-line' },
          { id: 'section4', label: 'SecciÃ³n 4', icon: 'fa-cog' },
          { id: 'section5', label: 'SecciÃ³n 5', icon: 'fa-star' }
        ],
        aprendizaje: [
          { id: 'home', label: 'Inicio', icon: 'fa-home' },
          { id: 'catalog', label: 'CatÃ¡logo', icon: 'fa-book' },
          { id: 'corporate', label: 'U. Corporativa', icon: 'fa-building-columns' },
          { id: 'study-zone', label: 'Zona de estudio', icon: 'fa-books' }
        ],
        desempeno: [
          { id: 'evaluations', label: 'Evaluaciones 360', icon: 'fa-chart-pie' },
          { id: 'objectives', label: 'Objetivos', icon: 'fa-bullseye' },
          { id: 'metrics', label: 'MÃ©tricas', icon: 'fa-chart-line' },
          { id: 'reports', label: 'Reportes', icon: 'fa-file-chart-line' }
        ],
        encuestas: [
          { id: 'encuestas', label: 'Encuestas', icon: 'fa-clipboard-list-check' }
        ],
        tareas: [
          { id: 'plans', label: 'Planes', icon: 'fa-layer-group' },
          { id: 'tasks', label: 'Tareas', icon: 'fa-tasks' }
        ],
        empresa: [
          { id: 'gestion-usuarios', label: 'GestiÃ³n de usuarios', icon: 'fa-users' },
          { id: 'organigrama', label: 'Organigrama', icon: 'fa-sitemap' },
          { id: 'datos-empresa', label: 'Datos de empresa', icon: 'fa-building' },
          { id: 'personalizacion', label: 'PersonalizaciÃ³n', icon: 'fa-paint-brush' },
          { id: 'roles-permisos', label: 'Roles y permisos', icon: 'fa-user-shield' },
          { id: 'comunicaciones', label: 'Comunicaciones', icon: 'fa-envelope' }
        ],
        'admin-aprendizaje': [
          { id: 'lms-cursos', label: 'LMS - Cursos propios', icon: 'fa-book' },
          { id: 'plan-formacion', label: 'Plan de formaciÃ³n', icon: 'fa-clipboard-list-check' },
          { id: 'certificados', label: 'Certificados', icon: 'fa-file-certificate' },
          { id: 'metricas-empresa', label: 'MÃ©tricas de empresa', icon: 'fa-chart-line' }
        ],
        'admin-desempeno': [
          { id: 'evaluations', label: 'Evaluaciones 360', icon: 'fa-chart-pie' },
          { id: 'objectives', label: 'Objetivos', icon: 'fa-bullseye' },
          { id: 'matriz-talento', label: 'Matriz de Talento', icon: 'fa-sitemap' }
        ]
      };
      
      function initSubNavPreviewState(componentId) {
        if (!subNavPreviewState[componentId]) {
          subNavPreviewState[componentId] = {
            variant: 'template',
            activeTabId: ''
          };
        }
        return subNavPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del SubNav
      window.updateSubNavPreview = function(componentId) {
        const state = initSubNavPreviewState(componentId);
        const preview = document.getElementById(`subnav-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de SubNav no encontrado:', `subnav-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”„ Actualizando preview de SubNav:', state);
        
        // Obtener tabs segÃºn la variante
        const tabs = subNavVariantsConfig[state.variant] || subNavVariantsConfig.template;
        
        // Determinar tab activo
        const activeTabId = state.activeTabId || (tabs.length > 0 ? tabs[0].id : '');
        
        // Renderizar directamente HTML estÃ¡tico
        renderSubNavStatic(preview, state, tabs, activeTabId);
        
        console.log('âœ… Preview de SubNav actualizado:', state);
      };
      
      // FunciÃ³n para renderizar SubNav estÃ¡tico
      function renderSubNavStatic(container, state, tabs, activeTabId) {
        const variant = state.variant || 'template';
        
        console.log('ğŸ¨ Renderizando SubNav estÃ¡tico:', {
          variant,
          tabsCount: tabs.length,
          activeTabId
        });
        
        // Helper para renderizar iconos
        function renderIcon(iconName) {
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="far ${name}"></i>`;
        }
        
        // Renderizar tabs
        const tabsHTML = tabs.map(tab => {
          const isActive = tab.id === activeTabId;
          const activeClass = isActive ? 'ubits-sub-nav-tab--active' : '';
          
          return `
            <button 
              class="ubits-sub-nav-tab ${activeClass}" 
              data-tab="${tab.id}"
              onclick="handleSubNavTabClick('${tab.id}', '${variant}')"
            >
              ${renderIcon(tab.icon)}
              <span>${tab.label}</span>
            </button>
          `;
        }).join('');
        
        const subNavHTML = `
          <nav class="ubits-sub-nav" data-variant="${variant}">
            <div class="ubits-sub-nav-tabs">
              ${tabsHTML}
            </div>
          </nav>
        `;
        
        container.innerHTML = subNavHTML;
      }
      
      // Handler para clicks en tabs
      window.handleSubNavTabClick = function(tabId, variant) {
        console.log('ğŸ–±ï¸ Tab clickeado:', tabId);
        
        // Actualizar estado activo en todos los componentes SubNav
        Object.keys(subNavPreviewState).forEach(componentId => {
          const state = subNavPreviewState[componentId];
          if (state.variant === variant) {
            state.activeTabId = tabId;
            window.updateSubNavPreview(componentId);
          }
        });
      };
      
      // FunciÃ³n para establecer controles
      window.setSubNavControl = function(option, value, componentId) {
        const state = initSubNavPreviewState(componentId);
        state[option] = value;
        
        // Si cambia la variante, resetear el tab activo al primero y actualizar dropdown
        if (option === 'variant') {
          const tabs = subNavVariantsConfig[value] || subNavVariantsConfig.template;
          state.activeTabId = tabs.length > 0 ? tabs[0].id : '';
          
          // Actualizar dropdown de tabs activos
          const tabSelect = document.getElementById(`subnav-active-tab-select-${componentId}`);
          if (tabSelect) {
            tabSelect.innerHTML = tabs.map(tab => 
              `<option value="${tab.id}" ${tab.id === state.activeTabId ? 'selected' : ''}>${tab.label}</option>`
            ).join('');
          }
        }
        
        window.updateSubNavPreview(componentId);
      };
      
      // FunciÃ³n para actualizar dropdown de tabs cuando cambia la variante
      function updateSubNavTabDropdown(componentId, variant) {
        const tabs = subNavVariantsConfig[variant] || subNavVariantsConfig.template;
        const tabSelect = document.getElementById(`subnav-active-tab-select-${componentId}`);
        const state = initSubNavPreviewState(componentId);
        
        if (tabSelect) {
          tabSelect.innerHTML = tabs.map(tab => 
            `<option value="${tab.id}" ${tab.id === state.activeTabId ? 'selected' : ''}>${tab.label}</option>`
          ).join('');
        }
      }
      
      // Actualizar dropdown cuando se renderiza el componente
      setTimeout(() => {
        const subNavComponent = document.getElementById('component-subnav');
        if (subNavComponent) {
          const variantSelect = document.getElementById('subnav-variant-select-subnav');
          if (variantSelect) {
            updateSubNavTabDropdown('subnav', variantSelect.value);
            
            // Listener para cambios en variante
            variantSelect.addEventListener('change', function() {
              updateSubNavTabDropdown('subnav', this.value);
            });
          }
        }
      }, 500);
      
      // ========================================
      // TABBAR PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const tabBarPreviewState = {};
      
      // Configuraciones de Floating Menu para cada variante
      const colaboradorFloatingMenuSections = [
        {
          id: 'aprendizaje',
          title: 'Aprendizaje',
          icon: 'graduation-cap',
          subitems: [
            { id: 'inicio', title: 'Inicio', icon: 'home', url: '#' },
            { id: 'catalogo', title: 'CatÃ¡logo', icon: 'book', url: '#' },
            { id: 'corporativa', title: 'U. Corporativa', icon: 'building-columns', url: '#' },
            { id: 'zona-estudio', title: 'Zona de estudio', icon: 'books', url: '#' }
          ]
        },
        {
          id: 'diagnostico',
          title: 'DiagnÃ³stico',
          icon: 'chart-mixed',
          url: '#',
          isLink: true,
          clickable: true
        },
        {
          id: 'desempeno',
          title: 'DesempeÃ±o',
          icon: 'bars-progress',
          subitems: [
            { id: 'evaluaciones-360', title: 'Evaluaciones 360', icon: 'chart-pie', url: '#' },
            { id: 'objetivos', title: 'Objetivos', icon: 'bullseye', url: '#' },
            { id: 'metricas', title: 'MÃ©tricas', icon: 'chart-line', url: '#' },
            { id: 'reportes', title: 'Reportes', icon: 'file-chart-line', url: '#' }
          ]
        },
        {
          id: 'encuestas',
          title: 'Encuestas',
          icon: 'clipboard-list-check',
          url: '#',
          isLink: true,
          clickable: false
        },
        {
          id: 'reclutamiento',
          title: 'Reclutamiento',
          icon: 'users',
          url: '#',
          isLink: true,
          clickable: true
        },
        {
          id: 'tareas',
          title: 'Tareas',
          icon: 'layer-group',
          subitems: [
            { id: 'planes', title: 'Planes', icon: 'calendar', url: '#' },
            { id: 'tareas', title: 'Tareas', icon: 'tasks', url: '#' }
          ]
        },
        {
          id: 'ubits-ai',
          title: 'UBITS AI',
          icon: 'sparkles',
          url: '#',
          isLink: true,
          clickable: true
        }
      ];
      
      const adminFloatingMenuSections = [
        {
          id: 'inicio',
          title: 'Inicio',
          icon: 'house',
          url: null,
          isLink: false
        },
        {
          id: 'empresa',
          title: 'Empresa',
          icon: 'building',
          subitems: [
            { id: 'gestion-usuarios', title: 'GestiÃ³n de usuarios', icon: 'users' },
            { id: 'organigrama', title: 'Organigrama', icon: 'sitemap' },
            { id: 'datos-empresa', title: 'Datos de empresa', icon: 'building' },
            { id: 'personalizacion', title: 'PersonalizaciÃ³n', icon: 'paint-brush' },
            { id: 'roles-permisos', title: 'Roles y permisos', icon: 'user-shield' },
            { id: 'comunicaciones', title: 'Comunicaciones', icon: 'envelope' }
          ]
        },
        {
          id: 'aprendizaje',
          title: 'Aprendizaje',
          icon: 'graduation-cap',
          subitems: [
            { id: 'lms-cursos', title: 'LMS - Cursos propios', icon: 'book' },
            { id: 'plan-formacion', title: 'Plan de formaciÃ³n', icon: 'clipboard-list-check' },
            { id: 'certificados', title: 'Certificados', icon: 'file-certificate' },
            { id: 'metricas-empresa', title: 'MÃ©tricas de empresa', icon: 'chart-line' }
          ]
        },
        {
          id: 'diagnÃ³stico',
          title: 'DiagnÃ³stico',
          icon: 'chart-mixed',
          url: null,
          isLink: false
        },
        {
          id: 'desempeÃ±o',
          title: 'DesempeÃ±o',
          icon: 'bars-progress',
          subitems: [
            { id: 'evaluations', title: 'Evaluaciones 360', icon: 'chart-pie' },
            { id: 'objectives', title: 'Objetivos', icon: 'bullseye' },
            { id: 'matriz-talento', title: 'Matriz de Talento', icon: 'sitemap' }
          ]
        },
        {
          id: 'encuestas',
          title: 'Encuestas',
          icon: 'clipboard-list-check',
          url: null,
          isLink: false
        }
      ];
      
      // Items del Profile Menu por variante (TabBar)
      const tabBarColaboradorProfileMenuItems = [
        { id: 'ver-perfil', label: 'Ver mi perfil', icon: 'user', url: '#' },
        { id: 'admin-mode', label: 'Modo Administrador', icon: 'laptop', url: '#' },
        { id: 'cambio-contraseÃ±a', label: 'Cambio de contraseÃ±a', icon: 'key' },
        { id: 'cerrar-sesion', label: 'Cerrar sesiÃ³n', icon: 'sign-out-alt' }
      ];
      
      const tabBarAdminProfileMenuItems = [
        { id: 'ver-perfil', label: 'Ver mi perfil', icon: 'user', url: '#' },
        { id: 'modo-colaborador', label: 'Modo colaborador', icon: 'user-gear', url: '#' },
        { id: 'cambio-contraseÃ±a', label: 'Cambio de contraseÃ±a', icon: 'key' },
        { id: 'cerrar-sesion', label: 'Cerrar sesiÃ³n', icon: 'sign-out-alt' }
      ];
      
      // Items estÃ¡ndar del TabBar
      const defaultTabBarItems = [
        { id: 'modulos', label: 'MÃ³dulos', icon: 'th-large' },
        { id: 'perfil', label: 'Mi perfil', avatar: '../assets/images/Profile-image.jpg', avatarAlt: 'Mi perfil' },
        { id: 'modo-oscuro', label: 'Modo oscuro', icon: 'moon' }
      ];
      
      // Secciones del Floating Menu por defecto (deprecated, usar segÃºn variante)
      const defaultFloatingMenuSections = colaboradorFloatingMenuSections;
      
      function initTabBarPreviewState(componentId) {
        if (!tabBarPreviewState[componentId]) {
          tabBarPreviewState[componentId] = {
            variant: 'colaborador',
            activeTabId: 'modulos',
            darkModeEnabled: true
          };
        }
        return tabBarPreviewState[componentId];
      }
      
      // Exponer funciÃ³n para uso externo
      window.initTabBarPreviewState = initTabBarPreviewState;
      
      // FunciÃ³n para actualizar el preview del TabBar
      window.updateTabBarPreview = function(componentId, preserveMenus) {
        // Obtener el estado directamente del objeto tabBarPreviewState para asegurar que sea el mÃ¡s reciente
        const state = tabBarPreviewState[componentId] || initTabBarPreviewState(componentId);
        const preview = document.getElementById(`tabbar-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de TabBar no encontrado:', `tabbar-preview-${componentId}`);
          return;
        }
        
        // Asegurar que el contenedor tenga fondo
        if (preview.parentElement) {
          preview.parentElement.style.background = 'var(--ubits-bg-2)';
        }
        preview.style.background = 'var(--ubits-bg-2)';
        
        console.log('ğŸ”„ [updateTabBarPreview] INICIO - componentId:', componentId);
        console.log('ğŸ”„ Actualizando preview de TabBar:', JSON.stringify(state, null, 2));
        
        // Guardar estado de los menÃºs si se debe preservar
        const floatingMenuContainer = document.getElementById(`ubits-floating-menu-container-${componentId}`);
        const profileMenuContainer = document.getElementById(`ubits-profile-menu-container-${componentId}`);
        let floatingMenuVisible = false;
        let profileMenuVisible = false;
        
        if (preserveMenus) {
          if (floatingMenuContainer) {
            floatingMenuVisible = floatingMenuContainer.style.display !== 'none' && floatingMenuContainer.style.display !== '';
          }
          if (profileMenuContainer) {
            profileMenuVisible = profileMenuContainer.style.display !== 'none' && profileMenuContainer.style.display !== '';
          }
        }
        
        // Obtener configuraciones segÃºn la variante
        console.log('ğŸ” [updateTabBarPreview] Estado actual:', JSON.stringify(state, null, 2));
        console.log('ğŸ” [updateTabBarPreview] Variante en estado:', state.variant, 'Tipo:', typeof state.variant);
        console.log('ğŸ” [updateTabBarPreview] Comparando con admin:', state.variant === 'admin');
        console.log('ğŸ” [updateTabBarPreview] adminFloatingMenuSections disponible:', typeof adminFloatingMenuSections !== 'undefined');
        console.log('ğŸ” [updateTabBarPreview] colaboradorFloatingMenuSections disponible:', typeof colaboradorFloatingMenuSections !== 'undefined');
        
        const floatingMenuSections = state.variant === 'admin' ? adminFloatingMenuSections : colaboradorFloatingMenuSections;
        const profileMenuItems = state.variant === 'admin' ? tabBarAdminProfileMenuItems : tabBarColaboradorProfileMenuItems;
        
        console.log('ğŸ“‹ [updateTabBarPreview] Configuraciones seleccionadas:', {
          variant: state.variant,
          floatingMenuSectionsCount: floatingMenuSections.length,
          profileMenuItemsCount: profileMenuItems.length,
          firstFloatingSection: floatingMenuSections[0]?.title,
          firstProfileItem: profileMenuItems[0]?.label,
          allFloatingSections: floatingMenuSections.map(s => s.title),
          allProfileItems: profileMenuItems.map(i => i.label)
        });
        
        // Renderizar directamente HTML estÃ¡tico
        renderTabBarStatic(preview, state, defaultTabBarItems, componentId, floatingMenuSections, profileMenuItems);
        
        // Restaurar estado de los menÃºs si se debe preservar
        if (preserveMenus) {
          const newFloatingMenuContainer = document.getElementById(`ubits-floating-menu-container-${componentId}`);
          const newProfileMenuContainer = document.getElementById(`ubits-profile-menu-container-${componentId}`);
          const newFloatingMenu = newFloatingMenuContainer ? newFloatingMenuContainer.querySelector('.ubits-floating-menu') : null;
          const newProfileMenu = newProfileMenuContainer ? newProfileMenuContainer.querySelector('.ubits-profile-menu') : null;
          
          if (floatingMenuVisible && newFloatingMenuContainer && newFloatingMenu) {
            newFloatingMenuContainer.style.display = 'block';
            newFloatingMenu.classList.add('ubits-floating-menu--show');
          }
          
          if (profileMenuVisible && newProfileMenuContainer && newProfileMenu) {
            newProfileMenuContainer.style.display = 'block';
            newProfileMenu.classList.add('ubits-profile-menu--show');
          }
        }
        
        console.log('âœ… Preview de TabBar actualizado:', state);
      };
      
      // FunciÃ³n para renderizar TabBar estÃ¡tico con Floating Menu y Profile Menu
      function renderTabBarStatic(container, state, items, componentId, floatingMenuSections, profileMenuItems) {
        const activeTabId = state.activeTabId || 'modulos';
        const darkModeEnabled = state.darkModeEnabled !== false;
        const finalComponentId = componentId || 'tabbar';
        
        console.log('ğŸ¨ [renderTabBarStatic] INICIO - ParÃ¡metros recibidos:', {
          variant: state.variant,
          floatingMenuSectionsReceived: floatingMenuSections?.length || 0,
          profileMenuItemsReceived: profileMenuItems?.length || 0,
          floatingMenuSectionsType: typeof floatingMenuSections,
          profileMenuItemsType: typeof profileMenuItems
        });
        
        // IMPORTANTE: Usar los parÃ¡metros pasados si estÃ¡n definidos, de lo contrario usar fallback segÃºn variante
        let finalFloatingMenuSections;
        let finalProfileMenuItems;
        
        if (floatingMenuSections && Array.isArray(floatingMenuSections) && floatingMenuSections.length > 0) {
          console.log('âœ… [renderTabBarStatic] Usando floatingMenuSections pasados como parÃ¡metro');
          finalFloatingMenuSections = floatingMenuSections;
        } else {
          console.log('âš ï¸ [renderTabBarStatic] Usando fallback segÃºn variante:', state.variant);
          // Fallback segÃºn variante
          finalFloatingMenuSections = (state.variant === 'admin' ? adminFloatingMenuSections : colaboradorFloatingMenuSections);
        }
        
        if (profileMenuItems && Array.isArray(profileMenuItems) && profileMenuItems.length > 0) {
          console.log('âœ… [renderTabBarStatic] Usando profileMenuItems pasados como parÃ¡metro');
          finalProfileMenuItems = profileMenuItems;
        } else {
          console.log('âš ï¸ [renderTabBarStatic] Usando fallback segÃºn variante:', state.variant);
          // Fallback segÃºn variante
          finalProfileMenuItems = (state.variant === 'admin' ? tabBarAdminProfileMenuItems : tabBarColaboradorProfileMenuItems);
        }
        
        console.log('ğŸ¨ Renderizando TabBar estÃ¡tico:', {
          activeTabId,
          darkModeEnabled,
          itemsCount: items.length,
          componentId: finalComponentId,
          variant: state.variant,
          floatingMenuSectionsReceived: floatingMenuSections?.length || 0,
          profileMenuItemsReceived: profileMenuItems?.length || 0,
          finalFloatingMenuSectionsCount: finalFloatingMenuSections.length,
          finalProfileMenuItemsCount: finalProfileMenuItems.length,
          firstFloatingSection: finalFloatingMenuSections[0]?.title,
          firstProfileItem: finalProfileMenuItems[0]?.label,
          allFloatingSections: finalFloatingMenuSections.map(s => s.title),
          allProfileItems: finalProfileMenuItems.map(i => i.label)
        });
        
        // Helper para renderizar iconos
        function renderIcon(iconName, options = {}) {
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          const fontSize = options.fontSize || '20px';
          const width = options.width || '24px';
          const height = options.height || '24px';
          return `<i class="far ${name}" style="font-size: ${fontSize}; width: ${width}; height: ${height}; display: flex; align-items: center; justify-content: center; line-height: 1; margin: 0; padding: 0; box-sizing: border-box;"></i>`;
        }
        
        // Renderizar items del TabBar
        const itemsHTML = items.map(item => {
          const isActive = item.id === activeTabId;
          const activeClass = isActive ? 'ubits-tabbar-item--active' : '';
          
          let iconOrAvatarHTML = '';
          if (item.avatar) {
            iconOrAvatarHTML = `<img src="${item.avatar}" alt="${item.avatarAlt || item.label}" class="ubits-tabbar-avatar">`;
          } else if (item.icon) {
            iconOrAvatarHTML = `<span class="ubits-tabbar-icon">${renderIcon(item.icon)}</span>`;
          }
          
          return `
            <div 
              class="ubits-tabbar-item ${activeClass}" 
              data-tab-id="${item.id}"
              onclick="handleTabBarItemClick('${item.id}', '${finalComponentId}')"
            >
              ${iconOrAvatarHTML}
              <span class="ubits-tabbar-text">${item.label}</span>
            </div>
          `;
        }).join('');
        
        // Renderizar Floating Menu
        function renderFloatingMenuStatic(sections) {
          console.log('ğŸ“ [renderFloatingMenuStatic] Renderizando secciones:', sections.length);
          sections.forEach((section, idx) => {
            console.log(`ğŸ“ [renderFloatingMenuStatic] SecciÃ³n ${idx}:`, {
              id: section.id,
              title: section.title,
              isLink: section.isLink,
              hasSubitems: !!(section.subitems && section.subitems.length > 0),
              subitemsCount: section.subitems?.length || 0
            });
          });
          
          const sectionsHTML = sections.map(section => {
            // Si es un link directo O no tiene subitems y no es link, renderizar como link directo
            if (section.isLink || (!section.subitems || section.subitems.length === 0)) {
              const url = section.url || '#';
              console.log(`ğŸ“ [renderFloatingMenuStatic] Renderizando como link directo:`, section.title, 'url:', url);
              return `
                <a href="${url}" class="ubits-accordion-link ubits-accordion-link--direct" data-section-id="${section.id}">
                  <div class="ubits-accordion-icon-circle" data-circle-id="${section.id}">
                    ${renderIcon(section.icon)}
                  </div>
                  <span>${section.title}</span>
                  <i class="far fa-chevron-right ubits-accordion-chevron"></i>
                </a>
              `;
            }
            
            // Si tiene subitems, renderizar como accordion
            const subitemsHTML = (section.subitems || []).map(subitem => `
              <a href="${subitem.url || '#'}" class="ubits-accordion-link" data-subitem-id="${subitem.id}">
                <div class="ubits-accordion-icon-circle" data-circle-id="${subitem.id}">
                  ${renderIcon(subitem.icon)}
                </div>
                <span>${subitem.title}</span>
              </a>
            `).join('');

            console.log(`ğŸ“ [renderFloatingMenuStatic] Renderizando como accordion:`, section.title, 'subitems:', section.subitems.length);
            return `
              <div class="ubits-accordion-item">
                <div class="ubits-accordion-header" data-accordion-id="${section.id}" onclick="handleTabBarAccordionClick('${section.id}', '${finalComponentId}')">
                  <div class="ubits-accordion-title">
                    <div class="ubits-accordion-icon-circle" data-circle-id="${section.id}">
                      ${renderIcon(section.icon)}
                    </div>
                    <span>${section.title}</span>
                  </div>
                  <i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="${section.id}"></i>
                </div>
                <div class="ubits-accordion-body" data-body-id="${section.id}">
                  ${subitemsHTML}
                </div>
              </div>
            `;
          }).join('');
          
          return `
            <div class="ubits-floating-menu ubits-floating-menu--preview" id="ubits-floating-menu-${finalComponentId}" style="display: block; position: absolute; top: 0; left: 0; right: 0; bottom: 0; max-height: 500px; border-radius: 8px;">
              <div class="ubits-floating-menu-header">
                <h2 class="ubits-floating-menu-title">MÃ³dulos</h2>
                <button class="ubits-floating-menu-close" onclick="handleTabBarCloseMenu('${finalComponentId}')">
                  ${renderIcon('times')}
                </button>
              </div>
              <div class="ubits-floating-menu-content">
                ${sectionsHTML}
              </div>
            </div>
          `;
        }
        
        // Renderizar Profile Menu
        function renderProfileMenuStatic(items, componentId) {
          const finalComponentId = componentId || 'tabbar';
          
          console.log('ğŸ‘¤ [renderProfileMenuStatic] Renderizando items del Profile Menu:', items.length);
          items.forEach((item, idx) => {
            console.log(`ğŸ‘¤ [renderProfileMenuStatic] Item ${idx}:`, {
              id: item.id,
              label: item.label,
              icon: item.icon
            });
          });
          
          const itemsHTML = items.map(item => `
            <div class="ubits-profile-menu-item" data-profile-item-id="${item.id}">
              <span class="ubits-profile-menu-icon">${renderIcon(item.icon, { fontSize: '16px', width: '16px', height: '16px' })}</span>
              <span class="ubits-profile-menu-text">${item.label}</span>
            </div>
          `).join('');
          
          return `
            <div class="ubits-profile-menu ubits-profile-menu--preview" id="ubits-profile-menu-${finalComponentId}" style="display: block; position: absolute; bottom: 0; left: 0; right: 0; width: 100%; max-width: 100%;">
              ${itemsHTML}
            </div>
          `;
        }
        
        // Wrapper para contener TabBar, Floating Menu y Profile Menu (para posicionamiento relativo)
        const tabBarWrapper = document.createElement('div');
        tabBarWrapper.style.cssText = 'position: relative; width: 100%; min-height: 576px;'; // 60px TabBar + 500px Floating Menu + 16px espacio
        
        const tabBarHTML = `
          <div class="ubits-tabbar ubits-tabbar--visible ubits-tabbar--preview" id="ubits-tabbar-${finalComponentId}" data-theme="light" style="position: absolute; bottom: 0; left: 0; right: 0; width: 100%;">
            <div class="ubits-tabbar-content">
              ${itemsHTML}
            </div>
          </div>
          <div id="ubits-floating-menu-container-${finalComponentId}" style="position: absolute; top: 0; left: 0; right: 0; bottom: 76px; width: 100%; height: 500px; display: none; z-index: 2000; overflow: visible;">
            ${renderFloatingMenuStatic(finalFloatingMenuSections)}
          </div>
          <div id="ubits-profile-menu-container-${finalComponentId}" style="position: absolute; bottom: 76px; left: 0; right: 0; width: 100%; display: none; z-index: 2001; overflow: visible;">
            ${renderProfileMenuStatic(finalProfileMenuItems, finalComponentId)}
          </div>
        `;
        
        tabBarWrapper.innerHTML = tabBarHTML;
        
        container.innerHTML = '';
        container.appendChild(tabBarWrapper);
        
        // Inicializar dark mode toggle si estÃ¡ habilitado
        if (darkModeEnabled) {
          initTabBarDarkModeToggle(container.querySelector('.ubits-tabbar'), finalComponentId);
        }
      }
      
      // Handler para clicks en accordions del Floating Menu
      window.handleTabBarAccordionClick = function(sectionId, componentId) {
        const body = document.querySelector(`#ubits-floating-menu-${componentId} [data-body-id="${sectionId}"]`);
        const chevron = document.querySelector(`#ubits-floating-menu-${componentId} [data-chevron-id="${sectionId}"]`);
        const circle = document.querySelector(`#ubits-floating-menu-${componentId} [data-circle-id="${sectionId}"]`);
        const title = document.querySelector(`#ubits-floating-menu-${componentId} [data-accordion-id="${sectionId}"] .ubits-accordion-title`);
        
        if (!body || !chevron || !circle || !title) return;
        
        const isCurrentlyOpen = body.style.display === 'block';
        
        // Cerrar todos los accordions primero
        document.querySelectorAll(`#ubits-floating-menu-${componentId} .ubits-accordion-body`).forEach(b => b.style.display = 'none');
        document.querySelectorAll(`#ubits-floating-menu-${componentId} .ubits-accordion-chevron`).forEach(c => c.style.transform = 'rotate(0deg)');
        document.querySelectorAll(`#ubits-floating-menu-${componentId} .ubits-accordion-icon-circle`).forEach(c => c.classList.remove('active'));
        document.querySelectorAll(`#ubits-floating-menu-${componentId} .ubits-accordion-title`).forEach(t => t.classList.remove('active'));
        
        if (!isCurrentlyOpen) {
          body.style.display = 'block';
          chevron.style.transform = 'rotate(180deg)';
          title.classList.add('active');
          circle.classList.add('active');
        }
      };
      
      // Handler para cerrar Floating Menu
      window.handleTabBarCloseMenu = function(componentId) {
        const floatingMenuContainer = document.getElementById(`ubits-floating-menu-container-${componentId}`);
        if (floatingMenuContainer) {
          floatingMenuContainer.style.display = 'none';
          const floatingMenu = floatingMenuContainer.querySelector('.ubits-floating-menu');
          if (floatingMenu) floatingMenu.classList.remove('ubits-floating-menu--show');
        }
      };
      
      // Handler para clicks en items del TabBar
      window.handleTabBarItemClick = function(tabId, componentId) {
        console.log('ğŸ–±ï¸ TabBar item clickeado:', tabId);
        
        const state = initTabBarPreviewState(componentId);
        state.activeTabId = tabId;
        
        const floatingMenuContainer = document.getElementById(`ubits-floating-menu-container-${componentId}`);
        const profileMenuContainer = document.getElementById(`ubits-profile-menu-container-${componentId}`);
        
        // Si es modo oscuro, toggle del tema
        if (tabId === 'modo-oscuro') {
          const tabBarElement = document.querySelector(`#ubits-tabbar-${componentId}`);
          if (tabBarElement) {
            const currentTheme = tabBarElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            tabBarElement.setAttribute('data-theme', newTheme);
            
            // Actualizar icono del modo oscuro
            const darkModeItem = tabBarElement.querySelector('[data-tab-id="modo-oscuro"]');
            if (darkModeItem) {
              const iconElement = darkModeItem.querySelector('.ubits-tabbar-icon i');
              if (iconElement) {
                iconElement.classList.remove('fa-moon', 'fa-sun', 'fa-sun-bright', 'fa-solid', 'fa-regular', 'far');
                if (newTheme === 'dark') {
                  iconElement.classList.add('fa-solid', 'fa-sun-bright');
                } else {
                  iconElement.classList.add('far', 'fa-moon');
                }
              }
            }
            
            console.log('ğŸŒ“ Tema cambiado a:', newTheme);
          }
          
          // Cerrar otros menÃºs
          if (floatingMenuContainer) floatingMenuContainer.style.display = 'none';
          if (profileMenuContainer) profileMenuContainer.style.display = 'none';
          return;
        }
        
        // Si es mÃ³dulos, toggle Floating Menu
        if (tabId === 'modulos') {
          console.log('ğŸ” Buscando contenedores:', {
            floatingMenu: `ubits-floating-menu-container-${componentId}`,
            profileMenu: `ubits-profile-menu-container-${componentId}`
          });
          
          if (floatingMenuContainer) {
            const floatingMenu = floatingMenuContainer.querySelector('.ubits-floating-menu');
            const isCurrentlyVisible = floatingMenuContainer.style.display !== 'none' && floatingMenuContainer.style.display !== '';
            
            console.log('ğŸ“¦ Estado Floating Menu:', {
              containerFound: !!floatingMenuContainer,
              menuFound: !!floatingMenu,
              isCurrentlyVisible,
              currentDisplay: floatingMenuContainer.style.display
            });
            
            if (isCurrentlyVisible) {
              // Ocultar
              floatingMenuContainer.style.display = 'none';
              if (floatingMenu) floatingMenu.classList.remove('ubits-floating-menu--show');
              console.log('âŒ Floating Menu ocultado');
            } else {
              // Mostrar
              floatingMenuContainer.style.display = 'block';
              floatingMenuContainer.style.zIndex = '2000';
              floatingMenuContainer.style.overflow = 'visible';
              floatingMenuContainer.style.position = 'absolute';
              floatingMenuContainer.style.top = '0';
              floatingMenuContainer.style.left = '0';
              floatingMenuContainer.style.right = '0';
              floatingMenuContainer.style.bottom = '76px';
              floatingMenuContainer.style.width = '100%';
              floatingMenuContainer.style.height = '500px';
              if (floatingMenu) {
                floatingMenu.classList.add('ubits-floating-menu--show', 'ubits-floating-menu--preview');
                floatingMenu.style.cssText = 'display: block !important; position: absolute !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; max-height: 500px !important; border-radius: 8px !important; z-index: 2000 !important;';
              }
              console.log('âœ… Floating Menu mostrado:', {
                containerDisplay: floatingMenuContainer.style.display,
                containerZIndex: floatingMenuContainer.style.zIndex,
                menuClasses: floatingMenu ? floatingMenu.className : 'N/A',
                menuDisplay: floatingMenu ? floatingMenu.style.display : 'N/A'
              });
              
              // Cerrar Profile Menu si estÃ¡ abierto
              if (profileMenuContainer) {
                profileMenuContainer.style.display = 'none';
                const profileMenu = profileMenuContainer.querySelector('.ubits-profile-menu');
                if (profileMenu) profileMenu.classList.remove('ubits-profile-menu--show');
              }
            }
          } else {
            console.error('âŒ Floating Menu Container no encontrado');
          }
          
          // Actualizar solo el tab activo sin re-renderizar
          const tabBarElement = document.querySelector(`#ubits-tabbar-${componentId}`);
          if (tabBarElement) {
            tabBarElement.querySelectorAll('.ubits-tabbar-item').forEach(item => {
              item.classList.remove('ubits-tabbar-item--active');
            });
            const activeItem = tabBarElement.querySelector(`[data-tab-id="${tabId}"]`);
            if (activeItem) {
              activeItem.classList.add('ubits-tabbar-item--active');
            }
          }
          
          return;
        }
        
        // Si es perfil, toggle Profile Menu
        if (tabId === 'perfil') {
          console.log('ğŸ” Buscando contenedores:', {
            floatingMenu: `ubits-floating-menu-container-${componentId}`,
            profileMenu: `ubits-profile-menu-container-${componentId}`
          });
          
          if (profileMenuContainer) {
            const profileMenu = profileMenuContainer.querySelector('.ubits-profile-menu');
            const isCurrentlyVisible = profileMenuContainer.style.display !== 'none' && profileMenuContainer.style.display !== '';
            
            console.log('ğŸ“¦ Estado Profile Menu:', {
              containerFound: !!profileMenuContainer,
              menuFound: !!profileMenu,
              isCurrentlyVisible,
              currentDisplay: profileMenuContainer.style.display
            });
            
            if (isCurrentlyVisible) {
              // Ocultar
              profileMenuContainer.style.display = 'none';
              if (profileMenu) profileMenu.classList.remove('ubits-profile-menu--show');
              console.log('âŒ Profile Menu ocultado');
            } else {
              // Mostrar
              profileMenuContainer.style.display = 'block';
              profileMenuContainer.style.zIndex = '2001';
              profileMenuContainer.style.overflow = 'visible';
              profileMenuContainer.style.position = 'absolute';
              profileMenuContainer.style.bottom = '76px';
              profileMenuContainer.style.left = '0';
              profileMenuContainer.style.right = '0';
              profileMenuContainer.style.width = '100%';
              if (profileMenu) {
                profileMenu.classList.add('ubits-profile-menu--show', 'ubits-profile-menu--preview');
                profileMenu.style.cssText = 'display: block !important; position: absolute !important; bottom: 0 !important; left: 0 !important; right: 0 !important; width: 100% !important; max-width: 100% !important; z-index: 2001 !important;';
              }
              console.log('âœ… Profile Menu mostrado:', {
                containerDisplay: profileMenuContainer.style.display,
                containerZIndex: profileMenuContainer.style.zIndex,
                menuClasses: profileMenu ? profileMenu.className : 'N/A',
                menuDisplay: profileMenu ? profileMenu.style.display : 'N/A'
              });
              
              // Cerrar Floating Menu si estÃ¡ abierto
              if (floatingMenuContainer) {
                floatingMenuContainer.style.display = 'none';
                const floatingMenu = floatingMenuContainer.querySelector('.ubits-floating-menu');
                if (floatingMenu) floatingMenu.classList.remove('ubits-floating-menu--show');
              }
            }
          } else {
            console.error('âŒ Profile Menu Container no encontrado');
          }
          
          // Actualizar solo el tab activo sin re-renderizar
          const tabBarElement = document.querySelector(`#ubits-tabbar-${componentId}`);
          if (tabBarElement) {
            tabBarElement.querySelectorAll('.ubits-tabbar-item').forEach(item => {
              item.classList.remove('ubits-tabbar-item--active');
            });
            const activeItem = tabBarElement.querySelector(`[data-tab-id="${tabId}"]`);
            if (activeItem) {
              activeItem.classList.add('ubits-tabbar-item--active');
            }
          }
          
          return;
        }
        
        // Actualizar preview para otros tabs (sin preservar menÃºs)
        window.updateTabBarPreview(componentId, false);
      };
      
      // FunciÃ³n para establecer controles
      window.setTabBarControl = function(option, value, componentId) {
        // Asegurar que componentId tenga un valor por defecto
        componentId = componentId || 'tabbar';
        
        console.log('ğŸ”§ [setTabBarControl] INICIO - ParÃ¡metros recibidos:', { option, value, componentId });
        
        // Obtener estado actual
        const state = initTabBarPreviewState(componentId);
        console.log('ğŸ”§ [setTabBarControl] Estado ANTES de actualizar:', JSON.stringify(state, null, 2));
        
        // ACTUALIZAR EL ESTADO DIRECTAMENTE
        state[option] = value;
        
        // FORZAR PERSISTENCIA: Asegurar que el estado se guarde correctamente
        tabBarPreviewState[componentId] = { ...state };
        
        // Verificar que el estado se guardÃ³ correctamente
        const storedState = tabBarPreviewState[componentId];
        console.log('ğŸ”§ [setTabBarControl] Estado DESPUÃ‰S de actualizar:', JSON.stringify(state, null, 2));
        console.log('ğŸ”§ [setTabBarControl] Estado guardado en tabBarPreviewState:', JSON.stringify(storedState, null, 2));
        console.log('ğŸ”§ [setTabBarControl] Verificando cambio:', { 
          option, 
          value, 
          stateValue: state[option], 
          storedValue: storedState[option],
          stateVariant: state.variant,
          storedVariant: storedState.variant
        });
        
        // Si se cambia la variante, actualizar los botones activos de los controles
        if (option === 'variant') {
          console.log('ğŸ”„ [setTabBarControl] Cambiando variante a:', value);
          console.log('ğŸ”„ [setTabBarControl] Verificando estado.variant:', state.variant);
          console.log('ğŸ”„ [setTabBarControl] Verificando estado guardado:', storedState.variant);
          
          // Actualizar el estado activo de los botones de variante
          const selector = `[data-component="${componentId}"][data-option="variant"]`;
          console.log('ğŸ”˜ [setTabBarControl] Buscando botones con selector:', selector);
          const buttons = document.querySelectorAll(selector);
          console.log('ğŸ”˜ [setTabBarControl] Botones encontrados:', buttons.length);
          
          if (buttons.length === 0) {
            console.error('âŒ [setTabBarControl] NO se encontraron botones de variante con selector:', selector);
            // Intentar buscar sin el componente especÃ­fico
            const allButtons = document.querySelectorAll('[data-option="variant"]');
            console.log('ğŸ”˜ [setTabBarControl] Botones encontrados sin filtro de componente:', allButtons.length);
          }
          
          buttons.forEach((btn, index) => {
            const btnValue = btn.getAttribute('data-value');
            const btnComponent = btn.getAttribute('data-component');
            const isMatch = btnValue === value;
            console.log(`ğŸ”˜ [setTabBarControl] BotÃ³n ${index}:`, { 
              btnValue, 
              btnComponent,
              value, 
              isMatch, 
              hasActive: btn.classList.contains('active') 
            });
            if (isMatch) {
              btn.classList.add('active');
              console.log(`âœ… [setTabBarControl] BotÃ³n ${index} marcado como activo`);
            } else {
              btn.classList.remove('active');
              console.log(`âŒ [setTabBarControl] BotÃ³n ${index} desmarcado`);
            }
          });
        }
        
        // Actualizar preview - Asegurar que se pase el estado correcto
        console.log('ğŸ”„ [setTabBarControl] Llamando updateTabBarPreview con componentId:', componentId);
        console.log('ğŸ”„ [setTabBarControl] Estado que se pasarÃ¡:', JSON.stringify(tabBarPreviewState[componentId], null, 2));
        
        // Verificar que el preview existe antes de actualizar
        const previewElement = document.getElementById(`tabbar-preview-${componentId}`);
        if (!previewElement) {
          console.error('âŒ [setTabBarControl] Preview no encontrado:', `tabbar-preview-${componentId}`);
        } else {
          console.log('âœ… [setTabBarControl] Preview encontrado:', previewElement);
        }
        
        window.updateTabBarPreview(componentId);
        console.log('ğŸ”§ [setTabBarControl] FIN');
      };
      
      // FunciÃ³n para inicializar dark mode toggle en TabBar
      function initTabBarDarkModeToggle(tabBarElement, componentId) {
        if (!tabBarElement) return;
        
        const darkModeItem = tabBarElement.querySelector('[data-tab-id="modo-oscuro"]');
        if (!darkModeItem) return;
        
        darkModeItem.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          
          const currentTheme = tabBarElement.getAttribute('data-theme') || 'light';
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          
          tabBarElement.setAttribute('data-theme', newTheme);
          
          // Actualizar icono del modo oscuro
          const iconElement = darkModeItem.querySelector('.ubits-tabbar-icon i');
          if (iconElement) {
            iconElement.classList.remove('fa-moon', 'fa-sun', 'fa-sun-bright', 'fa-solid', 'fa-regular', 'far');
            if (newTheme === 'dark') {
              iconElement.classList.add('fa-solid', 'fa-sun-bright');
            } else {
              iconElement.classList.add('far', 'fa-moon');
            }
          }
          
          console.log('ğŸŒ“ Tema cambiado a:', newTheme);
        });
      }
      
      // ========================================
      // TABS PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const tabsPreviewState = {};
      
      // Inicializar estado del preview de Tabs
      function initTabsPreviewState(componentId) {
        if (!tabsPreviewState[componentId]) {
          tabsPreviewState[componentId] = {
            tabs: [
              { id: 'tab-1', label: 'Label', icon: 'far fa-th', active: true },
              { id: 'tab-2', label: 'Label', icon: 'far fa-th' },
              { id: 'tab-3', label: 'Label', icon: 'far fa-th' },
              { id: 'tab-4', label: 'Label', icon: 'far fa-th' },
              { id: 'tab-5', label: 'Label', icon: 'far fa-th' }
            ],
            activeTabId: 'tab-1',
            showIcons: true,
            tabCount: 5
          };
        }
        return tabsPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview de Tabs
      window.updateTabsPreview = function(componentId) {
        const state = initTabsPreviewState(componentId);
        const preview = document.getElementById(`tabs-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Tabs no encontrado:', `tabs-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”„ Actualizando preview de Tabs:', state);
        
        // Generar tabs segÃºn el estado
        const shouldShowIcons = state.showIcons !== false;
        const icons = ['fa-th', 'fa-chart-line', 'fa-cog', 'fa-star', 'fa-book', 'fa-home', 'fa-user', 'fa-bell', 'fa-envelope', 'fa-calendar'];
        const labels = ['Label 1', 'Label 2', 'Label 3', 'Label 4', 'Label 5', 'Label 6', 'Label 7', 'Label 8', 'Label 9', 'Label 10'];
        
        // Regenerar tabs siempre para asegurar que coincidan con el estado actual
        state.tabs = Array.from({ length: state.tabCount || 5 }, (_, i) => ({
          id: `tab-${i + 1}`,
          label: labels[i] || `Label ${i + 1}`,
          icon: shouldShowIcons ? `far ${icons[i] || 'fa-th'}` : undefined,
          active: false
        }));
        
        // Asegurar que el tab activo estÃ© correctamente marcado
        const activeId = state.activeTabId || state.tabs[0]?.id;
        // Validar que el activeTabId existe en los tabs actuales
        const validActiveId = state.tabs.find(t => t.id === activeId) ? activeId : state.tabs[0]?.id;
        state.activeTabId = validActiveId;
        
        state.tabs.forEach(tab => {
          tab.active = tab.id === validActiveId;
        });
        
        // Actualizar dropdown de Tab Activo
        const activeTabSelect = document.getElementById(`tabs-active-tab-select-${componentId}`);
        if (activeTabSelect) {
          activeTabSelect.innerHTML = state.tabs.map(tab => 
            `<option value="${tab.id}" ${tab.id === validActiveId ? 'selected' : ''}>${tab.label}</option>`
          ).join('');
        }
        
        // Limpiar preview anterior
        preview.innerHTML = '';
        
        // Renderizar tabs
        const tabsHTML = state.tabs.map(tab => {
          const isActive = tab.id === validActiveId;
          const activeClass = isActive ? 'ubits-tab--active' : '';
          
          // Determinar estilo de icono segÃºn estado activo
          // Active: solid (fas), Inactive: regular (far)
          let iconHTML = '';
          if (tab.icon) {
            // Extraer nombre del icono sin prefijo
            let iconName = tab.icon.replace(/^(far|fas)\s+/, '').replace(/^fa-/, '');
            if (!iconName.startsWith('fa-')) {
              iconName = `fa-${iconName}`;
            }
            // Aplicar estilo segÃºn estado activo
            const iconStyle = isActive ? 'fas' : 'far';
            iconHTML = `<i class="${iconStyle} ${iconName}"></i>`;
          }
          
          return `
            <button 
              class="ubits-tab ${activeClass}" 
              data-tab-id="${tab.id}"
              onclick="handleTabsClick('${tab.id}', '${componentId}')"
            >
              ${iconHTML}
              <span class="ubits-tab__label">${tab.label}</span>
            </button>
          `;
        }).join('');
        
        const containerHTML = `
          <div class="ubits-tabs">
            ${tabsHTML}
          </div>
        `;
        
        preview.innerHTML = containerHTML;
        
        console.log('âœ… Preview de Tabs actualizado:', state);
      };
      
      // Handler para clicks en tabs
      window.handleTabsClick = function(tabId, componentId) {
        const state = initTabsPreviewState(componentId);
        state.activeTabId = tabId;
        
        // Actualizar preview
        window.updateTabsPreview(componentId);
      };
      
      // FunciÃ³n para establecer controles de Tabs
      window.setTabsControl = function(option, value, componentId) {
        const state = initTabsPreviewState(componentId);
        
        if (option === 'activeTabId') {
          state.activeTabId = value;
        } else if (option === 'showIcons') {
          state.showIcons = value;
          // Actualizar toggle visual
          const toggle = document.getElementById(`tabs-show-icons-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = value;
          }
        } else if (option === 'tabCount') {
          state.tabCount = Math.max(1, Math.min(10, parseInt(value) || 5));
          // Actualizar input visual
          const input = document.getElementById(`tabs-count-input-${componentId}`);
          if (input) {
            input.value = state.tabCount;
          }
          // Resetear tab activo al primero cuando cambia el count
          state.activeTabId = 'tab-1';
        }
        
        // Actualizar preview
        window.updateTabsPreview(componentId);
        
        console.log('âœ… Control de Tabs actualizado:', option, value);
      };
      
      // ========================================
      // SEGMENT CONTROL PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const segmentControlPreviewState = {};
      
      // Inicializar estado del preview de Segment Control
      function initSegmentControlPreviewState(componentId) {
        if (!segmentControlPreviewState[componentId]) {
          segmentControlPreviewState[componentId] = {
            segments: [
              { id: 'segment-1', label: 'Label', icon: 'far fa-th', active: true },
              { id: 'segment-2', label: 'Label', icon: 'far fa-th' },
              { id: 'segment-3', label: 'Label', icon: 'far fa-th' },
              { id: 'segment-4', label: 'Label', icon: 'far fa-th' },
              { id: 'segment-5', label: 'Label', icon: 'far fa-th' }
            ],
            activeSegmentId: 'segment-1',
            showIcons: true,
            segmentCount: 5
          };
        }
        return segmentControlPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview de Segment Control
      window.updateSegmentControlPreview = function(componentId) {
        const state = initSegmentControlPreviewState(componentId);
        const preview = document.getElementById(`segment-control-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Segment Control no encontrado:', `segment-control-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”„ Actualizando preview de Segment Control:', state);
        
        // Generar segmentos segÃºn el estado
        const shouldShowIcons = state.showIcons !== false;
        const icons = ['fa-th', 'fa-chart-line', 'fa-cog', 'fa-star', 'fa-book', 'fa-home', 'fa-user', 'fa-bell', 'fa-envelope', 'fa-calendar'];
        const labels = ['Label 1', 'Label 2', 'Label 3', 'Label 4', 'Label 5', 'Label 6', 'Label 7', 'Label 8', 'Label 9', 'Label 10'];
        
        // Regenerar segmentos siempre para asegurar que coincidan con el estado actual
        state.segments = Array.from({ length: state.segmentCount || 5 }, (_, i) => ({
          id: `segment-${i + 1}`,
          label: labels[i] || `Label ${i + 1}`,
          icon: shouldShowIcons ? `far ${icons[i] || 'fa-th'}` : undefined,
          active: false
        }));
        
        // Asegurar que el segmento activo estÃ© correctamente marcado
        const activeId = state.activeSegmentId || state.segments[0]?.id;
        // Validar que el activeSegmentId existe en los segmentos actuales
        const validActiveId = state.segments.find(s => s.id === activeId) ? activeId : state.segments[0]?.id;
        state.activeSegmentId = validActiveId;
        
        state.segments.forEach(segment => {
          segment.active = segment.id === validActiveId;
        });
        
        // Actualizar dropdown de Segmento Activo
        const activeSegmentSelect = document.getElementById(`segment-control-active-segment-select-${componentId}`);
        if (activeSegmentSelect) {
          activeSegmentSelect.innerHTML = state.segments.map(segment => 
            `<option value="${segment.id}" ${segment.id === validActiveId ? 'selected' : ''}>${segment.label}</option>`
          ).join('');
        }
        
        // Limpiar preview anterior
        preview.innerHTML = '';
        
        // Renderizar segmentos
        const segmentsHTML = state.segments.map(segment => {
          const isActive = segment.id === validActiveId;
          const activeClass = isActive ? 'ubits-segment--active' : '';
          
          // Determinar estilo de icono segÃºn estado activo
          // Active: solid (fas), Inactive: regular (far)
          let iconHTML = '';
          if (segment.icon) {
            // Extraer nombre del icono sin prefijo
            let iconName = segment.icon.replace(/^(far|fas)\s+/, '').replace(/^fa-/, '');
            if (!iconName.startsWith('fa-')) {
              iconName = `fa-${iconName}`;
            }
            // Aplicar estilo segÃºn estado activo
            const iconStyle = isActive ? 'fas' : 'far';
            iconHTML = `<i class="${iconStyle} ${iconName}"></i>`;
          }
          
          return `
            <button 
              class="ubits-segment ${activeClass}" 
              data-segment-id="${segment.id}"
              onclick="handleSegmentControlClick('${segment.id}', '${componentId}')"
            >
              ${iconHTML}
              <span class="ubits-segment__label">${segment.label}</span>
            </button>
          `;
        }).join('');
        
        const containerHTML = `
          <div class="ubits-segment-control">
            ${segmentsHTML}
          </div>
        `;
        
        preview.innerHTML = containerHTML;
        
        console.log('âœ… Preview de Segment Control actualizado:', state);
      };
      
      // Handler para clicks en segmentos
      window.handleSegmentControlClick = function(segmentId, componentId) {
        const state = initSegmentControlPreviewState(componentId);
        state.activeSegmentId = segmentId;
        
        // Actualizar preview
        window.updateSegmentControlPreview(componentId);
      };
      
      // FunciÃ³n para establecer controles de Segment Control
      window.setSegmentControlControl = function(option, value, componentId) {
        const state = initSegmentControlPreviewState(componentId);
        
        if (option === 'activeSegmentId') {
          state.activeSegmentId = value;
        } else if (option === 'showIcons') {
          state.showIcons = value;
          // Actualizar toggle visual
          const toggle = document.getElementById(`segment-control-show-icons-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = value;
          }
        } else if (option === 'segmentCount') {
          state.segmentCount = Math.max(1, Math.min(10, parseInt(value) || 5));
          // Actualizar input visual
          const input = document.getElementById(`segment-control-count-input-${componentId}`);
          if (input) {
            input.value = state.segmentCount;
          }
          // Resetear segmento activo al primero cuando cambia el count
          state.activeSegmentId = 'segment-1';
        }
        
        // Actualizar preview
        window.updateSegmentControlPreview(componentId);
        
        console.log('âœ… Control de Segment Control actualizado:', option, value);
      };
      
      // ========================================
      // BREADCRUMB PREVIEW STATE & FUNCTIONS
      // ========================================
      
      const breadcrumbPreviewState = {};
      
      // Inicializar estado del preview de Breadcrumb
      function initBreadcrumbPreviewState(componentId) {
        if (!breadcrumbPreviewState[componentId]) {
          breadcrumbPreviewState[componentId] = {
            items: [
              { id: 'item-1', label: 'Home', url: '#home' },
              { id: 'item-2', label: 'CategorÃ­a', url: '#categoria' },
              { id: 'item-3', label: 'SubcategorÃ­a', url: '#subcategoria' },
              { id: 'item-4', label: 'PÃ¡gina', url: '#pagina' },
              { id: 'item-5', label: 'Detalle', active: true }
            ],
            separator: '>',
            itemCount: 5
          };
        }
        return breadcrumbPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview de Breadcrumb
      window.updateBreadcrumbPreview = function(componentId) {
        const state = initBreadcrumbPreviewState(componentId);
        const preview = document.getElementById(`breadcrumb-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Breadcrumb no encontrado:', `breadcrumb-preview-${componentId}`);
          return;
        }
        
        console.log('ğŸ”„ Actualizando preview de Breadcrumb:', state);
        
        // Generar items segÃºn el estado
        const labels = ['Home', 'CategorÃ­a', 'SubcategorÃ­a', 'PÃ¡gina', 'Detalle', 'Elemento', 'Vista', 'Final'];
        
        // Regenerar items siempre para asegurar que coincidan con el estado actual
        state.items = Array.from({ length: state.itemCount || 5 }, (_, i) => ({
          id: `item-${i + 1}`,
          label: labels[i] || `Item ${i + 1}`,
          url: i < state.itemCount - 1 ? `#${labels[i]?.toLowerCase() || `item-${i + 1}`}` : undefined,
          active: i === state.itemCount - 1
        }));
        
        // Actualizar dropdown de NÃºmero de Items
        const itemCountInput = document.getElementById(`breadcrumb-count-input-${componentId}`);
        if (itemCountInput) {
          itemCountInput.value = state.itemCount;
        }
        
        // Actualizar input de Separador
        const separatorInput = document.getElementById(`breadcrumb-separator-input-${componentId}`);
        if (separatorInput) {
          separatorInput.value = state.separator;
        }
        
        // Limpiar preview anterior
        preview.innerHTML = '';
        
        // Renderizar breadcrumb
        const itemsHTML = state.items.map((item, index) => {
          const isActive = item.active;
          const isLast = index === state.items.length - 1;
          const activeClass = isActive ? 'ubits-breadcrumb__item--active' : '';
          const classes = ['ubits-breadcrumb__item', activeClass].filter(Boolean).join(' ');
          
          // Si es el Ãºltimo item, usar span, sino usar link
          if (isLast || !item.url) {
            return `
              <span class="${classes}" data-breadcrumb-id="${item.id}">
                ${item.label}
              </span>
            `;
          } else {
            return `
              <a href="${item.url}" class="${classes}" data-breadcrumb-id="${item.id}">
                ${item.label}
              </a>
            `;
          }
        }).join(`<span class="ubits-breadcrumb__separator" aria-hidden="true">${state.separator}</span>`);
        
        const containerHTML = `
          <nav class="ubits-breadcrumb" aria-label="Breadcrumb">
            <ol class="ubits-breadcrumb__list">
              ${itemsHTML}
            </ol>
          </nav>
        `;
        
        preview.innerHTML = containerHTML;
        
        console.log('âœ… Preview de Breadcrumb actualizado:', state);
      };
      
      // FunciÃ³n para establecer controles de Breadcrumb
      window.setBreadcrumbControl = function(option, value, componentId) {
        const state = initBreadcrumbPreviewState(componentId);
        
        if (option === 'itemCount') {
          state.itemCount = Math.max(2, Math.min(8, parseInt(value) || 5));
          // Actualizar input visual
          const input = document.getElementById(`breadcrumb-count-input-${componentId}`);
          if (input) {
            input.value = state.itemCount;
          }
        } else if (option === 'separator') {
          state.separator = value || '>';
          // Actualizar input visual
          const input = document.getElementById(`breadcrumb-separator-input-${componentId}`);
          if (input) {
            input.value = state.separator;
          }
        }
        
        // Actualizar preview
        window.updateBreadcrumbPreview(componentId);
        
        console.log('âœ… Control de Breadcrumb actualizado:', option, value);
      };
      
      // ========================================
      // CARD CONTENT PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Card Content
      const cardPreviewState = {};
      
      // Proveedores con sus logos (mapeo) - Usando rutas relativas desde autoframe
      const PROVIDER_LOGOS = {
        'UBITS': '../assets/images/Favicons/UBITS.jpg',
        'Microsoft': '../assets/images/Favicons/Microsoft.jpg',
        'Hubspot': '../assets/images/Favicons/Hubspot.jpg',
        'Harvard Business Publishing': '../assets/images/Favicons/Harvard-Business-Publishing.jpg',
        'TED': '../assets/images/Favicons/TED.jpg',
        'AWS': '../assets/images/Favicons/AWS.jpg',
        'Universidad de Los Andes': '../assets/images/Favicons/Universidad-de-Los Andes.jpg',
        'Advanced English': '../assets/images/Favicons/Advanced-English.jpg',
        'IE University': '../assets/images/Favicons/IE-University-Publishing.jpg',
        'CÃ³digo Facilito': '../assets/images/Favicons/CÃ³digo-Facilito.jpg',
        'Hackers del Talento': '../assets/images/Favicons/Hackers-del-Talento.jpg',
        'All Ears English': '../assets/images/Favicons/All Ears English.jpg',
        'American & British Academy': '../assets/images/Favicons/American & British Academy.jpg',
        'Bureau Veritas': '../assets/images/Favicons/Bureau-Veritas.jpg',
        'Welu': '../assets/images/Favicons/Welu.jpg',
        'Figsha Smart Consulting': '../assets/images/Favicons/Figsha Smart Consulting.jpg',
        'Instafit': '../assets/images/Favicons/Instafit.jpg',
        'WOBI': '../assets/images/Favicons/WOBI.jpg'
      };
      
      // Niveles con iconos
      const LEVEL_ICONS = {
        'BÃ¡sico': 'far fa-gauge-min',
        'Intermedio': 'far fa-gauge',
        'Avanzado': 'far fa-gauge-max'
      };
      
      // Estados con clases y textos
      const STATUS_CONFIG = {
        'default': { class: '', text: '' },
        'progress': { class: 'course-status--progress', text: 'En progreso' },
        'completed': { class: 'course-status--completed', text: 'Completado' }
      };
      
      // Inicializar estado por componente
      function initCardPreviewState(componentId) {
        if (!cardPreviewState[componentId]) {
          cardPreviewState[componentId] = {
            status: 'default',
            progress: 0,
            type: 'Curso',
            provider: 'UBITS',
            competency: 'Product design',
            level: 'BÃ¡sico',
            language: 'EspaÃ±ol',
            title: 'Segmenta la experiencia del cliente',
            duration: '60 min',
            image: '../assets/images/cards-learn/segmenta-la-experiencia-del-cliente.jpg'
          };
        }
        return cardPreviewState[componentId];
      }
      
      // FunciÃ³n para generar HTML de card (similar a renderCardContent)
      function generateCardHTML(state) {
        const statusConfig = STATUS_CONFIG[state.status] || STATUS_CONFIG.default;
        const statusClass = statusConfig.class;
        const statusText = statusConfig.text;
        const levelIcon = LEVEL_ICONS[state.level] || LEVEL_ICONS['Intermedio'];
        const providerLogo = PROVIDER_LOGOS[state.provider] || PROVIDER_LOGOS['UBITS'];
        
        // Asegurar que la imagen tenga la ruta completa si no la tiene
        let imagePath = state.image;
        if (!imagePath.startsWith('../assets/images/') && !imagePath.startsWith('http')) {
          imagePath = '../assets/images/' + imagePath.replace(/^images\//, 'images/');
        }
        
        return `
          <div class="course-card" data-progress="${state.progress}" data-status="${state.status}">
            <div class="course-thumbnail-wrapper">
              <div class="course-thumbnail">
                <img src="${imagePath}" alt="${state.title}" class="course-image" onerror="this.onerror=null; this.style.display='none'; this.parentElement.style.background='linear-gradient(135deg, var(--ubits-accent-brand-static-inverted), var(--ubits-accent-brand-static-inverted-static))'; this.parentElement.innerHTML='<i class=\\'far fa-image\\' style=\\'font-size: 48px; color: var(--ubits-btn-primary-fg);\\'></i>';">
              </div>
              <div class="course-progress-overlay">
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${state.progress}%"></div>
                </div>
              </div>
            </div>
            <div class="course-content">
              <div class="course-header">
                <div class="course-type-status">
                  <span class="course-type ubits-body-sm-regular">${state.type}</span>
                  ${statusText ? `<span class="course-status ${statusClass} ubits-body-sm-bold">${statusText}</span>` : ''}
                </div>
              </div>
              <h3 class="course-title ubits-body-sm-bold">${state.title}</h3>
              <div class="course-provider">
                <div class="provider-avatar">
                  <img src="${providerLogo}" alt="${state.provider}" class="provider-icon" onerror="this.onerror=null; this.src='../assets/images/Favicons/UBITS.jpg';">
                </div>
                <span class="provider-name ubits-body-sm-regular">${state.provider}</span>
              </div>
              <div class="course-competency">
                <div class="spec-icon">
                  <i class="far fa-tag"></i>
                </div>
                <span class="ubits-body-sm-regular">${state.competency}</span>
              </div>
              <div class="course-specs">
                <div class="spec-item">
                  <div class="spec-icon">
                    <i class="${levelIcon}"></i>
                  </div>
                  <span class="ubits-body-sm-regular">${state.level}</span>
                </div>
                <div class="spec-item">
                  <div class="spec-icon">
                    <i class="far fa-clock"></i>
                  </div>
                  <span class="ubits-body-sm-regular">${state.duration}</span>
                </div>
                <div class="spec-item">
                  <div class="spec-icon">
                    <i class="far fa-globe"></i>
                  </div>
                  <span class="ubits-body-sm-regular">${state.language}</span>
                </div>
              </div>
            </div>
          </div>
        `.trim();
      }
      
      // Estado del preview del Contenedor
      const contenedorPreviewState = {};
      
      // FunciÃ³n para inicializar el estado del preview del Contenedor
      function initContenedorPreviewState(componentId) {
        if (!contenedorPreviewState[componentId]) {
          contenedorPreviewState[componentId] = {
            backgroundVariant: 'bg1'
          };
        }
        return contenedorPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del Contenedor
      window.updateContenedorPreview = function(componentId) {
        const state = initContenedorPreviewState(componentId);
        const preview = document.getElementById(`contenedor-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Contenedor no encontrado:', `contenedor-preview-${componentId}`);
          return;
        }
        
        // Obtener la variante de fondo del estado
        const bgVariant = state.backgroundVariant || 'bg1';
        const bgToken = `var(--ubits-bg-${bgVariant.replace('bg', '')})`;
        
        // Crear el HTML del contenedor usando tokens UBITS
        const containerHTML = `
          <div class="ubits-container" style="
            background: ${bgToken};
            border-radius: var(--ubits-border-radius-md);
            padding: var(--ubits-spacing-md);
            color: var(--ubits-fg-1-high);
            font-family: var(--font-sans);
            font-size: var(--font-body-md-size);
            line-height: var(--font-body-md-line);
          ">
            <p style="margin: 0; color: var(--ubits-fg-1-medium);">
              Este es un contenedor bÃ¡sico con fondo <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: 12px;">${bgVariant}</code>, 
              border-radius de <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: 12px;">8px</code> 
              y padding interno de <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: 12px;">12px</code>.
            </p>
            <p style="margin: 12px 0 0 0; color: var(--ubits-fg-1-medium);">
              Usa la clase <code style="background: var(--ubits-bg-2); padding: 2px 6px; border-radius: 4px; font-size: 12px;">ubits-container</code> para aplicar estos estilos.
            </p>
          </div>
        `.trim();
        
        preview.innerHTML = containerHTML;
        
        console.log('âœ… Preview de Contenedor actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Contenedor
      window.setContenedorControl = function(option, value, componentId) {
        const state = initContenedorPreviewState(componentId);
        
        // Actualizar estado segÃºn la opciÃ³n
        if (option === 'backgroundVariant') {
          state.backgroundVariant = value;
        }
        
        // Actualizar el preview
        window.updateContenedorPreview(componentId);
        
        console.log('âœ… Control de Contenedor actualizado:', option, value);
      };
      
      // FunciÃ³n para actualizar el preview del Card Content
      window.updateCardPreview = function(componentId) {
        const state = initCardPreviewState(componentId);
        const preview = document.getElementById(`card-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Card Content no encontrado:', `card-preview-${componentId}`);
          return;
        }
        
        // Si el progreso cambiÃ³ a 0 y el estado es default, asegurar que no se muestre barra
        if (state.progress === 0 && state.status === 'default') {
          state.progress = 0;
        } else if (state.status === 'progress' && state.progress === 0) {
          state.progress = 25; // Si estÃ¡ en progreso pero el valor es 0, poner un valor por defecto
        }
        
        // Generar HTML de la card
        const cardHTML = generateCardHTML(state);
        preview.innerHTML = cardHTML;
        
        console.log('âœ… Preview de Card Content actualizado:', state);
      };
      
      // ========================================
      // PAGINATION PREVIEW FUNCTIONS
      // ========================================
      
      // Nota: paginationPreviewState ya estÃ¡ declarado en lÃ­nea 28242, no redeclarar
      function initPaginationPreviewState(componentId) {
        if (!paginationPreviewState[componentId]) {
          paginationPreviewState[componentId] = {
            currentPage: 5,
            totalPages: 20,
            totalItems: 200,
            itemsPerPage: 10,
            variant: 'default',
            size: 'md',
            maxVisiblePages: 7,
            showFirst: true,
            showLast: true,
            showPrevNext: true,
            showInfo: true,
            showItemsPerPage: true,
            itemsPerPageOptions: [10, 20, 50, 100]
          };
        }
        return paginationPreviewState[componentId];
      }
      
      // FunciÃ³n para establecer controles del Pagination
      window.setPaginationControl = function(option, value, componentId) {
        const state = initPaginationPreviewState(componentId);
        
        if (option === 'currentPage') {
          state.currentPage = Math.max(1, Math.min(value, state.totalPages));
          const inputEl = document.getElementById(`pagination-current-page-${componentId}`);
          if (inputEl) inputEl.value = state.currentPage;
        } else if (option === 'totalPages') {
          state.totalPages = Math.max(1, value);
          const inputEl = document.getElementById(`pagination-total-pages-${componentId}`);
          if (inputEl) inputEl.value = state.totalPages;
          // Ajustar currentPage si es mayor que totalPages
          if (state.currentPage > state.totalPages) {
            state.currentPage = state.totalPages;
            const currentPageInput = document.getElementById(`pagination-current-page-${componentId}`);
            if (currentPageInput) currentPageInput.value = state.currentPage;
          }
        } else if (option === 'totalItems') {
          state.totalItems = value;
          const inputEl = document.getElementById(`pagination-total-items-${componentId}`);
          if (inputEl) inputEl.value = state.totalItems;
        } else if (option === 'itemsPerPage') {
          state.itemsPerPage = value;
          const inputEl = document.getElementById(`pagination-items-per-page-${componentId}`);
          if (inputEl) inputEl.value = state.itemsPerPage;
        } else if (option === 'variant') {
          state.variant = value;
          const selectEl = document.getElementById(`pagination-variant-select-${componentId}`);
          if (selectEl) selectEl.value = value;
        } else if (option === 'size') {
          state.size = value;
          const selectEl = document.getElementById(`pagination-size-select-${componentId}`);
          if (selectEl) selectEl.value = value;
        } else if (option === 'maxVisiblePages') {
          state.maxVisiblePages = Math.max(3, Math.min(15, value));
          const inputEl = document.getElementById(`pagination-max-visible-${componentId}`);
          if (inputEl) inputEl.value = state.maxVisiblePages;
        } else if (option === 'showFirst') {
          state.showFirst = value;
          const statusEl = document.getElementById(`pagination-show-first-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showLast') {
          state.showLast = value;
          const statusEl = document.getElementById(`pagination-show-last-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showPrevNext') {
          state.showPrevNext = value;
          const statusEl = document.getElementById(`pagination-show-prev-next-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showInfo') {
          state.showInfo = value;
          const statusEl = document.getElementById(`pagination-show-info-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showItemsPerPage') {
          state.showItemsPerPage = value;
          const statusEl = document.getElementById(`pagination-show-items-per-page-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar el preview
        window.updatePaginationPreview(componentId);
      };
      
      // FunciÃ³n para actualizar el preview del Pagination
      window.updatePaginationPreview = function(componentId) {
        const state = initPaginationPreviewState(componentId);
        const preview = document.getElementById(`pagination-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Pagination no encontrado:', `pagination-preview-${componentId}`);
          return;
        }
        
        // Limpiar preview
        preview.innerHTML = '';
        
        // Cargar CSS si no estÃ¡ cargado
        if (!document.querySelector('link[href*="pagination.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/pagination/src/styles/pagination.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Button si no estÃ¡ cargado
        if (!document.querySelector('link[href*="button.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
        
        // Crear contenedor para el paginador
        const containerId = `pagination-container-${componentId}`;
        // Limpiar contenedor anterior si existe
        const existingContainer = document.getElementById(containerId);
        if (existingContainer) {
          existingContainer.remove();
        }
        const container = document.createElement('div');
        container.id = containerId;
        preview.appendChild(container);
        
        // Definir funciones primero
        function createPaginationInstanceInline() {
          // Generar HTML directamente usando la lÃ³gica de renderPagination
          const validCurrentPage = Math.max(1, Math.min(state.currentPage, state.totalPages));
          const buttonSize = state.size === 'sm' ? 'sm' : state.size === 'lg' ? 'lg' : 'md';
          
          // Calcular pÃ¡ginas visibles
          const maxVisible = state.maxVisiblePages || 7;
          const visiblePages = [];
          if (state.totalPages <= maxVisible) {
            for (let i = 1; i <= state.totalPages; i++) {
              visiblePages.push(i);
            }
          } else {
            const half = Math.floor(maxVisible / 2);
            let start = Math.max(1, validCurrentPage - half);
            let end = Math.min(state.totalPages, start + maxVisible - 1);
            if (end - start < maxVisible - 1) {
              start = Math.max(1, end - maxVisible + 1);
            }
            for (let i = start; i <= end; i++) {
              visiblePages.push(i);
            }
          }
          
          // Generar HTML de informaciÃ³n
          let infoHTML = '';
          if (state.showInfo && state.totalItems !== undefined) {
            const start = (validCurrentPage - 1) * (state.itemsPerPage || 10) + 1;
            const end = Math.min(validCurrentPage * (state.itemsPerPage || 10), state.totalItems);
            infoHTML = `<div class="ubits-pagination__info"><span class="ubits-body-sm">${start}-${end} de ${state.totalItems} items</span></div>`;
          }
          
          // Generar HTML de selector de items por pÃ¡gina
          let itemsPerPageHTML = '';
          if (state.showItemsPerPage) {
            const selectId = `ubits-pagination-items-per-page-${componentId}`;
            itemsPerPageHTML = `
              <div class="ubits-pagination__items-per-page">
                <label for="${selectId}" class="ubits-body-sm">Por pÃ¡gina:</label>
                <select id="${selectId}" class="ubits-pagination__select ubits-body-sm">
                  ${state.itemsPerPageOptions.map(opt => 
                    `<option value="${opt}" ${opt === state.itemsPerPage ? 'selected' : ''}>${opt}</option>`
                  ).join('')}
                </select>
              </div>
            `;
          }
          
          // Generar botones usando renderButton si estÃ¡ disponible, sino HTML directo
          let buttonsHTML = '';
          
          // FunciÃ³n helper para renderizar botÃ³n
          const renderButtonHTML = (options) => {
            const { variant, size, icon, iconOnly, disabled, className, ariaLabel, title, text, active } = options;
            const classes = [
              'ubits-button',
              `ubits-button--${variant}`,
              `ubits-button--${size}`,
              active ? 'ubits-button--active' : '',
              disabled ? 'disabled' : '',
              className
            ].filter(Boolean).join(' ');
            
            const iconHTML = icon ? `<i class="fas fa-${icon}"></i>` : '';
            const textHTML = text ? `<span>${text}</span>` : '';
            const content = iconOnly ? iconHTML : (icon && text ? iconHTML + textHTML : textHTML || iconHTML);
            
            return `<button class="${classes}" ${disabled ? 'disabled' : ''} ${ariaLabel ? `aria-label="${ariaLabel}"` : ''} ${title ? `title="${title}"` : ''} ${text ? `data-page="${text}"` : ''}>${content}</button>`;
          };
          
          // BotÃ³n Primera
          if (state.showFirst && state.variant === 'default') {
            buttonsHTML += renderButtonHTML({
              variant: 'tertiary',
              size: buttonSize,
              icon: 'angle-double-left',
              iconOnly: true,
              disabled: validCurrentPage === 1,
              className: 'ubits-pagination__nav-button',
              ariaLabel: 'Primera',
              title: 'Primera'
            });
          }
          
          // BotÃ³n Anterior
          if (state.showPrevNext) {
            buttonsHTML += renderButtonHTML({
              variant: 'tertiary',
              size: buttonSize,
              icon: 'chevron-left',
              iconOnly: true,
              disabled: validCurrentPage === 1,
              className: 'ubits-pagination__nav-button',
              ariaLabel: 'Anterior',
              title: 'Anterior'
            });
          }
          
          // PÃ¡ginas
          if (state.variant === 'default') {
            if (visiblePages[0] > 1) {
              buttonsHTML += `<span class="ubits-pagination__ellipsis">...</span>`;
            }
            visiblePages.forEach(page => {
              const isActive = page === validCurrentPage;
              buttonsHTML += renderButtonHTML({
                variant: isActive ? 'secondary' : 'tertiary',
                size: buttonSize,
                text: String(page),
                active: isActive,
                className: 'ubits-pagination__page-button'
              });
            });
            if (visiblePages[visiblePages.length - 1] < state.totalPages) {
              buttonsHTML += `<span class="ubits-pagination__ellipsis">...</span>`;
            }
          } else if (state.variant === 'compact') {
            buttonsHTML += `<span class="ubits-pagination__page-info ubits-body-md">PÃ¡gina ${validCurrentPage} de ${state.totalPages}</span>`;
          }
          
          // BotÃ³n Siguiente
          if (state.showPrevNext) {
            buttonsHTML += renderButtonHTML({
              variant: 'tertiary',
              size: buttonSize,
              icon: 'chevron-right',
              iconOnly: true,
              disabled: validCurrentPage === state.totalPages,
              className: 'ubits-pagination__nav-button',
              ariaLabel: 'Siguiente',
              title: 'Siguiente'
            });
          }
          
          // BotÃ³n Ãšltima
          if (state.showLast && state.variant === 'default') {
            buttonsHTML += renderButtonHTML({
              variant: 'tertiary',
              size: buttonSize,
              icon: 'angle-double-right',
              iconOnly: true,
              disabled: validCurrentPage === state.totalPages,
              className: 'ubits-pagination__nav-button',
              ariaLabel: 'Ãšltima',
              title: 'Ãšltima'
            });
          }
          
          // HTML completo
          const html = `
            <div class="ubits-pagination ubits-pagination--${state.variant} ubits-pagination--${state.size}" data-current-page="${validCurrentPage}" data-total-pages="${state.totalPages}">
              ${infoHTML}
              ${itemsPerPageHTML}
              <div class="ubits-pagination__controls">
                ${buttonsHTML}
              </div>
            </div>
          `;
          
          container.innerHTML = html;
          attachPaginationListeners(container);
        }
        
        function attachPaginationListeners(container) {
          const paginationElement = container.querySelector('.ubits-pagination');
          if (!paginationElement) return;
          
          // Event listeners para botones de pÃ¡gina
          const pageButtons = paginationElement.querySelectorAll('.ubits-pagination__page-button');
          pageButtons.forEach(button => {
            button.addEventListener('click', () => {
              const page = parseInt(button.textContent || '1');
              state.currentPage = page;
              const inputEl = document.getElementById(`pagination-current-page-${componentId}`);
              if (inputEl) inputEl.value = page;
              window.updatePaginationPreview(componentId);
            });
          });
          
          // Event listeners para botones de navegaciÃ³n
          const navButtons = paginationElement.querySelectorAll('.ubits-pagination__nav-button');
          navButtons.forEach(button => {
            button.addEventListener('click', () => {
              const currentPage = parseInt(paginationElement.getAttribute('data-current-page') || '1');
              const totalPages = parseInt(paginationElement.getAttribute('data-total-pages') || '1');
              const ariaLabel = button.getAttribute('aria-label') || '';
              
              let newPage = currentPage;
              if (ariaLabel.includes('Primera')) newPage = 1;
              else if (ariaLabel.includes('Ãšltima')) newPage = totalPages;
              else if (ariaLabel.includes('Anterior')) newPage = Math.max(1, currentPage - 1);
              else if (ariaLabel.includes('Siguiente')) newPage = Math.min(totalPages, currentPage + 1);
              
              if (newPage !== currentPage) {
                state.currentPage = newPage;
                const inputEl = document.getElementById(`pagination-current-page-${componentId}`);
                if (inputEl) inputEl.value = newPage;
                window.updatePaginationPreview(componentId);
              }
            });
          });
          
          // Event listener para selector de items por pÃ¡gina
          const itemsPerPageSelect = paginationElement.querySelector('.ubits-pagination__select');
          if (itemsPerPageSelect) {
            itemsPerPageSelect.addEventListener('change', (e) => {
              const itemsPerPage = parseInt(e.target.value || '10');
              state.itemsPerPage = itemsPerPage;
              state.currentPage = 1;
              const inputEl = document.getElementById(`pagination-items-per-page-${componentId}`);
              if (inputEl) inputEl.value = itemsPerPage;
              const currentPageInput = document.getElementById(`pagination-current-page-${componentId}`);
              if (currentPageInput) currentPageInput.value = 1;
              window.updatePaginationPreview(componentId);
            });
          }
        }
        
        // Crear instancia inmediatamente usando fallback inline (siempre funciona)
        createPaginationInstanceInline();
        
        // Intentar cargar el script del componente Pagination en paralelo (opcional, para mejor funcionalidad)
        const existingPaginationScript = document.querySelector('script[src*="pagination"]');
        if (!existingPaginationScript && (typeof window.UBITS === 'undefined' || !window.UBITS.Pagination) && typeof window.createPagination === 'undefined') {
          const script = document.createElement('script');
          script.type = 'module';
          script.src = '../../addons/pagination/dist/pagination.js';
          script.setAttribute('data-loaded', 'false');
          document.head.appendChild(script);
          
          // Si el script se carga exitosamente, podemos mejorar la funcionalidad
          script.onload = () => {
            console.log('âœ… Pagination script cargado');
          };
        }
      };
      
      // FunciÃ³n para establecer controles
      window.setCardControl = function(option, value, componentId) {
        const state = initCardPreviewState(componentId);
        
        if (option === 'status') {
          state.status = value;
          const select = document.getElementById(`card-status-select-${componentId}`);
          if (select) select.value = value;
          
          // Si cambia a default, resetear progreso a 0
          if (value === 'default') {
            state.progress = 0;
            const progressSelect = document.getElementById(`card-progress-select-${componentId}`);
            if (progressSelect) progressSelect.value = '0';
          } else if (value === 'progress' && state.progress === 0) {
            // Si cambia a progress y estÃ¡ en 0, poner 25%
            state.progress = 25;
            const progressSelect = document.getElementById(`card-progress-select-${componentId}`);
            if (progressSelect) progressSelect.value = '25';
          }
        } else if (option === 'progress') {
          const progressValue = parseInt(value);
          state.progress = isNaN(progressValue) ? 0 : progressValue;
          const select = document.getElementById(`card-progress-select-${componentId}`);
          if (select) select.value = value;
          
          // Si el progreso es mayor a 0 y el estado es default, cambiar a progress
          if (state.progress > 0 && state.status === 'default') {
            state.status = 'progress';
            const statusSelect = document.getElementById(`card-status-select-${componentId}`);
            if (statusSelect) statusSelect.value = 'progress';
          }
        } else if (option === 'type') {
          state.type = value;
          const select = document.getElementById(`card-type-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'provider') {
          state.provider = value;
          const select = document.getElementById(`card-provider-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'competency') {
          state.competency = value;
          const select = document.getElementById(`card-competency-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'level') {
          state.level = value;
          const select = document.getElementById(`card-level-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'language') {
          state.language = value;
          const select = document.getElementById(`card-language-select-${componentId}`);
          if (select) select.value = value;
        }
        
        // Actualizar preview
        window.updateCardPreview(componentId);
      };
      
      // ========================================
      // ACCORDION PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Accordion
      const accordionPreviewState = {};
      
      // Items de ejemplo para el accordion
      const sampleAccordionItems = [
        {
          id: '1',
          title: 'What makes coss ui different?',
          content: 'coss ui focuses on developer experience and performance. Built with TypeScript, it offers excellent type safety, follows accessibility standards, and provides comprehensive documentation with regular updates.',
          icon: 'command',
          iconStyle: 'regular'
        },
        {
          id: '2',
          title: 'How can I customize the components?',
          content: 'You can customize components using CSS variables, theme tokens, and component props. All components are built with customization in mind.',
          icon: 'moon',
          iconStyle: 'regular'
        },
        {
          id: '3',
          title: 'Is coss ui optimized for performance?',
          content: 'Yes, coss ui is built with performance in mind. We optimize every component for maximum performance and minimal bundle size.',
          icon: 'bolt',
          iconStyle: 'regular'
        },
        {
          id: '4',
          title: 'How accessible are the components?',
          content: 'All components follow WCAG 2.1 accessibility standards and include proper ARIA attributes and keyboard navigation support.',
          icon: 'at',
          iconStyle: 'regular'
        }
      ];
      
      const sampleAccordionItemsNoIcons = [
        {
          id: '1',
          title: 'What makes coss ui different?',
          content: 'coss ui focuses on developer experience and performance. Built with TypeScript, it offers excellent type safety, follows accessibility standards, and provides comprehensive documentation with regular updates.'
        },
        {
          id: '2',
          title: 'How can I customize the components?',
          content: 'You can customize components using CSS variables, theme tokens, and component props. All components are built with customization in mind.'
        },
        {
          id: '3',
          title: 'Is coss ui optimized for performance?',
          content: 'Yes, coss ui is built with performance in mind. We optimize every component for maximum performance and minimal bundle size.'
        },
        {
          id: '4',
          title: 'How accessible are the components?',
          content: 'All components follow WCAG 2.1 accessibility standards and include proper ARIA attributes and keyboard navigation support.'
        }
      ];
      
      // Inicializar estado del Accordion
      function initAccordionPreviewState(componentId) {
        if (!accordionPreviewState[componentId]) {
          accordionPreviewState[componentId] = {
            variant: 'list',
            chevronPosition: 'right',
            allowMultiple: false,
            showIcons: true,
            items: sampleAccordionItems
          };
        }
        return accordionPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del Accordion
      window.updateAccordionPreview = function(componentId) {
        const state = initAccordionPreviewState(componentId);
        const preview = document.getElementById(`accordion-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Accordion no encontrado:', `accordion-preview-${componentId}`);
          return;
        }
        
        // Determinar quÃ© items usar segÃºn showIcons
        const itemsToUse = state.showIcons ? sampleAccordionItems : sampleAccordionItemsNoIcons;
        
        // Intentar cargar script del Accordion en segundo plano (no bloquea el renderizado)
        if (typeof window.createAccordion === 'undefined' && typeof window.renderAccordion === 'undefined') {
          const existingScript = document.querySelector('script[src*="accordion"]');
          if (!existingScript) {
            const script = document.createElement('script');
            script.type = 'module';
            script.src = '../../addons/accordion/dist/index.js';
            script.onload = () => {
              console.log('âœ… Accordion script cargado');
              // Hacer las funciones disponibles globalmente
              if (typeof createAccordion !== 'undefined') {
                window.createAccordion = createAccordion;
              }
              if (typeof renderAccordion !== 'undefined') {
                window.renderAccordion = renderAccordion;
              }
              // Re-renderizar con el script cargado (opcional, ya tenemos el fallback)
            };
            script.onerror = () => {
              console.warn('âš ï¸ No se pudo cargar el script del Accordion, usando fallback inline');
            };
            document.head.appendChild(script);
            // NO retornar aquÃ­, continuar con el renderizado inline
          }
        }
        
        // FunciÃ³n helper para renderizar iconos
        function renderIconHelper(iconName, iconStyle = 'regular') {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="${iconClass} ${name}"></i>`;
        }
        
        // FunciÃ³n helper para renderizar un item
        function renderAccordionItem(item, options, itemId) {
          const { variant = 'list', chevronPosition = 'right', showIcons = true } = options;
          const isBoxed = variant === 'boxed';
          const chevronLeft = chevronPosition === 'left';
          const chevronRight = chevronPosition === 'right';
          
          const itemClasses = [
            'ubits-accordion-item',
            isBoxed && 'ubits-accordion-item--boxed'
          ].filter(Boolean).join(' ');
          
          const chevronHTML = chevronLeft || chevronRight
            ? `<i class="far fa-chevron-down ubits-accordion-chevron" data-chevron-id="${itemId}"></i>`
            : '';
          
          const iconHTML = (showIcons && item.icon)
            ? `<span class="ubits-accordion-icon">${renderIconHelper(item.icon, item.iconStyle || 'regular')}</span>`
            : '';
          
          const headerContent = chevronLeft
            ? `${chevronHTML}${iconHTML}<div class="ubits-accordion-header-content"><span class="ubits-accordion-title">${item.title}</span>${item.subHeader ? `<span class="ubits-accordion-subheader">${item.subHeader}</span>` : ''}</div>`
            : `${iconHTML}<div class="ubits-accordion-header-content"><span class="ubits-accordion-title">${item.title}</span>${item.subHeader ? `<span class="ubits-accordion-subheader">${item.subHeader}</span>` : ''}</div>${chevronHTML}`;
          
          const bodyContent = item.content
            ? `<div class="ubits-accordion-body-content">${item.content}</div>`
            : '';
          
          return `
            <div class="${itemClasses}" data-accordion-id="${itemId}">
              <div class="ubits-accordion-header" data-header-id="${itemId}">
                ${headerContent}
              </div>
              <div class="ubits-accordion-body" data-body-id="${itemId}" style="display: none;">
                ${bodyContent}
              </div>
            </div>
          `;
        }
        
        // Generar HTML del accordion
        const accordionClasses = [
          'ubits-accordion',
          `ubits-accordion--${state.variant}`,
          `ubits-accordion--chevron-${state.chevronPosition}`
        ].filter(Boolean).join(' ');
        
        const itemsHTML = itemsToUse
          .map(item => renderAccordionItem(item, state, item.id))
          .join('');
        
        const accordionHTML = `<div class="${accordionClasses}" data-allow-multiple="${state.allowMultiple || false}">
          ${itemsHTML}
        </div>`;
        
        preview.innerHTML = accordionHTML;
        
        // Inicializar funcionalidad de toggle
        const accordionElement = preview.querySelector('.ubits-accordion');
        if (accordionElement) {
          const allowMultiple = state.allowMultiple || false;
          const headers = accordionElement.querySelectorAll('.ubits-accordion-header');
          
          headers.forEach(header => {
            header.addEventListener('click', (e) => {
              e.stopPropagation();
              const headerId = header.getAttribute('data-header-id');
              if (!headerId) return;
              
              const body = accordionElement.querySelector(`[data-body-id="${headerId}"]`);
              const chevron = accordionElement.querySelector(`[data-chevron-id="${headerId}"]`);
              if (!body || !chevron) return;
              
              const isOpen = body.style.display === 'block';
              
              if (!allowMultiple && !isOpen) {
                // Cerrar todos los demÃ¡s
                const allBodies = accordionElement.querySelectorAll('.ubits-accordion-body');
                const allHeaders = accordionElement.querySelectorAll('.ubits-accordion-header');
                const allChevrons = accordionElement.querySelectorAll('.ubits-accordion-chevron');
                
                allBodies.forEach(b => {
                  if (b !== body) {
                    b.style.display = 'none';
                  }
                });
                allHeaders.forEach(h => {
                  if (h !== header) h.classList.remove('ubits-accordion-header--open');
                });
                allChevrons.forEach(c => {
                  if (c !== chevron) {
                    c.style.transform = 'rotate(0deg)';
                  }
                });
              }
              
              // Toggle del item actual
              if (isOpen) {
                body.style.display = 'none';
                header.classList.remove('ubits-accordion-header--open');
                chevron.style.transform = 'rotate(0deg)';
              } else {
                body.style.display = 'block';
                header.classList.add('ubits-accordion-header--open');
                chevron.style.transform = 'rotate(180deg)';
              }
            });
          });
        }
        
        // Inicializar toggles si existen
        const allowMultipleToggle = document.getElementById(`accordion-allow-multiple-toggle-${componentId}`);
        if (allowMultipleToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(allowMultipleToggle);
        }
        
        const showIconsToggle = document.getElementById(`accordion-show-icons-toggle-${componentId}`);
        if (showIconsToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showIconsToggle);
        }
        
        // Actualizar textos de estado
        const allowMultipleStatus = document.getElementById(`accordion-allow-multiple-status-${componentId}`);
        if (allowMultipleStatus) {
          allowMultipleStatus.textContent = state.allowMultiple ? 'Activado' : 'Desactivado';
        }
        
        const showIconsStatus = document.getElementById(`accordion-show-icons-status-${componentId}`);
        if (showIconsStatus) {
          showIconsStatus.textContent = state.showIcons ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… Accordion preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Accordion
      window.setAccordionControl = function(option, value, componentId) {
        const state = initAccordionPreviewState(componentId);
        
        if (option === 'variant') {
          state.variant = value;
          const select = document.getElementById(`accordion-variant-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'chevronPosition') {
          state.chevronPosition = value;
          // Actualizar botones activos
          document.querySelectorAll(`[data-component="${componentId}"][data-option="chevronPosition"]`).forEach(btn => {
            btn.classList.toggle('active', btn.getAttribute('data-value') === value);
          });
        } else if (option === 'allowMultiple') {
          state.allowMultiple = value === true || value === 'true';
          const toggle = document.getElementById(`accordion-allow-multiple-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.allowMultiple;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`accordion-allow-multiple-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.allowMultiple ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showIcons') {
          state.showIcons = value === true || value === 'true';
          const toggle = document.getElementById(`accordion-show-icons-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showIcons;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`accordion-show-icons-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showIcons ? 'Activado' : 'Desactivado';
          }
          // Actualizar items segÃºn showIcons
          state.items = state.showIcons ? sampleAccordionItems : sampleAccordionItemsNoIcons;
        }
        
        // Actualizar preview
        window.updateAccordionPreview(componentId);
      };
      
      // ========================================
      // SELECTION CARD PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Selection Card
      const selectionCardPreviewState = {};
      
      // Inicializar estado del Selection Card
      function initSelectionCardPreviewState(componentId) {
        if (!selectionCardPreviewState[componentId]) {
          selectionCardPreviewState[componentId] = {
            id: 'card-1',
            title: 'Asignar toda la empresa',
            description: 'Agregaras a todos los colaboradores de la empresa que tengas en la plataforma.',
            showDescription: true,
            icon: 'building',
            showIcon: true,
            iconStyle: 'regular',
            selectionCount: { current: 0, total: 290 },
            showSelectionCount: true,
            state: 'default',
            size: 'md',
            value: ''
          };
        }
        return selectionCardPreviewState[componentId];
      }
      
      // FunciÃ³n helper para renderizar iconos
      function renderSelectionCardIconHelper(iconName, iconStyle = 'regular') {
        const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
        const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
        return `<i class="${iconClass} ${name}"></i>`;
      }
      
      // FunciÃ³n helper para renderizar radio button (simplificado)
      function renderSelectionCardRadioButton(checked, disabled, itemId) {
        const checkedClass = checked ? 'ubits-radio-button--checked' : '';
        const disabledClass = disabled ? 'ubits-radio-button--disabled' : '';
        const dotHTML = checked ? '<span class="ubits-radio-button__dot"></span>' : '';
        return `
          <label class="ubits-radio-button ubits-radio-button--md ${checkedClass} ${disabledClass} ubits-selection-card__radio-button">
            <input type="radio" name="selection-card-group-${itemId}" value="${itemId}" ${checked ? 'checked' : ''} ${disabled ? 'disabled' : ''} style="display: none;">
            <span class="ubits-radio-button__circle">${dotHTML}</span>
          </label>
        `;
      }
      
      // FunciÃ³n para actualizar el preview del Selection Card
      window.updateSelectionCardPreview = function(componentId) {
        const state = initSelectionCardPreviewState(componentId);
        const preview = document.getElementById(`selection-card-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Selection Card no encontrado:', `selection-card-preview-${componentId}`);
          return;
        }
        
        const isSelected = state.state === 'selected';
        const isDisabled = state.state === 'disabled';
        
        // Construir clases
        const classes = [
          'ubits-selection-card',
          `ubits-selection-card--${state.size}`,
          state.state !== 'default' ? `ubits-selection-card--${state.state}` : '',
          isSelected ? 'ubits-selection-card--selected' : ''
        ].filter(Boolean).join(' ');
        
        // Renderizar icono
        let iconHTML = '';
        if (state.showIcon && state.icon) {
          iconHTML = `
            <div class="ubits-selection-card__icon">
              ${renderSelectionCardIconHelper(state.icon, state.iconStyle)}
            </div>
          `;
        }
        
        // Renderizar contador de selecciÃ³n
        let selectionCountHTML = '';
        if (state.showSelectionCount && state.selectionCount) {
          const { current, total } = state.selectionCount;
          selectionCountHTML = `
            <div class="ubits-selection-card__selection-count">
              <span class="ubits-selection-card__selection-count-number ubits-body-md-bold">${current}/${total}</span>
              <span class="ubits-selection-card__selection-count-text ubits-body-md-regular">seleccionados</span>
            </div>
          `;
        }
        
        // Renderizar radio button
        const radioButtonHTML = renderSelectionCardRadioButton(isSelected, isDisabled, state.id);
        
        // Generar HTML
        const cardHTML = `
          <div class="${classes}" data-card-id="${state.id}" ${isDisabled ? 'aria-disabled="true"' : ''} ${!isDisabled ? 'tabindex="0"' : ''}>
            <div class="ubits-selection-card__content">
              <h3 class="ubits-selection-card__title ubits-body-md-semibold">
                ${iconHTML}
                <span>${state.title}</span>
              </h3>
              ${state.showDescription && state.description ? `<p class="ubits-selection-card__description ubits-body-sm">${state.description}</p>` : ''}
              ${selectionCountHTML}
            </div>
            <div class="ubits-selection-card__radio-wrapper">
              ${radioButtonHTML}
            </div>
          </div>
        `.trim();
        
        preview.innerHTML = cardHTML;
        
        // Inicializar toggles si existen
        const showDescriptionToggle = document.getElementById(`selection-card-show-description-toggle-${componentId}`);
        if (showDescriptionToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showDescriptionToggle);
        }
        
        const showIconToggle = document.getElementById(`selection-card-show-icon-toggle-${componentId}`);
        if (showIconToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showIconToggle);
        }
        
        const showCountToggle = document.getElementById(`selection-card-show-count-toggle-${componentId}`);
        if (showCountToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showCountToggle);
        }
        
        // Actualizar textos de estado
        const showDescriptionStatus = document.getElementById(`selection-card-show-description-status-${componentId}`);
        if (showDescriptionStatus) {
          showDescriptionStatus.textContent = state.showDescription ? 'Activado' : 'Desactivado';
        }
        
        const showIconStatus = document.getElementById(`selection-card-show-icon-status-${componentId}`);
        if (showIconStatus) {
          showIconStatus.textContent = state.showIcon ? 'Activado' : 'Desactivado';
        }
        
        const showCountStatus = document.getElementById(`selection-card-show-count-status-${componentId}`);
        if (showCountStatus) {
          showCountStatus.textContent = state.showSelectionCount ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… Selection Card preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Selection Card
      window.setSelectionCardControl = function(option, value, componentId) {
        const state = initSelectionCardPreviewState(componentId);
        
        if (option === 'title') {
          state.title = value || 'Asignar toda la empresa';
          const input = document.getElementById(`selection-card-title-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'description') {
          state.description = value || '';
          const input = document.getElementById(`selection-card-description-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showDescription') {
          state.showDescription = value === true || value === 'true';
          const toggle = document.getElementById(`selection-card-show-description-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showDescription;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`selection-card-show-description-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showDescription ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'icon') {
          state.icon = value || 'building';
          const input = document.getElementById(`selection-card-icon-input-${componentId}`);
          if (input && input.value !== value) input.value = value;
        } else if (option === 'showIcon') {
          state.showIcon = value === true || value === 'true';
          const toggle = document.getElementById(`selection-card-show-icon-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showIcon;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`selection-card-show-icon-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showIcon ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'iconStyle') {
          state.iconStyle = value || 'regular';
          const select = document.getElementById(`selection-card-icon-style-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'state') {
          state.state = value || 'default';
          const select = document.getElementById(`selection-card-state-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'size') {
          state.size = value || 'md';
          const select = document.getElementById(`selection-card-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'selectionCountCurrent') {
          if (!state.selectionCount) state.selectionCount = { current: 0, total: 290 };
          state.selectionCount.current = parseInt(value) || 0;
          const input = document.getElementById(`selection-card-count-current-input-${componentId}`);
          if (input) input.value = state.selectionCount.current;
        } else if (option === 'selectionCountTotal') {
          if (!state.selectionCount) state.selectionCount = { current: 0, total: 290 };
          state.selectionCount.total = parseInt(value) || 290;
          const input = document.getElementById(`selection-card-count-total-input-${componentId}`);
          if (input) input.value = state.selectionCount.total;
        } else if (option === 'showSelectionCount') {
          state.showSelectionCount = value === true || value === 'true';
          const toggle = document.getElementById(`selection-card-show-count-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showSelectionCount;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`selection-card-show-count-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showSelectionCount ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        window.updateSelectionCardPreview(componentId);
      };
      
      // ========================================
      // STEPPER PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Stepper
      const stepperPreviewState = {};
      
      // Inicializar estado del Stepper
      function initStepperPreviewState(componentId) {
        if (!stepperPreviewState[componentId]) {
          stepperPreviewState[componentId] = {
            orientation: 'horizontal',
            size: 'md',
            showTitle: true,
            showDescription: true,
            numSteps: 3,
            steps: [
              { number: 1, title: 'Step One', description: 'Desc for step one', state: 'completed' },
              { number: 2, title: 'Step Two', description: 'Desc for step two', state: 'active' },
              { number: 3, title: 'Step Three', description: 'Desc for step three', state: 'default' }
            ]
          };
        }
        return stepperPreviewState[componentId];
      }
      
      // FunciÃ³n helper para escapar HTML
      function escapeStepperHtml(text) {
        if (typeof text !== 'string') return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      // FunciÃ³n helper para renderizar indicador del paso
      function renderStepperIndicator(number, state) {
        const indicatorClasses = [
          'ubits-stepper__indicator',
          `ubits-stepper__indicator--${state}`
        ].filter(Boolean).join(' ');
        
        let content = '';
        if (state === 'completed') {
          content = `
            <svg class="ubits-stepper__checkmark" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13.3333 4L6 11.3333L2.66667 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          `;
        } else {
          content = `<span class="ubits-stepper__number">${number}</span>`;
        }
        
        return `<div class="${indicatorClasses}">${content}</div>`;
      }
      
      // FunciÃ³n helper para renderizar conector
      function renderStepperConnector(orientation) {
        return `<div class="ubits-stepper__connector ubits-stepper__connector--${orientation}"></div>`;
      }
      
      // FunciÃ³n helper para renderizar contenido del paso
      function renderStepperStepContent(title, description, showTitle, showDescription) {
        const titleHtml = (showTitle && title)
          ? `<h3 class="ubits-stepper__title ubits-body-md-semibold">${escapeStepperHtml(title)}</h3>`
          : '';
        
        const descriptionHtml = (showDescription && description)
          ? `<p class="ubits-stepper__description ubits-body-sm-regular">${escapeStepperHtml(description)}</p>`
          : '';
        
        if (!titleHtml && !descriptionHtml) {
          return '<div class="ubits-stepper__step-content ubits-stepper__step-content--empty"></div>';
        }
        
        return `
          <div class="ubits-stepper__step-content">
            <div class="ubits-stepper__content-wrapper">
              ${titleHtml}
              ${descriptionHtml}
            </div>
          </div>
        `;
      }
      
      // FunciÃ³n para generar controles dinÃ¡micos de pasos
      function generateStepperStepsControls(componentId, numSteps) {
        const controlsContainer = document.getElementById(`stepper-steps-controls-${componentId}`);
        if (!controlsContainer) return;
        
        const state = initStepperPreviewState(componentId);
        let html = '';
        
        for (let i = 1; i <= numSteps; i++) {
          const step = state.steps[i - 1] || {
            number: i,
            title: `Step ${i === 1 ? 'One' : i === 2 ? 'Two' : i === 3 ? 'Three' : i === 4 ? 'Four' : 'Five'}`,
            description: `Desc for step ${i === 1 ? 'one' : i === 2 ? 'two' : i === 3 ? 'three' : i === 4 ? 'four' : 'five'}`,
            state: i === 1 ? 'completed' : i === 2 ? 'active' : 'default'
          };
          
          html += `
            <div style="background: var(--ubits-bg-1); padding: 20px; border-radius: 8px; border: 1px solid var(--ubits-border-1);">
              <h5 style="margin: 0 0 16px 0; color: var(--ubits-fg-1-high); font-size: 14px; font-weight: 600;">Paso ${i}</h5>
              <div style="display: flex; flex-wrap: wrap; gap: 16px;">
                <!-- Estado -->
                <div style="flex: 0 0 auto; min-width: 150px;">
                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Estado</label>
                  <select id="stepper-step-${i}-state-select-${componentId}" onchange="setStepperControl('step${i}State', this.value, '${componentId}')" style="width: 100%; padding: 8px 32px 8px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226,9 12,15 18,9%22></polyline></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; box-sizing: border-box;">
                    <option value="default" ${step.state === 'default' ? 'selected' : ''}>Default</option>
                    <option value="completed" ${step.state === 'completed' ? 'selected' : ''}>Completed</option>
                    <option value="active" ${step.state === 'active' ? 'selected' : ''}>Active</option>
                    <option value="error" ${step.state === 'error' ? 'selected' : ''}>Error</option>
                    <option value="warning" ${step.state === 'warning' ? 'selected' : ''}>Warning</option>
                  </select>
                </div>
                
                <!-- TÃ­tulo -->
                <div style="flex: 1 1 auto; min-width: 200px;">
                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">TÃ­tulo</label>
                  <input type="text" id="stepper-step-${i}-title-input-${componentId}" value="${escapeStepperHtml(step.title)}" onchange="setStepperControl('step${i}Title', this.value, '${componentId}')" placeholder="TÃ­tulo del paso" style="width: 100%; padding: 8px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                </div>
                
                <!-- DescripciÃ³n -->
                <div style="flex: 1 1 auto; min-width: 250px;">
                  <label style="display: block; font-size: 12px; font-weight: 600; color: var(--ubits-fg-1-medium); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">DescripciÃ³n</label>
                  <input type="text" id="stepper-step-${i}-description-input-${componentId}" value="${escapeStepperHtml(step.description || '')}" onchange="setStepperControl('step${i}Description', this.value, '${componentId}')" placeholder="DescripciÃ³n del paso" style="width: 100%; padding: 8px 12px; border: none; border-radius: 8px; background: var(--ubits-bg-2); color: var(--ubits-fg-1-high); font-size: 13px; font-family: var(--font-sans); box-sizing: border-box;">
                </div>
              </div>
            </div>
          `;
        }
        
        controlsContainer.innerHTML = html;
      }
      
      // FunciÃ³n para actualizar el preview del Stepper
      window.updateStepperPreview = function(componentId) {
        const state = initStepperPreviewState(componentId);
        const preview = document.getElementById(`stepper-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Stepper no encontrado:', `stepper-preview-${componentId}`);
          return;
        }
        
        // Generar controles dinÃ¡micos de pasos
        generateStepperStepsControls(componentId, state.numSteps);
        
        // Construir clases del stepper
        const classes = [
          'ubits-stepper',
          `ubits-stepper--${state.orientation}`,
          `ubits-stepper--${state.size}`
        ].filter(Boolean).join(' ');
        
        // Renderizar pasos
        const stepsHtml = state.steps.slice(0, state.numSteps).map((step, index) => {
          const isLast = index === state.numSteps - 1;
          const stepState = step.state || (index === 0 ? 'active' : 'default');
          
          const stepClasses = [
            'ubits-stepper__step',
            `ubits-stepper__step--${stepState}`,
            isLast ? 'ubits-stepper__step--last' : ''
          ].filter(Boolean).join(' ');
          
          const indicator = renderStepperIndicator(step.number, stepState);
          const connector = !isLast ? renderStepperConnector(state.orientation) : '';
          const content = renderStepperStepContent(
            step.title,
            step.description,
            state.showTitle,
            state.showDescription
          );
          
          if (state.orientation === 'vertical') {
            return `
              <div class="${stepClasses}">
                <div class="ubits-stepper__step-wrapper">
                  ${indicator}
                  <div class="ubits-stepper__step-content">
                    ${content}
                  </div>
                </div>
                ${connector}
              </div>
            `.trim();
          } else {
            return `
              <div class="${stepClasses}">
                ${indicator}
                ${content}
                ${connector}
              </div>
            `.trim();
          }
        }).join('');
        
        const stepperHTML = `<div class="${classes}">${stepsHtml}</div>`;
        preview.innerHTML = stepperHTML;
        
        // Inicializar toggles
        const showTitleToggle = document.getElementById(`stepper-show-title-toggle-${componentId}`);
        if (showTitleToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showTitleToggle);
        }
        
        const showDescriptionToggle = document.getElementById(`stepper-show-description-toggle-${componentId}`);
        if (showDescriptionToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showDescriptionToggle);
        }
        
        // Actualizar textos de estado
        const showTitleStatus = document.getElementById(`stepper-show-title-status-${componentId}`);
        if (showTitleStatus) {
          showTitleStatus.textContent = state.showTitle ? 'Activado' : 'Desactivado';
        }
        
        const showDescriptionStatus = document.getElementById(`stepper-show-description-status-${componentId}`);
        if (showDescriptionStatus) {
          showDescriptionStatus.textContent = state.showDescription ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… Stepper preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Stepper
      window.setStepperControl = function(option, value, componentId) {
        const state = initStepperPreviewState(componentId);
        
        if (option === 'orientation') {
          state.orientation = value || 'horizontal';
          const select = document.getElementById(`stepper-orientation-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'size') {
          state.size = value || 'md';
          const select = document.getElementById(`stepper-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'numSteps') {
          const newNumSteps = parseInt(value) || 3;
          state.numSteps = Math.max(2, Math.min(5, newNumSteps));
          
          // Ajustar array de pasos
          while (state.steps.length < state.numSteps) {
            const stepNum = state.steps.length + 1;
            state.steps.push({
              number: stepNum,
              title: `Step ${stepNum === 1 ? 'One' : stepNum === 2 ? 'Two' : stepNum === 3 ? 'Three' : stepNum === 4 ? 'Four' : 'Five'}`,
              description: `Desc for step ${stepNum === 1 ? 'one' : stepNum === 2 ? 'two' : stepNum === 3 ? 'three' : stepNum === 4 ? 'four' : 'five'}`,
              state: stepNum === 1 ? 'completed' : stepNum === 2 ? 'active' : 'default'
            });
          }
          state.steps = state.steps.slice(0, state.numSteps);
          
          const select = document.getElementById(`stepper-num-steps-select-${componentId}`);
          if (select) select.value = state.numSteps;
        } else if (option === 'showTitle') {
          state.showTitle = value === true || value === 'true';
          const toggle = document.getElementById(`stepper-show-title-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showTitle;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`stepper-show-title-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showTitle ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showDescription') {
          state.showDescription = value === true || value === 'true';
          const toggle = document.getElementById(`stepper-show-description-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showDescription;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`stepper-show-description-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showDescription ? 'Activado' : 'Desactivado';
          }
        } else if (option.match(/^step(\d+)State$/)) {
          const stepNum = parseInt(option.match(/^step(\d+)State$/)[1]);
          if (stepNum >= 1 && stepNum <= 5) {
            if (!state.steps[stepNum - 1]) {
              state.steps[stepNum - 1] = { number: stepNum, title: '', description: '', state: 'default' };
            }
            state.steps[stepNum - 1].state = value || 'default';
            const select = document.getElementById(`stepper-step-${stepNum}-state-select-${componentId}`);
            if (select) select.value = value;
          }
        } else if (option.match(/^step(\d+)Title$/)) {
          const stepNum = parseInt(option.match(/^step(\d+)Title$/)[1]);
          if (stepNum >= 1 && stepNum <= 5) {
            if (!state.steps[stepNum - 1]) {
              state.steps[stepNum - 1] = { number: stepNum, title: '', description: '', state: 'default' };
            }
            state.steps[stepNum - 1].title = value || '';
            const input = document.getElementById(`stepper-step-${stepNum}-title-input-${componentId}`);
            if (input && input.value !== value) input.value = value;
          }
        } else if (option.match(/^step(\d+)Description$/)) {
          const stepNum = parseInt(option.match(/^step(\d+)Description$/)[1]);
          if (stepNum >= 1 && stepNum <= 5) {
            if (!state.steps[stepNum - 1]) {
              state.steps[stepNum - 1] = { number: stepNum, title: '', description: '', state: 'default' };
            }
            state.steps[stepNum - 1].description = value || '';
            const input = document.getElementById(`stepper-step-${stepNum}-description-input-${componentId}`);
            if (input && input.value !== value) input.value = value;
          }
        }
        
        // Actualizar preview
        window.updateStepperPreview(componentId);
      };
      
      // ========================================
      // TIMELINE PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Timeline
      const timelinePreviewState = {};
      
      // Inicializar estado del Timeline
      function initTimelinePreviewState(componentId) {
        if (!timelinePreviewState[componentId]) {
          timelinePreviewState[componentId] = {
            showAvatar: false,
            showDate: true,
            showDescription: true,
            showIcon: true,
            alignment: 'left',
            filledItems: 2
          };
        }
        return timelinePreviewState[componentId];
      }
      
      // FunciÃ³n helper para renderizar icono FontAwesome
      function renderTimelineIcon(iconName, style = 'regular') {
        const iconClass = style === 'solid' ? 'fas' : 'far';
        return `<i class="${iconClass} fa-${iconName}"></i>`;
      }
      
      // FunciÃ³n para generar datos de ejemplo del Timeline
      function generateTimelineData(filledItems = 2) {
        return [
          {
            date: 'Mar 15, 2024',
            title: 'Project Kickoff',
            description: 'Initial team meeting and project scope definition. Established key milestones and resource allocation.',
            state: filledItems > 0 ? 'filled' : 'default',
            avatar: {
              imageUrl: '/images/Profile-image.jpg',
            },
            icon: 'circle',
          },
          {
            date: 'Mar 22, 2024',
            title: 'Design Phase',
            description: 'Completed wireframes and user interface mockups. Stakeholder review and feedback incorporated.',
            state: filledItems > 1 ? 'filled' : 'default',
            avatar: {
              imageUrl: '/images/Profile-image.jpg',
            },
            icon: 'paint-brush',
          },
          {
            date: 'Apr 5, 2024',
            title: 'Development Sprint',
            description: 'Backend API implementation and frontend component development in progress.',
            state: filledItems > 2 ? 'filled' : 'default',
            avatar: {
              imageUrl: '/images/Profile-image.jpg',
            },
            icon: 'code',
          },
          {
            date: 'Apr 19, 2024',
            title: 'Testing & Deployment',
            description: 'Quality assurance testing, performance optimization, and production deployment preparation.',
            state: filledItems > 3 ? 'filled' : 'default',
            avatar: {
              imageUrl: '/images/Profile-image.jpg',
            },
            icon: 'rocket',
          },
        ];
      }
      
      // FunciÃ³n para escapar HTML
      function escapeTimelineHtml(text) {
        if (typeof text !== 'string') return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      // FunciÃ³n para renderizar un item del timeline
      function renderTimelineItem(item, index, isLast, args) {
        const {
          showAvatar = false,
          showDate = true,
          showDescription = true,
          showIcon = true,
          alignment = 'left',
        } = args;
        
        // Avatar e icono son mutuamente excluyentes
        const useAvatar = showAvatar === true && showIcon !== true;
        const useIcon = showIcon === true && showAvatar !== true;
        
        const isFilled = item.state === 'filled';
        const markerClass = isFilled ? 'ubits-timeline-marker--filled' : 'ubits-timeline-marker--default';
        const markerColor = isFilled ? 'var(--ubits-fg-1-medium-static)' : 'var(--ubits-border-1)';
        
        // Avatar HTML
        let avatarHTML = '';
        if (useAvatar && item.avatar) {
          // Usar renderAvatar si estÃ¡ disponible, sino crear HTML bÃ¡sico
          if (typeof window.renderAvatar === 'function') {
            const avatarOptions = {
              size: 'xs',
              alt: item.title,
            };
            if (item.avatar.imageUrl) avatarOptions.imageUrl = item.avatar.imageUrl;
            else if (item.avatar.initials) avatarOptions.initials = item.avatar.initials;
            else avatarOptions.icon = item.avatar.icon || 'user';
            avatarHTML = window.renderAvatar(avatarOptions);
          } else {
            avatarHTML = `<div class="ubits-avatar ubits-avatar--xs" style="width: 24px; height: 24px; border-radius: 50%; background: var(--ubits-bg-2); display: flex; align-items: center; justify-content: center; font-size: 10px; color: var(--ubits-fg-1-medium);">${item.avatar.initials || 'U'}</div>`;
          }
        }
        
        // Icono del marcador
        let markerIconHTML = '';
        if (useIcon) {
          const iconName = item.icon || 'circle';
          markerIconHTML = `<span class="ubits-timeline-marker__icon">${renderTimelineIcon(iconName, 'solid')}</span>`;
        }
        
        // Contenido del item
        const isCentered = alignment === 'center';
        const isEven = index % 2 === 0;
        const contentSide = isCentered ? (isEven ? 'left' : 'right') : 'left';
        
        const lineHTML = !isLast ? `<div class="ubits-timeline-line"></div>` : '';
        
        const markerBackground = isFilled ? markerColor : 'var(--ubits-bg-1)';
        
        // Si usa avatar
        if (useAvatar && avatarHTML) {
          return `
            <div class="ubits-timeline-item ${isCentered ? `ubits-timeline-item--${contentSide}` : ''}" data-index="${index}" data-state="${item.state}">
              ${isCentered && contentSide === 'right' ? `
                <div class="ubits-timeline-item__content">
                  <div class="ubits-timeline-item__text">
                    ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                    <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                    ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                  </div>
                </div>
              ` : ''}
              <div class="ubits-timeline-item__marker-container">
                <div class="ubits-timeline-marker ubits-timeline-marker--avatar">
                  ${avatarHTML}
                </div>
              </div>
              ${lineHTML}
              ${isCentered && contentSide === 'left' ? `
                <div class="ubits-timeline-item__content">
                  <div class="ubits-timeline-item__text">
                    ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                    <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                    ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                  </div>
                </div>
              ` : !isCentered ? `
                <div class="ubits-timeline-item__content">
                  <div class="ubits-timeline-item__text">
                    ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                    <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                    ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                  </div>
                </div>
              ` : ''}
            </div>
          `;
        }
        
        // Si usa icono
        return `
          <div class="ubits-timeline-item ${isCentered ? `ubits-timeline-item--${contentSide}` : ''}" data-index="${index}" data-state="${item.state}">
            ${isCentered && contentSide === 'right' ? `
              <div class="ubits-timeline-item__content">
                <div class="ubits-timeline-item__text">
                  ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                  <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                  ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                </div>
              </div>
            ` : ''}
            <div class="ubits-timeline-item__marker-container">
              <div class="ubits-timeline-marker ${markerClass}" style="border-color: ${markerColor}; background-color: ${markerBackground};">
                ${markerIconHTML}
              </div>
            </div>
            ${lineHTML}
            ${isCentered && contentSide === 'left' ? `
              <div class="ubits-timeline-item__content">
                <div class="ubits-timeline-item__text">
                  ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                  <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                  ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                </div>
              </div>
            ` : !isCentered ? `
              <div class="ubits-timeline-item__content">
                <div class="ubits-timeline-item__text">
                  ${showDate && item.date ? `<div class="ubits-timeline-item__date ubits-body-sm-regular">${escapeTimelineHtml(item.date)}</div>` : ''}
                  <div class="ubits-timeline-item__title ubits-body-md-semibold">${escapeTimelineHtml(item.title)}</div>
                  ${showDescription && item.description ? `<div class="ubits-timeline-item__description ubits-body-sm-regular">${escapeTimelineHtml(item.description)}</div>` : ''}
                </div>
              </div>
            ` : ''}
          </div>
        `;
      }
      
      // FunciÃ³n para actualizar el preview del Timeline
      window.updateTimelinePreview = function(componentId) {
        const state = initTimelinePreviewState(componentId);
        const preview = document.getElementById(`timeline-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Timeline no encontrado:', `timeline-preview-${componentId}`);
          return;
        }
        
        // Asegurar que avatar e icono sean mutuamente excluyentes
        if (state.showAvatar === true) {
          state.showIcon = false;
        }
        if (state.showIcon === true) {
          state.showAvatar = false;
        }
        
        // Cargar CSS del Timeline si no estÃ¡ cargado
        const timelineCSSId = 'ubits-timeline-css';
        if (!document.getElementById(timelineCSSId)) {
          const style = document.createElement('style');
          style.id = timelineCSSId;
          style.textContent = `
            .ubits-timeline {
              position: relative;
              display: flex;
              flex-direction: column;
              gap: 0;
              width: 100%;
            }
            
            .ubits-timeline--left {
              align-items: flex-start;
            }
            
            .ubits-timeline--center {
              align-items: center;
              position: relative;
            }
            
            .ubits-timeline--center::before {
              content: '';
              position: absolute;
              left: 50%;
              top: 0;
              bottom: 0;
              width: 2px;
              transform: translateX(-50%);
              background-color: var(--ubits-border-1);
              z-index: 0;
            }
            
            .ubits-timeline-item {
              position: relative;
              display: flex;
              width: 100%;
              gap: 0;
              align-items: flex-start;
              margin-bottom: var(--ubits-spacing-xl);
            }
            
            .ubits-timeline-item:last-child {
              margin-bottom: 0;
            }
            
            .ubits-timeline--center .ubits-timeline-item {
              justify-content: flex-start;
              align-items: flex-start;
              position: relative;
            }
            
            .ubits-timeline--center .ubits-timeline-item--left {
              flex-direction: row;
              justify-content: flex-end;
            }
            
            .ubits-timeline--center .ubits-timeline-item--right {
              flex-direction: row;
              justify-content: flex-start;
            }
            
            .ubits-timeline-item__content {
              display: flex;
              flex-direction: column;
              gap: 0;
              flex: 1;
              min-width: 0;
              margin-left: var(--ubits-spacing-md);
            }
            
            .ubits-timeline--center .ubits-timeline-item__content {
              flex: 0 0 auto;
              max-width: calc(50% - 40px);
              align-self: flex-start;
              padding-top: 0;
            }
            
            .ubits-timeline--center .ubits-timeline-item--right .ubits-timeline-item__content {
              text-align: right;
              align-items: flex-end;
              margin-left: var(--ubits-spacing-md);
              margin-right: 0;
              order: 2;
            }
            
            .ubits-timeline--center .ubits-timeline-item--left .ubits-timeline-item__content {
              text-align: left;
              align-items: flex-start;
              margin-right: var(--ubits-spacing-md);
              margin-left: 0;
              order: 0;
            }
            
            .ubits-timeline--center .ubits-timeline-item--left .ubits-timeline-item__marker-container {
              order: 1;
            }
            
            .ubits-timeline--center .ubits-timeline-item--right .ubits-timeline-item__marker-container {
              order: 1;
            }
            
            .ubits-timeline-item__text {
              flex: 1;
              min-width: 0;
              display: flex;
              flex-direction: column;
              gap: 0;
              align-items: flex-start;
            }
            
            .ubits-timeline-item__date {
              margin: 0 0 4px 0;
              font-family: var(--font-sans);
              font-size: var(--font-body-sm-size);
              font-weight: var(--weight-regular);
              line-height: var(--font-body-sm-line);
              color: var(--ubits-fg-1-medium);
            }
            
            .ubits-timeline-item__title {
              margin: 0 0 4px 0;
              font-family: var(--font-sans);
              font-size: var(--font-body-md-size);
              font-weight: var(--weight-semibold);
              line-height: var(--font-body-md-line);
              color: var(--ubits-fg-1-high);
            }
            
            .ubits-timeline-item__description {
              margin: 0;
              font-family: var(--font-sans);
              font-size: var(--font-body-sm-size);
              font-weight: var(--weight-regular);
              line-height: var(--font-body-sm-line);
              color: var(--ubits-fg-1-medium);
            }
            
            .ubits-timeline-item__marker-container {
              position: relative;
              display: flex;
              flex-direction: column;
              align-items: center;
              flex-shrink: 0;
              width: 24px;
              z-index: 1;
            }
            
            .ubits-timeline--center .ubits-timeline-item__marker-container {
              position: absolute;
              left: 50%;
              transform: translateX(-50%);
              z-index: 2;
              top: 0;
            }
            
            .ubits-timeline-marker {
              width: 24px;
              height: 24px;
              border-radius: var(--ubits-border-radius-full, 50%);
              border: 2px solid;
              display: flex;
              align-items: center;
              justify-content: center;
              position: relative;
              z-index: 1;
              flex-shrink: 0;
              transition: all 0.2s ease;
              box-sizing: border-box;
            }
            
            .ubits-timeline-marker--avatar {
              width: 24px;
              height: 24px;
              border: 2px solid var(--ubits-border-1);
              padding: 0;
              background: var(--ubits-bg-1);
              border-radius: var(--ubits-border-radius-full);
            }
            
            .ubits-timeline-marker--avatar .ubits-avatar {
              width: 24px;
              height: 24px;
            }
            
            .ubits-timeline-marker--default {
              background-color: var(--ubits-bg-1);
              border-color: var(--ubits-border-1);
            }
            
            .ubits-timeline-marker--filled {
              background-color: var(--ubits-fg-1-medium-static);
              border-color: var(--ubits-fg-1-medium-static);
            }
            
            .ubits-timeline-marker__icon {
              font-size: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
            }
            
            .ubits-timeline-marker--default .ubits-timeline-marker__icon {
              color: var(--ubits-fg-1-medium);
            }
            
            .ubits-timeline-marker--filled .ubits-timeline-marker__icon {
              color: var(--ubits-fg-bold);
            }
            
            .ubits-timeline-line {
              position: absolute;
              left: 11px;
              top: 24px;
              bottom: -32px;
              width: 2px;
              z-index: 0;
              background-color: var(--ubits-border-1);
              transition: background-color 0.2s ease;
            }
            
            .ubits-timeline--center .ubits-timeline-line {
              display: none;
            }
            
            .ubits-timeline-item:last-child .ubits-timeline-line {
              display: none;
            }
            
            .ubits-timeline-item[data-state="filled"] .ubits-timeline-line {
              background-color: var(--ubits-fg-1-medium-static);
            }
            
            .ubits-timeline-item[data-state="default"] .ubits-timeline-line {
              background-color: var(--ubits-border-1);
            }
          `;
          document.head.appendChild(style);
        }
        
        // Cargar CSS del avatar si no estÃ¡ cargado
        const avatarCSSId = 'ubits-avatar-css';
        if (!document.getElementById(avatarCSSId)) {
          const link = document.createElement('link');
          link.id = avatarCSSId;
          link.rel = 'stylesheet';
          link.href = '../../addons/avatar/src/styles/avatar.css';
          document.head.appendChild(link);
        }
        
        // Generar datos del timeline
        const timelineData = generateTimelineData(state.filledItems);
        const alignmentClass = state.alignment === 'center' ? 'ubits-timeline--center' : 'ubits-timeline--left';
        
        // Renderizar items
        const itemsHtml = timelineData.map((item, index) => 
          renderTimelineItem(item, index, index === timelineData.length - 1, state)
        ).join('');
        
        const timelineHTML = `<div class="ubits-timeline ${alignmentClass}">${itemsHtml}</div>`;
        preview.innerHTML = timelineHTML;
        
        // Actualizar estados de toggles
        const showAvatarToggle = document.getElementById(`timeline-show-avatar-toggle-${componentId}`);
        if (showAvatarToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showAvatarToggle);
        }
        
        const showDateToggle = document.getElementById(`timeline-show-date-toggle-${componentId}`);
        if (showDateToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showDateToggle);
        }
        
        const showDescriptionToggle = document.getElementById(`timeline-show-description-toggle-${componentId}`);
        if (showDescriptionToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showDescriptionToggle);
        }
        
        const showIconToggle = document.getElementById(`timeline-show-icon-toggle-${componentId}`);
        if (showIconToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showIconToggle);
        }
        
        // Actualizar textos de estado
        const showAvatarStatus = document.getElementById(`timeline-show-avatar-status-${componentId}`);
        if (showAvatarStatus) {
          showAvatarStatus.textContent = state.showAvatar ? 'Activado' : 'Desactivado';
        }
        
        const showDateStatus = document.getElementById(`timeline-show-date-status-${componentId}`);
        if (showDateStatus) {
          showDateStatus.textContent = state.showDate ? 'Activado' : 'Desactivado';
        }
        
        const showDescriptionStatus = document.getElementById(`timeline-show-description-status-${componentId}`);
        if (showDescriptionStatus) {
          showDescriptionStatus.textContent = state.showDescription ? 'Activado' : 'Desactivado';
        }
        
        const showIconStatus = document.getElementById(`timeline-show-icon-status-${componentId}`);
        if (showIconStatus) {
          showIconStatus.textContent = state.showIcon ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… Timeline preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del Timeline
      window.setTimelineControl = function(option, value, componentId) {
        const state = initTimelinePreviewState(componentId);
        
        if (option === 'alignment') {
          state.alignment = value || 'left';
          const select = document.getElementById(`timeline-alignment-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'filledItems') {
          state.filledItems = Math.max(0, Math.min(4, parseInt(value) || 0));
          const select = document.getElementById(`timeline-filled-items-select-${componentId}`);
          if (select) select.value = state.filledItems;
        } else if (option === 'showAvatar') {
          state.showAvatar = value === true || value === 'true';
          // Si se activa avatar, desactivar icono
          if (state.showAvatar) {
            state.showIcon = false;
            const iconToggle = document.getElementById(`timeline-show-icon-toggle-${componentId}`);
            if (iconToggle) {
              iconToggle.checked = false;
              if (typeof window.updateToggleState === 'function') {
                window.updateToggleState(iconToggle);
              }
            }
            const iconStatus = document.getElementById(`timeline-show-icon-status-${componentId}`);
            if (iconStatus) iconStatus.textContent = 'Desactivado';
          }
          const toggle = document.getElementById(`timeline-show-avatar-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showAvatar;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`timeline-show-avatar-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showAvatar ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showDate') {
          state.showDate = value === true || value === 'true';
          const toggle = document.getElementById(`timeline-show-date-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showDate;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`timeline-show-date-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showDate ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showDescription') {
          state.showDescription = value === true || value === 'true';
          const toggle = document.getElementById(`timeline-show-description-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showDescription;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`timeline-show-description-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showDescription ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showIcon') {
          state.showIcon = value === true || value === 'true';
          // Si se activa icono, desactivar avatar
          if (state.showIcon) {
            state.showAvatar = false;
            const avatarToggle = document.getElementById(`timeline-show-avatar-toggle-${componentId}`);
            if (avatarToggle) {
              avatarToggle.checked = false;
              if (typeof window.updateToggleState === 'function') {
                window.updateToggleState(avatarToggle);
              }
            }
            const avatarStatus = document.getElementById(`timeline-show-avatar-status-${componentId}`);
            if (avatarStatus) avatarStatus.textContent = 'Desactivado';
          }
          const toggle = document.getElementById(`timeline-show-icon-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showIcon;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`timeline-show-icon-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showIcon ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        window.updateTimelinePreview(componentId);
      };
      
      // ========================================
      // TREEMENU PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del TreeMenu
      const treeMenuPreviewState = {};
      
      // Inicializar estado del TreeMenu
      function initTreeMenuPreviewState(componentId) {
        if (!treeMenuPreviewState[componentId]) {
          treeMenuPreviewState[componentId] = {
            showIcons: true,
            showChevron: true,
            maxLevels: 3,
            defaultExpanded: false,
            size: 'md',
            cascade: true
          };
        }
        return treeMenuPreviewState[componentId];
      }
      
      // FunciÃ³n helper para renderizar icono FontAwesome
      function renderTreeMenuIcon(iconName, style = 'regular') {
        const iconClass = style === 'solid' ? 'fas' : 'far';
        return `<i class="${iconClass} fa-${iconName}"></i>`;
      }
      
      // FunciÃ³n para generar datos de ejemplo segÃºn niveles
      function generateTreeMenuData(maxLevels, showIcons) {
        if (maxLevels === 1) {
          return [
            { label: 'Engineering', icon: showIcons ? 'code' : undefined },
            { label: 'Marketing', icon: showIcons ? 'chart-line' : undefined },
            { label: 'Operations', icon: showIcons ? 'cog' : undefined },
          ];
        }
        
        if (maxLevels === 2) {
          return [
            {
              label: 'Engineering',
              icon: showIcons ? 'code' : undefined,
              children: [
                { label: 'Frontend', icon: showIcons ? 'paint-brush' : undefined },
                { label: 'Backend', icon: showIcons ? 'server' : undefined },
                { label: 'Platform Team', icon: showIcons ? 'cog' : undefined },
              ],
            },
            {
              label: 'Marketing',
              icon: showIcons ? 'chart-line' : undefined,
              children: [
                { label: 'Content', icon: showIcons ? 'file-alt' : undefined },
                { label: 'SEO', icon: showIcons ? 'search' : undefined },
              ],
            },
            {
              label: 'Operations',
              icon: showIcons ? 'cog' : undefined,
              children: [
                { label: 'Support', icon: showIcons ? 'headset' : undefined },
              ],
            },
          ];
        }
        
        if (maxLevels === 3) {
          return [
            {
              label: 'Engineering',
              icon: showIcons ? 'code' : undefined,
              children: [
                {
                  label: 'Frontend',
                  icon: showIcons ? 'paint-brush' : undefined,
                  children: [
                    {
                      label: 'Design System',
                      icon: showIcons ? 'palette' : undefined,
                      children: [
                        { label: 'Components', icon: showIcons ? 'cubes' : undefined },
                        { label: 'Tokens', icon: showIcons ? 'tags' : undefined },
                        { label: 'Guidelines', icon: showIcons ? 'book' : undefined },
                      ],
                    },
                    { label: 'Web Platform', icon: showIcons ? 'globe' : undefined },
                  ],
                },
                { label: 'Backend', icon: showIcons ? 'server' : undefined },
                { label: 'Platform Team', icon: showIcons ? 'cog' : undefined },
              ],
            },
            {
              label: 'Marketing',
              icon: showIcons ? 'chart-line' : undefined,
              children: [
                { label: 'Content', icon: showIcons ? 'file-alt' : undefined },
              ],
            },
            {
              label: 'Operations',
              icon: showIcons ? 'cog' : undefined,
            },
          ];
        }
        
        if (maxLevels === 4) {
          return [
            {
              label: 'Engineering',
              icon: showIcons ? 'code' : undefined,
              children: [
                {
                  label: 'Frontend',
                  icon: showIcons ? 'paint-brush' : undefined,
                  children: [
                    {
                      label: 'Design System',
                      icon: showIcons ? 'palette' : undefined,
                      children: [
                        {
                          label: 'Components',
                          icon: showIcons ? 'cubes' : undefined,
                          children: [
                            { label: 'Button', icon: showIcons ? 'square' : undefined },
                            { label: 'Input', icon: showIcons ? 'keyboard' : undefined },
                          ],
                        },
                        { label: 'Tokens', icon: showIcons ? 'tags' : undefined },
                        { label: 'Guidelines', icon: showIcons ? 'book' : undefined },
                      ],
                    },
                    { label: 'Web Platform', icon: showIcons ? 'globe' : undefined },
                  ],
                },
                { label: 'Backend', icon: showIcons ? 'server' : undefined },
              ],
            },
            {
              label: 'Marketing',
              icon: showIcons ? 'chart-line' : undefined,
            },
          ];
        }
        
        // maxLevels === 5
        return [
          {
            label: 'Engineering',
            icon: showIcons ? 'code' : undefined,
            children: [
              {
                label: 'Frontend',
                icon: showIcons ? 'paint-brush' : undefined,
                children: [
                  {
                    label: 'Design System',
                    icon: showIcons ? 'palette' : undefined,
                    children: [
                      {
                        label: 'Components',
                        icon: showIcons ? 'cubes' : undefined,
                        children: [
                          {
                            label: 'Button',
                            icon: showIcons ? 'square' : undefined,
                            children: [
                              { label: 'Primary', icon: showIcons ? 'circle' : undefined },
                              { label: 'Secondary', icon: showIcons ? 'circle' : undefined },
                            ],
                          },
                          { label: 'Input', icon: showIcons ? 'keyboard' : undefined },
                        ],
                      },
                      { label: 'Tokens', icon: showIcons ? 'tags' : undefined },
                    ],
                  },
                ],
              },
            ],
          },
        ];
      }
      
      // FunciÃ³n para escapar HTML
      function escapeTreeMenuHtml(text) {
        if (typeof text !== 'string') return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
      
      // FunciÃ³n para renderizar un nodo del Ã¡rbol
      function renderTreeMenuTreeNode(node, level, maxLevels, defaultExpanded, showIcons, showChevron, cascade, size, uniqueId) {
        const hasChildren = node.children && node.children.length > 0;
        const nodeId = `${uniqueId}-node-${level}-${node.label.toLowerCase().replace(/\s+/g, '-')}`;
        const isExpanded = defaultExpanded && hasChildren;
        
        // Clases de tipografÃ­a segÃºn tamaÃ±o
        const typographyClass = size === 'sm' 
          ? 'ubits-body-sm-regular' 
          : size === 'lg' 
          ? 'ubits-body-lg-regular' 
          : 'ubits-body-md-regular';
        
        // Espaciado segÃºn modo
        const paddingLeft = cascade 
          ? (size === 'sm' 
            ? `calc(var(--ubits-spacing-md, 16px) * ${level})` 
            : size === 'lg'
            ? `calc(var(--ubits-spacing-lg, 24px) * ${level})`
            : `calc(var(--ubits-spacing-md, 16px) * ${level})`)
          : '0';
        
        const iconSize = size === 'sm' ? '14px' : size === 'lg' ? '18px' : '16px';
        const chevronSize = size === 'sm' ? '12px' : size === 'lg' ? '16px' : '14px';
        
        let html = `
          <div class="ubits-tree-node ${cascade ? 'ubits-tree-node--cascade' : 'ubits-tree-node--vertical'}" data-level="${level}" style="${cascade ? `padding-left: ${paddingLeft};` : ''}">
            <div 
              class="ubits-tree-node__content ${hasChildren ? 'ubits-tree-node__content--expandable' : ''}" 
              data-node-id="${nodeId}"
              ${hasChildren ? `data-expanded="${isExpanded}"` : ''}
              role="${hasChildren ? 'button' : 'treeitem'}"
              ${hasChildren ? 'tabindex="0"' : ''}
              aria-expanded="${hasChildren ? isExpanded : undefined}"
              aria-label="${escapeTreeMenuHtml(node.label)}"
            >
              ${hasChildren && showChevron ? `
                <span class="ubits-tree-node__chevron" style="width: ${chevronSize}; height: ${chevronSize};">
                  <i class="far fa-chevron-${isExpanded ? 'down' : 'right'}" style="font-size: ${chevronSize};"></i>
                </span>
              ` : hasChildren && !showChevron ? `
                <span class="ubits-tree-node__chevron" style="width: 0; height: 0; display: none;"></span>
              ` : `
                <span class="ubits-tree-node__chevron" style="width: 0; height: 0; display: none;"></span>
              `}
              ${showIcons && node.icon ? `
                <span class="ubits-tree-node__icon" style="font-size: ${iconSize};">
                  ${renderTreeMenuIcon(node.icon, 'regular')}
                </span>
              ` : ''}
              <span class="ubits-tree-node__label ${typographyClass}">${escapeTreeMenuHtml(node.label)}</span>
            </div>
            ${hasChildren ? `
              <div class="ubits-tree-node__children ${cascade ? 'ubits-tree-node__children--cascade' : 'ubits-tree-node__children--vertical'}" data-children-id="${nodeId}" style="display: ${isExpanded ? 'block' : 'none'};">
                ${node.children.map(child => 
                  renderTreeMenuTreeNode(child, level + 1, maxLevels, defaultExpanded, showIcons, showChevron, cascade, size, uniqueId)
                ).join('')}
              </div>
            ` : ''}
          </div>
        `;
        
        return html;
      }
      
      // FunciÃ³n para actualizar el preview del TreeMenu
      window.updateTreeMenuPreview = function(componentId) {
        const state = initTreeMenuPreviewState(componentId);
        const preview = document.getElementById(`tree-menu-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de TreeMenu no encontrado:', `tree-menu-preview-${componentId}`);
          return;
        }
        
        // Cargar CSS del TreeMenu si no estÃ¡ cargado
        const treeMenuCSSId = 'ubits-tree-menu-css';
        if (!document.getElementById(treeMenuCSSId)) {
          const style = document.createElement('style');
          style.id = treeMenuCSSId;
          style.textContent = `
            .ubits-tree-menu {
              width: 100%;
              user-select: none;
            }
            
            .ubits-tree-node {
              position: relative;
            }
            
            .ubits-tree-node__content {
              display: flex;
              align-items: center;
              gap: var(--ubits-spacing-sm, 8px);
              padding: var(--ubits-spacing-xs, 4px) var(--ubits-spacing-sm, 8px);
              border-radius: 6px;
              cursor: pointer;
              transition: all 0.2s ease;
              color: var(--ubits-fg-1-high, #303a47);
              background: transparent;
              position: relative;
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) {
              background: var(--ubits-bg-2, #F3F3F4);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__chevron {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__icon {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content:hover:not(.ubits-tree-node__content--active) .ubits-tree-node__label {
              color: var(--ubits-fg-1-high, #303a47);
            }
            
            .ubits-tree-node__content--active,
            .ubits-tree-node__content[aria-selected="true"] {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              background: var(--ubits-bg-active-button, rgba(12, 91, 239, 0.15));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__chevron,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__chevron {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__icon,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__icon {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
            }
            
            .ubits-tree-node__content--active .ubits-tree-node__label,
            .ubits-tree-node__content[aria-selected="true"] .ubits-tree-node__label {
              color: var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              font-weight: var(--weight-semibold, 600);
            }
            
            .ubits-tree-node__content--expandable:focus-visible {
              outline: 2px solid var(--ubits-button-active-fg, var(--ubits-accent-brand-static));
              outline-offset: -2px;
              border-radius: 6px;
            }
            
            .ubits-tree-node__chevron {
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              color: var(--ubits-fg-1-medium, #5c646f);
              transition: color 0.2s ease;
            }
            
            .ubits-tree-node__icon {
              display: flex;
              align-items: center;
              justify-content: center;
              flex-shrink: 0;
              color: var(--ubits-fg-1-medium, #5c646f);
              width: 20px;
              transition: color 0.2s ease;
            }
            
            .ubits-tree-node__label {
              flex: 1;
              color: var(--ubits-fg-1-high, #303a47);
              transition: color 0.2s ease, font-weight 0.2s ease;
            }
            
            .ubits-tree-node__children {
              margin-top: 2px;
            }
            
            .ubits-tree-menu--vertical .ubits-tree-node {
              padding-left: 0 !important;
            }
            
            .ubits-tree-menu--vertical .ubits-tree-node__children {
              margin-left: 0;
              padding-left: 0;
            }
            
            .ubits-tree-menu--cascade .ubits-tree-node__children {
              margin-left: 0;
            }
          `;
          document.head.appendChild(style);
        }
        
        // Generar datos del Ã¡rbol
        const treeData = generateTreeMenuData(state.maxLevels, state.showIcons);
        const uniqueId = `tree-${Date.now()}-${componentId}`;
        const cascadeClass = state.cascade ? 'ubits-tree-menu--cascade' : 'ubits-tree-menu--vertical';
        
        // Renderizar nodos
        const nodesHtml = treeData.map(node => 
          renderTreeMenuTreeNode(node, 0, state.maxLevels, state.defaultExpanded, state.showIcons, state.showChevron, state.cascade, state.size, uniqueId)
        ).join('');
        
        const treeHTML = `<div class="ubits-tree-menu ${cascadeClass}" id="${uniqueId}" role="tree">${nodesHtml}</div>`;
        preview.innerHTML = treeHTML;
        
        // Agregar funcionalidad de expandir/colapsar y selecciÃ³n
        setTimeout(() => {
          const treeElement = preview.querySelector('.ubits-tree-menu');
          if (treeElement) {
            // Remover listeners anteriores si existen
            const newTreeElement = treeElement.cloneNode(true);
            treeElement.parentNode.replaceChild(newTreeElement, treeElement);
            
            newTreeElement.addEventListener('click', (e) => {
              const target = e.target;
              const content = target.closest('.ubits-tree-node__content');
              
              if (!content) return;
              
              // Manejar expandir/colapsar para nodos con hijos
              if (content.classList.contains('ubits-tree-node__content--expandable')) {
                const nodeId = content.getAttribute('data-node-id');
                const children = newTreeElement.querySelector(`[data-children-id="${nodeId}"]`);
                const chevron = content.querySelector('.ubits-tree-node__chevron i');
                const isExpanded = content.getAttribute('data-expanded') === 'true';
                
                if (children) {
                  if (isExpanded) {
                    children.style.display = 'none';
                    content.setAttribute('data-expanded', 'false');
                    content.setAttribute('aria-expanded', 'false');
                    if (chevron && state.showChevron) {
                      chevron.className = 'far fa-chevron-right';
                    }
                  } else {
                    children.style.display = 'block';
                    content.setAttribute('data-expanded', 'true');
                    content.setAttribute('aria-expanded', 'true');
                    if (chevron && state.showChevron) {
                      chevron.className = 'far fa-chevron-down';
                    }
                  }
                }
              }
              
              // Manejar selecciÃ³n (active state) para todos los nodos
              const allContents = newTreeElement.querySelectorAll('.ubits-tree-node__content');
              allContents.forEach((node) => {
                node.classList.remove('ubits-tree-node__content--active');
                node.removeAttribute('aria-selected');
              });
              
              // Agregar active al nodo clickeado
              content.classList.add('ubits-tree-node__content--active');
              content.setAttribute('aria-selected', 'true');
            });
            
            // Soporte para teclado
            newTreeElement.addEventListener('keydown', (e) => {
              const target = e.target;
              const content = target.closest('.ubits-tree-node__content');
              
              if (!content) return;
              
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                content.click();
              }
            });
          }
        }, 100);
        
        // Actualizar estados de toggles
        const showIconsToggle = document.getElementById(`tree-menu-show-icons-toggle-${componentId}`);
        if (showIconsToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showIconsToggle);
        }
        
        const showChevronToggle = document.getElementById(`tree-menu-show-chevron-toggle-${componentId}`);
        if (showChevronToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(showChevronToggle);
        }
        
        const defaultExpandedToggle = document.getElementById(`tree-menu-default-expanded-toggle-${componentId}`);
        if (defaultExpandedToggle && typeof window.updateToggleState === 'function') {
          window.updateToggleState(defaultExpandedToggle);
        }
        
        // Actualizar textos de estado
        const showIconsStatus = document.getElementById(`tree-menu-show-icons-status-${componentId}`);
        if (showIconsStatus) {
          showIconsStatus.textContent = state.showIcons ? 'Activado' : 'Desactivado';
        }
        
        const showChevronStatus = document.getElementById(`tree-menu-show-chevron-status-${componentId}`);
        if (showChevronStatus) {
          showChevronStatus.textContent = state.showChevron ? 'Activado' : 'Desactivado';
        }
        
        const defaultExpandedStatus = document.getElementById(`tree-menu-default-expanded-status-${componentId}`);
        if (defaultExpandedStatus) {
          defaultExpandedStatus.textContent = state.defaultExpanded ? 'Activado' : 'Desactivado';
        }
        
        console.log('âœ… TreeMenu preview actualizado:', state);
      };
      
      // FunciÃ³n unificada para controles del TreeMenu
      window.setTreeMenuControl = function(option, value, componentId) {
        const state = initTreeMenuPreviewState(componentId);
        
        if (option === 'size') {
          state.size = value || 'md';
          const select = document.getElementById(`tree-menu-size-select-${componentId}`);
          if (select) select.value = value;
        } else if (option === 'maxLevels') {
          state.maxLevels = Math.max(1, Math.min(5, parseInt(value) || 3));
          const select = document.getElementById(`tree-menu-max-levels-select-${componentId}`);
          if (select) select.value = state.maxLevels;
        } else if (option === 'cascade') {
          state.cascade = value === true || value === 'true';
          const select = document.getElementById(`tree-menu-cascade-select-${componentId}`);
          if (select) select.value = state.cascade ? 'true' : 'false';
        } else if (option === 'showIcons') {
          state.showIcons = value === true || value === 'true';
          const toggle = document.getElementById(`tree-menu-show-icons-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showIcons;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`tree-menu-show-icons-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showIcons ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'showChevron') {
          state.showChevron = value === true || value === 'true';
          const toggle = document.getElementById(`tree-menu-show-chevron-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.showChevron;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`tree-menu-show-chevron-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.showChevron ? 'Activado' : 'Desactivado';
          }
        } else if (option === 'defaultExpanded') {
          state.defaultExpanded = value === true || value === 'true';
          const toggle = document.getElementById(`tree-menu-default-expanded-toggle-${componentId}`);
          if (toggle) {
            toggle.checked = state.defaultExpanded;
            if (typeof window.updateToggleState === 'function') {
              window.updateToggleState(toggle);
            }
          }
          const statusSpan = document.getElementById(`tree-menu-default-expanded-status-${componentId}`);
          if (statusSpan) {
            statusSpan.textContent = state.defaultExpanded ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        window.updateTreeMenuPreview(componentId);
      };
      
      // ========================================
      // CALENDAR PREVIEW FUNCTIONS (usando CalendarProvider)
      // ========================================
      
      // Sobrescribir updateCalendarPreview para usar CalendarProvider
      if (typeof window.updateCalendarPreview === 'undefined') {
        window.updateCalendarPreview = async function(componentId) {
          console.log('ğŸ“… [updateCalendarPreview] Iniciando actualizaciÃ³n del preview del calendario...');
          const state = initCalendarPreviewState(componentId);
          const preview = document.getElementById(`calendar-preview-container-${componentId}`);
          
          if (!preview) {
            console.error('âŒ [updateCalendarPreview] Preview container no encontrado:', `calendar-preview-container-${componentId}`);
            return;
          }
          
          console.log('ğŸ“… [updateCalendarPreview] Estado del calendario:', state);
          
          // Cargar CSS si no estÃ¡ cargado
          const existingCalendarLink = document.querySelector('link[href*="calendar.css"]');
          if (!existingCalendarLink) {
            console.log('ğŸ“… [updateCalendarPreview] Cargando CSS del calendario...');
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/calendar/src/styles/calendar.css';
            document.head.appendChild(link);
          }
          
          // Cargar CSS de scroll si no estÃ¡ cargado (para el scrollbar de las listas)
          const existingScrollLink = document.querySelector('link[href*="scroll.css"]');
          if (!existingScrollLink) {
            console.log('ğŸ“… [updateCalendarPreview] Cargando CSS del scrollbar...');
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/scroll/src/styles/scroll.css';
            document.head.appendChild(link);
          }
          
          // Cargar CSS de button, input y list si no estÃ¡n cargados
          const existingButtonLink = document.querySelector('link[href*="button.css"]');
          if (!existingButtonLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/button/src/styles/button.css';
            document.head.appendChild(link);
          }
          
          const existingInputLink = document.querySelector('link[href*="input.css"]');
          if (!existingInputLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/input/src/styles/input.css';
            document.head.appendChild(link);
          }
          
          const existingListLink = document.querySelector('link[href*="list.css"]');
          if (!existingListLink) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '../../addons/list/src/styles/list.css';
            document.head.appendChild(link);
          }
          
          // Limpiar preview anterior
          preview.innerHTML = '';
          
          // Importar y crear el calendario dinÃ¡micamente
          try {
            console.log('ğŸ“… [updateCalendarPreview] Importando CalendarProvider...');
            // Intentar importar desde dist primero, luego desde src
            let calendarModule;
            try {
              calendarModule = await import('../../addons/calendar/dist/index.js');
            } catch (e) {
              console.log('ğŸ“… [updateCalendarPreview] Intentando importar desde src...');
              calendarModule = await import('../../addons/calendar/src/CalendarProvider.js');
            }
            const { createCalendar } = calendarModule;
            console.log('âœ… [updateCalendarPreview] CalendarProvider importado correctamente');
            
            // Crear instancia del calendario
            console.log('ğŸ“… [updateCalendarPreview] Creando instancia del calendario con modo:', state.mode);
            const calendarInstance = createCalendar({
              mode: state.mode,
              selectedDate: state.selectedDate,
              endDate: state.endDate,
              onDateSelect: (date) => {
                console.log('ğŸ“… [updateCalendarPreview] Fecha seleccionada:', date);
                state.selectedDate = date;
              },
              onRangeSelect: (startDate, endDate) => {
                console.log('ğŸ“… [updateCalendarPreview] Rango seleccionado:', startDate, 'a', endDate);
                state.selectedDate = startDate;
                state.endDate = endDate;
              }
            });
            
            console.log('âœ… [updateCalendarPreview] Calendario creado:', calendarInstance);
            
            // Agregar el calendario al preview
            preview.appendChild(calendarInstance.element);
            
            console.log('âœ… [updateCalendarPreview] Preview del calendario actualizado correctamente');
          } catch (error) {
            console.error('âŒ [updateCalendarPreview] Error al crear el calendario:', error);
            preview.innerHTML = `
              <div style="padding: 24px; background: var(--ubits-bg-1); border: 1px solid var(--ubits-border-1); border-radius: 8px; color: var(--ubits-fg-1-high);">
                <p style="margin: 0 0 8px 0; font-weight: var(--weight-semibold);">Error al cargar el calendario</p>
                <p style="margin: 0; font-size: var(--font-body-sm-size); color: var(--ubits-fg-1-medium);">${error.message}</p>
              </div>
            `;
          }
        };
      }
      
      // FunciÃ³n para establecer controles del Calendar (sobrescribir si no existe)
      if (typeof window.setCalendarControl === 'undefined') {
        window.setCalendarControl = function(option, value, componentId) {
          console.log('ğŸ“… [setCalendarControl] Actualizando control:', option, '=', value);
          const state = initCalendarPreviewState(componentId);
          
          if (option === 'mode') {
            state.mode = value;
            state.endDate = null; // Reset endDate cuando cambia el modo
          } else if (option === 'selectedDate') {
            state.selectedDate = value ? new Date(value) : null;
          } else if (option === 'endDate') {
            state.endDate = value ? new Date(value) : null;
          }
          
          // Actualizar el preview
          window.updateCalendarPreview(componentId);
          
          console.log('âœ… [setCalendarControl] Control actualizado:', option, value);
        };
      }
      
      // FunciÃ³n para renderizar la barra de acciones
      function renderActionBar(componentId, state, container) {
        console.log('ğŸ¯ [ACTION BAR] Iniciando renderizado...');
        
        // Obtener estado mÃ¡s reciente
        const currentState = initDataTablePreviewState(componentId);
        state = currentState;
        
        // Buscar contenedor y header
        const dataTableContainer = document.getElementById(`data-table-container-${componentId}`);
        if (!dataTableContainer) {
          console.error('ğŸ¯ [ACTION BAR] âŒ Contenedor no encontrado');
          return;
        }
        
        const header = dataTableContainer.querySelector('.ubits-data-table__header');
        if (!header) {
          console.error('ğŸ¯ [ACTION BAR] âŒ Header no encontrado');
          return;
        }
        
        // Buscar o crear barra
        let actionBar = dataTableContainer.querySelector('.ubits-data-table__action-bar');
        if (!actionBar) {
          actionBar = document.createElement('div');
          actionBar.className = 'ubits-data-table__action-bar';
          actionBar.style.cssText = `
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: var(--ubits-spacing-sm) 0;
            gap: var(--ubits-spacing-xs);
            flex-wrap: wrap;
            background-color: var(--ubits-bg-1);
          `;
          header.insertAdjacentElement('afterend', actionBar);
        }
        
        // Buscar columna checkbox
        const checkboxColumn = state.columns.find(col => col.id === 'checkbox-2');
        if (!checkboxColumn) {
          console.error('ğŸ¯ [ACTION BAR] âŒ Columna checkbox-2 no encontrada');
          return;
        }
        
        // Contar selecciones - IMPORTANTE: contar en TODAS las filas originales, no en las filtradas
        // El estado puede tener las filas filtradas cuando viewSelectedActive estÃ¡ activo,
        // pero necesitamos contar todas las selecciones, no solo las visibles
        const selectedRows = state.rows.filter((row) => {
          return row.data && row.data[checkboxColumn.id] === true;
        });
        
        const selectedCount = selectedRows.length;
        const selectedIds = selectedRows.map(r => r.id);
        console.log('ğŸ¯ [ACTION BAR] Selecciones encontradas:', selectedCount, 'IDs:', selectedIds, 'viewSelectedActive:', state.viewSelectedActive);
        
        // IMPORTANTE: La barra debe mostrarse SIEMPRE que haya selecciones,
        // independientemente de si viewSelectedActive estÃ¡ activo o no
        // Esto es diferente a ocultar cuando no hay selecciones
        if (selectedCount === 0) {
          actionBar.style.display = 'none';
          console.log('ğŸ¯ [ACTION BAR] Barra ocultada - sin selecciones');
          return;
        }
        
        // Mostrar barra SIEMPRE que haya selecciones (incluso si viewSelectedActive estÃ¡ activo)
        actionBar.style.display = 'flex';
        console.log('ğŸ¯ [ACTION BAR] Barra mostrada -', selectedCount, 'selecciÃ³n(es)');
        
        const countText = `(${selectedCount})`;
        const isMultipleSelection = selectedCount > 1;
        
        // Estado del botÃ³n "Ver seleccionados" (compartido entre ambos modos)
        const isViewSelectedActive = state.viewSelectedActive || false;
        const viewSelectedText = isViewSelectedActive
          ? `Dejar de ver seleccionados ${countText}`
          : `Ver seleccionados ${countText}`;
        const viewSelectedIcon = isViewSelectedActive ? 'eye-slash' : 'eye';
        
        // FunciÃ³n helper para renderizar botones (usa renderButton si estÃ¡ disponible, sino HTML directo)
        const renderButtonHelper = (options) => {
          if (typeof window.renderButton !== 'undefined') {
            return window.renderButton(options);
          }
          // Fallback: generar HTML directamente usando la misma estructura que renderButton
          const { variant = 'secondary', size = 'sm', text = '', icon, iconStyle = 'regular', iconOnly = false, active = false, className = '', attributes = {} } = options;
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const iconName = icon ? (icon.startsWith('fa-') ? icon : `fa-${icon}`) : '';
          const iconHTML = iconName ? `<i class="${iconClass} ${iconName}"></i>` : '';
          const textHTML = text ? `<span>${text}</span>` : '';
          const classes = [
            'ubits-button',
            `ubits-button--${variant}`,
            `ubits-button--${size}`,
            active && 'ubits-button--active',
            iconOnly && 'ubits-button--icon-only',
            className
          ].filter(Boolean).join(' ');
          const attrs = Object.entries(attributes).map(([key, value]) => `${key}="${value}"`).join(' ');
          return `<button class="${classes}" ${attrs} type="button">${iconHTML}${textHTML}</button>`;
        };
        
        // Usar fallback HTML directamente si renderButton no estÃ¡ disponible (sin esperar)
        const renderButtonsNow = () => {
          // Verificar rÃ¡pidamente si renderButton estÃ¡ disponible (solo 1 intento)
          if (typeof window.renderButton === 'undefined') {
            // Usar fallback HTML inmediatamente
          } else {
            console.log('ğŸ¯ [ACTION BAR] renderButton disponible, renderizando botones...');
          }
          
          let buttonsHTML = '';
          
          // Construir array de botones segÃºn los estados de los controladores
          const buttons = [];
          
          // Ver seleccionados - siempre disponible si estÃ¡ habilitado
          if (state.showViewSelected !== false) {
            buttons.push({
              variant: 'secondary',
              size: 'sm',
              text: viewSelectedText,
              icon: viewSelectedIcon,
              iconStyle: 'regular',
              active: isViewSelectedActive,
              attributes: { id: 'action-btn-view-selected' }
            });
          }
          
          // Notificaciones - solo si estÃ¡ habilitado
          if (state.showNotifications !== false) {
            buttons.push({
              variant: 'secondary',
              size: 'sm',
              icon: 'bell',
              iconStyle: 'regular',
              iconOnly: true,
              attributes: { id: 'action-btn-notifications' }
            });
          }
          
          // Solo mostrar otros botones si hay 1 selecciÃ³n (modo individual)
          if (!isMultipleSelection) {
            // Copiar - solo si estÃ¡ habilitado
            if (state.showCopy !== false) {
              buttons.push({
                variant: 'secondary',
                size: 'sm',
                icon: 'copy',
                iconStyle: 'regular',
                iconOnly: true,
                attributes: { id: 'action-btn-copy' }
              });
            }
            
            // Ver - solo si estÃ¡ habilitado
            if (state.showView !== false) {
              buttons.push({
                variant: 'secondary',
                size: 'sm',
                icon: 'eye',
                iconStyle: 'regular',
                iconOnly: true,
                attributes: { id: 'action-btn-view' }
              });
            }
            
            // Editar - solo si estÃ¡ habilitado
            if (state.showEdit !== false) {
              buttons.push({
                variant: 'secondary',
                size: 'sm',
                icon: 'edit',
                iconStyle: 'regular',
                iconOnly: true,
                attributes: { id: 'action-btn-edit' }
              });
            }
            
            // Descargar - solo si estÃ¡ habilitado
            if (state.showDownload !== false) {
              buttons.push({
                variant: 'secondary',
                size: 'sm',
                icon: 'download',
                iconStyle: 'regular',
                iconOnly: true,
                attributes: { id: 'action-btn-download' }
              });
            }
          }
          
          // Eliminar - siempre disponible si estÃ¡ habilitado
          if (state.showDelete !== false) {
            buttons.push({
              variant: 'secondary',
              size: 'sm',
              icon: 'trash',
              iconStyle: 'regular',
              iconOnly: true,
              className: 'ubits-button--error',
              attributes: { id: 'action-btn-delete' }
            });
          }
          
          // Renderizar todos los botones
          buttonsHTML = buttons.map(btn => renderButtonHelper(btn)).join('');
        
          actionBar.innerHTML = buttonsHTML;
          
          // CRÃTICO: Agregar listeners DESPUÃ‰S de establecer innerHTML
          // Usar setTimeout para asegurar que el DOM estÃ© actualizado
          setTimeout(() => {
            // Listener para "Ver seleccionados"
            const viewSelectedBtn = actionBar.querySelector('#action-btn-view-selected');
            if (viewSelectedBtn) {
              // Remover listener anterior si existe
              const newBtn = viewSelectedBtn.cloneNode(true);
              viewSelectedBtn.parentNode?.replaceChild(newBtn, viewSelectedBtn);
              
              newBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('ğŸ¯ [ACTION BAR] Click en Ver seleccionados');
                const newState = initDataTablePreviewState(componentId);
                newState.viewSelectedActive = !isViewSelectedActive;
                // Re-renderizar tabla con filtro
                if (window.dataTableInstances[componentId]) {
                  try {
                    window.dataTableInstances[componentId].destroy();
                  } catch (e) {
                    console.warn('Error destruyendo instancia:', e);
                  }
                  delete window.dataTableInstances[componentId];
                }
                // Recrear la tabla
                setTimeout(() => {
                  window.updateDataTablePreview(componentId);
                  // IMPORTANTE: Llamar a renderActionBar despuÃ©s de que la tabla se haya actualizado
                  setTimeout(() => {
                    const container = document.getElementById(`data-table-container-${componentId}`);
                    if (container) {
                      const latestState = initDataTablePreviewState(componentId);
                      renderActionBar(componentId, latestState, container);
                    }
                  }, 300);
                }, 50);
              });
            }
            
            // Otros botones - agregar listeners a todos los botones disponibles
            ['notifications', 'copy', 'view', 'edit', 'download', 'delete'].forEach(action => {
              const btn = actionBar.querySelector(`#action-btn-${action}`);
              if (btn) {
                // Remover listener anterior si existe
                const newBtn = btn.cloneNode(true);
                btn.parentNode?.replaceChild(newBtn, btn);
                
                newBtn.addEventListener('click', (e) => {
                  e.preventDefault();
                  e.stopPropagation();
                  console.log(`ğŸ¯ [ACTION BAR] Click en ${action}`, selectedIds);
                  alert(`AcciÃ³n: ${action} para ${selectedCount} elemento(s)`);
                });
              }
            });
            
            console.log('ğŸ¯ [ACTION BAR] âœ… Listeners agregados correctamente');
          }, 0);
          
          console.log('ğŸ¯ [ACTION BAR] âœ… Renderizado completado');
        };
        
        // Renderizar inmediatamente sin esperar
        renderButtonsNow();
      }
      
      // Hacer la funciÃ³n accesible globalmente para debugging
      window.renderActionBar = renderActionBar;
      
      // FunciÃ³n para toggle de acordeones del Data Table
      // FunciÃ³n para inicializar acordeones UBITS del Data Table
      window.initDataTableAccordions = function(componentId) {
        const componentElement = document.getElementById(`component-data-table`);
        if (!componentElement) return;
        
        const allAccordionItems = componentElement.querySelectorAll('.ubits-accordion-item');
        if (allAccordionItems.length === 0) return;
        
        // Inicializar cada acordeÃ³n
        allAccordionItems.forEach(item => {
          const header = item.querySelector('.ubits-accordion-header');
          if (!header) return;
          
          const headerId = header.getAttribute('data-header-id');
          if (!headerId) return;
          
          const body = item.querySelector(`[data-body-id="${headerId}"]`);
          const chevron = item.querySelector(`[data-chevron-id="${headerId}"]`);
          if (!body || !chevron) return;
          
          // Remover listeners anteriores si existen
          const newHeader = header.cloneNode(true);
          header.parentNode.replaceChild(newHeader, header);
          
          // Agregar event listener
          newHeader.addEventListener('click', (e) => {
            e.stopPropagation();
            
            const isOpen = body.style.display === 'block';
            
            // Cerrar todos los demÃ¡s acordeones (solo uno abierto a la vez)
            allAccordionItems.forEach(otherItem => {
              if (otherItem !== item) {
                const otherBody = otherItem.querySelector('.ubits-accordion-body');
                const otherChevron = otherItem.querySelector('.ubits-accordion-chevron');
                const otherHeader = otherItem.querySelector('.ubits-accordion-header');
                
                if (otherBody && otherChevron && otherHeader) {
                  otherBody.style.display = 'none';
                  otherChevron.style.transform = 'rotate(0deg)';
                  otherHeader.classList.remove('ubits-accordion-header--open');
                }
              }
            });
            
            // Toggle del acordeÃ³n actual
            if (isOpen) {
              body.style.display = 'none';
              chevron.style.transform = 'rotate(0deg)';
              newHeader.classList.remove('ubits-accordion-header--open');
            } else {
              body.style.display = 'block';
              chevron.style.transform = 'rotate(180deg)';
              newHeader.classList.add('ubits-accordion-header--open');
              
              // Si es el acordeÃ³n de columnas, generar los selectores si no existen
              if (headerId.startsWith('columns-')) {
                setTimeout(() => {
                  const columnTypesContainer = document.getElementById(`data-table-column-types-${componentId}`);
                  if (columnTypesContainer && (!columnTypesContainer.innerHTML || columnTypesContainer.innerHTML.trim() === '')) {
                    if (window.generateColumnTypeSelectors) {
                      window.generateColumnTypeSelectors(componentId);
                    }
                  }
                }, 50);
              }
            }
          });
        });
      };
      
      // ========================================
      // FUNCIONES DE CONTROL PARA SIMPLE CARD
      // ========================================
      
      // FunciÃ³n para controlar SimpleCard
      window.setSimpleCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setSimpleCardControl:', option, value, componentId);
        
        // Actualizar estado activo de botones
        if (option === 'variant') {
          document.querySelectorAll(`[data-component="${componentId}"][data-option="variant"]`).forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('data-value') === value) {
              btn.classList.add('active');
            }
          });
        }
        
        // Actualizar estados de toggles
        if (option === 'showHeader') {
          const statusEl = document.getElementById(`simple-card-show-header-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        if (option === 'headerDecorations') {
          const statusEl = document.getElementById(`simple-card-header-decorations-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        if (option === 'showButtons') {
          const statusEl = document.getElementById(`simple-card-show-buttons-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateSimpleCardPreview === 'function') {
          window.updateSimpleCardPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de SimpleCard usando tokens UBITS
      window.updateSimpleCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`simple-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `simple-card-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const variant = document.querySelector(`[data-component="${componentId}"][data-option="variant"].active`)?.getAttribute('data-value') || 'default';
        const size = document.getElementById(`simple-card-size-select-${componentId}`)?.value || 'md';
        const showHeader = document.getElementById(`simple-card-show-header-toggle-${componentId}`)?.checked !== false;
        const headerDecorations = document.getElementById(`simple-card-header-decorations-toggle-${componentId}`)?.checked !== false;
        const showButtons = document.getElementById(`simple-card-show-buttons-toggle-${componentId}`)?.checked !== false;
        const title = document.getElementById(`simple-card-title-input-${componentId}`)?.value || 'Advanced Card';
        const subtitle = document.getElementById(`simple-card-subtitle-input-${componentId}`)?.value || 'Card subtitle';
        const content = document.getElementById(`simple-card-content-input-${componentId}`)?.value || 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore sed consequuntur error repudiandae numquam deserunt quisquam repellat libero asperiores earum nam nobis, culpa ratione quam perferendis esse, cupiditate neque quas!';
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Crear opciones para SimpleCard usando tokens UBITS
        const cardOptions = {
          title: title,
          subtitle: subtitle,
          content: content,
          showHeader: showHeader,
          headerDecorations: headerDecorations,
          headerBackground: 'var(--ubits-bg-4)',
          backgroundColor: 'var(--ubits-bg-1)',
          borderColor: 'var(--ubits-border-1)',
          borderRadius: '8px',
          padding: 'var(--ubits-spacing-lg)',
          titleTypography: 'ubits-heading-h2',
          subtitleTypography: 'ubits-body-md',
          contentTypography: 'ubits-body-md',
          buttons: showButtons ? [
            { label: 'Cancel', variant: 'secondary', size: 'md' },
            { label: 'Save', variant: 'primary', size: 'md' }
          ] : [],
          showButtons: showButtons,
          variant: variant,
          size: size
        };
        
        // Generar HTML usando tokens UBITS
        const cardHTML = generateSimpleCardHTML(cardOptions);
        previewContainer.innerHTML = cardHTML;
        
        console.log('âœ… SimpleCard preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de SimpleCard usando tokens UBITS
      function generateSimpleCardHTML(options) {
        const {
          title,
          subtitle,
          content,
          showHeader,
          headerDecorations,
          headerBackground,
          backgroundColor,
          borderColor,
          borderRadius,
          padding,
          titleTypography,
          subtitleTypography,
          contentTypography,
          buttons,
          showButtons,
          variant,
          size
        } = options;
        
        // Clases base usando tokens UBITS
        const cardClasses = [
          'ubits-simple-card',
          `ubits-simple-card--${variant}`,
          `ubits-simple-card--${size}`
        ].join(' ');
        
        // Estilos inline usando tokens UBITS
        const cardStyles = [
          `background: ${backgroundColor}`,
          `border: 1px solid ${borderColor}`,
          `border-radius: ${borderRadius}`,
          `padding: ${padding}`
        ].join('; ');
        
        // Header HTML
        const headerHTML = showHeader ? `
          <div class="ubits-simple-card__header" style="background: ${headerBackground};">
            ${headerDecorations ? `
              <div class="ubits-simple-card__header-decoration ubits-simple-card__header-decoration--left">
                <div class="ubits-simple-card__bubble">
                  <div class="ubits-simple-card__bubble-content">
                    <div class="ubits-simple-card__logo">A</div>
                  </div>
                </div>
              </div>
              <div class="ubits-simple-card__header-decoration ubits-simple-card__header-decoration--right">
                <div class="ubits-simple-card__bubble ubits-simple-card__bubble--small">
                  <div class="ubits-simple-card__bubble-content">
                    <div class="ubits-simple-card__logo">A</div>
                  </div>
                </div>
              </div>
            ` : ''}
          </div>
        ` : '';
        
        // Botones HTML usando componente Button UBITS
        const buttonsHTML = showButtons && buttons && buttons.length > 0 ? `
          <div class="ubits-simple-card__footer">
            ${buttons.map(button => `
              <div class="ubits-simple-card__button">
                <button class="ubits-button ubits-button--${button.variant} ubits-button--${button.size}">
                  <span>${button.label}</span>
                </button>
              </div>
            `).join('')}
          </div>
        ` : '';
        
        return `
          <div class="${cardClasses}" style="${cardStyles}">
            ${headerHTML}
            <div class="ubits-simple-card__body">
              <h2 class="ubits-simple-card__title ${titleTypography}">${title}</h2>
              <p class="ubits-simple-card__subtitle ${subtitleTypography}">${subtitle}</p>
              <div class="ubits-simple-card__content ${contentTypography}">${content}</div>
            </div>
            ${buttonsHTML}
          </div>
        `;
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA CAROUSEL
      // ========================================
      
      // FunciÃ³n para controlar Carousel
      window.setCarouselControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setCarouselControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        if (option === 'showArrows') {
          const statusEl = document.getElementById(`carousel-show-arrows-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        if (option === 'showDots') {
          const statusEl = document.getElementById(`carousel-show-dots-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        if (option === 'autoplay') {
          const statusEl = document.getElementById(`carousel-autoplay-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        if (option === 'loop') {
          const statusEl = document.getElementById(`carousel-loop-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateCarouselPreview === 'function') {
          window.updateCarouselPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de Carousel usando tokens UBITS
      window.updateCarouselPreview = function(componentId) {
        const previewContainer = document.getElementById(`carousel-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `carousel-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const cardSize = document.getElementById(`carousel-card-size-select-${componentId}`)?.value || 'md';
        const itemsPerView = parseInt(document.getElementById(`carousel-items-per-view-select-${componentId}`)?.value || '3');
        const gap = parseInt(document.getElementById(`carousel-gap-input-${componentId}`)?.value || '16');
        const arrowPosition = document.getElementById(`carousel-arrow-position-select-${componentId}`)?.value || 'outside';
        const dotPosition = document.getElementById(`carousel-dot-position-select-${componentId}`)?.value || 'bottom';
        const showArrows = document.getElementById(`carousel-show-arrows-toggle-${componentId}`)?.checked !== false;
        const showDots = document.getElementById(`carousel-show-dots-toggle-${componentId}`)?.checked !== false;
        const autoplay = document.getElementById(`carousel-autoplay-toggle-${componentId}`)?.checked === true;
        const loop = document.getElementById(`carousel-loop-toggle-${componentId}`)?.checked === true;
        const autoplayInterval = parseInt(document.getElementById(`carousel-autoplay-interval-input-${componentId}`)?.value || '3000');
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Crear items de ejemplo usando Simple Card con tokens UBITS
        const items = [
          {
            id: 1,
            title: 'Card 1',
            subtitle: 'Subtitle 1',
            content: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit.',
            showHeader: true,
            headerDecorations: true,
            variant: 'default',
            size: cardSize,
            backgroundColor: 'var(--ubits-bg-1)',
            borderColor: 'var(--ubits-border-1)',
            titleTypography: 'ubits-heading-h2',
            subtitleTypography: 'ubits-body-md',
            contentTypography: 'ubits-body-md',
            buttons: [
              { label: 'Action', variant: 'primary', size: 'md' }
            ]
          },
          {
            id: 2,
            title: 'Card 2',
            subtitle: 'Subtitle 2',
            content: 'Inventore sed consequuntur error repudiandae numquam deserunt.',
            showHeader: true,
            headerDecorations: true,
            variant: 'default',
            size: cardSize,
            backgroundColor: 'var(--ubits-bg-1)',
            borderColor: 'var(--ubits-border-1)',
            titleTypography: 'ubits-heading-h2',
            subtitleTypography: 'ubits-body-md',
            contentTypography: 'ubits-body-md',
            buttons: [
              { label: 'Action', variant: 'primary', size: 'md' }
            ]
          },
          {
            id: 3,
            title: 'Card 3',
            subtitle: 'Subtitle 3',
            content: 'Quisquam repellat libero asperiores earum nam nobis.',
            showHeader: true,
            headerDecorations: true,
            variant: 'default',
            size: cardSize,
            backgroundColor: 'var(--ubits-bg-1)',
            borderColor: 'var(--ubits-border-1)',
            titleTypography: 'ubits-heading-h2',
            subtitleTypography: 'ubits-body-md',
            contentTypography: 'ubits-body-md',
            buttons: [
              { label: 'Action', variant: 'primary', size: 'md' }
            ]
          },
          {
            id: 4,
            title: 'Card 4',
            subtitle: 'Subtitle 4',
            content: 'Culpa ratione quam perferendis esse, cupiditate neque quas!',
            showHeader: true,
            headerDecorations: true,
            variant: 'default',
            size: cardSize,
            backgroundColor: 'var(--ubits-bg-1)',
            borderColor: 'var(--ubits-border-1)',
            titleTypography: 'ubits-heading-h2',
            subtitleTypography: 'ubits-body-md',
            contentTypography: 'ubits-body-md',
            buttons: [
              { label: 'Action', variant: 'primary', size: 'md' }
            ]
          },
          {
            id: 5,
            title: 'Card 5',
            subtitle: 'Subtitle 5',
            content: 'Sed do eiusmod tempor incididunt ut labore et dolore magna.',
            showHeader: true,
            headerDecorations: true,
            variant: 'default',
            size: cardSize,
            backgroundColor: 'var(--ubits-bg-1)',
            borderColor: 'var(--ubits-border-1)',
            titleTypography: 'ubits-heading-h2',
            subtitleTypography: 'ubits-body-md',
            contentTypography: 'ubits-body-md',
            buttons: [
              { label: 'Action', variant: 'primary', size: 'md' }
            ]
          }
        ];
        
        // Crear opciones para Carousel usando tokens UBITS
        const carouselOptions = {
          items: items,
          itemsPerView: itemsPerView,
          showArrows: showArrows,
          showDots: showDots,
          autoplay: autoplay,
          autoplayInterval: autoplayInterval,
          loop: loop,
          gap: gap,
          arrowPosition: arrowPosition,
          dotPosition: dotPosition
        };
        
        // Generar HTML usando tokens UBITS
        const carouselHTML = generateCarouselHTML(carouselOptions, cardSize);
        previewContainer.innerHTML = carouselHTML;
        
        // Inicializar funcionalidad JavaScript del carrusel
        setTimeout(() => {
          const carouselElement = previewContainer.querySelector('.ubits-carousel');
          if (carouselElement) {
            initializeCarouselPreview(carouselElement, carouselOptions);
          }
        }, 100);
        
        console.log('âœ… Carousel preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de Carousel usando tokens UBITS
      function generateCarouselHTML(options, cardSize = 'md') {
        const {
          items,
          itemsPerView,
          showArrows,
          showDots,
          autoplay,
          autoplayInterval,
          loop,
          gap,
          arrowPosition,
          dotPosition
        } = options;
        
        if (!items || items.length === 0) {
          return '<div class="ubits-carousel ubits-carousel--empty">No hay items para mostrar</div>';
        }
        
        // Clases base usando tokens UBITS
        const classes = [
          'ubits-carousel',
          arrowPosition === 'inside' && 'ubits-carousel--arrows-inside',
          dotPosition === 'top' && 'ubits-carousel--dots-top'
        ].filter(Boolean).join(' ');
        
        // Atributos de datos
        const dataAttrs = [
          `data-items-per-view="${itemsPerView}"`,
          autoplay && `data-autoplay="true"`,
          autoplay && `data-autoplay-interval="${autoplayInterval}"`,
          loop && `data-loop="true"`,
          `data-gap="${gap}"`
        ].filter(Boolean).join(' ');
        
        // Renderizar items usando Simple Card
        const itemsHTML = items.map((item, index) => {
          const cardHTML = generateSimpleCardHTML({
            title: item.title,
            subtitle: item.subtitle,
            content: item.content,
            showHeader: item.showHeader,
            headerDecorations: item.headerDecorations,
            headerBackground: 'var(--ubits-bg-4)',
            backgroundColor: item.backgroundColor || 'var(--ubits-bg-1)',
            borderColor: item.borderColor || 'var(--ubits-border-1)',
            borderRadius: '8px',
            padding: 'var(--ubits-spacing-lg)',
            titleTypography: item.titleTypography || 'ubits-heading-h2',
            subtitleTypography: item.subtitleTypography || 'ubits-body-md',
            contentTypography: item.contentTypography || 'ubits-body-md',
            buttons: item.buttons || [],
            showButtons: item.buttons && item.buttons.length > 0,
            variant: item.variant || 'default',
            size: item.size || cardSize
          });
          
          return `
            <div class="ubits-carousel-item" data-item-id="${item.id}" data-item-index="${index}">
              ${cardHTML}
            </div>
          `;
        }).join('');
        
        // Renderizar flechas
        const prevArrowHTML = showArrows ? `
          <button class="ubits-carousel__arrow ubits-carousel__arrow--prev" data-action="prev" aria-label="Anterior">
            <i class="fas fa-chevron-left"></i>
          </button>
        ` : '';
        
        const nextArrowHTML = showArrows ? `
          <button class="ubits-carousel__arrow ubits-carousel__arrow--next" data-action="next" aria-label="Siguiente">
            <i class="fas fa-chevron-right"></i>
          </button>
        ` : '';
        
        // Renderizar dots
        const totalPages = Math.ceil(items.length / itemsPerView);
        const dotsHTML = showDots ? `
          <div class="ubits-carousel__dots">
            ${Array.from({ length: totalPages }, (_, index) => `
              <button class="ubits-carousel__dot ${index === 0 ? 'ubits-carousel__dot--active' : ''}" 
                      data-dot-index="${index}" 
                      aria-label="Ir a pÃ¡gina ${index + 1}">
              </button>
            `).join('')}
          </div>
        ` : '';
        
        return `
          <div class="${classes}" ${dataAttrs} style="--carousel-gap: ${gap}px;">
            <div class="ubits-carousel__content-wrapper">
              ${prevArrowHTML}
              <div class="ubits-carousel__container">
                <div class="ubits-carousel__track">
                  ${itemsHTML}
                </div>
              </div>
              ${nextArrowHTML}
            </div>
            ${dotsHTML}
          </div>
        `;
      }
      
      // FunciÃ³n helper para inicializar el carrusel en el preview
      function initializeCarouselPreview(element, options) {
        const track = element.querySelector('.ubits-carousel__track');
        const items = element.querySelectorAll('.ubits-carousel-item');
        const prevButton = element.querySelector('.ubits-carousel__arrow--prev');
        const nextButton = element.querySelector('.ubits-carousel__arrow--next');
        const dots = element.querySelectorAll('.ubits-carousel__dot');
        
        if (!track || items.length === 0) return;
        
        let currentIndex = 0;
        let autoplayTimer = null;
        
        const itemsPerView = parseInt(element.getAttribute('data-items-per-view') || '3');
        const gap = parseInt(element.getAttribute('data-gap') || '16');
        const autoplay = element.getAttribute('data-autoplay') === 'true';
        const autoplayInterval = parseInt(element.getAttribute('data-autoplay-interval') || '3000');
        const loop = element.getAttribute('data-loop') === 'true';
        
        const getCardWidth = () => {
          if (items.length === 0) return 0;
          const firstItem = items[0];
          const firstCard = firstItem.querySelector('.ubits-simple-card');
          if (firstCard && firstCard.offsetWidth > 0) {
            return firstCard.offsetWidth + gap;
          }
          const container = element.querySelector('.ubits-carousel__container');
          if (container && container.offsetWidth > 0) {
            return container.offsetWidth / itemsPerView;
          }
          return 400 + gap;
        };
        
        const updatePosition = () => {
          const cardWidth = getCardWidth();
          const translateX = -currentIndex * cardWidth;
          track.style.transform = `translateX(${translateX}px)`;
          
          dots.forEach((dot, index) => {
            const pageIndex = Math.floor(currentIndex / itemsPerView);
            if (index === pageIndex) {
              dot.classList.add('ubits-carousel__dot--active');
            } else {
              dot.classList.remove('ubits-carousel__dot--active');
            }
          });
        };
        
        if (prevButton) {
          prevButton.addEventListener('click', () => {
            if (currentIndex > 0) {
              currentIndex--;
            } else if (loop) {
              currentIndex = Math.max(0, items.length - itemsPerView);
            }
            updatePosition();
            resetAutoplay();
          });
        }
        
        if (nextButton) {
          nextButton.addEventListener('click', () => {
            const maxIndex = Math.max(0, items.length - itemsPerView);
            if (currentIndex < maxIndex) {
              currentIndex++;
            } else if (loop) {
              currentIndex = 0;
            }
            updatePosition();
            resetAutoplay();
          });
        }
        
        dots.forEach((dot, index) => {
          dot.addEventListener('click', () => {
            currentIndex = index * itemsPerView;
            updatePosition();
            resetAutoplay();
          });
        });
        
        const startAutoplay = () => {
          if (autoplay) {
            autoplayTimer = window.setInterval(() => {
              const maxIndex = Math.max(0, items.length - itemsPerView);
              if (currentIndex < maxIndex) {
                currentIndex++;
              } else if (loop) {
                currentIndex = 0;
              } else {
                currentIndex = 0;
              }
              updatePosition();
            }, autoplayInterval);
          }
        };
        
        const stopAutoplay = () => {
          if (autoplayTimer) {
            clearInterval(autoplayTimer);
            autoplayTimer = null;
          }
        };
        
        const resetAutoplay = () => {
          stopAutoplay();
          startAutoplay();
        };
        
        element.addEventListener('mouseenter', stopAutoplay);
        element.addEventListener('mouseleave', startAutoplay);
        
        setTimeout(() => {
          updatePosition();
          startAutoplay();
        }, 200);
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA BAR METRIC CARD
      // ========================================
      
      // FunciÃ³n para controlar Bar Metric Card
      window.setBarMetricCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setBarMetricCardControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showTitle': 'bar-metric-card-show-title-status',
          'showResponseCount': 'bar-metric-card-show-response-count-status',
          'showBarChart': 'bar-metric-card-show-bar-chart-status',
          'showCategories': 'bar-metric-card-show-categories-status',
          'showInfoIcon': 'bar-metric-card-show-info-icon-status',
          'showActionButton': 'bar-metric-card-show-action-button-status',
          'showNegativeValues': 'bar-metric-card-show-negative-values-status',
          'showGridLines': 'bar-metric-card-show-grid-lines-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar botones de layout
        if (option === 'layout') {
          const buttons = document.querySelectorAll(`[data-component="${componentId}"][data-option="layout"]`);
          buttons.forEach(btn => {
            if (btn.getAttribute('data-value') === value) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        }
        
        // Actualizar preview
        if (typeof window.updateBarMetricCardPreview === 'function') {
          window.updateBarMetricCardPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de Bar Metric Card usando tokens UBITS
      window.updateBarMetricCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`bar-metric-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `bar-metric-card-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const layout = document.querySelector(`[data-component="${componentId}"][data-option="layout"][data-value].active`)?.getAttribute('data-value') || 'vertical';
        const size = document.getElementById(`bar-metric-card-size-select-${componentId}`)?.value || 'md';
        const title = document.getElementById(`bar-metric-card-title-input-${componentId}`)?.value || 'MÃ©tricas';
        const responseCount = parseInt(document.getElementById(`bar-metric-card-response-count-input-${componentId}`)?.value || '7');
        const showTitle = document.getElementById(`bar-metric-card-show-title-toggle-${componentId}`)?.checked !== false;
        const showResponseCount = document.getElementById(`bar-metric-card-show-response-count-toggle-${componentId}`)?.checked === true;
        const showBarChart = document.getElementById(`bar-metric-card-show-bar-chart-toggle-${componentId}`)?.checked !== false;
        const showCategories = document.getElementById(`bar-metric-card-show-categories-toggle-${componentId}`)?.checked !== false;
        const showInfoIcon = document.getElementById(`bar-metric-card-show-info-icon-toggle-${componentId}`)?.checked === true;
        const showActionButton = document.getElementById(`bar-metric-card-show-action-button-toggle-${componentId}`)?.checked === true;
        const showNegativeValues = document.getElementById(`bar-metric-card-show-negative-values-toggle-${componentId}`)?.checked !== false;
        const showGridLines = document.getElementById(`bar-metric-card-show-grid-lines-toggle-${componentId}`)?.checked !== false;
        
        // Parsear barData y barLabels
        const barDataStr = document.getElementById(`bar-metric-card-bar-data-input-${componentId}`)?.value || '-25,-15,15,25,35,45,55,5,25,-15,-30,-50';
        const barData = barDataStr.split(',').map(v => parseFloat(v.trim())).filter(v => !isNaN(v));
        const barLabelsStr = document.getElementById(`bar-metric-card-bar-labels-input-${componentId}`)?.value || 'Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago,Ago';
        const barLabels = barLabelsStr.split(',').map(v => v.trim()).filter(v => v.length > 0);
        
        const maxValue = parseInt(document.getElementById(`bar-metric-card-max-value-input-${componentId}`)?.value || '60');
        const minValue = parseInt(document.getElementById(`bar-metric-card-min-value-input-${componentId}`)?.value || '-60');
        
        // Obtener categorÃ­as
        const category1Label = document.getElementById(`bar-metric-card-category1-label-input-${componentId}`)?.value || 'Ãrea';
        const category1Current = parseInt(document.getElementById(`bar-metric-card-category1-current-input-${componentId}`)?.value || '3');
        const category1Total = parseInt(document.getElementById(`bar-metric-card-category1-total-input-${componentId}`)?.value || '20');
        
        const category2Label = document.getElementById(`bar-metric-card-category2-label-input-${componentId}`)?.value || 'Equipo';
        const category2Current = parseInt(document.getElementById(`bar-metric-card-category2-current-input-${componentId}`)?.value || '5');
        const category2Total = parseInt(document.getElementById(`bar-metric-card-category2-total-input-${componentId}`)?.value || '15');
        
        const category3Label = document.getElementById(`bar-metric-card-category3-label-input-${componentId}`)?.value || 'Propio';
        const category3Current = parseInt(document.getElementById(`bar-metric-card-category3-current-input-${componentId}`)?.value || '2');
        const category3Total = parseInt(document.getElementById(`bar-metric-card-category3-total-input-${componentId}`)?.value || '10');
        
        const categories = [
          { label: category1Label, current: category1Current, total: category1Total },
          { label: category2Label, current: category2Current, total: category2Total },
          { label: category3Label, current: category3Current, total: category3Total }
        ];
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Crear opciones para Bar Metric Card usando tokens UBITS
        const barMetricCardOptions = {
          title: title,
          responseCount: responseCount,
          showResponseCount: showResponseCount,
          barData: barData,
          barLabels: barLabels.length > 0 ? barLabels : undefined,
          maxValue: maxValue,
          minValue: minValue,
          categories: categories,
          layout: layout,
          size: size,
          showTitle: showTitle,
          showBarChart: showBarChart,
          showCategories: showCategories,
          showInfoIcon: showInfoIcon,
          showActionButton: showActionButton,
          showNegativeValues: showNegativeValues,
          showGridLines: showGridLines,
          barColor: 'var(--ubits-chart-color-bg-neutral-blue-base, #557593)',
          chartBackgroundColor: 'var(--ubits-bg-1)',
          gridLineColor: 'var(--ubits-border-1)'
        };
        
        // Generar HTML usando tokens UBITS
        // Nota: Necesitamos usar renderBarMetricCard desde el provider
        // Por ahora, generaremos el HTML manualmente basÃ¡ndonos en la estructura del componente
        const barMetricCardHTML = generateBarMetricCardHTML(barMetricCardOptions);
        previewContainer.innerHTML = barMetricCardHTML;
        
        console.log('âœ… Bar Metric Card preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de Bar Metric Card usando tokens UBITS
      function generateBarMetricCardHTML(options) {
        const {
          title = 'MÃ©tricas',
          responseCount = 0,
          showResponseCount = false,
          barData = [],
          barLabels = [],
          maxValue,
          minValue,
          categories = [],
          layout = 'vertical',
          size = 'md',
          showTitle = true,
          showBarChart = true,
          showCategories = true,
          showInfoIcon = false,
          showActionButton = false,
          showNegativeValues = true,
          showGridLines = true,
          barColor = 'var(--ubits-chart-color-bg-neutral-blue-base, #557593)',
          chartBackgroundColor = 'var(--ubits-bg-1)',
          gridLineColor = 'var(--ubits-border-1)'
        } = options;
        
        // Clases base usando tokens UBITS
        const classes = [
          'ubits-bar-metric-card',
          `ubits-bar-metric-card--${layout}`,
          `ubits-bar-metric-card--${size}`
        ].filter(Boolean).join(' ');
        
        // Calcular porcentaje de categorÃ­a
        const calculatePercentage = (current, total) => {
          if (total === 0) return 0;
          return Math.round((current / total) * 100);
        };
        
        // Clases de tipografÃ­a segÃºn tamaÃ±o
        const getTypographyClasses = (type) => {
          if (size === 'sm') {
            return type === 'label' ? 'ubits-body-sm-regular' : type === 'value' ? 'ubits-body-sm-regular' : 'ubits-body-sm-bold';
          } else if (size === 'lg') {
            return type === 'label' ? 'ubits-body-md-regular' : type === 'value' ? 'ubits-body-md-regular' : 'ubits-body-md-bold';
          } else {
            // MD: usar body-sm para label y value, body-md-bold para percentage (16px)
            return type === 'label' ? 'ubits-body-sm-regular' : type === 'value' ? 'ubits-body-sm-regular' : 'ubits-body-md-bold';
          }
        };
        
        // Renderizar botÃ³n helper
        const renderButtonHTML = (opts) => {
          const { variant = 'tertiary', size: btnSize = 'sm', icon, iconOnly = true } = opts;
          const btnClasses = [
            'ubits-button',
            `ubits-button--${variant}`,
            `ubits-button--${btnSize}`
          ].filter(Boolean).join(' ');
          const iconHTML = icon ? `<i class="far fa-${icon}"></i>` : '';
          return `<button class="${btnClasses}" type="button" aria-label="${opts.ariaLabel || ''}">${iconHTML}</button>`;
        };
        
        // Renderizar categorÃ­a estÃ¡ndar
        const renderCategory = (category) => {
          const percentage = calculatePercentage(category.current, category.total);
          const labelClass = getTypographyClasses('label');
          const valueClass = getTypographyClasses('value');
          const percentageClass = getTypographyClasses('percentage');
          
          return `
            <div class="ubits-bar-metric-card__category">
              <div class="ubits-bar-metric-card__category-label ${labelClass}">
                ${category.label}
              </div>
              <div class="ubits-bar-metric-card__category-value ${valueClass}">
                ${category.current}/${category.total} <span class="ubits-bar-metric-card__category-percentage ${percentageClass}">${percentage}%</span>
              </div>
            </div>
          `;
        };
        
        // Renderizar categorÃ­a con progress bar (para layout horizontal)
        const renderCategoryWithProgressBar = (category) => {
          const percentage = calculatePercentage(category.current, category.total);
          const labelClass = getTypographyClasses('label');
          const percentageClass = getTypographyClasses('percentage');
          const progressBarSize = size === 'sm' ? 'sm' : size === 'lg' ? 'lg' : 'md';
          
          // Usar renderProgressBarLocal si estÃ¡ disponible
          let progressBarHTML = '';
          if (typeof renderProgressBarLocal !== 'undefined') {
            const progressBarWithIndicator = renderProgressBarLocal({
              size: progressBarSize,
              value: percentage,
              variant: 'default',
              indicator: false
            });
            const indicatorHTML = `<span class="ubits-progress-bar__indicator">${category.current}/${category.total} <span class="${percentageClass}">${percentage}%</span></span>`;
            progressBarHTML = progressBarWithIndicator.replace(
              /(<\/div>\s*)(<\/div>\s*)$/,
              `$1${indicatorHTML}$2`
            );
          } else {
            // Fallback simple
            progressBarHTML = `
              <div class="ubits-progress-bar ubits-progress-bar--${progressBarSize}" style="height: ${progressBarSize === 'sm' ? 8 : progressBarSize === 'lg' ? 20 : 16}px;">
                <div class="ubits-progress-bar__container">
                  <div class="ubits-progress-bar__indicator-wrapper" style="width: ${percentage}%;"></div>
                </div>
                <span class="ubits-progress-bar__indicator">${category.current}/${category.total} <span class="${percentageClass}">${percentage}%</span></span>
              </div>
            `;
          }
          
          return `
            <div class="ubits-bar-metric-card__category ubits-bar-metric-card__category--with-progress">
              <div class="ubits-bar-metric-card__category-header">
                <div class="ubits-bar-metric-card__category-label ${labelClass}">
                  ${category.label}
                </div>
              </div>
              <div class="ubits-bar-metric-card__category-progress-wrapper">
                ${progressBarHTML}
              </div>
            </div>
          `;
        };
        
        // Renderizar grÃ¡fico de barras simplificado
        const renderBarChart = () => {
          if (barData.length === 0) return '';
          
          // Mapeo de tamaÃ±os a anchos de barras (igual que en el provider original)
          const BAR_WIDTHS_BY_SIZE = {
            xs: 4,
            sm: 8,
            md: 16,
            lg: 20
          };
          
          // Calcular rango
          const dataForRange = showNegativeValues ? barData : barData.filter(v => v >= 0);
          const calculatedMax = maxValue !== undefined ? maxValue : (dataForRange.length > 0 ? Math.ceil(Math.max(...dataForRange) / 20) * 20 : 100);
          const calculatedMin = minValue !== undefined ? minValue : (showNegativeValues && dataForRange.length > 0 ? Math.floor(Math.min(...dataForRange) / 20) * 20 : 0);
          const rangeSize = calculatedMax - calculatedMin;
          
          // Ancho base de la card segÃºn CSS (392px)
          const baseCardWidth = 392;
          const cardPadding = 12;
          const width = baseCardWidth - (cardPadding * 2); // 368px
          const height = 158;
          
          // Calcular padding de manera proporcional
          const paddingLeft = Math.max(30, Math.min(35, width * 0.08));
          const paddingRight = 4;
          const paddingTop = 8;
          const paddingBottom = 25;
          const chartHeight = height - paddingTop - paddingBottom;
          
          // Calcular zeroY: si no hay valores negativos, zeroY estÃ¡ en la parte inferior
          const zeroY = showNegativeValues && calculatedMin < 0 
            ? paddingTop + (calculatedMax / rangeSize) * chartHeight
            : height - paddingBottom; // Si no hay negativos, zeroY estÃ¡ abajo
          
          // Calcular barras usando el ancho segÃºn el tamaÃ±o
          const barCount = barData.length;
          const barsAreaWidth = width - paddingLeft - paddingRight;
          
          // Usar el ancho de barra segÃºn el tamaÃ±o
          const baseBarWidth = BAR_WIDTHS_BY_SIZE[size] || BAR_WIDTHS_BY_SIZE.md;
          
          // Calcular el espacio disponible y distribuir las barras
          // Si hay muchas barras, usar un ancho mÃ¡s pequeÃ±o pero mantener proporciÃ³n
          const totalBarsWidth = barCount * baseBarWidth;
          const totalGapsWidth = (barCount - 1) * 4; // Gap mÃ­nimo de 4px
          const totalUsedWidth = totalBarsWidth + totalGapsWidth;
          
          let barWidth, gapSize;
          if (totalUsedWidth <= barsAreaWidth) {
            // Hay espacio suficiente, usar el ancho base y distribuir el espacio extra
            barWidth = baseBarWidth;
            const extraSpace = barsAreaWidth - totalUsedWidth;
            gapSize = 4 + (extraSpace / (barCount - 1 || 1));
          } else {
            // No hay espacio suficiente, reducir proporcionalmente
            const scale = barsAreaWidth / totalUsedWidth;
            barWidth = baseBarWidth * scale;
            gapSize = 4 * scale;
          }
          
          // Asegurar que el gap mÃ­nimo sea 2px
          gapSize = Math.max(2, gapSize);
          
          // Primero, identificar quÃ© barras se van a renderizar (filtrar las que no se muestran)
          const barsToRender = barData.map((value, index) => {
            const isPositive = value >= 0;
            const displayValue = showNegativeValues ? value : Math.max(0, value);
            
            let barHeightValue;
            
            if (!showNegativeValues || calculatedMin >= 0) {
              // Solo valores positivos
              barHeightValue = (displayValue / calculatedMax) * chartHeight;
            } else if (displayValue >= 0) {
              // Valores positivos cuando hay negativos tambiÃ©n
              barHeightValue = (displayValue / calculatedMax) * (zeroY - paddingTop);
            } else {
              // Valores negativos
              const minAbs = Math.abs(calculatedMin);
              barHeightValue = (Math.abs(displayValue) / minAbs) * (height - paddingBottom - zeroY);
            }
            
            // Determinar si esta barra se renderiza
            // Las barras con valor 0 se renderizan como lÃ­nea delgada, las demÃ¡s si tienen altura suficiente
            const isZero = Math.abs(displayValue) < 0.01;
            const shouldRender = isZero || (barHeightValue >= 0.5 && Math.abs(displayValue) >= 0.01);
            
            return {
              index,
              value: displayValue,
              label: barLabels[index] || '',
              isPositive: displayValue >= 0,
              shouldRender,
              barHeightValue,
              isZero: Math.abs(displayValue) < 0.01
            };
          });
          
          // Filtrar solo las barras que se van a renderizar
          const renderableBars = barsToRender.filter(bar => bar.shouldRender);
          
          // Si no hay barras para renderizar, retornar SVG vacÃ­o
          if (renderableBars.length === 0) {
            return `
              <svg class="ubits-bar-metric-card__chart-svg" width="100%" height="100%" viewBox="0 0 ${width} ${height}" preserveAspectRatio="none">
              </svg>
            `;
          }
          
          // Recalcular el espacio disponible para las barras que SÃ se renderizan
          const renderableBarCount = renderableBars.length;
          const totalBarsWidthRenderable = renderableBarCount * baseBarWidth;
          const totalGapsWidthRenderable = (renderableBarCount - 1) * 4;
          const totalUsedWidthRenderable = totalBarsWidthRenderable + totalGapsWidthRenderable;
          
          let barWidthFinal, gapSizeFinal;
          if (totalUsedWidthRenderable <= barsAreaWidth) {
            barWidthFinal = baseBarWidth;
            const extraSpace = barsAreaWidth - totalUsedWidthRenderable;
            gapSizeFinal = 4 + (extraSpace / (renderableBarCount - 1 || 1));
          } else {
            const scale = barsAreaWidth / totalUsedWidthRenderable;
            barWidthFinal = baseBarWidth * scale;
            gapSizeFinal = 4 * scale;
          }
          gapSizeFinal = Math.max(2, gapSizeFinal);
          
          // Calcular las barras renderizables con posiciones distribuidas uniformemente
          // Mantener el Ã­ndice original para distribuir correctamente en el espacio total
          const totalBars = barData.length;
          const bars = renderableBars.map((barInfo, renderIndex) => {
            // Calcular posiciÃ³n X basada en el Ã­ndice original para mantener la distribuciÃ³n correcta
            // Incluir todas las barras (incluso las que no se renderizan) en el cÃ¡lculo del espacio
            const x = paddingLeft + barInfo.index * ((barsAreaWidth) / (totalBars - 1 || 1));
            
            let barY, barHeight;
            
            // Si es valor 0, renderizar como lÃ­nea delgada en la lÃ­nea cero
            if (barInfo.isZero) {
              barHeight = 1; // LÃ­nea de 1px de altura
              barY = zeroY - 0.5; // Centrada en la lÃ­nea cero
            } else if (!showNegativeValues || calculatedMin >= 0) {
              // Solo valores positivos: barras desde zeroY (abajo) hacia arriba
              barHeight = barInfo.barHeightValue;
              barY = zeroY - barHeight;
            } else if (barInfo.isPositive) {
              // Valores positivos cuando hay negativos tambiÃ©n
              barHeight = barInfo.barHeightValue;
              barY = zeroY - barHeight;
            } else {
              // Valores negativos
              barHeight = barInfo.barHeightValue;
              barY = zeroY;
            }
            
            return { 
              x, 
              y: barY, 
              width: barWidthFinal, 
              height: barHeight, 
              value: barInfo.value, 
              isPositive: barInfo.isPositive, 
              label: barInfo.label,
              originalIndex: barInfo.index,
              isZero: barInfo.isZero
            };
          });
          
          // LÃ­neas de grilla y nÃºmeros del eje Y (siempre calcular los nÃºmeros, las lÃ­neas solo si showGridLines)
          const gridLines = [];
          for (let i = 0; i <= 5; i++) {
            const value = calculatedMin + (rangeSize / 5) * i;
            // Si no hay valores negativos, calcular Y desde abajo
            let y;
            if (!showNegativeValues || calculatedMin >= 0) {
              // Solo valores positivos: las lÃ­neas van de abajo hacia arriba
              y = height - paddingBottom - ((value / calculatedMax) * chartHeight);
            } else {
              // Hay valores negativos: calcular desde arriba
              y = paddingTop + ((calculatedMax - value) / rangeSize) * chartHeight;
            }
            gridLines.push({ y, value: Math.round(value) });
          }
          
          return `
            <svg class="ubits-bar-metric-card__chart-svg" width="100%" height="100%" viewBox="0 0 ${width} ${height}" preserveAspectRatio="none">
              <!-- NÃºmeros del eje Y (siempre visibles) -->
              ${gridLines.map(line => `
                <text x="${paddingLeft - 5}" y="${line.y + 4}" font-family="var(--font-sans)" font-size="13px" fill="var(--ubits-fg-2-medium)" text-anchor="end">${line.value}</text>
              `).join('')}
              
              <!-- LÃ­neas de grilla horizontales (solo si showGridLines estÃ¡ activado) -->
              ${showGridLines ? gridLines.map(line => `
                <line x1="${paddingLeft}" y1="${line.y}" x2="${width - paddingRight}" y2="${line.y}" stroke="${gridLineColor}" stroke-width="1" stroke-dasharray="2,2" opacity="0.3" />
              `).join('') : ''}
              
              <!-- LÃ­nea cero si hay valores negativos y positivos (solo si showGridLines estÃ¡ activado) -->
              ${showGridLines && showNegativeValues && calculatedMin < 0 && calculatedMax > 0 ? `
                <line x1="${paddingLeft}" y1="${zeroY}" x2="${width - paddingRight}" y2="${zeroY}" stroke="${gridLineColor}" stroke-width="1.5" opacity="0.6" />
              ` : ''}
              
              <!-- LÃ­nea vertical del eje Y (solo si showGridLines estÃ¡ activado) -->
              ${showGridLines ? `
                <line x1="${paddingLeft}" y1="${paddingTop}" x2="${paddingLeft}" y2="${height - paddingBottom}" stroke="${gridLineColor}" stroke-width="1" opacity="0.6" />
              ` : ''}
              ${bars.map((bar, index) => {
                // Si es valor 0, renderizar como lÃ­nea horizontal delgada
                if (bar.isZero) {
                  return `
                    <g>
                      <line x1="${bar.x}" y1="${bar.y + bar.height / 2}" x2="${bar.x + bar.width}" y2="${bar.y + bar.height / 2}" stroke="${barColor}" stroke-width="1" opacity="0.6" />
                      ${bar.label ? `<text x="${bar.x + bar.width / 2}" y="${height - paddingBottom + 15}" font-family="var(--font-sans)" font-size="11px" fill="var(--ubits-fg-2-medium)" text-anchor="middle">${bar.label}</text>` : ''}
                    </g>
                  `;
                }
                
                const rx = bar.width / 2;
                let path = '';
                if (bar.isPositive) {
                  path = `M ${bar.x} ${bar.y + bar.height} L ${bar.x} ${bar.y + rx} Q ${bar.x} ${bar.y} ${bar.x + rx} ${bar.y} L ${bar.x + bar.width - rx} ${bar.y} Q ${bar.x + bar.width} ${bar.y} ${bar.x + bar.width} ${bar.y + rx} L ${bar.x + bar.width} ${bar.y + bar.height} Z`;
                } else {
                  path = `M ${bar.x} ${bar.y} L ${bar.x} ${bar.y + bar.height - rx} Q ${bar.x} ${bar.y + bar.height} ${bar.x + rx} ${bar.y + bar.height} L ${bar.x + bar.width - rx} ${bar.y + bar.height} Q ${bar.x + bar.width} ${bar.y + bar.height} ${bar.x + bar.width} ${bar.y + bar.height - rx} L ${bar.x + bar.width} ${bar.y} Z`;
                }
                return `
                  <g>
                    <path d="${path}" fill="${barColor}" />
                    ${bar.label ? `<text x="${bar.x + bar.width / 2}" y="${height - paddingBottom + 15}" font-family="var(--font-sans)" font-size="11px" fill="var(--ubits-fg-2-medium)" text-anchor="middle">${bar.label}</text>` : ''}
                  </g>
                `;
              }).join('')}
            </svg>
          `;
        };
        
        // Renderizar tÃ­tulo
        const infoIconHTML = showInfoIcon ? renderButtonHTML({ icon: 'circle-info', ariaLabel: 'InformaciÃ³n' }) : '';
        const actionButtonHTML = showActionButton ? renderButtonHTML({ icon: 'chevron-right', ariaLabel: 'Ver mÃ¡s' }) : '';
        const responseCountHTML = showResponseCount && responseCount !== undefined
          ? `<div class="ubits-bar-metric-card__response-count"><span class="ubits-body-xs-regular">${responseCount} ${responseCount === 1 ? 'respuesta' : 'respuestas'}</span></div>`
          : '';
        
        const titleHTML = showTitle ? `
          <div class="ubits-bar-metric-card__header">
            <div class="ubits-bar-metric-card__title-group">
              <h3 class="ubits-bar-metric-card__title ubits-body-md-bold">${title}</h3>
              ${infoIconHTML}
            </div>
            ${actionButtonHTML ? `<div class="ubits-bar-metric-card__action-button">${actionButtonHTML}</div>` : ''}
          </div>
          ${responseCountHTML}
        ` : '';
        
        // Renderizar grÃ¡fico
        const barChartHTML = showBarChart && barData.length > 0 && layout !== 'horizontal' ? `
          <div class="ubits-bar-metric-card__chart-wrapper" style="background-color: ${chartBackgroundColor};">
            <div class="ubits-bar-metric-card__chart-inner">
              ${renderBarChart()}
            </div>
          </div>
        ` : '';
        
        // Renderizar categorÃ­as
        const categoriesHTML = showCategories && categories.length > 0 ? `
          <div class="ubits-bar-metric-card__categories">
            ${categories.map(cat => layout === 'horizontal' ? renderCategoryWithProgressBar(cat) : renderCategory(cat)).join('')}
          </div>
        ` : '';
        
        return `
          <div class="${classes}">
            ${titleHTML}
            <div class="ubits-bar-metric-card__content">
              ${barChartHTML}
              ${categoriesHTML}
            </div>
          </div>
        `;
      }
      
      // ============================================
      // TEXT METRIC CARD - Funciones de control
      // ============================================
      
      window.setTextMetricCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setTextMetricCardControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        if (option === 'showInfoIcon') {
          const statusEl = document.getElementById(`text-metric-card-show-info-icon-status-${componentId}`);
          if (statusEl) {
            statusEl.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        if (option === 'showActionButton') {
          const statusEl = document.getElementById(`text-metric-card-show-action-button-status-${componentId}`);
          if (statusEl) {
            statusEl.textContent = value ? 'Activado' : 'Desactivado';
          }
        }
        
        // Actualizar preview
        if (typeof window.updateTextMetricCardPreview === 'function') {
          window.updateTextMetricCardPreview(componentId);
        }
      };
      
      window.updateTextMetricCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`text-metric-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `text-metric-card-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const size = document.getElementById(`text-metric-card-size-select-${componentId}`)?.value || 'md';
        const title = document.getElementById(`text-metric-card-title-input-${componentId}`)?.value || 'Net confidence score';
        const value = document.getElementById(`text-metric-card-value-input-${componentId}`)?.value || '200 / 204';
        const label = document.getElementById(`text-metric-card-label-input-${componentId}`)?.value || 'Colaboradores';
        const titleIcon = document.getElementById(`text-metric-card-title-icon-input-${componentId}`)?.value || '';
        const titleIconStyle = document.getElementById(`text-metric-card-title-icon-style-select-${componentId}`)?.value || 'regular';
        const titleIconColor = document.getElementById(`text-metric-card-title-icon-color-input-${componentId}`)?.value || '';
        const showInfoIcon = document.getElementById(`text-metric-card-show-info-icon-toggle-${componentId}`)?.checked || false;
        const showActionButton = document.getElementById(`text-metric-card-show-action-button-toggle-${componentId}`)?.checked || false;
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Crear opciones para Text Metric Card usando tokens UBITS
        const textMetricCardOptions = {
          title: title,
          value: value,
          label: label,
          titleIcon: titleIcon || undefined,
          titleIconStyle: titleIconStyle,
          titleIconColor: titleIconColor || undefined,
          showInfoIcon: showInfoIcon,
          showActionButton: showActionButton,
          size: size
        };
        
        // Generar HTML usando tokens UBITS
        const textMetricCardHTML = generateTextMetricCardHTML(textMetricCardOptions);
        previewContainer.innerHTML = textMetricCardHTML;
        
        console.log('âœ… Text Metric Card preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de Text Metric Card usando tokens UBITS
      function generateTextMetricCardHTML(options) {
        const {
          title = 'Net confidence score',
          value = '200 / 204',
          label = 'Colaboradores',
          titleIcon,
          titleIconStyle = 'regular',
          titleIconColor,
          showInfoIcon = false,
          showActionButton = false,
          size = 'md'
        } = options;
        
        // Construir clases CSS
        const classes = [
          'ubits-metric-card',
          `ubits-metric-card--${size}`
        ].filter(Boolean).join(' ');
        
        // Helper para renderizar iconos FontAwesome
        function renderIconHelper(iconName, iconStyle, iconColor) {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          const colorStyle = iconColor ? `style="color: ${iconColor};"` : '';
          return `<i class="${iconClass} ${name}" ${colorStyle}></i>`;
        }
        
        // Helper para formatear valores numÃ©ricos
        function formatValue(val) {
          if (typeof val === 'number') {
            return val.toLocaleString('es-ES');
          }
          return String(val);
        }
        
        // Renderizar icono del tÃ­tulo si existe
        const titleIconHTML = titleIcon 
          ? `<div class="ubits-metric-card__title-icon">${renderIconHelper(titleIcon, titleIconStyle, titleIconColor)}</div>`
          : '';
        
        // Renderizar icono de informaciÃ³n como botÃ³n terciario si estÃ¡ habilitado
        const infoIconHTML = showInfoIcon
          ? generateSimpleButtonHTML({
              variant: 'tertiary',
              size: 'sm',
              icon: 'circle-info',
              iconStyle: 'regular',
              iconOnly: true,
              ariaLabel: 'InformaciÃ³n'
            })
          : '';
        
        // Renderizar botÃ³n de acciÃ³n con flecha a la derecha en la esquina superior derecha
        const actionButtonHTML = showActionButton
          ? generateSimpleButtonHTML({
              variant: 'tertiary',
              size: 'sm',
              icon: 'chevron-right',
              iconStyle: 'regular',
              iconOnly: true,
              ariaLabel: 'Ver mÃ¡s'
            })
          : '';
        
        // Clases de tipografÃ­a segÃºn tamaÃ±o (usando solo clases vÃ¡lidas UBITS)
        const titleSizeClass = 'ubits-body-md-regular';
        const labelSizeClass = size === 'sm' ? 'ubits-body-sm-regular' : 'ubits-body-md-regular';
        const valueClass = 'ubits-heading-h2';
        
        const formattedValue = formatValue(value);
        
        return `
          <div class="${classes}">
            <div class="ubits-metric-card__header">
              ${titleIconHTML}
              <div class="ubits-metric-card__title-group">
                <h3 class="ubits-metric-card__title ${titleSizeClass}">${title}</h3>
                ${infoIconHTML}
              </div>
              ${actionButtonHTML ? `<div class="ubits-metric-card__action-button">${actionButtonHTML}</div>` : ''}
            </div>
            <div class="ubits-metric-card__body">
              <div class="ubits-metric-card__value-wrapper">
                <h2 class="ubits-metric-card__value ${valueClass}">${formattedValue}</h2>
                <div class="ubits-metric-card__label ${labelSizeClass}">${label}</div>
              </div>
            </div>
          </div>
        `;
      }
      
      // Helper para generar HTML de botÃ³n (simplificado para uso en preview)
      function generateSimpleButtonHTML(options) {
        const {
          variant = 'primary',
          size = 'md',
          icon,
          iconStyle = 'regular',
          iconOnly = false,
          ariaLabel,
          text = ''
        } = options;
        
        const buttonClasses = [
          'ubits-button',
          `ubits-button--${variant}`,
          `ubits-button--${size}`,
          iconOnly ? 'ubits-button--icon-only' : ''
        ].filter(Boolean).join(' ');
        
        // Generar HTML del icono solo si existe
        let iconHTML = '';
        if (icon) {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const iconName = icon.startsWith('fa-') ? icon : `fa-${icon}`;
          iconHTML = `<i class="${iconClass} ${iconName}"></i>`;
        }
        
        return `
          <button class="${buttonClasses}" type="button" ${ariaLabel ? `aria-label="${ariaLabel}"` : ''}>
            ${iconHTML}
            ${text ? `<span>${text}</span>` : ''}
          </button>
        `;
      }
      
      // ============================================
      // CIRCLE METRIC CARD - Funciones de control
      // ============================================
      
      // Estado del preview
      const circleMetricCardPreviewState = {};
      
      // Inicializar estado del preview
      function initCircleMetricCardPreviewState(componentId) {
        if (!circleMetricCardPreviewState[componentId]) {
          circleMetricCardPreviewState[componentId] = {
            title: 'Progreso general',
            mainPercentage: 50,
            mainLabel: 'Ciclos',
            layout: 'horizontal',
            size: 'md',
            showTitle: true,
            showCircularProgress: true,
            showCategories: true,
            showInfoIcon: false,
            showActionButton: false,
            progressColor: 'var(--ubits-chart-color-bg-neutral-blue-base, #557593)',
            circleBackgroundColor: 'var(--ubits-bg-3)',
            category1Label: 'Ãrea',
            category1Current: 3,
            category1Total: 20,
            category2Label: 'Equipo',
            category2Current: 8,
            category2Total: 50,
            category3Label: 'Propio',
            category3Current: 5,
            category3Total: 30
          };
        }
      }
      
      window.setCircleMetricCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setCircleMetricCardControl:', option, value, componentId);
        
        // Inicializar estado si no existe
        initCircleMetricCardPreviewState(componentId);
        
        // Actualizar estado
        circleMetricCardPreviewState[componentId][option] = value;
        
        // Actualizar estados de toggles y botones de layout
        const toggleStatusMap = {
          'showTitle': 'circle-metric-card-show-title-status',
          'showCircularProgress': 'circle-metric-card-show-circular-progress-status',
          'showCategories': 'circle-metric-card-show-categories-status',
          'showInfoIcon': 'circle-metric-card-show-info-icon-status',
          'showActionButton': 'circle-metric-card-show-action-button-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar botones de layout
        if (option === 'layout') {
          const verticalBtn = document.getElementById(`circle-metric-card-layout-vertical-${componentId}`);
          const horizontalBtn = document.getElementById(`circle-metric-card-layout-horizontal-${componentId}`);
          if (verticalBtn && horizontalBtn) {
            if (value === 'vertical') {
              // Vertical activo (primary), Horizontal inactivo (secondary)
              verticalBtn.className = 'ubits-button ubits-button--primary ubits-button--sm';
              horizontalBtn.className = 'ubits-button ubits-button--secondary ubits-button--sm';
            } else {
              // Horizontal activo (primary), Vertical inactivo (secondary)
              horizontalBtn.className = 'ubits-button ubits-button--primary ubits-button--sm';
              verticalBtn.className = 'ubits-button ubits-button--secondary ubits-button--sm';
            }
          }
        }
        
        // Actualizar preview
        if (typeof window.updateCircleMetricCardPreview === 'function') {
          window.updateCircleMetricCardPreview(componentId);
        }
      };
      
      window.updateCircleMetricCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`circle-metric-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `circle-metric-card-preview-${componentId}`);
          return;
        }
        
        // Inicializar estado si no existe
        initCircleMetricCardPreviewState(componentId);
        
        // Obtener valores de los controles o usar estado
        const state = circleMetricCardPreviewState[componentId];
        const title = document.getElementById(`circle-metric-card-title-input-${componentId}`)?.value || state.title;
        const mainPercentage = parseInt(document.getElementById(`circle-metric-card-main-percentage-input-${componentId}`)?.value) || state.mainPercentage;
        const mainLabel = document.getElementById(`circle-metric-card-main-label-input-${componentId}`)?.value || state.mainLabel;
        const layout = state.layout;
        const size = document.getElementById(`circle-metric-card-size-select-${componentId}`)?.value || state.size;
        const showTitle = document.getElementById(`circle-metric-card-show-title-toggle-${componentId}`)?.checked ?? state.showTitle;
        const showCircularProgress = document.getElementById(`circle-metric-card-show-circular-progress-toggle-${componentId}`)?.checked ?? state.showCircularProgress;
        const showCategories = document.getElementById(`circle-metric-card-show-categories-toggle-${componentId}`)?.checked ?? state.showCategories;
        const showInfoIcon = document.getElementById(`circle-metric-card-show-info-icon-toggle-${componentId}`)?.checked ?? state.showInfoIcon;
        const showActionButton = document.getElementById(`circle-metric-card-show-action-button-toggle-${componentId}`)?.checked ?? state.showActionButton;
        const progressColor = document.getElementById(`circle-metric-card-progress-color-input-${componentId}`)?.value || state.progressColor;
        const circleBackgroundColor = document.getElementById(`circle-metric-card-circle-background-color-input-${componentId}`)?.value || state.circleBackgroundColor;
        
        // Construir categorÃ­as
        const categories = [];
        const category1Label = document.getElementById(`circle-metric-card-category1-label-input-${componentId}`)?.value || state.category1Label;
        const category1Current = parseInt(document.getElementById(`circle-metric-card-category1-current-input-${componentId}`)?.value) || state.category1Current;
        const category1Total = parseInt(document.getElementById(`circle-metric-card-category1-total-input-${componentId}`)?.value) || state.category1Total;
        if (category1Label) {
          categories.push({ label: category1Label, current: category1Current, total: category1Total });
        }
        
        const category2Label = document.getElementById(`circle-metric-card-category2-label-input-${componentId}`)?.value || state.category2Label;
        const category2Current = parseInt(document.getElementById(`circle-metric-card-category2-current-input-${componentId}`)?.value) || state.category2Current;
        const category2Total = parseInt(document.getElementById(`circle-metric-card-category2-total-input-${componentId}`)?.value) || state.category2Total;
        if (category2Label) {
          categories.push({ label: category2Label, current: category2Current, total: category2Total });
        }
        
        const category3Label = document.getElementById(`circle-metric-card-category3-label-input-${componentId}`)?.value || state.category3Label;
        const category3Current = parseInt(document.getElementById(`circle-metric-card-category3-current-input-${componentId}`)?.value) || state.category3Current;
        const category3Total = parseInt(document.getElementById(`circle-metric-card-category3-total-input-${componentId}`)?.value) || state.category3Total;
        if (category3Label) {
          categories.push({ label: category3Label, current: category3Current, total: category3Total });
        }
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar HTML usando funciÃ³n inline (similar a renderProgressGeneralCard)
        const circleMetricCardHTML = renderProgressGeneralCardInline({
          title,
          mainPercentage,
          mainLabel,
          categories,
          layout,
          size,
          showTitle,
          showCircularProgress,
          showCategories,
          showInfoIcon,
          showActionButton,
          progressColor,
          circleBackgroundColor
        });
        
        previewContainer.innerHTML = circleMetricCardHTML;
        
        console.log('âœ… Circle Metric Card preview actualizado');
      };
      
      // FunciÃ³n inline para renderizar Circle Metric Card (basada en ProgressGeneralCardProvider)
      function renderProgressGeneralCardInline(options) {
        const {
          title = 'Progreso general',
          mainPercentage = 50,
          mainLabel = 'Ciclos',
          categories = [],
          layout = 'vertical',
          size = 'md',
          showTitle = true,
          showCircularProgress = true,
          showCategories = true,
          showInfoIcon = false,
          showActionButton = false,
          progressColor = 'var(--ubits-chart-color-bg-neutral-blue-base, #557593)',
          circleBackgroundColor = 'var(--ubits-bg-3)'
        } = options;
        
        // Construir clases CSS
        const classes = [
          'ubits-progress-general-card',
          `ubits-progress-general-card--${layout}`,
          `ubits-progress-general-card--${size}`
        ].filter(Boolean).join(' ');
        
        // TamaÃ±o del cÃ­rculo fijo a 158px
        const circleSize = 158;
        const strokeWidth = 16;
        const radius = (circleSize - strokeWidth) / 2;
        const circumference = 2 * Math.PI * radius;
        const offset = circumference - (mainPercentage / 100) * circumference;
        const center = circleSize / 2;
        
        // Clases de tipografÃ­a fijas
        const titleClass = 'ubits-body-md-bold';
        const percentageClass = 'ubits-heading-h2';
        const mainLabelClass = 'ubits-body-sm-bold';
        
        // Renderizar SVG del cÃ­rculo
        const circularProgressSVG = showCircularProgress ? `
          <svg class="ubits-progress-general-card__circle-svg" width="${circleSize}" height="${circleSize}" viewBox="0 0 ${circleSize} ${circleSize}">
            <circle cx="${center}" cy="${center}" r="${radius}" fill="none" stroke="${circleBackgroundColor}" stroke-width="${strokeWidth}" />
            <circle cx="${center}" cy="${center}" r="${radius}" fill="none" stroke="${progressColor}" stroke-width="${strokeWidth}" stroke-dasharray="${circumference}" stroke-dashoffset="${offset}" stroke-linecap="round" transform="rotate(-90 ${center} ${center})" class="ubits-progress-general-card__circle-progress" />
          </svg>
        ` : '';
        
        // Renderizar icono de informaciÃ³n
        const infoIconHTML = showInfoIcon ? generateSimpleButtonHTML({
          variant: 'tertiary',
          size: 'sm',
          icon: 'circle-info',
          iconStyle: 'regular',
          iconOnly: true,
          ariaLabel: 'InformaciÃ³n'
        }) : '';
        
        // Renderizar botÃ³n de acciÃ³n
        const actionButtonHTML = showActionButton ? generateSimpleButtonHTML({
          variant: 'tertiary',
          size: 'sm',
          icon: 'chevron-right',
          iconStyle: 'regular',
          iconOnly: true,
          ariaLabel: 'Ver mÃ¡s'
        }) : '';
        
        // Renderizar tÃ­tulo
        const titleHTML = showTitle ? `
          <div class="ubits-progress-general-card__header">
            <div class="ubits-progress-general-card__title-group">
              <h3 class="ubits-progress-general-card__title ${titleClass}">${title}</h3>
              ${infoIconHTML}
            </div>
            ${actionButtonHTML ? `<div class="ubits-progress-general-card__action-button">${actionButtonHTML}</div>` : ''}
          </div>
        ` : '';
        
        // Renderizar indicador circular
        const circularProgressHTML = showCircularProgress ? `
          <div class="ubits-progress-general-card__circle-wrapper">
            ${circularProgressSVG}
            <div class="ubits-progress-general-card__circle-content">
              <div class="ubits-progress-general-card__circle-percentage ${percentageClass}">${mainPercentage}%</div>
              <div class="ubits-progress-general-card__circle-label ${mainLabelClass}">${mainLabel}</div>
            </div>
          </div>
        ` : '';
        
        // Helper para calcular porcentaje
        function calculatePercentage(current, total) {
          if (total === 0) return 0;
          return Math.round((current / total) * 100);
        }
        
        // Renderizar categorÃ­as
        const categoryLabelClass = size === 'sm' ? 'ubits-body-sm-regular' : size === 'lg' ? 'ubits-body-md-regular' : 'ubits-body-sm-regular';
        const categoryValueClass = size === 'sm' ? 'ubits-body-sm-regular' : size === 'lg' ? 'ubits-body-md-regular' : 'ubits-body-sm-regular';
        const categoryPercentageClass = size === 'sm' ? 'ubits-body-sm-bold' : size === 'lg' ? 'ubits-body-md-bold' : 'ubits-body-sm-bold';
        
        const categoriesHTML = showCategories && categories.length > 0 ? `
          <div class="ubits-progress-general-card__categories">
            ${categories.map(cat => {
              const percentage = calculatePercentage(cat.current, cat.total);
              return `
                <div class="ubits-progress-general-card__category">
                  <div class="ubits-progress-general-card__category-label ${categoryLabelClass}">${cat.label}</div>
                  <div class="ubits-progress-general-card__category-value ${categoryValueClass}">${cat.current}/${cat.total} <span class="ubits-progress-general-card__category-percentage ${categoryPercentageClass}">${percentage}%</span></div>
                </div>
              `;
            }).join('')}
          </div>
        ` : '';
        
        return `
          <div class="${classes}">
            ${titleHTML}
            <div class="ubits-progress-general-card__content">
              ${circularProgressHTML}
              ${categoriesHTML}
            </div>
          </div>
        `;
      }
      
      // ============================================
      // SCORE CARD METRICS - Funciones de control
      // ============================================
      
      // Estado del preview
      const scoreCardMetricsPreviewState = {};
      
      // Inicializar estado del preview
      function initScoreCardMetricsPreviewState(componentId) {
        if (!scoreCardMetricsPreviewState[componentId]) {
          scoreCardMetricsPreviewState[componentId] = {
            title: 'Califica el producto',
            totalResponses: 7,
            responsesLabel: 'respuestas',
            average: 4.00,
            averageLabel: 'Promedio:',
            score: 3,
            leftLabel: '0',
            rightLabel: '5',
            titleIcon: '',
            titleIconStyle: 'regular',
            titleIconColor: '',
            showInfoIcon: false,
            showActionButton: false,
            size: 'md'
          };
        }
      }
      
      window.setScoreCardMetricsControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setScoreCardMetricsControl:', option, value, componentId);
        
        // Inicializar estado si no existe
        initScoreCardMetricsPreviewState(componentId);
        
        // Actualizar estado
        scoreCardMetricsPreviewState[componentId][option] = value;
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showInfoIcon': 'score-card-metrics-show-info-icon-status',
          'showActionButton': 'score-card-metrics-show-action-button-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateScoreCardMetricsPreview === 'function') {
          window.updateScoreCardMetricsPreview(componentId);
        }
      };
      
      window.updateScoreCardMetricsPreview = function(componentId) {
        const previewContainer = document.getElementById(`score-card-metrics-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `score-card-metrics-preview-${componentId}`);
          return;
        }
        
        // Inicializar estado si no existe
        initScoreCardMetricsPreviewState(componentId);
        
        // Obtener valores de los controles o usar estado
        const state = scoreCardMetricsPreviewState[componentId];
        const title = document.getElementById(`score-card-metrics-title-input-${componentId}`)?.value || state.title;
        const totalResponses = parseInt(document.getElementById(`score-card-metrics-total-responses-input-${componentId}`)?.value) || state.totalResponses;
        const responsesLabel = document.getElementById(`score-card-metrics-responses-label-input-${componentId}`)?.value || state.responsesLabel;
        const average = parseFloat(document.getElementById(`score-card-metrics-average-input-${componentId}`)?.value) || state.average;
        const averageLabel = document.getElementById(`score-card-metrics-average-label-input-${componentId}`)?.value || state.averageLabel;
        const score = parseFloat(document.getElementById(`score-card-metrics-score-input-${componentId}`)?.value) || state.score;
        const leftLabel = document.getElementById(`score-card-metrics-left-label-input-${componentId}`)?.value || state.leftLabel;
        const rightLabel = document.getElementById(`score-card-metrics-right-label-input-${componentId}`)?.value || state.rightLabel;
        const titleIcon = document.getElementById(`score-card-metrics-title-icon-input-${componentId}`)?.value || state.titleIcon;
        const titleIconStyle = document.getElementById(`score-card-metrics-title-icon-style-select-${componentId}`)?.value || state.titleIconStyle;
        const titleIconColor = document.getElementById(`score-card-metrics-title-icon-color-input-${componentId}`)?.value || state.titleIconColor;
        const showInfoIcon = document.getElementById(`score-card-metrics-show-info-icon-toggle-${componentId}`)?.checked ?? state.showInfoIcon;
        const showActionButton = document.getElementById(`score-card-metrics-show-action-button-toggle-${componentId}`)?.checked ?? state.showActionButton;
        const size = document.getElementById(`score-card-metrics-size-select-${componentId}`)?.value || state.size;
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar HTML usando funciÃ³n inline
        const scoreCardMetricsHTML = renderScoreCardMetricsInline({
          title,
          totalResponses,
          responsesLabel,
          average,
          averageLabel,
          score,
          leftLabel,
          rightLabel,
          titleIcon: titleIcon || undefined,
          titleIconStyle,
          titleIconColor: titleIconColor || undefined,
          showInfoIcon,
          showActionButton,
          size
        });
        
        previewContainer.innerHTML = scoreCardMetricsHTML;
        
        console.log('âœ… Score Card Metrics preview actualizado');
      };
      
      // FunciÃ³n inline para renderizar Score Card Metrics (basada en ScoreCardMetricsProvider)
      function renderScoreCardMetricsInline(options) {
        const {
          title = 'Califica el producto',
          totalResponses = 0,
          responsesLabel = 'respuestas',
          average = 0,
          averageLabel = 'Promedio:',
          score = 0,
          leftLabel = '0',
          rightLabel = '5',
          titleIcon,
          titleIconStyle = 'regular',
          titleIconColor,
          showInfoIcon = false,
          showActionButton = false,
          size = 'md'
        } = options;
        
        // Construir clases CSS
        const classes = [
          'ubits-score-card-metrics',
          `ubits-score-card-metrics--${size}`
        ].filter(Boolean).join(' ');
        
        // Clases de tipografÃ­a segÃºn tamaÃ±o
        const titleSizeClass = 'ubits-body-md-bold';
        const statsClass = 'ubits-body-sm-regular';
        
        // Helper para renderizar iconos FontAwesome
        function renderIconHelper(iconName, iconStyle, iconColor) {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          const colorStyle = iconColor ? `style="color: ${iconColor};"` : '';
          return `<i class="${iconClass} ${name}" ${colorStyle}></i>`;
        }
        
        // Renderizar icono del tÃ­tulo si existe
        const titleIconHTML = titleIcon 
          ? `<div class="ubits-score-card-metrics__title-icon">${renderIconHelper(titleIcon, titleIconStyle, titleIconColor)}</div>`
          : '';
        
        // Renderizar icono de informaciÃ³n
        const infoIconHTML = showInfoIcon ? generateSimpleButtonHTML({
          variant: 'tertiary',
          size: 'sm',
          icon: 'circle-info',
          iconStyle: 'regular',
          iconOnly: true,
          ariaLabel: 'InformaciÃ³n'
        }) : '';
        
        // Renderizar botÃ³n de acciÃ³n
        const actionButtonHTML = showActionButton ? generateSimpleButtonHTML({
          variant: 'tertiary',
          size: 'sm',
          icon: 'chevron-right',
          iconStyle: 'regular',
          iconOnly: true,
          ariaLabel: 'Ver mÃ¡s'
        }) : '';
        
        // Renderizar grÃ¡fico de estrellas
        function renderStarRating(scoreValue) {
          const totalStars = 5;
          const filledStars = Math.round(scoreValue);
          const emptyStars = totalStars - filledStars;
          
          let starsHTML = '';
          
          // Estrellas llenas
          for (let i = 0; i < filledStars; i++) {
            const starNumber = i + 1;
            starsHTML += `
              <div class="ubits-score-card-metrics__star-wrapper">
                <i class="fas fa-star ubits-score-card-metrics__star ubits-score-card-metrics__star--filled"></i>
                <span class="ubits-score-card-metrics__star-number">${starNumber}</span>
              </div>
            `;
          }
          
          // Estrellas vacÃ­as
          for (let i = 0; i < emptyStars; i++) {
            const starNumber = filledStars + i + 1;
            starsHTML += `
              <div class="ubits-score-card-metrics__star-wrapper">
                <i class="far fa-star ubits-score-card-metrics__star ubits-score-card-metrics__star--empty"></i>
                <span class="ubits-score-card-metrics__star-number">${starNumber}</span>
              </div>
            `;
          }
          
          return starsHTML;
        }
        
        const starsHTML = renderStarRating(score);
        const formattedAverage = average.toFixed(2);
        
        return `
          <div class="${classes}">
            <div class="ubits-score-card-metrics__header">
              ${titleIconHTML}
              <div class="ubits-score-card-metrics__title-group">
                <h3 class="ubits-score-card-metrics__title ${titleSizeClass}">${title}</h3>
                ${infoIconHTML}
              </div>
              ${actionButtonHTML ? `<div class="ubits-score-card-metrics__action-button">${actionButtonHTML}</div>` : ''}
            </div>
            <div class="ubits-score-card-metrics__body">
              <div class="ubits-score-card-metrics__stats">
                <span class="ubits-score-card-metrics__responses ${statsClass}">${totalResponses} ${responsesLabel}</span>
                <span class="ubits-score-card-metrics__average ${statsClass}">${averageLabel} (${formattedAverage})</span>
              </div>
              <div class="ubits-score-card-metrics__chart">
                <div class="ubits-score-card-metrics__stars">
                  ${starsHTML}
                </div>
              </div>
            </div>
          </div>
        `;
      }
      
      // ============================================
      // NPS CARD - Funciones de control
      // ============================================
      
      window.setNPSCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setNPSCardControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showTitle': 'nps-card-show-title-status',
          'showResponsesCount': 'nps-card-show-responses-count-status',
          'showGauge': 'nps-card-show-gauge-status',
          'showCategories': 'nps-card-show-categories-status',
          'showInfoIcon': 'nps-card-show-info-icon-status',
          'showActionButton': 'nps-card-show-action-button-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateNPSCardPreview === 'function') {
          window.updateNPSCardPreview(componentId);
        }
      };
      
      window.updateNPSCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`nps-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `nps-card-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const size = document.getElementById(`nps-card-size-select-${componentId}`)?.value || 'md';
        const title = document.getElementById(`nps-card-title-input-${componentId}`)?.value || 'Nivel de confianza';
        const score = parseInt(document.getElementById(`nps-card-score-input-${componentId}`)?.value || '56');
        const scoreLabel = document.getElementById(`nps-card-score-label-input-${componentId}`)?.value || 'PuntuaciÃ³n';
        const totalResponses = parseInt(document.getElementById(`nps-card-total-responses-input-${componentId}`)?.value || '290');
        const responsesLabel = document.getElementById(`nps-card-responses-label-input-${componentId}`)?.value || 'respuestas';
        const category1Label = document.getElementById(`nps-card-category1-label-input-${componentId}`)?.value || 'No tienen confianza';
        const category1Current = parseInt(document.getElementById(`nps-card-category1-current-input-${componentId}`)?.value || '50');
        const category1Total = parseInt(document.getElementById(`nps-card-category1-total-input-${componentId}`)?.value || '100');
        const category1Color = document.getElementById(`nps-card-category1-color-input-${componentId}`)?.value || 'var(--ubits-semantic-error, #E53E3E)';
        const category2Label = document.getElementById(`nps-card-category2-label-input-${componentId}`)?.value || 'Neutrales';
        const category2Current = parseInt(document.getElementById(`nps-card-category2-current-input-${componentId}`)?.value || '10');
        const category2Total = parseInt(document.getElementById(`nps-card-category2-total-input-${componentId}`)?.value || '100');
        const category2Color = document.getElementById(`nps-card-category2-color-input-${componentId}`)?.value || 'var(--ubits-semantic-warning, #F6AD55)';
        const category3Label = document.getElementById(`nps-card-category3-label-input-${componentId}`)?.value || 'Tienen confianza';
        const category3Current = parseInt(document.getElementById(`nps-card-category3-current-input-${componentId}`)?.value || '30');
        const category3Total = parseInt(document.getElementById(`nps-card-category3-total-input-${componentId}`)?.value || '100');
        const category3Color = document.getElementById(`nps-card-category3-color-input-${componentId}`)?.value || 'var(--ubits-semantic-success, #38A169)';
        const showTitle = document.getElementById(`nps-card-show-title-toggle-${componentId}`)?.checked === true;
        const showResponsesCount = document.getElementById(`nps-card-show-responses-count-toggle-${componentId}`)?.checked === true;
        const showGauge = document.getElementById(`nps-card-show-gauge-toggle-${componentId}`)?.checked === true;
        const showCategories = document.getElementById(`nps-card-show-categories-toggle-${componentId}`)?.checked === true;
        const showInfoIcon = document.getElementById(`nps-card-show-info-icon-toggle-${componentId}`)?.checked === true;
        const showActionButton = document.getElementById(`nps-card-show-action-button-toggle-${componentId}`)?.checked === true;
        const lowColor = document.getElementById(`nps-card-low-color-input-${componentId}`)?.value || 'var(--ubits-semantic-error, #E53E3E)';
        const mediumColor = document.getElementById(`nps-card-medium-color-input-${componentId}`)?.value || 'var(--ubits-semantic-warning, #F6AD55)';
        const highColor = document.getElementById(`nps-card-high-color-input-${componentId}`)?.value || 'var(--ubits-semantic-success, #38A169)';
        const gaugeBackgroundColor = document.getElementById(`nps-card-gauge-background-color-input-${componentId}`)?.value || 'var(--ubits-bg-3)';
        
        // Construir categorÃ­as
        const categories = [
          { label: category1Label, current: category1Current, total: category1Total, color: category1Color },
          { label: category2Label, current: category2Current, total: category2Total, color: category2Color },
          { label: category3Label, current: category3Current, total: category3Total, color: category3Color }
        ];
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar HTML usando tokens UBITS
        const npsCardHTML = generateNPSCardHTML({
          title: title,
          score: score,
          scoreLabel: scoreLabel,
          totalResponses: totalResponses,
          responsesLabel: responsesLabel,
          categories: categories,
          size: size,
          showTitle: showTitle,
          showResponsesCount: showResponsesCount,
          showGauge: showGauge,
          showCategories: showCategories,
          showInfoIcon: showInfoIcon,
          showActionButton: showActionButton,
          lowColor: lowColor,
          mediumColor: mediumColor,
          highColor: highColor,
          gaugeBackgroundColor: gaugeBackgroundColor
        });
        previewContainer.innerHTML = npsCardHTML;
        
        console.log('âœ… NPS Card preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de NPS Card usando tokens UBITS
      function generateNPSCardHTML(options) {
        const {
          title = 'Nivel de confianza',
          score = 0,
          scoreLabel = 'PuntuaciÃ³n',
          totalResponses = 0,
          responsesLabel = 'respuestas',
          categories = [],
          size = 'md',
          showTitle = true,
          showResponsesCount = true,
          showGauge = true,
          showCategories = true,
          showInfoIcon = false,
          showActionButton = false,
          lowColor = 'var(--ubits-semantic-error, #E53E3E)',
          mediumColor = 'var(--ubits-semantic-warning, #F6AD55)',
          highColor = 'var(--ubits-semantic-success, #38A169)',
          gaugeBackgroundColor = 'var(--ubits-bg-3)'
        } = options;
        
        // Construir clases CSS
        const classes = [
          'ubits-nps-card',
          `ubits-nps-card--${size}`
        ].filter(Boolean).join(' ');
        
        // TamaÃ±o del gauge
        const gaugeSize = 360;
        const strokeWidth = 24;
        
        // Clases de tipografÃ­a
        const titleClass = 'ubits-body-md-bold';
        const responsesCountClass = 'ubits-body-sm-regular';
        const scoreClass = 'ubits-display-3-bold';
        const scoreLabelClass = 'ubits-body-sm-bold';
        
        // Helper para renderizar iconos FontAwesome
        function renderIconHelper(iconName, iconStyle, iconColor) {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          const colorStyle = iconColor ? `style="color: ${iconColor};"` : '';
          return `<i class="${iconClass} ${name}" ${colorStyle}></i>`;
        }
        
        // Renderizar icono de informaciÃ³n como botÃ³n terciario si estÃ¡ habilitado
        const infoIconHTML = showInfoIcon
          ? generateSimpleButtonHTML({
              variant: 'tertiary',
              size: 'sm',
              icon: 'circle-info',
              iconStyle: 'regular',
              iconOnly: true,
              ariaLabel: 'InformaciÃ³n'
            })
          : '';
        
        // Renderizar botÃ³n de acciÃ³n con flecha a la derecha en la esquina superior derecha
        const actionButtonHTML = showActionButton
          ? generateSimpleButtonHTML({
              variant: 'tertiary',
              size: 'sm',
              icon: 'chevron-right',
              iconStyle: 'regular',
              iconOnly: true,
              ariaLabel: 'Ver mÃ¡s'
            })
          : '';
        
        // Renderizar tÃ­tulo y contador de respuestas
        const headerHTML = showTitle || showResponsesCount
          ? `
            <div class="ubits-nps-card__header" style="margin-bottom: -16px !important; padding-bottom: 0 !important;">
              <div class="ubits-nps-card__title-group">
                ${showTitle ? `<h3 class="ubits-nps-card__title ${titleClass}">${title}</h3>` : ''}
                ${infoIconHTML}
              </div>
              ${showResponsesCount ? `<div class="ubits-nps-card__responses-count ${responsesCountClass}">${totalResponses} ${responsesLabel}</div>` : ''}
              ${actionButtonHTML ? `<div class="ubits-nps-card__action-button">${actionButtonHTML}</div>` : ''}
            </div>
          `
          : '';
        
        // Calcular la posiciÃ³n del texto para alinearlo donde empieza la media luna
        const textPadding = strokeWidth / 2;
        const textRadius = (gaugeSize - textPadding * 2) / 2;
        const textCenterY = gaugeSize - textPadding;
        const textPositionY = textCenterY - (textRadius * 0.75);
        const textPositionPercent = (textPositionY / gaugeSize) * 100;
        
        // Renderizar gauge semicircular
        const gaugeHTML = showGauge
          ? `
            <div class="ubits-nps-card__gauge-wrapper" style="--text-position: ${textPositionPercent}%;">
              ${renderSemicircularGaugeHTML(
                score,
                gaugeSize,
                strokeWidth,
                lowColor,
                mediumColor,
                highColor,
                gaugeBackgroundColor
              )}
              <div class="ubits-nps-card__gauge-content">
                <div class="ubits-nps-card__gauge-score ${scoreClass}">
                  ${score}
                </div>
                <div class="ubits-nps-card__gauge-label ${scoreLabelClass}">
                  ${scoreLabel}
                </div>
              </div>
            </div>
          `
          : '';
        
        // Renderizar categorÃ­as
        const categoriesHTML = showCategories && categories.length > 0
          ? `
            <div class="ubits-nps-card__categories">
              ${categories.map(cat => renderNPSCategoryHTML(cat, size)).join('')}
            </div>
          `
          : '';
        
        // Agregar padding-bottom al content cuando no hay categorÃ­as para mantener el espacio de 12px
        const contentStyle = !showCategories || categories.length === 0
          ? 'padding-bottom: 12px;'
          : '';
        
        return `
          <div class="${classes}">
            ${headerHTML}
            <div class="ubits-nps-card__content" style="${contentStyle}">
              ${gaugeHTML}
              ${categoriesHTML}
            </div>
          </div>
        `;
      }
      
      // Helper para renderizar el gauge semicircular
      function renderSemicircularGaugeHTML(score, size, strokeWidth, lowColor, mediumColor, highColor, backgroundColor) {
        const padding = strokeWidth / 2;
        const radius = (size - padding * 2) / 2;
        const centerX = size / 2;
        const centerY = size - padding;
        
        const startAngle = 180;
        const endAngle = 0;
        
        // FunciÃ³n helper para convertir grados a coordenadas SVG
        const angleToCoords = (angleDeg, r) => {
          const angleRad = (angleDeg * Math.PI) / 180;
          const x = centerX + r * Math.cos(angleRad);
          const y = centerY + r * Math.sin(angleRad);
          return { x, y };
        };
        
        // Crear el arco del fondo
        const startCoords = angleToCoords(startAngle, radius);
        const endCoords = angleToCoords(endAngle, radius);
        const backgroundPath = `M ${startCoords.x} ${startCoords.y} A ${radius} ${radius} 0 1 1 ${endCoords.x} ${endCoords.y}`;
        
        // Color del progreso
        const progressColor = 'var(--ubits-chart-color-bg-neutral-blue-base, #557593)';
        
        // Calcular el Ã¡ngulo del score
        let scoreAngle;
        if (score <= 50) {
          scoreAngle = 180 + (score / 50) * 90;
        } else {
          scoreAngle = 270 + ((score - 50) / 50) * 90;
          if (scoreAngle >= 360) {
            scoreAngle = scoreAngle - 360;
          }
        }
        
        // Calcular coordenadas del punto final del progreso
        const scoreCoords = angleToCoords(scoreAngle, radius);
        
        // Determinar largeArcFlag
        const angleDiff = scoreAngle > startAngle 
          ? scoreAngle - startAngle 
          : (360 - startAngle) + scoreAngle;
        const progressLargeArcFlag = angleDiff > 180 ? 1 : 0;
        
        // Path del progreso
        const progressPath = `M ${startCoords.x} ${startCoords.y} A ${radius} ${radius} 0 ${progressLargeArcFlag} 1 ${scoreCoords.x} ${scoreCoords.y}`;
        
        // Calcular el punto mÃ¡s alto del semicÃ­rculo
        const topPoint = angleToCoords(270, radius);
        
        // Calcular viewBox
        const viewBoxPadding = 30;
        const viewBoxSize = size + (viewBoxPadding * 2);
        const viewBoxStartY = topPoint.y - 20;
        const viewBoxHeight = size - viewBoxStartY + viewBoxPadding;
        const halfMoonCenterY = centerY - (radius / 2);
        const halfMoonCenterPercent = (halfMoonCenterY / size) * 100;
        
        // NÃºmeros alrededor de la media luna
        const marks = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100];
        const markElements = marks.map(mark => {
          let markAngle;
          if (mark <= 50) {
            markAngle = 180 + (mark / 50) * 90;
          } else {
            markAngle = 270 + ((mark - 50) / 50) * 90;
            if (markAngle >= 360) {
              markAngle = markAngle - 360;
            }
          }
          
          const textDistance = radius + 20;
          const textPos = angleToCoords(markAngle, textDistance);
          
          return `
            <text
              x="${textPos.x}"
              y="${textPos.y}"
              font-family="var(--font-sans)"
              font-size="var(--font-body-sm-size, 13px)"
              font-weight="var(--weight-regular, 400)"
              fill="var(--ubits-fg-2-medium)"
              text-anchor="middle"
              dominant-baseline="middle"
              style="font-size: var(--font-body-sm-size, 13px) !important; font-weight: var(--weight-regular, 400) !important; font-family: var(--font-sans) !important;"
            >${mark}</text>
          `;
        }).join('');
        
        return `
          <svg 
            class="ubits-nps-card__gauge-svg" 
            width="${size}" 
            height="${size}" 
            viewBox="${-viewBoxPadding} ${viewBoxStartY} ${viewBoxSize} ${viewBoxHeight}"
            data-half-moon-center="${halfMoonCenterPercent}"
            style="overflow: visible; display: block;"
          >
            <path
              d="${backgroundPath}"
              fill="none"
              stroke="${backgroundColor}"
              stroke-width="${strokeWidth}"
              stroke-linecap="round"
            />
            <path
              d="${progressPath}"
              fill="none"
              stroke="${progressColor}"
              stroke-width="${strokeWidth}"
              stroke-linecap="round"
              class="ubits-nps-card__gauge-progress"
            />
            ${markElements}
          </svg>
        `;
      }
      
      // Helper para renderizar una categorÃ­a de NPS
      function renderNPSCategoryHTML(category, size) {
        const percentage = Math.round((category.current / category.total) * 100);
        
        const labelClass = size === 'sm' 
          ? 'ubits-body-sm-regular' 
          : size === 'lg' 
          ? 'ubits-body-md-regular' 
          : 'ubits-body-sm-regular';
        
        const valueClass = size === 'sm'
          ? 'ubits-body-sm-regular'
          : size === 'lg'
          ? 'ubits-body-md-regular'
          : 'ubits-body-sm-regular';
        
        const percentageClass = size === 'sm'
          ? 'ubits-body-sm-bold'
          : size === 'lg'
          ? 'ubits-body-md-bold'
          : 'ubits-body-sm-bold';
        
        return `
          <div class="ubits-nps-card__category">
            <div class="ubits-nps-card__category-label ${labelClass}">
              ${category.label}
            </div>
            <div class="ubits-nps-card__category-value ${valueClass}">
              ${category.current}/${category.total} <span class="ubits-nps-card__category-percentage ${percentageClass}">${percentage}%</span>
            </div>
          </div>
        `;
      }
      
      // ============================================
      // CSAT METRIC CARD - Funciones de control
      // ============================================
      
      window.setCSATMetricCardControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setCSATMetricCardControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showInfoIcon': 'csat-metric-card-show-info-icon-status',
          'showActionButton': 'csat-metric-card-show-action-button-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateCSATMetricCardPreview === 'function') {
          window.updateCSATMetricCardPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de CSAT Metric Card usando tokens UBITS
      window.updateCSATMetricCardPreview = function(componentId) {
        const previewContainer = document.getElementById(`csat-metric-card-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `csat-metric-card-preview-${componentId}`);
          return;
        }
        
        // Obtener valores de los controles
        const size = document.getElementById(`csat-metric-card-size-select-${componentId}`)?.value || 'md';
        const title = document.getElementById(`csat-metric-card-title-input-${componentId}`)?.value || 'Califica el producto';
        const totalResponses = parseInt(document.getElementById(`csat-metric-card-total-responses-input-${componentId}`)?.value || '7');
        const responsesLabel = document.getElementById(`csat-metric-card-responses-label-input-${componentId}`)?.value || 'respuestas';
        const average = parseFloat(document.getElementById(`csat-metric-card-average-input-${componentId}`)?.value || '4.00');
        const averageLabel = document.getElementById(`csat-metric-card-average-label-input-${componentId}`)?.value || 'Promedio:';
        const score = parseFloat(document.getElementById(`csat-metric-card-score-input-${componentId}`)?.value || '3');
        const titleIcon = document.getElementById(`csat-metric-card-title-icon-input-${componentId}`)?.value || '';
        const titleIconStyle = document.getElementById(`csat-metric-card-title-icon-style-select-${componentId}`)?.value || 'regular';
        const titleIconColor = document.getElementById(`csat-metric-card-title-icon-color-input-${componentId}`)?.value || '';
        const showInfoIcon = document.getElementById(`csat-metric-card-show-info-icon-toggle-${componentId}`)?.checked === true;
        const showActionButton = document.getElementById(`csat-metric-card-show-action-button-toggle-${componentId}`)?.checked === true;
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar HTML usando tokens UBITS
        const csatMetricCardHTML = generateCSATMetricCardHTML({
          title: title,
          totalResponses: totalResponses,
          responsesLabel: responsesLabel,
          average: average,
          averageLabel: averageLabel,
          score: score,
          titleIcon: titleIcon || undefined,
          titleIconStyle: titleIconStyle,
          titleIconColor: titleIconColor || undefined,
          showInfoIcon: showInfoIcon,
          showActionButton: showActionButton,
          size: size
        });
        previewContainer.innerHTML = csatMetricCardHTML;
        
        console.log('âœ… CSAT Metric Card preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de CSAT Metric Card usando tokens UBITS
      function generateCSATMetricCardHTML(options) {
        const {
          title = 'Califica el producto',
          totalResponses = 0,
          responsesLabel = 'respuestas',
          average = 0,
          averageLabel = 'Promedio:',
          score = 0,
          titleIcon,
          titleIconStyle = 'regular',
          titleIconColor,
          showInfoIcon = false,
          showActionButton = false,
          size = 'md'
        } = options;
        
        // Clases base usando tokens UBITS
        const classes = [
          'ubits-csat-metric-card',
          `ubits-csat-metric-card--${size}`
        ].filter(Boolean).join(' ');
        
        // Helper para renderizar iconos FontAwesome
        const renderIconHelper = (iconName, iconStyle, iconColor) => {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          const colorStyle = iconColor ? `style="color: ${iconColor};"` : '';
          return `<i class="${iconClass} ${name}" ${colorStyle}></i>`;
        };
        
        // Mapeo de caritas segÃºn el Ã­ndice (0-4) con sus colores
        const FACES = [
          { icon: 'face-angry', label: 'Muy malo', color: 'var(--ubits-feedback-accent-error)' },
          { icon: 'face-sad-tear', label: 'Malo', color: 'var(--ubits-feedback-fg-warning-subtle-hover)' },
          { icon: 'face-meh', label: 'Regular', color: 'var(--ubits-feedback-accent-info)' },
          { icon: 'face-smile', label: 'Bueno', color: 'var(--ubits-feedback-accent-success)' },
          { icon: 'face-smile-beam', label: 'Muy bueno', color: 'var(--ubits-feedback-accent-success)' }
        ];
        
        // Renderizar grÃ¡fico de caritas
        const renderFacesRating = (scoreValue) => {
          const totalFaces = 5;
          const roundedScore = Math.round(scoreValue);
          const selectedFaceIndex = Math.min(Math.max(roundedScore - 1, 0), totalFaces - 1); // 0-4
          
          let facesHTML = '';
          
          for (let i = 0; i < totalFaces; i++) {
            const face = FACES[i];
            const isSelected = i === selectedFaceIndex;
            const faceClass = isSelected 
              ? 'ubits-csat-metric-card__face ubits-csat-metric-card__face--selected'
              : 'ubits-csat-metric-card__face ubits-csat-metric-card__face--empty';
            const faceColor = isSelected ? face.color : 'var(--ubits-border-1)';
            
            facesHTML += `
              <div class="ubits-csat-metric-card__face-wrapper">
                <i class="far fa-${face.icon} ${faceClass}" style="color: ${faceColor};"></i>
                <span class="ubits-csat-metric-card__face-label">${face.label}</span>
              </div>
            `;
          }
          
          return facesHTML;
        };
        
        // Renderizar botÃ³n helper
        const renderButtonHTML = (opts) => {
          const { variant = 'tertiary', size: btnSize = 'sm', icon, iconOnly = true } = opts;
          const btnClasses = [
            'ubits-button',
            `ubits-button--${variant}`,
            `ubits-button--${btnSize}`
          ].filter(Boolean).join(' ');
          const iconHTML = icon ? `<i class="far fa-${icon}"></i>` : '';
          return `<button class="${btnClasses}" type="button" aria-label="${opts.ariaLabel || ''}">${iconHTML}</button>`;
        };
        
        // Renderizar icono del tÃ­tulo si existe
        const titleIconHTML = titleIcon 
          ? `<div class="ubits-csat-metric-card__title-icon">${renderIconHelper(titleIcon, titleIconStyle, titleIconColor)}</div>`
          : '';
        
        // Renderizar icono de informaciÃ³n
        const infoIconHTML = showInfoIcon
          ? renderButtonHTML({ icon: 'circle-info', ariaLabel: 'InformaciÃ³n' })
          : '';
        
        // Renderizar botÃ³n de acciÃ³n
        const actionButtonHTML = showActionButton
          ? renderButtonHTML({ icon: 'chevron-right', ariaLabel: 'Ver mÃ¡s' })
          : '';
        
        // Clases de tipografÃ­a segÃºn tamaÃ±o (usando solo clases vÃ¡lidas UBITS)
        const titleSizeClass = 'ubits-body-md-bold';
        const statsClass = 'ubits-body-sm-regular';
        
        // Formatear promedio con 2 decimales
        const formattedAverage = average.toFixed(2);
        
        // Renderizar grÃ¡fico de caritas
        const facesHTML = renderFacesRating(score);
        
        return `
          <div class="${classes}">
            <div class="ubits-csat-metric-card__header">
              ${titleIconHTML}
              <div class="ubits-csat-metric-card__title-group">
                <h3 class="ubits-csat-metric-card__title ${titleSizeClass}">${title}</h3>
                ${infoIconHTML}
              </div>
              ${actionButtonHTML ? `<div class="ubits-csat-metric-card__action-button">${actionButtonHTML}</div>` : ''}
            </div>
            <div class="ubits-csat-metric-card__body">
              <div class="ubits-csat-metric-card__stats">
                <span class="ubits-csat-metric-card__responses ${statsClass}">${totalResponses} ${responsesLabel}</span>
                <span class="ubits-csat-metric-card__average ${statsClass}">${averageLabel} (${formattedAverage})</span>
              </div>
              <div class="ubits-csat-metric-card__chart">
                <div class="ubits-csat-metric-card__faces">
                  ${facesHTML}
                </div>
              </div>
            </div>
          </div>
        `;
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA DATA VIEW
      // ========================================
      
      // FunciÃ³n para controlar DataView
      window.setDataViewControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setDataViewControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showCategory': 'data-view-show-category-status',
          'showRating': 'data-view-show-rating-status',
          'showPrice': 'data-view-show-price-status',
          'showWishlist': 'data-view-show-wishlist-status',
          'showBuyButton': 'data-view-show-buy-button-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateDataViewPreview === 'function') {
          window.updateDataViewPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de DataView usando tokens UBITS
      window.updateDataViewPreview = function(componentId) {
        console.log('ğŸ”„ updateDataViewPreview llamado con componentId:', componentId);
        const previewContainer = document.getElementById(`data-view-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `data-view-preview-${componentId}`);
          return;
        }
        console.log('âœ… Preview container encontrado:', previewContainer);
        
        // Obtener valores de los controles
        const size = document.getElementById(`data-view-size-select-${componentId}`)?.value || 'md';
        const productCount = parseInt(document.getElementById(`data-view-product-count-input-${componentId}`)?.value || '5');
        const defaultStockStatus = document.getElementById(`data-view-stock-status-select-${componentId}`)?.value || 'INSTOCK';
        const defaultRating = parseFloat(document.getElementById(`data-view-rating-input-${componentId}`)?.value || '4');
        const defaultPrice = parseInt(document.getElementById(`data-view-price-input-${componentId}`)?.value || '50');
        const buyButtonText = document.getElementById(`data-view-buy-button-text-input-${componentId}`)?.value || 'Buy Now';
        const buyButtonIcon = document.getElementById(`data-view-buy-button-icon-input-${componentId}`)?.value || 'shopping-cart';
        const wishlistIcon = document.getElementById(`data-view-wishlist-icon-input-${componentId}`)?.value || 'heart';
        const showCategory = document.getElementById(`data-view-show-category-toggle-${componentId}`)?.checked === true;
        const showRating = document.getElementById(`data-view-show-rating-toggle-${componentId}`)?.checked === true;
        const showPrice = document.getElementById(`data-view-show-price-toggle-${componentId}`)?.checked === true;
        const showWishlist = document.getElementById(`data-view-show-wishlist-toggle-${componentId}`)?.checked === true;
        const showBuyButton = document.getElementById(`data-view-show-buy-button-toggle-${componentId}`)?.checked === true;
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar productos
        const products = generateDataViewProducts(productCount, defaultStockStatus, defaultRating, defaultPrice);
        
        // Generar HTML usando tokens UBITS
        const dataViewHTML = generateDataViewHTML({
          products: products,
          size: size,
          showCategory: showCategory,
          showRating: showRating,
          showPrice: showPrice,
          showWishlist: showWishlist,
          showBuyButton: showBuyButton,
          buyButtonText: buyButtonText,
          buyButtonIcon: buyButtonIcon,
          wishlistIcon: wishlistIcon
        });
        previewContainer.innerHTML = dataViewHTML;
        
        console.log('âœ… DataView preview actualizado');
      };
      
      // FunciÃ³n helper para generar productos de ejemplo
      function generateDataViewProducts(count, defaultStockStatus, defaultRating, defaultPrice) {
        const categories = ['Accessories', 'Fitness', 'Clothing', 'Electronics', 'Home'];
        const names = [
          'Bamboo Watch',
          'Black Watch',
          'Blue Band',
          'Blue T-Shirt',
          'Bracelet',
          'Wireless Headphones',
          'Smart Watch',
          'Running Shoes',
          'Yoga Mat',
          'Water Bottle',
        ];
        
        // Lista de imÃ¡genes reales disponibles (rutas relativas desde index.html)
        const availableImages = [
          '../assets/images/cards-learn/administracion-efectiva-del-tiempo.jpg',
          '../assets/images/cards-learn/segmenta-la-experiencia-del-cliente.jpg',
          '../assets/images/cards-learn/introduccion-al-backend-node-js.jpeg',
          '../assets/images/cards-learn/introduccion-al-desarrollo-web.jpeg',
          '../assets/images/cards-learn/como-ejercer-el-liderazgo-inclusivo.jpeg',
          '../assets/images/cards-learn/flexbox-y-grid.jpeg',
          '../assets/images/cards-learn/react-context-api.jpeg',
          '../assets/images/cards-learn/agilidad-emocional.jpeg',
          '../assets/images/cards-learn/primeros-pasos-en-react.jpeg',
          '../assets/images/cards-learn/neuroliderazgo-configura-tu-mente.jpeg',
        ];
        
        return Array.from({ length: count }, (_, index) => {
          const categoryIndex = index % categories.length;
          const nameIndex = index % names.length;
          
          const stockStatuses = ['INSTOCK', 'LOWSTOCK', 'OUTOFSTOCK'];
          const stockIndex = index % stockStatuses.length;
          
          const ratings = [3, 3.5, 4, 4.5, 5];
          const ratingIndex = index % ratings.length;
          
          const prices = [15, 29, 50, 65, 72, 79, 100];
          const priceIndex = index % prices.length;
          
          return {
            id: `product-${index + 1}`,
            image: availableImages[index % availableImages.length],
            imageAlt: names[nameIndex],
            category: categories[categoryIndex],
            name: names[nameIndex],
            rating: defaultRating !== 4 ? defaultRating : ratings[ratingIndex],
            price: defaultPrice !== 50 ? defaultPrice : prices[priceIndex],
            stockStatus: defaultStockStatus !== 'INSTOCK' ? defaultStockStatus : stockStatuses[stockIndex],
            inWishlist: index % 3 === 0,
          };
        });
      }
      
      // FunciÃ³n helper para generar HTML de DataView usando tokens UBITS
      function generateDataViewHTML(options) {
        const {
          products = [],
          size = 'md',
          showCategory = true,
          showRating = true,
          showPrice = true,
          showWishlist = true,
          showBuyButton = true,
          buyButtonText = 'Buy Now',
          buyButtonIcon = 'shopping-cart',
          wishlistIcon = 'heart'
        } = options;
        
        // Clases base usando tokens UBITS
        const classes = [
          'ubits-data-view',
          `ubits-data-view--${size}`
        ].filter(Boolean).join(' ');
        
        // Helper para renderizar iconos FontAwesome
        const renderIconHelper = (iconName, iconStyle = 'regular') => {
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="${iconClass} ${name}"></i>`;
        };
        
        // Helper para renderizar el badge de stock
        const renderStockBadge = (status) => {
          const statusConfig = {
            INSTOCK: { text: 'INSTOCK', class: 'ubits-data-view__stock-badge--instock' },
            LOWSTOCK: { text: 'LOWSTOCK', class: 'ubits-data-view__stock-badge--lowstock' },
            OUTOFSTOCK: { text: 'OUTOFSTOCK', class: 'ubits-data-view__stock-badge--outofstock' }
          };
          
          const config = statusConfig[status] || statusConfig.INSTOCK;
          return `<span class="ubits-data-view__stock-badge ${config.class}">${config.text}</span>`;
        };
        
        // Helper para renderizar el rating con estrellas
        const renderRating = (rating) => {
          const fullStars = Math.floor(rating);
          const hasHalfStar = rating % 1 >= 0.5;
          const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
          
          let starsHTML = '';
          
          for (let i = 0; i < fullStars; i++) {
            starsHTML += `<i class="fas fa-star ubits-data-view__star ubits-data-view__star--filled"></i>`;
          }
          
          if (hasHalfStar) {
            starsHTML += `<i class="fas fa-star-half-alt ubits-data-view__star ubits-data-view__star--half"></i>`;
          }
          
          for (let i = 0; i < emptyStars; i++) {
            starsHTML += `<i class="far fa-star ubits-data-view__star ubits-data-view__star--empty"></i>`;
          }
          
          return `
            <div class="ubits-data-view__rating">
              ${starsHTML}
              <span class="ubits-body-sm-regular ubits-data-view__rating-number">${rating}</span>
            </div>
          `;
        };
        
        // Helper para formatear precio
        const formatPrice = (price) => {
          return new Intl.NumberFormat('es-CO', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 0,
            maximumFractionDigits: 0
          }).format(price);
        };
        
        // Renderizar productos
        let itemsHTML = '';
        products.forEach((product, index) => {
          const productId = product.id || `product-${index}`;
          const stockStatus = product.stockStatus || 'INSTOCK';
          const inWishlist = product.inWishlist || false;
          
          itemsHTML += `
            <div class="ubits-data-view__item" data-product-id="${productId}" data-index="${index}">
              <div class="ubits-data-view__image-wrapper">
                <img 
                  src="${product.image}" 
                  alt="${product.imageAlt || product.name}" 
                  class="ubits-data-view__image"
                />
                ${renderStockBadge(stockStatus)}
              </div>
              <div class="ubits-data-view__content">
                <div class="ubits-data-view__main">
                  ${showCategory ? `<div class="ubits-body-sm-regular ubits-data-view__category">${product.category}</div>` : ''}
                  <h3 class="ubits-body-md-semibold ubits-data-view__name">${product.name}</h3>
                  ${showRating ? renderRating(product.rating) : ''}
                </div>
                <div class="ubits-data-view__right">
                  ${showPrice ? `<span class="ubits-body-md-bold ubits-data-view__price">${formatPrice(product.price)}</span>` : ''}
                  <div class="ubits-data-view__actions">
                    ${showWishlist ? `
                      <button 
                        class="ubits-button ubits-button--secondary ubits-button--sm ubits-data-view__wishlist-button ${inWishlist ? 'ubits-data-view__wishlist-button--active' : ''}"
                        data-action="wishlist"
                        aria-label="${inWishlist ? 'Remover de favoritos' : 'Agregar a favoritos'}"
                      >
                        ${renderIconHelper(wishlistIcon, inWishlist ? 'solid' : 'regular')}
                      </button>
                    ` : ''}
                    ${showBuyButton ? `
                      <button class="ubits-button ubits-button--primary ubits-button--sm ubits-data-view__buy-button" data-action="buy">
                        ${renderIconHelper(buyButtonIcon, 'solid')}
                        <span>${buyButtonText}</span>
                      </button>
                    ` : ''}
                  </div>
                </div>
              </div>
            </div>
          `;
        });
        
        return `
          <div class="${classes}">
            ${itemsHTML}
          </div>
        `;
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA GALLERY
      // ========================================
      
      // FunciÃ³n para controlar Gallery
      window.setGalleryControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setGalleryControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showThumbnails': 'gallery-show-thumbnails-status',
          'lazyLoad': 'gallery-lazy-load-status',
          'lightbox': 'gallery-lightbox-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateGalleryPreview === 'function') {
          window.updateGalleryPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de Gallery usando tokens UBITS
      window.updateGalleryPreview = function(componentId) {
        console.log('ğŸ”„ updateGalleryPreview llamado con componentId:', componentId);
        const previewContainer = document.getElementById(`gallery-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `gallery-preview-${componentId}`);
          return;
        }
        console.log('âœ… Preview container encontrado:', previewContainer);
        
        // Obtener valores de los controles
        const layout = document.getElementById(`gallery-layout-select-${componentId}`)?.value || 'grid';
        const size = document.getElementById(`gallery-size-select-${componentId}`)?.value || 'md';
        const columns = parseInt(document.getElementById(`gallery-columns-input-${componentId}`)?.value || '3');
        const gap = parseInt(document.getElementById(`gallery-gap-input-${componentId}`)?.value || '16');
        const aspectRatio = document.getElementById(`gallery-aspect-ratio-input-${componentId}`)?.value || undefined;
        const showThumbnails = document.getElementById(`gallery-show-thumbnails-toggle-${componentId}`)?.checked === true;
        const lazyLoad = document.getElementById(`gallery-lazy-load-toggle-${componentId}`)?.checked === true;
        const lightbox = document.getElementById(`gallery-lightbox-toggle-${componentId}`)?.checked === true;
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar items de ejemplo
        const items = generateGalleryItems();
        
        // Generar HTML usando tokens UBITS
        const galleryHTML = generateGalleryHTML({
          items: items,
          layout: layout,
          size: size,
          columns: columns,
          gap: gap,
          showThumbnails: showThumbnails,
          lazyLoad: lazyLoad,
          lightbox: lightbox,
          aspectRatio: aspectRatio
        });
        previewContainer.innerHTML = galleryHTML;
        
        // Inicializar funcionalidad JavaScript del Gallery
        initializeGalleryPreview(previewContainer, items, lightbox);
        
        console.log('âœ… Gallery preview actualizado');
      };
      
      // FunciÃ³n helper para generar items de ejemplo
      function generateGalleryItems() {
        const availableImages = [
          '../assets/images/cards-learn/administracion-efectiva-del-tiempo.jpg',
          '../assets/images/cards-learn/segmenta-la-experiencia-del-cliente.jpg',
          '../assets/images/cards-learn/introduccion-al-backend-node-js.jpeg',
          '../assets/images/cards-learn/introduccion-al-desarrollo-web.jpeg',
          '../assets/images/cards-learn/como-ejercer-el-liderazgo-inclusivo.jpeg',
          '../assets/images/cards-learn/flexbox-y-grid.jpeg',
          '../assets/images/cards-learn/react-context-api.jpeg',
          '../assets/images/cards-learn/agilidad-emocional.jpeg',
          '../assets/images/cards-learn/primeros-pasos-en-react.jpeg',
          '../assets/images/cards-learn/neuroliderazgo-configura-tu-mente.jpeg',
        ];
        
        const titles = [
          'AdministraciÃ³n Efectiva del Tiempo',
          'Segmenta la Experiencia del Cliente',
          'IntroducciÃ³n al Backend Node.js',
          'IntroducciÃ³n al Desarrollo Web',
          'CÃ³mo Ejercer el Liderazgo Inclusivo',
          'Flexbox y Grid',
          'React Context API',
          'Agilidad Emocional',
          'Primeros Pasos en React',
          'Neuroliderazgo Configura tu Mente'
        ];
        
        return availableImages.map((image, index) => ({
          id: index + 1,
          image: image,
          thumbnail: image,
          title: titles[index] || `Imagen ${index + 1}`,
          description: `DescripciÃ³n de ${titles[index] || `Imagen ${index + 1}`}`,
          alt: titles[index] || `Imagen ${index + 1}`
        }));
      }
      
      // FunciÃ³n helper para generar HTML de Gallery usando tokens UBITS
      function generateGalleryHTML(options) {
        const {
          items = [],
          layout = 'grid',
          size = 'md',
          columns = 3,
          gap = 16,
          showThumbnails = false,
          lazyLoad = false,
          lightbox = false,
          aspectRatio
        } = options;
        
        if (items.length === 0) {
          return '<div class="ubits-gallery ubits-gallery--empty">No hay imÃ¡genes para mostrar</div>';
        }
        
        // Construir clases CSS
        const classes = [
          'ubits-gallery',
          `ubits-gallery--${layout}`,
          `ubits-gallery--${size}`,
          showThumbnails && 'ubits-gallery--thumbnails',
          lazyLoad && 'ubits-gallery--lazy',
          lightbox && 'ubits-gallery--lightbox'
        ].filter(Boolean).join(' ');
        
        // Renderizar items
        const itemsHTML = items.map((item, index) => {
          const imageSrc = showThumbnails && item.thumbnail ? item.thumbnail : item.image;
          const imageAlt = item.alt || item.title || `Imagen ${index + 1}`;
          const loadingAttr = lazyLoad ? 'loading="lazy"' : '';
          const lightboxAttr = lightbox ? 'data-lightbox-item="true"' : '';
          const aspectRatioStyle = aspectRatio ? `style="aspect-ratio: ${aspectRatio};"` : '';
          
          return `
            <div class="ubits-gallery-item" 
                 data-item-id="${item.id}" 
                 data-item-index="${index}"
                 ${lightboxAttr}
                 ${aspectRatioStyle}>
              <div class="ubits-gallery-item__image-wrapper">
                <img src="${imageSrc}" 
                     alt="${imageAlt}" 
                     class="ubits-gallery-item__image"
                     ${loadingAttr}
                     data-full-image="${item.image}" />
                ${lightbox ? '<div class="ubits-gallery-item__overlay"><i class="fas fa-expand"></i></div>' : ''}
              </div>
            </div>
          `;
        }).join('');
        
        // Atributos de datos para JavaScript
        const dataAttrs = [
          `data-layout="${layout}"`,
          `data-size="${size}"`,
          `data-columns="${columns}"`,
          `data-gap="${gap}"`,
          lightbox && 'data-lightbox="true"',
          lazyLoad && 'data-lazy="true"'
        ].filter(Boolean).join(' ');
        
        // Estilos inline para grid columns y gap
        const style = `--gallery-gap: ${gap}px; --gallery-columns: ${columns};`;
        
        return `
          <div class="${classes}" ${dataAttrs} style="${style}">
            <div class="ubits-gallery__container">
              ${itemsHTML}
            </div>
          </div>
        `;
      }
      
      // FunciÃ³n para inicializar la funcionalidad JavaScript del Gallery preview
      function initializeGalleryPreview(container, items, lightbox) {
        const galleryElement = container.querySelector('.ubits-gallery');
        if (!galleryElement) return;
        
        const galleryItems = galleryElement.querySelectorAll('.ubits-gallery-item');
        if (galleryItems.length === 0) return;
        
        // Click en items para lightbox
        if (lightbox) {
          galleryItems.forEach((item, index) => {
            const itemElement = item;
            const itemId = itemElement.getAttribute('data-item-id');
            const galleryItem = items.find(i => String(i.id) === itemId);
            
            if (!galleryItem) return;
            
            itemElement.addEventListener('click', (e) => {
              e.preventDefault();
              openLightboxPreview(galleryItem, items, index);
            });
          });
        }
      }
      
      // FunciÃ³n para abrir el lightbox en el preview
      function openLightboxPreview(item, allItems, currentIndex) {
        // Crear overlay del lightbox
        const overlay = document.createElement('div');
        overlay.className = 'ubits-gallery-lightbox';
        overlay.style.background = 'rgba(0, 0, 0, 0.95)';
        
        // Generar thumbnails
        const thumbnailsHTML = allItems.map((thumbItem, idx) => {
          const isActive = idx === currentIndex ? 'ubits-gallery-lightbox__thumbnail--active' : '';
          const thumbSrc = thumbItem.thumbnail || thumbItem.image;
          return `
            <div class="ubits-gallery-lightbox__thumbnail ${isActive}" 
                 data-thumb-index="${idx}"
                 data-item-id="${thumbItem.id}"
                 style="display: flex; align-items: center; justify-content: center; background: rgba(0, 0, 0, 0.3);">
              <img src="${thumbSrc}" alt="${thumbItem.alt || thumbItem.title || `Thumbnail ${idx + 1}`}" style="object-fit: cover; object-position: center; width: 100%; height: 100%;" />
            </div>
          `;
        }).join('');
        
        overlay.innerHTML = `
          <div class="ubits-gallery-lightbox__content">
            <button class="ubits-gallery-lightbox__close" aria-label="Cerrar">
              <i class="fas fa-times"></i>
            </button>
            <div class="ubits-gallery-lightbox__main">
              <button class="ubits-gallery-lightbox__prev" aria-label="Anterior">
                <i class="fas fa-chevron-left"></i>
              </button>
              <div class="ubits-gallery-lightbox__image-wrapper">
                <img src="${item.image}" alt="${item.alt || item.title || 'Imagen'}" class="ubits-gallery-lightbox__image" />
              </div>
              <button class="ubits-gallery-lightbox__next" aria-label="Siguiente">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
            <div class="ubits-gallery-lightbox__thumbnails">
              ${thumbnailsHTML}
            </div>
          </div>
        `;
        
        document.body.appendChild(overlay);
        document.body.style.overflow = 'hidden';
        
        let currentIdx = currentIndex;
        
        // Cerrar lightbox
        const closeBtn = overlay.querySelector('.ubits-gallery-lightbox__close');
        const closeLightbox = () => {
          overlay.remove();
          document.body.style.overflow = '';
        };
        
        if (closeBtn) {
          closeBtn.addEventListener('click', closeLightbox);
        }
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) {
            closeLightbox();
          }
        });
        
        // NavegaciÃ³n
        const prevBtn = overlay.querySelector('.ubits-gallery-lightbox__prev');
        const nextBtn = overlay.querySelector('.ubits-gallery-lightbox__next');
        const lightboxImage = overlay.querySelector('.ubits-gallery-lightbox__image');
        const thumbnails = overlay.querySelectorAll('.ubits-gallery-lightbox__thumbnail');
        
        const updateLightbox = () => {
          const currentItem = allItems[currentIdx];
          if (currentItem && lightboxImage) {
            lightboxImage.src = currentItem.image;
            lightboxImage.alt = currentItem.alt || currentItem.title || 'Imagen';
            
            // Actualizar thumbnails activos
            thumbnails.forEach((thumb, idx) => {
              if (idx === currentIdx) {
                thumb.classList.add('ubits-gallery-lightbox__thumbnail--active');
                thumb.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
              } else {
                thumb.classList.remove('ubits-gallery-lightbox__thumbnail--active');
              }
            });
          }
        };
        
        // Click en thumbnails
        thumbnails.forEach((thumb, idx) => {
          thumb.addEventListener('click', () => {
            currentIdx = idx;
            updateLightbox();
          });
        });
        
        if (prevBtn) {
          prevBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            currentIdx = currentIdx > 0 ? currentIdx - 1 : allItems.length - 1;
            updateLightbox();
          });
        }
        
        if (nextBtn) {
          nextBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            currentIdx = currentIdx < allItems.length - 1 ? currentIdx + 1 : 0;
            updateLightbox();
          });
        }
        
        // NavegaciÃ³n con teclado
        const handleKeyDown = (e) => {
          if (e.key === 'Escape') {
            closeLightbox();
            document.removeEventListener('keydown', handleKeyDown);
          } else if (e.key === 'ArrowLeft') {
            currentIdx = currentIdx > 0 ? currentIdx - 1 : allItems.length - 1;
            updateLightbox();
          } else if (e.key === 'ArrowRight') {
            currentIdx = currentIdx < allItems.length - 1 ? currentIdx + 1 : 0;
            updateLightbox();
          }
        };
        
        document.addEventListener('keydown', handleKeyDown);
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA MENU
      // ========================================
      
      // FunciÃ³n para controlar Menu
      window.setMenuControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setMenuControl:', option, value, componentId);
        
        // Actualizar preview
        if (typeof window.updateMenuPreview === 'function') {
          window.updateMenuPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de Menu usando tokens UBITS
      window.updateMenuPreview = function(componentId) {
        console.log('ğŸ”„ updateMenuPreview llamado con componentId:', componentId);
        const previewContainer = document.getElementById(`menu-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `menu-preview-${componentId}`);
          return;
        }
        console.log('âœ… Preview container encontrado:', previewContainer);
        
        // Obtener valores de los controles
        const logoImage = document.getElementById(`menu-logo-image-input-${componentId}`)?.value || '';
        const appName = document.getElementById(`menu-app-name-input-${componentId}`)?.value || '';
        const logoHref = document.getElementById(`menu-logo-href-input-${componentId}`)?.value || '';
        const width = parseInt(document.getElementById(`menu-width-input-${componentId}`)?.value || '280');
        
        // SecciÃ³n 1
        const section1Title = document.getElementById(`menu-section1-title-input-${componentId}`)?.value || '';
        const section1Item1Label = document.getElementById(`menu-section1-item1-label-input-${componentId}`)?.value || '';
        const section1Item1Icon = document.getElementById(`menu-section1-item1-icon-input-${componentId}`)?.value || '';
        const section1Item1IconStyle = document.getElementById(`menu-section1-item1-icon-style-select-${componentId}`)?.value || 'regular';
        const section1Item1Active = document.getElementById(`menu-section1-item1-active-toggle-${componentId}`)?.checked || false;
        const section1Item1Disabled = document.getElementById(`menu-section1-item1-disabled-toggle-${componentId}`)?.checked || false;
        const section1Item2Label = document.getElementById(`menu-section1-item2-label-input-${componentId}`)?.value || '';
        const section1Item2Icon = document.getElementById(`menu-section1-item2-icon-input-${componentId}`)?.value || '';
        const section1Item2IconStyle = document.getElementById(`menu-section1-item2-icon-style-select-${componentId}`)?.value || 'regular';
        const section1Item2Active = document.getElementById(`menu-section1-item2-active-toggle-${componentId}`)?.checked || false;
        const section1Item2Disabled = document.getElementById(`menu-section1-item2-disabled-toggle-${componentId}`)?.checked || false;
        
        // SecciÃ³n 2
        const section2Title = document.getElementById(`menu-section2-title-input-${componentId}`)?.value || '';
        const section2Item1Label = document.getElementById(`menu-section2-item1-label-input-${componentId}`)?.value || '';
        const section2Item1Icon = document.getElementById(`menu-section2-item1-icon-input-${componentId}`)?.value || '';
        const section2Item1IconStyle = document.getElementById(`menu-section2-item1-icon-style-select-${componentId}`)?.value || 'regular';
        const section2Item1Active = document.getElementById(`menu-section2-item1-active-toggle-${componentId}`)?.checked || false;
        const section2Item1Disabled = document.getElementById(`menu-section2-item1-disabled-toggle-${componentId}`)?.checked || false;
        const section2Item2Label = document.getElementById(`menu-section2-item2-label-input-${componentId}`)?.value || '';
        const section2Item2Icon = document.getElementById(`menu-section2-item2-icon-input-${componentId}`)?.value || '';
        const section2Item2IconStyle = document.getElementById(`menu-section2-item2-icon-style-select-${componentId}`)?.value || 'regular';
        const section2Item2Badge = parseInt(document.getElementById(`menu-section2-item2-badge-input-${componentId}`)?.value || '0');
        const section2Item2BadgeVariant = document.getElementById(`menu-section2-item2-badge-variant-select-${componentId}`)?.value || 'primary';
        const section2Item2Active = document.getElementById(`menu-section2-item2-active-toggle-${componentId}`)?.checked || false;
        const section2Item2Disabled = document.getElementById(`menu-section2-item2-disabled-toggle-${componentId}`)?.checked || false;
        const section2Item3Label = document.getElementById(`menu-section2-item3-label-input-${componentId}`)?.value || '';
        const section2Item3Icon = document.getElementById(`menu-section2-item3-icon-input-${componentId}`)?.value || '';
        const section2Item3IconStyle = document.getElementById(`menu-section2-item3-icon-style-select-${componentId}`)?.value || 'regular';
        const section2Item3Active = document.getElementById(`menu-section2-item3-active-toggle-${componentId}`)?.checked || false;
        const section2Item3Disabled = document.getElementById(`menu-section2-item3-disabled-toggle-${componentId}`)?.checked || false;
        
        // Usuario
        const userAvatarImage = document.getElementById(`menu-user-avatar-image-input-${componentId}`)?.value || '';
        const userName = document.getElementById(`menu-user-name-input-${componentId}`)?.value || '';
        const userRole = document.getElementById(`menu-user-role-input-${componentId}`)?.value || '';
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Generar HTML usando tokens UBITS
        const menuHTML = generateMenuHTML({
          logoImage,
          appName,
          logoHref,
          width,
          section1Title,
          section1Item1Label,
          section1Item1Icon,
          section1Item1IconStyle,
          section1Item1Active,
          section1Item1Disabled,
          section1Item2Label,
          section1Item2Icon,
          section1Item2IconStyle,
          section1Item2Active,
          section1Item2Disabled,
          section2Title,
          section2Item1Label,
          section2Item1Icon,
          section2Item1IconStyle,
          section2Item1Active,
          section2Item1Disabled,
          section2Item2Label,
          section2Item2Icon,
          section2Item2IconStyle,
          section2Item2Badge,
          section2Item2BadgeVariant,
          section2Item2Active,
          section2Item2Disabled,
          section2Item3Label,
          section2Item3Icon,
          section2Item3IconStyle,
          section2Item3Active,
          section2Item3Disabled,
          userAvatarImage,
          userName,
          userRole
        });
        
        // Crear contenedor para el menÃº
        const menuContainer = document.createElement('div');
        menuContainer.style.cssText = `
          position: relative;
          height: 600px;
          min-height: 600px;
          background: var(--ubits-bg-1);
          display: flex;
          flex-direction: column;
          overflow: hidden;
          border-radius: 8px;
        `;
        menuContainer.innerHTML = menuHTML;
        previewContainer.appendChild(menuContainer);
        
        // Inicializar eventos del menÃº
        initializeMenuPreview(menuContainer, {
          logoImage,
          appName,
          logoHref,
          width,
          section1Title,
          section1Item1Label,
          section1Item1Icon,
          section1Item1IconStyle,
          section1Item1Active,
          section1Item1Disabled,
          section1Item2Label,
          section1Item2Icon,
          section1Item2IconStyle,
          section1Item2Active,
          section1Item2Disabled,
          section2Title,
          section2Item1Label,
          section2Item1Icon,
          section2Item1IconStyle,
          section2Item1Active,
          section2Item1Disabled,
          section2Item2Label,
          section2Item2Icon,
          section2Item2IconStyle,
          section2Item2Badge,
          section2Item2BadgeVariant,
          section2Item2Active,
          section2Item2Disabled,
          section2Item3Label,
          section2Item3Icon,
          section2Item3IconStyle,
          section2Item3Active,
          section2Item3Disabled,
          userAvatarImage,
          userName,
          userRole
        });
        
        console.log('âœ… Menu preview actualizado');
      };
      
      // FunciÃ³n helper para generar HTML de Menu usando tokens UBITS
      function generateMenuHTML(options) {
        const {
          logoImage,
          appName,
          logoHref,
          width = 280,
          section1Title,
          section1Item1Label,
          section1Item1Icon,
          section1Item1IconStyle = 'regular',
          section1Item1Active = false,
          section1Item1Disabled = false,
          section1Item2Label,
          section1Item2Icon,
          section1Item2IconStyle = 'regular',
          section1Item2Active = false,
          section1Item2Disabled = false,
          section2Title,
          section2Item1Label,
          section2Item1Icon,
          section2Item1IconStyle = 'regular',
          section2Item1Active = false,
          section2Item1Disabled = false,
          section2Item2Label,
          section2Item2Icon,
          section2Item2IconStyle = 'regular',
          section2Item2Badge = 0,
          section2Item2BadgeVariant = 'primary',
          section2Item2Active = false,
          section2Item2Disabled = false,
          section2Item3Label,
          section2Item3Icon,
          section2Item3IconStyle = 'regular',
          section2Item3Active = false,
          section2Item3Disabled = false,
          userAvatarImage,
          userName,
          userRole
        } = options;
        
        // Helper para renderizar iconos
        function renderIcon(iconName, iconStyle) {
          if (!iconName) return '';
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="${iconClass} ${name}"></i>`;
        }
        
        // Helper para renderizar badge
        function renderBadge(content, variant) {
          if (!content || content === 0) return '';
          return `<span class="ubits-badge ubits-badge--${variant} ubits-badge--number ubits-badge--sm">${content}</span>`;
        }
        
        // Construir secciones
        const sections = [];
        
        // SecciÃ³n 1
        if (section1Title) {
          const section1Items = [];
          if (section1Item1Label) {
            section1Items.push({
              id: 'section1-item1',
              label: section1Item1Label,
              icon: renderIcon(section1Item1Icon, section1Item1IconStyle),
              active: section1Item1Active,
              disabled: section1Item1Disabled
            });
          }
          if (section1Item2Label) {
            section1Items.push({
              id: 'section1-item2',
              label: section1Item2Label,
              icon: renderIcon(section1Item2Icon, section1Item2IconStyle),
              active: section1Item2Active,
              disabled: section1Item2Disabled
            });
          }
          if (section1Items.length > 0) {
            sections.push({ id: 'section1', title: section1Title, items: section1Items });
          }
        }
        
        // SecciÃ³n 2
        if (section2Title) {
          const section2Items = [];
          if (section2Item1Label) {
            section2Items.push({
              id: 'section2-item1',
              label: section2Item1Label,
              icon: renderIcon(section2Item1Icon, section2Item1IconStyle),
              active: section2Item1Active,
              disabled: section2Item1Disabled
            });
          }
          if (section2Item2Label) {
            section2Items.push({
              id: 'section2-item2',
              label: section2Item2Label,
              icon: renderIcon(section2Item2Icon, section2Item2IconStyle),
              badge: renderBadge(section2Item2Badge, section2Item2BadgeVariant),
              active: section2Item2Active,
              disabled: section2Item2Disabled
            });
          }
          if (section2Item3Label) {
            section2Items.push({
              id: 'section2-item3',
              label: section2Item3Label,
              icon: renderIcon(section2Item3Icon, section2Item3IconStyle),
              active: section2Item3Active,
              disabled: section2Item3Disabled
            });
          }
          if (section2Items.length > 0) {
            sections.push({ id: 'section2', title: section2Title, items: section2Items });
          }
        }
        
        // Renderizar logo
        const logoHTML = logoImage ? `
          <div class="ubits-menu-header">
            <div class="ubits-menu-logo" ${logoHref ? `data-href="${logoHref}"` : ''}>
              <img src="${logoImage}" alt="${appName || 'Logo'}" />
            </div>
            ${appName ? `<div class="ubits-menu-app-name">${appName}</div>` : ''}
          </div>
        ` : '';
        
        // Renderizar secciones
        const sectionsHTML = sections.map(section => `
          <div class="ubits-menu-section" data-section-id="${section.id}">
            <h3 class="ubits-menu-section-title">${section.title}</h3>
            <div class="ubits-menu-section-items">
              ${section.items.map(item => {
                const classes = [
                  'ubits-menu-item',
                  item.active && 'ubits-menu-item--active',
                  item.disabled && 'ubits-menu-item--disabled'
                ].filter(Boolean).join(' ');
                const disabledAttr = item.disabled ? 'disabled' : '';
                return `
                  <button class="${classes}" data-item-id="${item.id}" data-section-id="${section.id}" ${disabledAttr}>
                    ${item.icon ? `<span class="ubits-menu-item-icon">${item.icon}</span>` : ''}
                    <span class="ubits-menu-item-label">${item.label}</span>
                    ${item.badge ? `<span class="ubits-menu-item-right">${item.badge}</span>` : ''}
                  </button>
                `;
              }).join('')}
            </div>
          </div>
        `).join('');
        
        // Renderizar informaciÃ³n de usuario
        const userInfoHTML = (userAvatarImage && userName && userRole) ? `
          <div class="ubits-menu-user-info">
            <div class="ubits-menu-user-avatar">
              <img src="${userAvatarImage}" alt="${userName}" />
            </div>
            <div class="ubits-menu-user-details">
              <div class="ubits-menu-user-name">${userName}</div>
              <div class="ubits-menu-user-role">${userRole}</div>
            </div>
          </div>
        ` : '';
        
        return `
          <aside class="ubits-menu" style="width: ${width}px;">
            ${logoHTML}
            <div class="ubits-menu-body">
              ${sectionsHTML}
            </div>
            ${userInfoHTML}
          </aside>
        `;
      }
      
      // FunciÃ³n para inicializar eventos del menÃº
      function initializeMenuPreview(container, options) {
        const menuElement = container.querySelector('.ubits-menu');
        if (!menuElement) return;
        
        // Click en logo
        const logoElement = menuElement.querySelector('.ubits-menu-logo');
        if (logoElement && options.logoHref) {
          logoElement.addEventListener('click', () => {
            if (options.logoHref && options.logoHref !== '#') {
              window.location.href = options.logoHref;
            }
          });
        }
        
        // Click en items del menÃº
        const menuItems = menuElement.querySelectorAll('.ubits-menu-item');
        menuItems.forEach((itemElement) => {
          itemElement.addEventListener('click', (e) => {
            e.preventDefault();
            
            const itemId = itemElement.getAttribute('data-item-id');
            const sectionId = itemElement.getAttribute('data-section-id');
            const isDisabled = itemElement.classList.contains('ubits-menu-item--disabled');
            
            if (isDisabled) return;
            
            // Remover active de todos los items
            menuItems.forEach(btn => btn.classList.remove('ubits-menu-item--active'));
            
            // Agregar active al item clickeado
            itemElement.classList.add('ubits-menu-item--active');
            
            console.log('Menu item clicked:', itemId, sectionId);
          });
        });
      }
      
      // ========================================
      // FUNCIONES DE CONTROL PARA MENUBAR
      // ========================================
      
      // FunciÃ³n para controlar Menubar
      window.setMenubarControl = function(option, value, componentId) {
        console.log('ğŸ›ï¸ setMenubarControl:', option, value, componentId);
        
        // Actualizar estados de toggles
        const toggleStatusMap = {
          'showIcons': 'menubar-show-icons-status',
          'hasDropdowns': 'menubar-has-dropdowns-status',
          'hasNestedSubmenus': 'menubar-has-nested-submenus-status'
        };
        
        if (toggleStatusMap[option]) {
          const statusEl = document.getElementById(`${toggleStatusMap[option]}-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar preview
        if (typeof window.updateMenubarPreview === 'function') {
          window.updateMenubarPreview(componentId);
        }
      };
      
      // FunciÃ³n para actualizar el preview de Menubar usando tokens UBITS
      window.updateMenubarPreview = function(componentId) {
        console.log('ğŸ”„ updateMenubarPreview llamado con componentId:', componentId);
        const previewContainer = document.getElementById(`menubar-preview-${componentId}`);
        if (!previewContainer) {
          console.error('âŒ Preview container no encontrado:', `menubar-preview-${componentId}`);
          return;
        }
        console.log('âœ… Preview container encontrado:', previewContainer);
        
        // Obtener valores de los controles
        const itemCount = parseInt(document.getElementById(`menubar-item-count-input-${componentId}`)?.value || '4');
        const showIcons = document.getElementById(`menubar-show-icons-toggle-${componentId}`)?.checked !== false;
        const hasDropdowns = document.getElementById(`menubar-has-dropdowns-toggle-${componentId}`)?.checked !== false;
        const hasNestedSubmenus = document.getElementById(`menubar-has-nested-submenus-toggle-${componentId}`)?.checked === true;
        const activeItemId = document.getElementById(`menubar-active-item-id-input-${componentId}`)?.value || 'projects';
        
        // Limpiar contenedor
        previewContainer.innerHTML = '';
        
        // Crear contenedor para el menubar
        const menubarContainer = document.createElement('div');
        menubarContainer.id = `menubar-preview-container-${componentId}`;
        menubarContainer.style.cssText = `
          position: relative;
          width: 100%;
          background: var(--ubits-bg-1);
          border-radius: var(--ubits-border-radius-md, 8px);
          padding: var(--ubits-spacing-md, 16px);
        `;
        previewContainer.appendChild(menubarContainer);
        
        // Generar items
        const items = createMenubarExampleItems(itemCount, showIcons, hasDropdowns, hasNestedSubmenus, activeItemId);
        
        // Generar HTML usando tokens UBITS
        const menubarHTML = generateMenubarHTML(items);
        menubarContainer.innerHTML = menubarHTML;
        
        // Inicializar eventos del menubar
        initializeMenubarPreview(menubarContainer, items, activeItemId);
        
        console.log('âœ… Menubar preview actualizado');
      };
      
      // FunciÃ³n helper para crear items de ejemplo del menubar
      function createMenubarExampleItems(itemCount, showIcons, hasDropdowns, hasNestedSubmenus, activeItemId) {
        const items = [];
        
        // Item Home (sin dropdown)
        items.push({
          id: 'home',
          label: 'Home',
          icon: showIcons ? 'house' : undefined,
          iconStyle: 'regular',
          href: '#',
          active: activeItemId === 'home',
        });
        
        // Item Features (sin dropdown)
        if (itemCount > 1) {
          items.push({
            id: 'features',
            label: 'Features',
            icon: showIcons ? 'star' : undefined,
            iconStyle: 'regular',
            href: '#',
            active: activeItemId === 'features',
          });
        }
        
        // Item Projects (con dropdown)
        if (itemCount > 2 && hasDropdowns) {
          items.push({
            id: 'projects',
            label: 'Projects',
            icon: showIcons ? 'magnifying-glass' : undefined,
            iconStyle: 'regular',
            active: activeItemId === 'projects',
            submenu: [
              {
                id: 'components',
                label: 'Components',
                icon: showIcons ? 'bolt' : undefined,
                iconStyle: 'regular',
                href: '#',
                active: activeItemId === 'components',
                ...(hasNestedSubmenus ? {
                  submenu: [
                    {
                      id: 'button',
                      label: 'Button',
                      icon: showIcons ? 'circle' : undefined,
                      iconStyle: 'regular',
                      href: '#',
                    },
                    {
                      id: 'input',
                      label: 'Input',
                      icon: showIcons ? 'square' : undefined,
                      iconStyle: 'regular',
                      href: '#',
                    },
                  ],
                } : {}),
              },
              {
                id: 'blocks',
                label: 'Blocks',
                icon: showIcons ? 'grid-2' : undefined,
                iconStyle: 'regular',
                href: '#',
                active: activeItemId === 'blocks',
              },
              {
                id: 'ui-kit',
                label: 'UI Kit',
                icon: showIcons ? 'pencil' : undefined,
                iconStyle: 'regular',
                href: '#',
                active: activeItemId === 'ui-kit',
              },
              {
                id: 'templates',
                label: 'Templates',
                icon: showIcons ? 'palette' : undefined,
                iconStyle: 'regular',
                ...(hasNestedSubmenus ? {
                  submenu: [
                    {
                      id: 'admin',
                      label: 'Admin',
                      icon: showIcons ? 'user-shield' : undefined,
                      iconStyle: 'regular',
                      href: '#',
                    },
                    {
                      id: 'colaborador',
                      label: 'Colaborador',
                      icon: showIcons ? 'user' : undefined,
                      iconStyle: 'regular',
                      href: '#',
                    },
                  ],
                } : {
                  href: '#',
                }),
              },
            ],
          });
        } else if (itemCount > 2) {
          items.push({
            id: 'projects',
            label: 'Projects',
            icon: showIcons ? 'magnifying-glass' : undefined,
            iconStyle: 'regular',
            href: '#',
            active: activeItemId === 'projects',
          });
        }
        
        // Item Contact (sin dropdown)
        if (itemCount > 3) {
          items.push({
            id: 'contact',
            label: 'Contact',
            icon: showIcons ? 'envelope' : undefined,
            iconStyle: 'regular',
            href: '#',
            active: activeItemId === 'contact',
          });
        }
        
        // Items adicionales si itemCount > 4
        for (let i = 4; i < itemCount; i++) {
          items.push({
            id: `item-${i}`,
            label: `Item ${i}`,
            icon: showIcons ? 'circle' : undefined,
            iconStyle: 'regular',
            href: '#',
            active: activeItemId === `item-${i}`,
          });
        }
        
        return items;
      }
      
      // FunciÃ³n helper para generar HTML de Menubar usando tokens UBITS
      function generateMenubarHTML(items) {
        // Helper para renderizar iconos
        function renderIcon(iconName, iconStyle) {
          if (!iconName) return '';
          const iconClass = iconStyle === 'solid' ? 'fas' : 'far';
          const name = iconName.startsWith('fa-') ? iconName : `fa-${iconName}`;
          return `<i class="${iconClass} ${name}"></i>`;
        }
        
        // Helper para renderizar submenu item (puede tener submenÃº anidado)
        function renderSubmenuItem(item, parentId, level = 1) {
          const classes = [
            'ubits-menubar-submenu-item',
            item.active && 'ubits-menubar-submenu-item--active',
            item.disabled && 'ubits-menubar-submenu-item--disabled',
            item.submenu && item.submenu.length > 0 && 'ubits-menubar-submenu-item--has-submenu'
          ].filter(Boolean).join(' ');
          
          const iconHTML = item.icon ? renderIcon(item.icon, item.iconStyle) : '';
          const hasSubmenu = item.submenu && item.submenu.length > 0;
          const chevronHTML = hasSubmenu ? '<i class="far fa-chevron-right ubits-menubar-submenu-chevron"></i>' : '';
          const submenuId = hasSubmenu ? `ubits-menubar-submenu-${parentId}-${item.id}-${level}` : '';
          
          const submenuHTML = hasSubmenu ? `
            <ul class="ubits-menubar-submenu ubits-menubar-submenu--level-${level + 1}" id="${submenuId}">
              ${item.submenu.map(subItem => renderSubmenuItem(subItem, `${parentId}-${item.id}`, level + 1)).join('')}
            </ul>
          ` : '';
          
          return `
            <li class="${classes}" data-item-id="${item.id}" data-parent-id="${parentId}">
              <a href="${item.href || '#'}" class="ubits-menubar-submenu-link" ${item.disabled ? 'disabled' : ''} ${hasSubmenu ? `data-submenu-id="${submenuId}"` : ''}>
                ${iconHTML ? `<span class="ubits-menubar-submenu-icon">${iconHTML}</span>` : ''}
                <span class="ubits-menubar-submenu-label">${item.label}</span>
                ${chevronHTML}
              </a>
              ${submenuHTML}
            </li>
          `;
        }
        
        // Renderizar dropdown
        function renderDropdown(item) {
          if (!item.submenu || item.submenu.length === 0) return '';
          const dropdownId = `ubits-menubar-dropdown-${item.id}`;
          return `
            <ul class="ubits-menubar-dropdown" id="${dropdownId}">
              ${item.submenu.map(subItem => renderSubmenuItem(subItem, item.id)).join('')}
            </ul>
          `;
        }
        
        // Renderizar items del menubar
        const itemsHTML = items.map(item => {
          const classes = [
            'ubits-menubar-item',
            item.active && 'ubits-menubar-item--active',
            item.disabled && 'ubits-menubar-item--disabled',
            item.submenu && item.submenu.length > 0 && 'ubits-menubar-item--has-dropdown'
          ].filter(Boolean).join(' ');
          
          const iconHTML = item.icon ? renderIcon(item.icon, item.iconStyle) : '';
          const hasDropdown = item.submenu && item.submenu.length > 0;
          const chevronHTML = hasDropdown ? '<i class="far fa-chevron-down ubits-menubar-chevron"></i>' : '';
          const dropdownId = hasDropdown ? `ubits-menubar-dropdown-${item.id}` : '';
          
          return `
            <li class="${classes}" data-item-id="${item.id}">
              <a href="${item.href || '#'}" class="ubits-menubar-link" ${item.disabled ? 'disabled' : ''} ${hasDropdown ? `data-dropdown-id="${dropdownId}" aria-haspopup="true" aria-expanded="false"` : ''}>
                ${iconHTML ? `<span class="ubits-menubar-icon">${iconHTML}</span>` : ''}
                <span class="ubits-menubar-label">${item.label}</span>
                ${chevronHTML}
              </a>
              ${renderDropdown(item)}
            </li>
          `;
        }).join('');
        
        return `
          <nav class="ubits-menubar">
            <ul class="ubits-menubar-list">
              ${itemsHTML}
            </ul>
          </nav>
        `;
      }
      
      // FunciÃ³n para inicializar eventos del menubar
      function initializeMenubarPreview(container, items, activeItemId) {
        const menubarElement = container.querySelector('.ubits-menubar');
        if (!menubarElement) return;
        
        // Aplicar estado active basado en los items
        items.forEach(item => {
          if (item.active) {
            const itemElement = menubarElement.querySelector(`.ubits-menubar-item[data-item-id="${item.id}"]`);
            if (itemElement) {
              itemElement.classList.add('ubits-menubar-item--active');
            }
          }
          // TambiÃ©n verificar subitems
          if (item.submenu) {
            item.submenu.forEach(subItem => {
              if (subItem.active) {
                const subItemElement = menubarElement.querySelector(`[data-item-id="${subItem.id}"][data-parent-id="${item.id}"]`);
                if (subItemElement) {
                  subItemElement.classList.add('ubits-menubar-submenu-item--active');
                }
              }
              // Verificar submenÃºs anidados
              if (subItem.submenu) {
                subItem.submenu.forEach(nestedItem => {
                  if (nestedItem.active) {
                    const nestedElement = menubarElement.querySelector(`[data-item-id="${nestedItem.id}"]`);
                    if (nestedElement) {
                      nestedElement.classList.add('ubits-menubar-submenu-item--active');
                    }
                  }
                });
              }
            });
          }
        });
        
        // Click en items principales del menubar para activarlos
        const menubarItems = menubarElement.querySelectorAll('.ubits-menubar-item');
        menubarItems.forEach(itemElement => {
          const link = itemElement.querySelector('.ubits-menubar-link');
          if (link) {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              
              const dropdownId = link.getAttribute('data-dropdown-id');
              const hasDropdown = !!dropdownId;
              
              // Si tiene dropdown, primero manejar el dropdown
              if (hasDropdown) {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                  const isExpanded = link.getAttribute('aria-expanded') === 'true';
                  const willBeExpanded = !isExpanded;
                  
                  // Toggle del dropdown
                  link.setAttribute('aria-expanded', willBeExpanded);
                  if (willBeExpanded) {
                    dropdown.classList.add('ubits-menubar-dropdown--open');
                  } else {
                    dropdown.classList.remove('ubits-menubar-dropdown--open');
                  }
                  
                  // Si se estÃ¡ cerrando el dropdown, no cambiar el estado activo
                  if (!willBeExpanded) {
                    return;
                  }
                  
                  // Si se estÃ¡ abriendo, activar el item
                  // Remover active de todos los items principales
                  menubarItems.forEach(btn => btn.classList.remove('ubits-menubar-item--active'));
                  
                  // Remover active de todos los subitems
                  const allSubItems = menubarElement.querySelectorAll('.ubits-menubar-submenu-item');
                  allSubItems.forEach(subItem => subItem.classList.remove('ubits-menubar-submenu-item--active'));
                  
                  // Agregar active al item clickeado
                  itemElement.classList.add('ubits-menubar-item--active');
                  
                  return; // Salir temprano si tiene dropdown
                }
              }
              
              // Si no tiene dropdown, activar el item normalmente
              // Remover active de todos los items principales
              menubarItems.forEach(btn => btn.classList.remove('ubits-menubar-item--active'));
              
              // Remover active de todos los subitems
              const allSubItems = menubarElement.querySelectorAll('.ubits-menubar-submenu-item');
              allSubItems.forEach(subItem => subItem.classList.remove('ubits-menubar-submenu-item--active'));
              
              // Agregar active al item clickeado
              itemElement.classList.add('ubits-menubar-item--active');
            });
          }
        });
        
        // Click en subitems del dropdown para activarlos
        const submenuItems = menubarElement.querySelectorAll('.ubits-menubar-submenu-item');
        submenuItems.forEach(subItemElement => {
          const link = subItemElement.querySelector('.ubits-menubar-submenu-link');
          if (link) {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              
              // Remover active de todos los items principales
              menubarItems.forEach(btn => btn.classList.remove('ubits-menubar-item--active'));
              
              // Remover active de todos los subitems
              submenuItems.forEach(item => item.classList.remove('ubits-menubar-submenu-item--active'));
              
              // Agregar active al subitem clickeado
              subItemElement.classList.add('ubits-menubar-submenu-item--active');
              
              // TambiÃ©n activar el item padre si existe
              const parentId = subItemElement.getAttribute('data-parent-id');
              if (parentId) {
                const parentItem = menubarElement.querySelector(`.ubits-menubar-item[data-item-id="${parentId}"]`);
                if (parentItem) {
                  parentItem.classList.add('ubits-menubar-item--active');
                  // Asegurar que el dropdown estÃ© abierto
                  const parentLink = parentItem.querySelector('.ubits-menubar-link');
                  if (parentLink) {
                    const dropdownId = parentLink.getAttribute('data-dropdown-id');
                    if (dropdownId) {
                      const dropdown = document.getElementById(dropdownId);
                      if (dropdown) {
                        parentLink.setAttribute('aria-expanded', 'true');
                        dropdown.classList.add('ubits-menubar-dropdown--open');
                      }
                    }
                  }
                }
              }
              
              // Si tiene submenÃº anidado, abrirlo
              const submenuId = link.getAttribute('data-submenu-id');
              if (submenuId) {
                const submenu = document.getElementById(submenuId);
                if (submenu) {
                  submenu.classList.toggle('ubits-menubar-submenu--open');
                }
              }
            });
          }
        });
        
        // Inicializar submenÃºs anidados (solo para items que tienen submenÃº anidado)
        const submenuTriggers = menubarElement.querySelectorAll('[data-submenu-id]');
        submenuTriggers.forEach(trigger => {
          trigger.addEventListener('click', (e) => {
            // No prevenir el comportamiento por defecto aquÃ­ porque ya se maneja en el listener de subitems
            // Solo manejar el toggle del submenÃº
            const submenuId = trigger.getAttribute('data-submenu-id');
            if (submenuId) {
              const submenu = document.getElementById(submenuId);
              if (submenu) {
                submenu.classList.toggle('ubits-menubar-submenu--open');
              }
            }
          });
        });
      }
      
      // ========================================
      // PARTICIPANTS MENU PREVIEW FUNCTIONS
      // ========================================
      
      // Estado del preview del Participants Menu
      const participantsMenuPreviewState = {};
      
      // FunciÃ³n para inicializar el estado del preview del Participants Menu
      function initParticipantsMenuPreviewState(componentId) {
        if (!participantsMenuPreviewState[componentId]) {
          participantsMenuPreviewState[componentId] = {
            title: 'Participantes',
            searchPlaceholder: 'Buscar participan...',
            participantCount: 9,
            selectedParticipantId: '1',
            showAvatar: true,
            showRole: true,
            showStatusTag: true,
            enableScrollbar: true,
            currentSearchTerm: '',
            activeFilters: {
              roles: [],
              statuses: []
            }
          };
        }
        return participantsMenuPreviewState[componentId];
      }
      
      // FunciÃ³n para actualizar el preview del Participants Menu
      // ImplementaciÃ³n simplificada usando funciones disponibles en window
      window.updateParticipantsMenuPreview = async function(componentId) {
        const state = initParticipantsMenuPreviewState(componentId);
        const preview = document.getElementById(`participants-menu-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Participants Menu no encontrado:', `participants-menu-preview-${componentId}`);
          console.error('âŒ Buscando elemento con ID:', `participants-menu-preview-${componentId}`);
          // Intentar buscar el elemento de otra forma
          const altPreview = document.querySelector(`[id*="participants-menu-preview"]`);
          if (altPreview) {
            console.warn('âš ï¸ Se encontrÃ³ un elemento similar:', altPreview.id);
          }
          return;
        }
        
        console.log('âœ… Preview encontrado:', preview);
        
        // Limpiar preview
        preview.innerHTML = '';
        
        // Crear contenedor para el menÃº
        const containerId = `participants-menu-container-${componentId}`;
        const menuContainer = document.createElement('div');
        menuContainer.id = containerId;
        menuContainer.style.cssText = `
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;
        `;
        preview.appendChild(menuContainer);
        
        console.log('âœ… Contenedor del menÃº creado:', containerId);
        
        // Generar participantes de ejemplo con avatares
        const sampleParticipants = [];
        const names = ['Elkin Garcia', 'EstefanÃ­a Rojas', 'Ligia salazar', 'Cristian Perez', 'Matias Castillo', 'Nelson Prado', 'Alisson VÃ©lez', 'Andres Lopez', 'Carlos Torres', 'MarÃ­a GonzÃ¡lez', 'Juan MartÃ­nez', 'Ana RodrÃ­guez', 'Pedro SÃ¡nchez', 'Patricia FernÃ¡ndez', 'Diego RamÃ­rez', 'Valentina Morales', 'Ricardo Herrera', 'Carmen JimÃ©nez', 'Fernando Castro', 'Isabel Ruiz'];
        const roles = ['Producto', 'Ventas', 'Recursos humanos', 'TecnologÃ­a', 'Marketing'];
        const statuses = ['bajo', 'medio', 'alto', 'muy-alto'];
        // URLs de ejemplo para avatares (usando randomuser.me como en Storybook)
        const avatarUrls = [
          'https://randomuser.me/api/portraits/men/1.jpg',
          'https://randomuser.me/api/portraits/women/2.jpg',
          'https://randomuser.me/api/portraits/women/3.jpg',
          'https://randomuser.me/api/portraits/men/4.jpg',
          'https://randomuser.me/api/portraits/women/5.jpg',
          'https://randomuser.me/api/portraits/men/6.jpg',
          'https://randomuser.me/api/portraits/women/7.jpg',
          'https://randomuser.me/api/portraits/men/8.jpg',
          'https://randomuser.me/api/portraits/men/9.jpg',
          'https://randomuser.me/api/portraits/women/10.jpg',
          'https://randomuser.me/api/portraits/men/11.jpg',
          'https://randomuser.me/api/portraits/women/12.jpg',
          'https://randomuser.me/api/portraits/men/13.jpg',
          'https://randomuser.me/api/portraits/women/14.jpg',
          'https://randomuser.me/api/portraits/men/15.jpg',
          'https://randomuser.me/api/portraits/women/16.jpg',
          'https://randomuser.me/api/portraits/men/17.jpg',
          'https://randomuser.me/api/portraits/women/18.jpg',
          'https://randomuser.me/api/portraits/men/19.jpg',
          'https://randomuser.me/api/portraits/women/20.jpg'
        ];
        
        for (let i = 1; i <= state.participantCount; i++) {
          const nameIndex = (i - 1) % names.length;
          const roleIndex = (i - 1) % roles.length;
          const statusIndex = (i - 1) % statuses.length;
          const avatarIndex = (i - 1) % avatarUrls.length;
          
          sampleParticipants.push({
            id: String(i),
            name: names[nameIndex],
            role: roles[roleIndex],
            status: statuses[statusIndex],
            avatarImage: avatarUrls[avatarIndex]
          });
        }
        
        // Intentar cargar el mÃ³dulo si no estÃ¡ disponible
        if (typeof window.createParticipantsMenu !== 'function') {
          // Cargar el mÃ³dulo UMD usando script tag (funciona con file://)
          return new Promise((resolve, reject) => {
            // Verificar si ya se estÃ¡ cargando
            if (window._loadingParticipantsMenu) {
              const checkInterval = setInterval(() => {
                if (typeof window.createParticipantsMenu === 'function') {
                  clearInterval(checkInterval);
                  window.updateParticipantsMenuPreview(componentId).then(resolve).catch(reject);
                }
              }, 100);
              return;
            }
            
            window._loadingParticipantsMenu = true;
            const script = document.createElement('script');
            script.src = '../../addons/participants-menu/dist/participants-menu.umd';
            script.type = 'text/javascript'; // Asegurar que se trate como JavaScript
            console.log('ğŸ“¦ [ParticipantsMenu] Cargando script desde:', script.src);
            
            script.onload = () => {
              setTimeout(() => {
                console.log('ğŸ“¦ [ParticipantsMenu] Script cargado, verificando exposiciÃ³n...');
                console.log('ğŸ“¦ [ParticipantsMenu] window.UbitsParticipantsMenu:', window.UbitsParticipantsMenu);
                
                // Intentar diferentes formas de acceso al mÃ³dulo UMD
                let createFunc, renderFunc;
                
                if (window.UbitsParticipantsMenu) {
                  createFunc = window.UbitsParticipantsMenu.createParticipantsMenu;
                  renderFunc = window.UbitsParticipantsMenu.renderParticipantsMenu;
                  console.log('ğŸ“¦ [ParticipantsMenu] Funciones desde window.UbitsParticipantsMenu:', {
                    create: typeof createFunc,
                    render: typeof renderFunc
                  });
                }
                
                // Si no estÃ¡n en UbitsParticipantsMenu, intentar directamente en window
                if (!createFunc && window.createParticipantsMenu) {
                  createFunc = window.createParticipantsMenu;
                }
                if (!renderFunc && window.renderParticipantsMenu) {
                  renderFunc = window.renderParticipantsMenu;
                }
                
                if (typeof createFunc === 'function') {
                  window.createParticipantsMenu = createFunc;
                  console.log('âœ… [ParticipantsMenu] createParticipantsMenu disponible');
                }
                if (typeof renderFunc === 'function') {
                  window.renderParticipantsMenu = renderFunc;
                  console.log('âœ… [ParticipantsMenu] renderParticipantsMenu disponible');
                }
                
                if (typeof window.createParticipantsMenu === 'function') {
                  window._loadingParticipantsMenu = false;
                  setTimeout(() => {
                    window.updateParticipantsMenuPreview(componentId).then(resolve).catch(reject);
                  }, 100);
                } else {
                  window._loadingParticipantsMenu = false;
                  console.error('âŒ [ParticipantsMenu] Funciones no disponibles despuÃ©s de cargar el script');
                  preview.innerHTML = `
                    <div style="padding: 24px; text-align: center; color: var(--ubits-feedback-error-text);">
                      <p style="margin: 0 0 16px 0; font-weight: 600;">Error: Las funciones no estÃ¡n disponibles</p>
                      <p style="margin: 0; font-size: 12px;">Verifica la consola para mÃ¡s detalles</p>
                    </div>
                  `;
                  reject(new Error('Funciones no disponibles'));
                }
              }, 100);
            };
            
            script.onerror = (error) => {
              window._loadingParticipantsMenu = false;
              preview.innerHTML = `
                <div style="padding: 24px; text-align: center; color: var(--ubits-feedback-error-text);">
                  <p style="margin: 0 0 16px 0; font-weight: 600;">Error al cargar el provider</p>
                </div>
              `;
              reject(error);
            };
            
            document.head.appendChild(script);
          });
        }
        
        // Asegurar que todos los CSS necesarios estÃ©n cargados
        const requiredCSS = [
          { href: '../../addons/avatar/src/styles/avatar.css', id: 'avatar-css' },
          { href: '../../addons/input/src/styles/input.css', id: 'input-css' },
          { href: '../../addons/button/src/styles/button.css', id: 'button-css' },
          { href: '../../addons/scroll/src/styles/scroll.css', id: 'scroll-css' },
          { href: '../../addons/drawer/src/styles/drawer.css', id: 'drawer-css' },
          { href: '../../addons/checkbox/src/styles/checkbox.css', id: 'checkbox-css' },
          { href: '../../addons/status-tag/src/styles/status-tag.css', id: 'status-tag-css' },
          { href: '../../addons/empty-state/src/styles/empty-state.css', id: 'empty-state-css' }
        ];
        
        requiredCSS.forEach(({ href, id }) => {
          if (!document.getElementById(id) && !document.querySelector(`link[href="${href}"]`)) {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = href;
            link.id = id;
            document.head.appendChild(link);
            console.log(`ğŸ“¦ [ParticipantsMenu] CSS cargado: ${href}`);
          }
        });
        
        // Usar createParticipantsMenu si estÃ¡ disponible
        // Verificar tambiÃ©n en window.UbitsParticipantsMenu por si el mÃ³dulo se expone allÃ­
        if (typeof window.createParticipantsMenu === 'function' || 
            (window.UbitsParticipantsMenu && typeof window.UbitsParticipantsMenu.createParticipantsMenu === 'function')) {
          
          // Si no estÃ¡ en window directamente, obtenerlo de UbitsParticipantsMenu
          if (typeof window.createParticipantsMenu !== 'function' && window.UbitsParticipantsMenu) {
            window.createParticipantsMenu = window.UbitsParticipantsMenu.createParticipantsMenu;
            window.renderParticipantsMenu = window.UbitsParticipantsMenu.renderParticipantsMenu;
          }
          // Usar el provider si estÃ¡ disponible
          try {
            const menuOptions = {
              title: state.title || 'Participantes',
              searchPlaceholder: state.searchPlaceholder || 'Buscar participan...',
              participants: sampleParticipants,
              selectedParticipantId: state.selectedParticipantId,
              showAvatar: state.showAvatar !== undefined ? state.showAvatar : true,
              showRole: state.showRole !== undefined ? state.showRole : true,
              showStatusTag: state.showStatusTag !== undefined ? state.showStatusTag : true,
              enableScrollbar: state.enableScrollbar !== undefined ? state.enableScrollbar : true,
              containerId: containerId,
              onParticipantSelect: (participantId) => {
                state.selectedParticipantId = participantId;
                // Actualizar el preview si hay una instancia guardada
                if (window.participantsMenuInstances && window.participantsMenuInstances[componentId]) {
                  window.participantsMenuInstances[componentId].updateParticipantsList(
                    sampleParticipants,
                    participantId
                  );
                }
              },
              onSearchChange: (searchText) => {
                state.currentSearchTerm = searchText || '';
                // Filtrar participantes segÃºn bÃºsqueda
                let filteredParticipants = sampleParticipants.filter(p => {
                  if (!searchText || searchText.trim() === '') return true;
                  const searchTerm = searchText.toLowerCase();
                  const matchesName = p.name.toLowerCase().includes(searchTerm);
                  const matchesRole = p.role.toLowerCase().includes(searchTerm);
                  return matchesName || matchesRole;
                });
                
                // Aplicar filtros activos
                if (state.activeFilters.roles.length > 0) {
                  filteredParticipants = filteredParticipants.filter(p => 
                    state.activeFilters.roles.includes(p.role)
                  );
                }
                if (state.activeFilters.statuses.length > 0) {
                  filteredParticipants = filteredParticipants.filter(p => 
                    p.status && state.activeFilters.statuses.includes(p.status)
                  );
                }
                
                // Actualizar lista (el provider actualiza el badge automÃ¡ticamente)
                if (window.participantsMenuInstances && window.participantsMenuInstances[componentId]) {
                  window.participantsMenuInstances[componentId].updateParticipantsList(
                    filteredParticipants,
                    state.selectedParticipantId
                  );
                }
              },
              onFilterChange: (filters) => {
                state.activeFilters = filters;
                
                // Aplicar filtros a los participantes
                let filteredParticipants = [...sampleParticipants];
                
                // Filtrar por roles
                if (filters.roles.length > 0) {
                  filteredParticipants = filteredParticipants.filter(p => 
                    filters.roles.includes(p.role)
                  );
                }
                
                // Filtrar por estados
                if (filters.statuses.length > 0) {
                  filteredParticipants = filteredParticipants.filter(p => 
                    p.status && filters.statuses.includes(p.status)
                  );
                }
                
                // TambiÃ©n aplicar bÃºsqueda si hay texto
                if (state.currentSearchTerm && state.currentSearchTerm.trim() !== '') {
                  filteredParticipants = filteredParticipants.filter(p => {
                    const searchTerm = state.currentSearchTerm.toLowerCase();
                    const matchesName = p.name.toLowerCase().includes(searchTerm);
                    const matchesRole = p.role.toLowerCase().includes(searchTerm);
                    return matchesName || matchesRole;
                  });
                }
                
                // Actualizar lista
                if (window.participantsMenuInstances && window.participantsMenuInstances[componentId]) {
                  window.participantsMenuInstances[componentId].updateParticipantsList(
                    filteredParticipants,
                    state.selectedParticipantId
                  );
                }
              }
            };
            
            // Guardar instancia para poder actualizarla despuÃ©s
            if (!window.participantsMenuInstances) {
              window.participantsMenuInstances = {};
            }
            
            // Destruir instancia anterior si existe
            if (window.participantsMenuInstances[componentId]) {
              try {
                window.participantsMenuInstances[componentId].destroy();
              } catch (e) {
                console.warn('âš ï¸ [ParticipantsMenu] Error al destruir instancia anterior:', e);
              }
            }
            
            console.log('ğŸ“‹ [ParticipantsMenu] Creando instancia con opciones:', {
              title: menuOptions.title,
              participantCount: sampleParticipants.length,
              selectedId: menuOptions.selectedParticipantId,
              showAvatar: menuOptions.showAvatar,
              showRole: menuOptions.showRole,
              showStatusTag: menuOptions.showStatusTag,
              enableScrollbar: menuOptions.enableScrollbar
            });
            
            window.participantsMenuInstances[componentId] = window.createParticipantsMenu(menuOptions);
            
            console.log('âœ… [ParticipantsMenu] Instancia creada:', window.participantsMenuInstances[componentId]);
          } catch (error) {
            console.error('âŒ Error al crear Participants Menu:', error);
            preview.innerHTML = '<p style="color: var(--ubits-feedback-error-text); padding: 16px;">Error al crear el menÃº de participantes: ' + error.message + '</p>';
          }
        } else {
          // ImplementaciÃ³n inline usando funciones disponibles en window
          console.log('ğŸ“‹ [updateParticipantsMenuPreview] createParticipantsMenu no disponible');
          console.log('ğŸ“‹ [updateParticipantsMenuPreview] window.createParticipantsMenu:', typeof window.createParticipantsMenu);
          console.log('ğŸ“‹ [updateParticipantsMenuPreview] window.UbitsParticipantsMenu:', window.UbitsParticipantsMenu);
          
          // Mostrar mensaje de error mÃ¡s detallado
          preview.innerHTML = `
            <div style="padding: 24px; text-align: center; color: var(--ubits-feedback-error-text);">
              <p style="margin: 0 0 16px 0; font-weight: 600;">El provider de Participants Menu no estÃ¡ cargado.</p>
              <p style="margin: 0 0 8px 0; font-size: 14px;">Verifica la consola para mÃ¡s detalles.</p>
              <p style="margin: 0; font-size: 12px; color: var(--ubits-fg-1-medium);">AsegÃºrate de que el mÃ³dulo estÃ© compilado y disponible en: ../../addons/participants-menu/dist/participants-menu.umd</p>
            </div>
          `;
        }
      };
      
      // FunciÃ³n para establecer controles del Participants Menu
      window.setParticipantsMenuControl = function(option, value, componentId) {
        const state = initParticipantsMenuPreviewState(componentId);
        
        if (option === 'title') {
          state.title = value || 'Participantes';
        } else if (option === 'searchPlaceholder') {
          state.searchPlaceholder = value || 'Buscar participan...';
        } else if (option === 'participantCount') {
          state.participantCount = Math.max(1, Math.min(20, parseInt(value) || 9));
        } else if (option === 'selectedParticipantId') {
          state.selectedParticipantId = value || undefined;
        } else if (option === 'showAvatar') {
          state.showAvatar = value === true || value === 'true';
        } else if (option === 'showRole') {
          state.showRole = value === true || value === 'true';
        } else if (option === 'showStatusTag') {
          state.showStatusTag = value === true || value === 'true';
        } else if (option === 'enableScrollbar') {
          state.enableScrollbar = value === true || value === 'true';
        }
        
        window.updateParticipantsMenuPreview(componentId);
      };
      
      // FunciÃ³n para actualizar el preview del Card Content
      window.updateCardPreview = function(componentId) {
        const state = initCardPreviewState(componentId);
        const preview = document.getElementById(`card-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Card Content no encontrado:', `card-preview-${componentId}`);
          return;
        }
        
        // Si el progreso cambiÃ³ a 0 y el estado es default, asegurar que no se muestre barra
        if (state.progress === 0 && state.status === 'default') {
          state.progress = 0;
        } else if (state.status === 'progress' && state.progress === 0) {
          state.progress = 25; // Si estÃ¡ en progreso pero el valor es 0, poner un valor por defecto
        }
        
        // Generar HTML de la card
        const cardHTML = generateCardHTML(state);
        preview.innerHTML = cardHTML;
        
        console.log('âœ… Preview de Card Content actualizado:', state);
      };
      
      // ========================================
      // PAGINATION PREVIEW FUNCTIONS
      // ========================================
      
      // Nota: paginationPreviewState ya estÃ¡ declarado en lÃ­nea 28242, no redeclarar
      function initPaginationPreviewState(componentId) {
        if (!paginationPreviewState[componentId]) {
          paginationPreviewState[componentId] = {
            currentPage: 5,
            totalPages: 20,
            totalItems: 200,
            itemsPerPage: 10,
            variant: 'default',
            size: 'md',
            maxVisiblePages: 7,
            showFirst: true,
            showLast: true,
            showPrevNext: true,
            showInfo: true,
            showItemsPerPage: true,
            itemsPerPageOptions: [10, 20, 50, 100]
          };
        }
        return paginationPreviewState[componentId];
      }
      
      // FunciÃ³n para establecer controles del Pagination
      window.setPaginationControl = function(option, value, componentId) {
        const state = initPaginationPreviewState(componentId);
        
        if (option === 'currentPage') {
          state.currentPage = Math.max(1, Math.min(value, state.totalPages));
          const inputEl = document.getElementById(`pagination-current-page-${componentId}`);
          if (inputEl) inputEl.value = state.currentPage;
        } else if (option === 'totalPages') {
          state.totalPages = Math.max(1, value);
          const inputEl = document.getElementById(`pagination-total-pages-${componentId}`);
          if (inputEl) inputEl.value = state.totalPages;
          // Ajustar currentPage si es mayor que totalPages
          if (state.currentPage > state.totalPages) {
            state.currentPage = state.totalPages;
            const currentPageInput = document.getElementById(`pagination-current-page-${componentId}`);
            if (currentPageInput) currentPageInput.value = state.currentPage;
          }
        } else if (option === 'totalItems') {
          state.totalItems = value;
          const inputEl = document.getElementById(`pagination-total-items-${componentId}`);
          if (inputEl) inputEl.value = state.totalItems;
        } else if (option === 'itemsPerPage') {
          state.itemsPerPage = value;
          const inputEl = document.getElementById(`pagination-items-per-page-${componentId}`);
          if (inputEl) inputEl.value = state.itemsPerPage;
        } else if (option === 'variant') {
          state.variant = value;
          const selectEl = document.getElementById(`pagination-variant-select-${componentId}`);
          if (selectEl) selectEl.value = value;
        } else if (option === 'size') {
          state.size = value;
          const selectEl = document.getElementById(`pagination-size-select-${componentId}`);
          if (selectEl) selectEl.value = value;
        } else if (option === 'maxVisiblePages') {
          state.maxVisiblePages = Math.max(3, Math.min(15, value));
          const inputEl = document.getElementById(`pagination-max-visible-${componentId}`);
          if (inputEl) inputEl.value = state.maxVisiblePages;
        } else if (option === 'showFirst') {
          state.showFirst = value;
          const statusEl = document.getElementById(`pagination-show-first-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showLast') {
          state.showLast = value;
          const statusEl = document.getElementById(`pagination-show-last-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showPrevNext') {
          state.showPrevNext = value;
          const statusEl = document.getElementById(`pagination-show-prev-next-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showInfo') {
          state.showInfo = value;
          const statusEl = document.getElementById(`pagination-show-info-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        } else if (option === 'showItemsPerPage') {
          state.showItemsPerPage = value;
          const statusEl = document.getElementById(`pagination-show-items-per-page-status-${componentId}`);
          if (statusEl) statusEl.textContent = value ? 'Activado' : 'Desactivado';
        }
        
        // Actualizar el preview
        window.updatePaginationPreview(componentId);
      };
      
      // FunciÃ³n para actualizar el preview del Pagination
      window.updatePaginationPreview = function(componentId) {
        const state = initPaginationPreviewState(componentId);
        const preview = document.getElementById(`pagination-preview-${componentId}`);
        
        if (!preview) {
          console.error('âŒ Preview de Pagination no encontrado:', `pagination-preview-${componentId}`);
          return;
        }
        
        // Limpiar preview
        preview.innerHTML = '';
        
        // Cargar CSS si no estÃ¡ cargado
        if (!document.querySelector('link[href*="pagination.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/pagination/src/styles/pagination.css';
          document.head.appendChild(link);
        }
        
        // Cargar CSS de Button si no estÃ¡ cargado
        if (!document.querySelector('link[href*="button.css"]')) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '../../addons/button/src/styles/button.css';
          document.head.appendChild(link);
        }
      }
    </script>